[
  {
    "objectID": "teaching/index.html",
    "href": "teaching/index.html",
    "title": "Teaching",
    "section": "",
    "text": "Note\n\n\n\nThese materials are prepared for my teaching at the Macquarie Business School.\n\nThe content may change before the actual delivery date to ensure the most up-to-date information is provided.\nThese materials are intended solely for educational purposes within the scope of this course. Unauthorized use, distribution, or reproduction of any part of this material is prohibited.\nAdditional resources and readings may be provided throughout the course to enhance learning experience.\nPlease provide any suggestions for improvement, which will be considered for future revisions."
  },
  {
    "objectID": "teaching/index.html#session-1-2025",
    "href": "teaching/index.html#session-1-2025",
    "title": "Teaching",
    "section": "Session 1, 2025",
    "text": "Session 1, 2025\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\nDate\nLecture\nWorkshop\n\n\n\n\nFeb 27, 2025\nWeek 1 - Introduction (PDF)\nWorkshop 1\n\n\nMar 6, 2025\nWeek 2 - Risks and Regulation (PDF)\nWorkshop 2 (Jupyter Notebook)\n\n\nMar 13, 2025\nWeek 3 - Capital Management and Adequacy (PDF)\nWorkshop 3\n\n\nMar 20, 2025\nWeek 4 - Interest Rate Risk (PDF)\nWorkshop 4\n\n\nMar 27, 2025\nWeek 5 - Market Risk (PDF)\nWorkshop 5\n\n\nApr 3, 2025\nWeek 6 - Credit Risk I: Individual Loan Risk (PDF)\nWorkshop 6\n\n\nApr 10, 2025\nWeek 7 - Credit Risk II: Loan Portfolio and Concentration Risk (PDF)\nWorkshop 7\n\n\nMay 1, 2025\nWeek 8 - Liquidity Risk (PDF)\nWorkshop 8\n\n\nMay 8, 2025\nWeek 9 - Liability and Liquidity Management (PDF)\nWorkshop 9\n\n\nMay 15, 2025\nWeek 10 - Sovereign Risk, FX Risk, and Off-Balance-Sheet Risk (PDF)\nWorkshop 10\n\n\nMay 22, 2025\nWeek 11 - Loan Sales and Securitisation (PDF)\nWorkshop 11"
  },
  {
    "objectID": "teaching/index.html#session-2-2024",
    "href": "teaching/index.html#session-2-2024",
    "title": "Teaching",
    "section": "Session 2, 2024",
    "text": "Session 2, 2024\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\nDate\nLecture\nWorkshop\n\n\n\n\nJul 24, 2024\nWeek 1 - Introduction (PDF)\nWorkshop 1\n\n\nJul 31, 2024\nWeek 2 - Risks and Regulation (PDF)\nWorkshop 2\n\n\nAug 7, 2024\nWeek 3 - Capital Management and Adequacy (PDF)\nWorkshop 3\n\n\nAug 14, 2024\nWeek 4 - Interest Rate Risk (PDF)\nWorkshop 4\n\n\nAug 21, 2024\nWeek 5 - Market Risk (PDF)\nWorkshop 5\n\n\nAug 28, 2024\nWeek 6 - Credit Risk I: Individual Loan Risk (PDF)\nWorkshop 6\n\n\nSep 4, 2024\nWeek 7 - Midterm Exam\nNone\n\n\nSep 11, 2024\nWeek 8 - Credit Risk II: Loan Portfolio and Concentration Risk (PDF)\nWorkshop 8\n\n\nOct 2, 2024\nWeek 9 - Liquidity Risk (PDF)\nWorkshop 9\n\n\nOct 9, 2024\nWeek 10 - Liability and Liquidity Management (PDF)\nWorkshop 10\n\n\nOct 16, 2024\nWeek 11 - Sovereign Risk, FX Risk, and Off-Balance-Sheet Risk (PDF)\nWorkshop 11\n\n\nOct 23, 2024\nWeek 12 - Loan Sales and Securitisation (PDF)\nWorkshop 12\n\n\nOct 30, 2024\nWeek 13 - Emerging Topics in Bank Risk Management (PDF)\nNone"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#changing-dynamics",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#changing-dynamics",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Changing dynamics",
    "text": "Changing dynamics\n\nTraditional “banks”, taking deposits and grant loans, are facing increasing challenges.\nGlobal competition with other banks.\nCompetition with nonbanks or “shadow banks”.\n\nMany of banks’ functions can be now performed by nonbanks.\nFor example, FinTech firms may better reduce information asymmetry through screening and monitoring based on big data and advanced technologies (AI/ML), improved and customized services, and reduced cost of search and match with platform economy.\nMore importantly, nonbanks are not regulated or less regulated than banks.\n\nCentral bank digital currencies (CBDC).\n\nIncreased funding costs for banks if households hold CBDC instead of bank deposits.\n\nTechnological advancement.\n\nOnline/mobile banking simplifies transfer of funds.\n\nTransition from “originate and hold” to “originate and distribute” business model."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#fintech",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#fintech",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "FinTech",
    "text": "FinTech\nFinancial technology (FinTech) has been fast growing in recent years.\n\nAdoption of FinTech, measured by FinTech users as a percentage of the digitally active population, varies by country:\n\nGlobal average is 64% in 2019.\nChina and India led other countries at 87%.\nRussia and South Africa at 82%.\nAustralia was 58%.\nU.S. was 46%.\n\n\n\n\n\n\n\n\nNote\n\n\nThe Financial Stability Board (FSB) defines FinTech as “technology-enabled innovation in financial services that could result in new business models, applications, processes or products with an associated material effect on the provision of financial services.”"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#evolution-of-fintech",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#evolution-of-fintech",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Evolution of FinTech",
    "text": "Evolution of FinTech\nFinTech innovation dates back to the 1800s.\n\nIn 1866, the first trans-Atlantic telegraph cable was laid, enabling strong financial globalization.\nIn 1918, the Federal Reserve Banks established Fedwire to transfer funds using a Morse code-based telegraph system.\nIn 1933, Germany trialed the world’s first telex network, replacing the Morse key with a typewriter keyboard.\nIn 1958, Western Union began building a telex network in the United States.\nIn 1960, Quotron Systems introduced the first electronic system to provide real-time stock quotes.\nIn 1966, the telex network became the standard for long-distance communication, enabling global financial transactions."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#evolution-of-fintech-contd",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#evolution-of-fintech-contd",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Evolution of FinTech (cont’d)",
    "text": "Evolution of FinTech (cont’d)\nLate 1960s and 1970s saw rapid advancements in electronic payments.\n\nBarclays Bank installed the first ATM in London, using paper checks marked with carbon-14 for security.\nIn 1968, the UK established the Inter Bank Computer Bureau (later BACS).\nIn 1970, the US created the Clearing House Interbank Payments System (CHIPS).\nIn 1973, SWIFT was established to facilitate global interbank communications.\nIn 1971, NASDAQ, the world’s first electronic stock market, was established.\n\nThe 1980s saw the rise of electronic trading, bank mainframe computers, and better data systems.\nThe 1990s brought the Internet and e-commerce, leading to online stock brokerage websites for retail investors.\nThe early 2000s saw the introduction of stock market decimalization, algorithmic trading, and high-frequency trading (HFT).\n\nShkilko and Sokolov (2020)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#factors-driving-fintech-development",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#factors-driving-fintech-development",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Factors driving FinTech development",
    "text": "Factors driving FinTech development\nMany supply and demand factors to explain why FinTech is evolving into what it is today.\nSupply-side factors:\n\nGFC:\n\nAfter the 2008 GFC, banks shifted to comply with post-crisis regulations and implemented cost-cutting measures.\nRegulatory burdens and increased risk aversion led banks to reduce lending activities.\nNew players entered the market, using technology to overcome banks’ branch network advantage.\nPeer-to-peer (P2P) lenders targeted borrowers banks were retreating from, such as small businesses and riskier consumers.\n\nMacroeconomic conditions:\n\nThe low interest rate environment reduced profits and incentivized financial institutions to cut costs.\nFinTechs focused on cost-cutting through technology, with online lenders streamlining loan underwriting processes to reduce expenses."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#factors-driving-fintech-development-contd",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#factors-driving-fintech-development-contd",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Factors driving FinTech development (cont’d)",
    "text": "Factors driving FinTech development (cont’d)\nDemand-side factors:\n\nMobile technology:\n\nThe release of the iPhone in 2007 launched the mobile revolution, with Android further fueling the boom.\nMobile Internet traffic surged due to iOS and Android apps, with millions of apps now available on both platforms.\nSmartphones have transformed industries, including financial services, by turning phones into multifunctional devices.\nGlobal smartphone penetration reached 67% in 2020, with Europe and North America having the highest rates. \n\nDemographics:\n\nMillennials (born 1981 to 1996) became the largest generation in the U.S. labor force in 2016, representing 35%.\nMillennials are tech-savvy digital natives, optimistic about technology’s benefits.\nThey tend to distrust banks due to the 2008 financial crisis’ impact on their parents.\nMillennials are comfortable with digital spending; 64% paid for apps, and use mobile for financial transactions more than branches.\nThey frequently use mobile payments, online financial advice, and digital currencies."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#changing-relationship-between-banks-and-fintechs",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#changing-relationship-between-banks-and-fintechs",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Changing relationship between banks and FinTechs",
    "text": "Changing relationship between banks and FinTechs\n\nAs FinTechs gained traction, some predicted the demise of traditional banks.\nFinTechs benefit from fewer regulatory burdens, no legacy IT systems, agility, innovation, and a consumer-centric approach.\nSome suggest banks may evolve into “narrow banking,” holding only safe assets while FinTechs match borrowers and savers.\nJPMorgan Chase’s CEO, Jamie Dimon, warned in 2015 that “Silicon Valley is coming” for the banking industry.\nA 2015 PwC survey showed 56% of CEOs worried about cross-sector competition, with 32% citing technology as the main threat.\nBy 2016, 76% of executives believed FinTech posed risks to their business, particularly consumer banking.\n\nKey threats included loss of market share (70%), pressure on margins (70%), and increased customer churn (50%).\n\nMcKinsey estimated that 10-40% of retail banking revenues and 20-60% of profits could be at risk by 2025.\nThe bleak outlook for traditional banks began to improve over time.\nRetail banks still hold a significant and lasting advantage.\nIncreasing FinTech–bank partnerships in the future."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#bigtech-fintech",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#bigtech-fintech",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "BigTech, FinTech",
    "text": "BigTech, FinTech\n\nTech giants like Google, Apple, Amazon, and Facebook have heavily invested in FinTech for new revenue streams.\nIn 2021, big tech firms invested $1.3 billion in FinTechs, showing a rebound from the pandemic slowdown.\nBig tech companies pose a risk to traditional banks due to their agility, data expertise, and lack of legacy systems.\nThese firms have focused mainly on payments, with Facebook consolidating its platforms and Apple expanding through Apple Card and contactless payments.\nBig techs are likely to add peripheral financial services but avoid becoming full-scale banks, partnering with licensed institutions instead."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#regulatory-approaches-to-fintech",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#regulatory-approaches-to-fintech",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Regulatory approaches to FinTech",
    "text": "Regulatory approaches to FinTech\nFinTech charters and other licenses\n\nRegulators have introduced virtual bank licenses, FinTech charters, and e-money licenses to lower barriers for FinTechs.\nIn 2018, the U.S. Treasury recommended special-purpose national bank charters for FinTechs, but legal challenges have delayed their implementation, with some FinTechs seeking full national bank charters instead."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#regulatory-approaches-to-fintech-contd",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#regulatory-approaches-to-fintech-contd",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Regulatory approaches to FinTech (cont’d)",
    "text": "Regulatory approaches to FinTech (cont’d)\nRegulating BigTechs\n\nBig tech firms entering financial services can scale rapidly using existing user data and network effects, raising concerns about market power and data governance.\nIn China, Alibaba and Tencent dominate the mobile payments market, highlighting the potential for rapid market concentration.\nBig techs have expanded into lending, insurance, and wealth management, warranting close attention from regulators due to their fast growth potential.\nThe current activity-based regulatory framework, such as payment licensing in the U.S. and EU, may not be sufficient to address the unique challenges posed by big tech firms.\nProposals for entity-based regulations are emerging in the EU (Digital Markets Act), China (anti-monopoly guidelines), and the U.S. (antitrust initiatives) to address data concentration and anti-competitive practices."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#regulatory-approaches-to-fintech-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#regulatory-approaches-to-fintech-contd-1",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Regulatory approaches to FinTech (cont’d)",
    "text": "Regulatory approaches to FinTech (cont’d)\nInternational regulations\n\nTwo key EU regulations, GDPR and PSD2, have boosted the FinTech industry and its competitiveness with traditional banks.\nGDPR, adopted in 2016 and fully enforceable by 2018, gives citizens control over their personal data and requires protection of data exported outside the EU.\nGDPR promotes transparent, opt-in data collection, allowing businesses to access honestly sourced consumer data.\nPSD2, passed in 2015 and effective in 2018, mandates banks to share consumer banking data with authorized third parties, creating new opportunities for FinTechs.\nPSD2 aims to increase competition and improve online payment security by regulating the payment services industry and FinTechs’ access to banking infrastructure."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#open-banking-and-consumer-data-right-cdr",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#open-banking-and-consumer-data-right-cdr",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Open Banking and Consumer Data Right (CDR)",
    "text": "Open Banking and Consumer Data Right (CDR)\nPSD2 marks the first regulatory move to the concept of Open Banking.\nOpen Banking allows the sharing of financial data between financial institutions through the use of application programming interfaces (APIs), conditional on the consent of the data owner, the customer. In Australia, this relates to the Consumer Data Right (CDR).\n\nHe, Huang, and Zhou (2023), Babina et al. (2024)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#central-bank-digital-currency-cbdc",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#central-bank-digital-currency-cbdc",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Central Bank Digital Currency (CBDC)",
    "text": "Central Bank Digital Currency (CBDC)\n\nCentral Bank Digital Currency (CBDC) is a digital form of a country’s fiat currency issued and regulated by its central bank.\nCBDCs aim to complement physical cash by providing a digital alternative that is secure, reliable, and widely accessible.\nThere are two primary types of CBDCs: Retail CBDCs, for use by the general public, and Wholesale CBDCs, for interbank transfers and large-scale financial institutions.\nCBDCs can enhance financial inclusion by providing access to banking services for unbanked populations through digital means.\nThey improve payment efficiency by offering faster, low-cost, and secure transactions both domestically and cross-border.\nCBDCs mitigate risks associated with cryptocurrencies by providing a regulated digital currency backed by the central bank.\nCentral banks can maintain monetary policy control while tracking money flows more effectively with CBDCs.\nKey concerns include issues around privacy, cybersecurity, and the potential impact on traditional banking systems if CBDCs lead to disintermediation.\n\nWilliamson (2022), Chiu and Davoodalhosseini (2023), Chiu et al. (2023), Niepelt (2024), among others."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#suggested-readings",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nEY - Global FinTech Adoption Index 2019.\nAustralian Banking Association - Open Banking.\nConsumer Data Right (CDR)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week13/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week13/index.html#references",
    "title": "AFIN8003 Week 13 - Emerging Topics in Bank Risk Management",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nBabina, Tania, Saleem Bahaj, Greg Buchak, Filippo De Marco, Angus Foulis, Will Gornall, Francesco Mazzola, and Tong Yu. 2024. “Customer Data Access and Fintech Entry: Early Evidence from Open Banking.” Bank of England working papers 1059. Bank of England. https://ideas.repec.org/p/boe/boeewp/1059.html.\n\n\nChiu, Jonathan, and Seyed Mohammadreza Davoodalhosseini. 2023. “Central Bank Digital Currency and Banking: Macroeconomic Benefits of a Cash-Like Design.” Management Science 69 (11): 6708–30. https://doi.org/10.1287/mnsc.2021.02763.\n\n\nChiu, Jonathan, Seyed Mohammadreza Davoodalhosseini, Janet Jiang, and Yu Zhu. 2023. “Bank Market Power and Central Bank Digital Currency: Theory and Quantitative Assessment.” Journal of Political Economy 131 (5): 1213–48. https://doi.org/10.1086/722517.\n\n\nHe, Zhiguo, Jing Huang, and Jidong Zhou. 2023. “Open Banking: Credit Market Competition When Borrowers Own the Data.” Journal of Financial Economics 147 (2): 449–74. https://doi.org/10.1016/j.jfineco.2022.12.003.\n\n\nNiepelt, Dirk. 2024. “Money and Banking with Reserves and CBDC.” The Journal of Finance 79 (4): 2505–52. https://doi.org/https://doi.org/10.1111/jofi.13357.\n\n\nShkilko, Andriy, and Konstantin Sokolov. 2020. “Every Cloud Has a Silver Lining: Fast Trading, Microwave Connectivity, and Trading Costs.” The Journal of Finance 75 (6): 2899–2927. https://doi.org/10.1111/jofi.12969.\n\n\nWilliamson, Stephen. 2022. “Central Bank Digital Currency: Welfare and Policy Implications.” Journal of Political Economy 130 (11): 2829–61. https://doi.org/10.1086/720457."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#introduction",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#introduction",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Introduction",
    "text": "Introduction\n\nSo far we have discussed many risks facing financial institutions, especially banks, and some of the many methods to manage them.\nThis week, we discuss two more approaches:\n\nloan sales\nsecuritisation\n\nLoan sales involve a transfer of risk to buyers.\nSecuritisation converts loans into tradable securities.\nThey both enhance liquidity and provide funding for banks.\nThe originate-to-distribute model:\n\nmake loans\nloan sales and securitisation\nuse proceeds to originate new loans/assets"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#introduction-1",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#introduction-1",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Introduction",
    "text": "Introduction\nCentral to bank risk management is credit risk, as discussed in Week 6 and Week 8.\nTraditionally, banks adopt several mechanisms to manage credit risk:\n\ncharging higher interest rates and fees for loans extended to more risky borrowers\nrationing credits (limit the amount) to more risky borrowers\nrequiring (more) collateral for loans to more risky borrowers\nimplementing more restrictive loan covenants\ndiversification\n…\n\nIn addition, FIs can use derivatives (e.g., forward, options, swaps) to manage their credit risk.\nHowever, FIs now increasingly use loan sales and securitisation to control credit risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#loan-sales-1",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#loan-sales-1",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Loan sales",
    "text": "Loan sales\n\nThe use of credit derivatives allows an FI to reduce credit risk without removing assets from balance sheet.\nWith loan sales, a loan is originated by an FI and then sold to an outside buyer (removed from the FI’s balance sheet).\n\nThere is a transfer of ownership from the seller to the buyer.\nIf a loan is sold without recourse, the FI has no explicit liability even if the loan defaults.\nIf a loan is sold with recourse, the buy may put the loan back to the selling FI under certain conditions.\nIn practice, most loans are sold without recourse.\n\nLoan sales do not create new types of securities such as the pass-throughs, CMOs, and MBBs, which are products of securitisation."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#types-of-loan-sales",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#types-of-loan-sales",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Types of loan sales",
    "text": "Types of loan sales\n\n\nTraditional short-term loan sales\n\nsecured by assets of the borrowing firm.\nmade to investment-grade borrowers or better.\nissued for a short term (90 days or less).\nhave yields closely tied to the commercial paper rate.\nsold in units of $1 million and up.\n\n\nLeveraged loan sales\n\nterm loans (TLs).\nsecured by assets of the borrowing firm (usually given senior secured status).\na long maturity (often three- to six-year maturities).\nhave floating rates tied to LIBOR, the prime rate, or a CD rate.\nhave strong covenant protection.\n\n\n\n\n\n\n\nNote\n\n\nThe definition of “leveraged loan” is ambiguous: some use spreads (e.g., +125bps) and others use rating criteria (e.g., BB- or lower).\n\n\n\n\n\n\n\n\n\nNote\n\n\nLeveraged loans can be:\n\nnondistressed (bid price exceeds 90 cents per $1 of loans), or\ndistressed (bid price is less than 90 cents per $1 of loans or the borrower is in default)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#types-of-loan-sales-contracts",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#types-of-loan-sales-contracts",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Types of loan sales contracts",
    "text": "Types of loan sales contracts\nTwo basic forms by which loans can be transferred from seller to buyer.\n\n\nParticipation\n\nbuyer is not a party to the underlying credit agreement so that the initial contract between loan seller and borrower remains in place after the sale.\nbuyer can exercise only partial control over changes in the loan contract’s terms.\nbuyer has a double risk exposure: underlying borrower and the selling FI.\n\n\nAssignment\n\nthe most common type.\nall rights are transferred on sale, i.e. buyer holds a direct claim on the borrower.\ntransfer of ownership"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#the-bank-loan-sales-market",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#the-bank-loan-sales-market",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "The bank loan sales market",
    "text": "The bank loan sales market\n\nIrani et al. (2021) provides a good summary.\nIf you’re interested in reading more, check here."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#the-buyers-and-sellers",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#the-buyers-and-sellers",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "The buyers and sellers",
    "text": "The buyers and sellers\n\n\nBuyers\n\nInvestment banks\nVulture funds (a specialized fund that invests in distressed loans)\nOther domestic banks and foreign banks\nInsurance companies and pension funds\nBank loan mutual funds\n\n\nSellers\n\nMajor money center banks\nGovernment and government agencies\nInvestment banks\nForeign banks\n“Good bank-bad bank”\n\nSome special-purpose banks established to absorb distressed assets from “good” banks."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#why-loan-sales",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#why-loan-sales",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Why loan sales?",
    "text": "Why loan sales?\nApart from credit risk management, there are some other reasons for FIs to sell loans.\n\nReserve requirements (becoming less important)\nFee income\nCapital costs (by reducing risky assets)\nLiquidity risk (by improving asset-side liquidity)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#factors-affecting-loan-sales-growth",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#factors-affecting-loan-sales-growth",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Factors affecting loan sales growth",
    "text": "Factors affecting loan sales growth\n\nAccess to the commercial paper market\nCustomer relationship\nLegal concerns\nBIS capital requirements\nMarket value accounting\nAssert brokerage and loan trading\nGovernment loan sales\nCredit ratings\nPurchase and sale of foreign bank loans\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#introduction-2",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#introduction-2",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Introduction",
    "text": "Introduction\nAsset securitisation is another mechanism to manage credit risk, interest rate risk, liquidity and more.\n\nIt is the process of packaging loans or other assets into newly created securities and selling these asset-backed securities (ABS) to investors.\nTwo basic mechanisms of securitisation, but both involve the creation of off-balance-sheet subsidiaries:\n\nspecial-purpose vehicle (SPV, aka special-purpose entity, SPE)\nstructured investment vehicle (SIV)\n\n\nThe mechanism is:\n\nThe loans are transferred from the originating FI to the SPV or SIV.\nThe SPV or SIV securitizes the loans (either directly or through the issuance of asset-backed commercial paper) and then sells the resulting asset-backed securities to investors.\nThe proceeds of the asset-backed security sale are paid to the FI that originates the loans."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#securitisation-via-spv",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#securitisation-via-spv",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Securitisation via SPV",
    "text": "Securitisation via SPV\n\nBank pools loans and sells them to a SPV.\nSPV packages the loans, creates new securities backed by cash flows from the underlying pool, and sells them to investors.\nSPV earns fees from the creation and servicing of these securities.\nSPV ceases to exist when underlying loans mature.\n\n\n\n\n\n\n\nNote\n\n\nThe underlying loans belong to the ultimate investors in these ABS."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#securitisation-via-spv-contd",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#securitisation-via-spv-contd",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Securitisation via SPV (cont’d)",
    "text": "Securitisation via SPV (cont’d)\n\nThe Traditional Securitization Process Using a Special-Purpose Vehicle"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#securitisation-via-siv",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#securitisation-via-siv",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Securitisation via SIV",
    "text": "Securitisation via SIV\n\nBank pools loans and sells them to a SIV.\nSIV manages the loans and sells commercial paper (or bonds) to investors.\nSIV earns fees and the expected spreads between loan returns and costs paid for the commercial paper (or bonds).\nSIV continues to exist!\n\n\n\n\n\n\n\nNote\n\n\nThe underlying loans belong to the SIV.\n\n\n\nSIV acts like a traditional bank: hold loans until maturity and issue short-term debt instruments.\n\nSIV cannot take deposits.\nSIV faces run risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#securitisation-via-siv-contd",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#securitisation-via-siv-contd",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Securitisation via SIV (cont’d)",
    "text": "Securitisation via SIV (cont’d)\n\nSecuritization Process Using a Structured Investment Vehicle"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#three-major-forms-of-securitisation",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#three-major-forms-of-securitisation",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Three major forms of securitisation",
    "text": "Three major forms of securitisation\nThe major forms of asset securitisation are:\n\nthe pass-through security,\nthe collateralized mortgage obligation (CMO), and\nthe mortgage-backed bond (MBB)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#pass-through-security",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#pass-through-security",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Pass-through security",
    "text": "Pass-through security\nPass-through securities “pass through” payments by underlying borrowers (e.g., household borrowers of mortgages) to secondary market investors holding an interest in the mortgage pool.\n\nEach pass-through security represents a fractional ownership share in a mortgage pool.\n1% ownership is entitled to 1% share of the principal and interest payment made over the life of mortgages underlying the pool.\nPrepayment risk.\n\n\n\n\n\n\n\nNote\n\n\nPass-throughs are the primary mechanism for securitisation."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#collateralized-mortgage-obligation-cmo",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#collateralized-mortgage-obligation-cmo",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Collateralized Mortgage Obligation (CMO)",
    "text": "Collateralized Mortgage Obligation (CMO)\nCMO is a second and growing securitisation mechanism.\n\nCMO repackages the cash flows from mortgages differently to create a multi-class pass-through.\nEach bond class (tranche) has a different guaranteed coupon.\nBut the allocation of early cash flows from mortgage prepayments has an pre-specified order, thereby mitigating prepayment risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#collateralized-mortgage-obligation-cmo-contd",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#collateralized-mortgage-obligation-cmo-contd",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Collateralized Mortgage Obligation (CMO) (cont’d)",
    "text": "Collateralized Mortgage Obligation (CMO) (cont’d)\nClass A\n\nPrepayment used to first retire principal of Class A.\nMinimum prepayment protection.\nShortest average life.\nDepositary institutions are large buyers.\n\nClass B\n\nSome prepayment protection.\nExpected durations from five to seven years.\nPension funds and life insurance companies are primary buyers.\n\nClass C\n\nLong expected duration.\nAttractive to insurance companies and pension funds seeking long-duration assets."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#mortgage-backed-bond-mbb-and-covered-bond",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#mortgage-backed-bond-mbb-and-covered-bond",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Mortgage-Backed Bond (MBB) and Covered Bond",
    "text": "Mortgage-Backed Bond (MBB) and Covered Bond\nMBB or covered bonds are the third securitisation vehicle.\nThey differ from pass-throughs and CMOs in two main aspects:\n\nMBBs normally remain on the balance sheet.\nNo direct link between cash flows on the underlying assets and the cash flows on the bond vehicles.\n\n\n\n\n\n\n\nNote\n\n\nUnderlying mortgages are more of collateral for the MBBs."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#mortgage-backed-bond-mbb-and-covered-bond-contd",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#mortgage-backed-bond-mbb-and-covered-bond-contd",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Mortgage-Backed Bond (MBB) and Covered Bond (cont’d)",
    "text": "Mortgage-Backed Bond (MBB) and Covered Bond (cont’d)\nThe process involved:\n\nThe FI segregates a group of mortgage assets on its balance sheet and pledges (covers) this group as collateral against the MBB issue.\nA trustee normally monitors the segregation of assets and makes sure that the market value of the collateral exceeds the principal owed to MBB holders.\nAs a result, FIs back most MBB issues by excess collateral.\nThis excess collateral ensures that these bonds can be sold with a high credit rating (can be even higher than the FI itself)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#the-goods-and-bads-about-mbb-and-covered-bond",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#the-goods-and-bads-about-mbb-and-covered-bond",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "The goods and bads about MBB and covered bond",
    "text": "The goods and bads about MBB and covered bond\nHowever, MBBs are less appealing to FIs for a number of reasons:\n\nThe underlying mortgages remain on the FI’s balance sheet.\nExcess collateral exacerbates the size of mortgages tied up on the FI’s balance sheet.\nThe FI remains liable for capital adequacy and reserve requirement taxes due to these mortgages staying on balance sheet."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#the-goods-and-bads-about-mbb-and-covered-bond-contd",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#the-goods-and-bads-about-mbb-and-covered-bond-contd",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "The goods and bads about MBB and covered bond (cont’d)",
    "text": "The goods and bads about MBB and covered bond (cont’d)\n\n\n\n\n\n\nCaution\n\n\nBut FIs issuing MBBs could gain at the cost of taxpayers’ money (deposit insurance)! Let’s see why.\n\n\n\nConsider an FI with $20 million in long-term mortgages as assets financed with $10 million in short-term uninsured deposits and $10 million in insured deposits.\n\n\n\nAssets\n\nLiabilities\n\n\n\n\n\nLong-term mortgages\n$20\nInsured deposits\n$10\n\n\n\n\nUninsured deposits\n$10\n\n\n\n$20\n\n$20\n\n\n\n\nA positive duration gap: interest rate risk and more.\nUninsured depositors are likely demand higher interest rate for their deposits.\nInsured depositors may demand interest rate marginally above the risk-free rate (since their deposits are fully insured)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#the-goods-and-bads-about-mbb-and-covered-bond-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#the-goods-and-bads-about-mbb-and-covered-bond-contd-1",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "The goods and bads about MBB and covered bond (cont’d)",
    "text": "The goods and bads about MBB and covered bond (cont’d)\nTo lower the duration gap and funding cost, the FI may choose securitisation via MBB issue.\n\nPledge $12 million of the mortgages as collateral backing a $10 million long-term MBB issue.\nThis excess collateralization reduces the required yield on the MBB, to maybe even lower than the interest rate for uninsured deposits.\nThe FI can use the proceeds to retire the $10 million of uninsured deposits.\n\n\n\n\n\n\n\n\n\n\nAssets\n\nLiabilities\n\n\n\n\n\nCollateral (market value of segregated mortgages)\n$12\nMBB issue\n$10\n\n\nOther mortgages\n8\nInsured deposits\n$10\n\n\n\n$20\n\n$20\n\n\n\n\n\n\n\n\n\nImportant\n\n\nThe $10 million insured deposits are now backed only by $8 million in unpledged assets!!"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#securitisation-of-non-mortgage-assets",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#securitisation-of-non-mortgage-assets",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Securitisation of non-mortgage assets",
    "text": "Securitisation of non-mortgage assets\nThe major use of the three securitisation vehicles (pass-throughs, CMOs and MBBs) packages fixed-rate mortgages. But securitisation can also be applied for other assets:\n\nAutomobile loans.\nCredit card receivables (certificates of amortizing revolving debts).\nSmall business loans guaranteed by the Small Business Administration.\nJunk bonds.\nAdjustable rate mortgages.\nCommercial and industrial loans [collateralized loan obligations (CLOs)].\nLeveraged loans (CLOs)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#leveraged-loans-via-clos",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#leveraged-loans-via-clos",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Leveraged loans via CLOs",
    "text": "Leveraged loans via CLOs\n\nIn September 2018, the Federal Reserve highlighted leveraged loans as a financial stability risk, with similar warnings from the Bank of England, IMF, and BIS.\nThe U.S. leveraged loan market doubled in six years, with high-risk loans (debt over five times EBITDA) making up half of new corporate issuances, surpassing pre-crisis levels.\nRising interest rates led money managers to invest heavily in leveraged loans via CLOs, expanding the market to $1.3 trillion—equivalent to the 2007 subprime mortgage market.\nInvestor demand led to weaker protections on loans to junk-rated companies, with 86% now “covenant-lite”, compared to less than 25% in 2006-2007 (Berlin, Nini, and Yu 2020).\nThe rating quality of leveraged loans declined, with over 60% rated B2 or lower by 2021, yet CLOs still purchase 60-70% of these syndicated loans."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#suggested-readings",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nLoan Syndications and Trading Association (LSTA).\nBerlin, M., Nini, G., & Yu, E. G. (2020). Concentration of control rights in leveraged loan syndicates. Journal of Financial Economics, 137, 249–271.\nIrani, R. M., Iyer, R., Meisenzahl, R. R., & Peydró, J.-L. (2021). The Rise of Shadow Banking: Evidence from Capital Regulation. The Review of Financial Studies, 34, 2181–2235.."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week12/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week12/index.html#references",
    "title": "AFIN8003 Week 12 - Loan Sales and Securitisation",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nBerlin, Mitchell, Greg Nini, and Edison G. Yu. 2020. “Concentration of Control Rights in Leveraged Loan Syndicates.” Journal of Financial Economics 137 (1): 249–71. https://doi.org/10.1016/j.jfineco.2020.02.002.\n\n\nIrani, Rustom M, Rajkamal Iyer, Ralf R Meisenzahl, and José-Luis Peydró. 2021. “The Rise of Shadow Banking: Evidence from Capital Regulation.” The Review of Financial Studies 34 (5): 2181–2235. https://doi.org/10.1093/rfs/hhaa106."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#introduction",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#introduction",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Introduction",
    "text": "Introduction\n\nForeign Exchange Risk: Also known as currency risk, this is the potential for losses due to changes in exchange rates. It affects businesses and financial institutions involved in cross-border transactions, as fluctuations can alter the value of foreign-denominated assets, liabilities, or revenues.\nSovereign Risk: This risk arises when a government defaults on its debt or restricts its residents from fulfilling international debt obligations. It reflects the political and economic stability of a country, impacting investors and financial institutions with exposure to that country’s assets.\nOff-Balance-Sheet Risk: These are risks associated with contingent liabilities or commitments that do not appear on the balance sheet. Common examples include guarantees, derivatives, and letters of credit, which can lead to substantial losses if the underlying exposures materialize."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#foreign-exchange-rates",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#foreign-exchange-rates",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Foreign exchange rates",
    "text": "Foreign exchange rates\nA foreign exchange (FX) rate is the price at which one currency (e.g., the U.S. dollar) can be exchanged for another currency (e.g., the Australian dollar).\nTwo basic types of FX transactions:\n\nSpot FX transactions involve the immediate settlement, or exchange, of currencies at the current (spot) exchange rate.\nForward FX transactions involve the exchange of currencies at a specified exchange rate (i.e., the forward exchange rate) which is settled at some specified date in the future."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#source-of-fx-risk-exposure",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#source-of-fx-risk-exposure",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Source of FX risk exposure",
    "text": "Source of FX risk exposure\nAssets and liabilities denominated in foreign currencies\n\nmaking foreign currency loans\nissuing foreign currency-denominated debt\n\nThe trading of foreign currencies involves\n\npurchase and sale of currencies to complete international transactions\nfacilitating positions in foreign real and financial investments\naccommodating hedging activities\nspeculation\n\nSubstantial risk arises via open positions (unhedged positions)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#fx-exposure",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#fx-exposure",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "FX exposure",
    "text": "FX exposure\nAn FI’s overall FX exposure in any given currency can be measured by the net position exposure, which is measured in local currency as\n\\[\n\\begin{aligned}\n\\text{Net exposure}_i &= (\\text{FX assets}_i - \\text{FX liabilities}_i) + (\\text{FX bought}_i - \\text{FX sold}_i) \\\\\n&=\\text{Net foreign assets}_i + \\text{Net FX bought}_i\n\\end{aligned}\n\\]\nwhere \\(i\\) represents the \\(i\\)th currency.\n\nFI could match its foreign currency assets to its liabilities in a given currency and match buys and sells in its trading book in that foreign currency\n\nreduce its foreign exchange net exposure to zero and thus avoid FX risk.\n\nFinancial holding companies can aggregate their foreign exchange exposure through their banking, insurance and funds management businesses under one umbrella\n\nallows them to reduce their net foreign exchange exposure across all units."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#fx-rate-volatility-and-fx-exposure",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#fx-rate-volatility-and-fx-exposure",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "FX rate volatility and FX exposure",
    "text": "FX rate volatility and FX exposure\nWe can measure the potential size of an FI’s FX exposure as:\n\\[\n\\begin{aligned}\n\\text{Dollar loss/gains in currency } i &= \\text{Net exposure in foreign currency } i \\text{ measured in local currency} \\\\\n&\\times \\text{Shock (volatility) to the exchange rate of local currency to foreign currency } i\n\\end{aligned}\n\\]\n\nGreater exposure to a foreign currency combined with greater volatility of the foreign currency implies greater daily earnings at risk (DEAR).\nReason for FX volatility: fluctuations in the demand for and supply of a country’s currency"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#fx-rate-volatility-and-fx-exposure-contd",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#fx-rate-volatility-and-fx-exposure-contd",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "FX rate volatility and FX exposure (cont’d)",
    "text": "FX rate volatility and FX exposure (cont’d)\n\\[\n\\begin{aligned}\n\\text{Dollar loss/gains in currency } i &= \\text{Net exposure in foreign currency } i \\text{ measured in local currency} \\\\\n&\\times \\text{Shock (volatility) to the exchange rate of local currency to foreign currency } i\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\nExample\n\n\nOn September 8, 2024, an Australian FI has a net exposure to New Zealand dollar (NZD) of NZD$1,000,000. The exchange rate of AUD to NZD was 1.08 AUD/NZD.\nIt is now October 8, 2024, and the exchange rate becomes 1.10 AUD/NZD. The AUD has depreciated in value relative to the NZD. Calculate the FI’s dollar loss/gain for this shock to the AUD/NZD exchange rate.\n\nThe AUD value of the NZD position on September 8 is \\(\\$1,000,000\\times 1.08=\\$1,080,000\\).\nThe AUD value of the NZD position on October 8 is \\(\\$1,000,000\\times 1.10=\\$1,100,000\\).\nThe gain from the net long position in NZD is \\(\\$1,100,000-\\$1,080,000=\\$20,000\\).\n\nOr, the dollar loss/gain is\n\\(\\text{NZD}\\$1,000,000 \\times (1.10 - 1.08) = \\text{AUD}\\$20,000\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#fx-rate-volatility-and-fx-exposure-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#fx-rate-volatility-and-fx-exposure-contd-1",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "FX rate volatility and FX exposure (cont’d)",
    "text": "FX rate volatility and FX exposure (cont’d)\nThe FI has a €2.0 million long trading position in spot euros at the close of business on a particular day. The exchange rate is €0.80/$1, or $1.25/€, at the daily close. Looking back at the daily changes in the exchange rate of the euro to dollars for the past year, the FI finds that the volatility or standard deviation (\\(\\sigma\\)) of the spot exchange rate was 50 basis points (bp). What is the DEAR?\n\n\\[\n\\text{DEAR} = \\text{Dollar value of position} \\times \\text{FX volatility}\n\\]\n\nDollar value of position = €2.0 x 1.25 $/€ = $2.5 million\nFX volatility = 2.33\\(\\sigma\\) = 2.33 x 0.005 = 0.01165\nDEAR = $2,500,000 x 0.01165 = $29,125"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#interaction-of-interest-rate-inflation-and-exchange-rates",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#interaction-of-interest-rate-inflation-and-exchange-rates",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Interaction of interest rate, inflation, and exchange rates",
    "text": "Interaction of interest rate, inflation, and exchange rates\n\nGlobal financial markets are increasingly interconnected, so are interest rates, inflation, and foreign exchange rates.\nWe now explore how inflation in one country affects its foreign currency exchange rates, focusing on purchasing power parity (PPP).\nNext, we examine the relationship between domestic/foreign interest rates and spot/forward foreign exchange rates, known as interest rate parity (IRP)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#purchasing-power-parity",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#purchasing-power-parity",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Purchasing Power Parity",
    "text": "Purchasing Power Parity\nNominal interest rate \\(R\\) is basically the sum of inflation \\(i\\) and real interest rate \\(r\\):\nFor two countries, e.g., Australia (AU) and United States (US), we have:\n\\[\n\\begin{aligned}\nR_{AU} &= i_{AU} + r_{AU} \\\\\nR_{US} &= i_{US} + r_{US}\n\\end{aligned}\n\\]\nAssuming real interest rates are equal across countries: \\(r_{AU}=r_{US}\\), then\n\\[\nR_{AU} - R_{US} = i_{AU} - i_{US}\n\\]\nThat is, the (nominal) interest rate spread between Australia and the United States represents the difference in inflation rates between the two countries.\n\n\n\n\n\n\nImportant\n\n\nWhen inflation rates and/or interest rates change, foreign exchange rates (without government control) should adjust to account for relative differences in the price levels (inflation) between the two countries.\n\n\n\nThe Purchasing Power Parity (PPP) is one theory explaining how this adjustment takes place."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#purchasing-power-parity-contd",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#purchasing-power-parity-contd",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Purchasing Power Parity (cont’d)",
    "text": "Purchasing Power Parity (cont’d)\nLet’s think of an example to illustrate the idea of PPP.\n\nImagine you have $1 and can buy one candy in the U.S. Now, let’s say in Japan, 100 yen also buys one candy.\nIf $1 is worth 100 yen, things are “balanced”.\nBut if candy’s price in Japan increases to 150 yen (inflation in Japan), your $1 won’t buy as much candy anymore.\n\nPPP states that, in different countries, the same money should buy the same amount of goods and services. So, when prices change, the money’s value changes, too, to keep things fair.\n\nThe relative value of money is the exchange rate!"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#purchasing-power-parity-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#purchasing-power-parity-contd-1",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Purchasing Power Parity (cont’d)",
    "text": "Purchasing Power Parity (cont’d)\n\n\n\n\n\n\nTip\n\n\nThe PPP says that the most important factor determining exchange rates is the price differences drive trade flows and thus demand for and supplies of currencies.\n\n\n\nSpecifically, the PPP theorem states that the change in the exchange rate between two countries’ currencies is proportional to the difference in the inflation rates in the two countries. That is:\n\\[\ni_{domestic} - i_{foreign} = \\frac{\\Delta S_{domestic/foreign}}{S_{domestic/foreign}}\n\\]\nwhere\n\n\\(S_{domestic/foreign}\\) is the spot exchange rate of the domestic currency for the foreign currency\n\\(\\Delta S_{domestic/foreign}\\) is the change in the one-period spot exchange rate"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#purchasing-power-parity-contd-2",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#purchasing-power-parity-contd-2",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Purchasing Power Parity (cont’d)",
    "text": "Purchasing Power Parity (cont’d)\nSuppose that the current spot exchange rate of Australian dollars for Chinese yuan, \\(S_{AUD/CNY}\\), is 0.17 (i.e. 0.17 dollars, or 17 cents is equal to 1 yuan). The price of Chinese-produced goods increases by 10 per cent (i.e. inflation in China \\(i_C\\), is 10 per cent), and the Australian price index increases by 4 per cent (i.e. inflation in Australia, \\(i_{AUS}\\), is 4 per cent). What will be the change of the exchange rate?\nAccording to PPP:\n\\[\ni_{AUS} - i_{C} = \\frac{\\Delta S_{AUD/CNY}}{S_{AUD/CNY}}\n\\]\nSo that\n\\[\n0.04 - 0.1 = \\frac{\\Delta S_{AUD/CNY}}{0.17}\n\\]\nSolving the equation, we get \\(\\Delta S_{AUD/CNY} = −0.0102\\). Thus, it costs 1.02 cents less to receive a yuan. The Chinese yuan depreciates in value by 6 per cent against the Australian dollar as a result of its higher relative inflation rate. In other words, a 6 per cent fall in the yuan’s value translates into a new exchange rate of 0.1598 dollars per yuan."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#purchasing-power-parity-contd-3",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#purchasing-power-parity-contd-3",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Purchasing Power Parity (cont’d)",
    "text": "Purchasing Power Parity (cont’d)\nThe theory behind purchasing power parity is the law of one price, an economic concept which states that in an efficient market, if countries produce a good or service that is identical to that in other countries, that good or service must have a single price, no matter where it is purchased."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#interest-rate-parity",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#interest-rate-parity",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Interest Rate Parity",
    "text": "Interest Rate Parity\nTo illustrate (covered) interest rate parity (IRP), let’s consider two investment strategies.\nStrategy 1: Domestic Investment\n\nYou invest $1 domestically at an interest rate \\(r_d\\) for one period.\nAfter one period, your investment grows to \\(1 + r_d\\).\n\nStrategy 2: Foreign Investment with Forward Contract\n\nYou convert $1 into foreign currency at the current spot exchange rate \\(S\\), which gives \\(1/S\\) foreign currency.\nYou then invest the foreign currency amount in a foreign asset at the interest rate \\(r_f\\) for one period.\nAfter one period, this investment grows to \\((1 + r_f)\\).\nYou lock in the forward exchange rate \\(F\\) now to convert the foreign currency back to domestic currency after one period.\n\nFor these two strategies to have the same return (and eliminate arbitrage opportunities), the returns on both should be equivalent when the foreign investment is converted back using the forward rate. This gives us the CIRP condition:\n\\[\n1 + r_d = \\frac{(1 + r_f) \\cdot F}{S}\n\\]\nRearranging, we can see the relation between interest rates and the forward rate:\n\\[\nF = S \\cdot \\frac{1 + r_d}{1 + r_f}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#interest-rate-parity-contd",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#interest-rate-parity-contd",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Interest Rate Parity (cont’d)",
    "text": "Interest Rate Parity (cont’d)\nAssume the interest rate on Australian dollar securities at time \\(t\\) equals 5 per cent and the interest rate on euro loans at time \\(t\\) is 10 per cent. Further, suppose the $/€ spot exchange rate (\\(S_t\\)) at time t is $0.60/€1 and the future exchange rate (\\(F_t\\)) is $0.55/€1. If the spot exchange rate rises to $0.65/€1, what is the change on the forward exchange rate?\n\n\n\nTo find the change in the forward exchange rate due to a change in the spot exchange rate, we can start by using the IRP condition:\n\\[\nF_t = S_t \\cdot \\frac{1 + r_d}{1 + r_f}\n\\]\n\nDomestic interest rate (Australia), \\(r_d = 5\\% = 0.05\\)\nForeign interest rate (Euro), \\(r_f = 10\\% = 0.10\\)\nInitial spot exchange rate, \\(S_t = 0.60\\) AUD/EUR\nInitial forward exchange rate, \\(F_t = 0.55\\) AUD/EUR\nNew spot exchange rate, \\(S'_t = 0.65\\) AUD/EUR\n\nLet’s calculate the new forward rate using CIRP, then we’ll find the change in the forward rate.\n\nStep 1: Calculate the New Forward Rate \\(F'_t\\)\n\\[\n\\begin{aligned}\nF'_t &= S'_t \\cdot \\frac{1 + r_d}{1 + r_f} \\\\\n     &= 0.65 \\cdot \\frac{1 + 0.05}{1 + 0.10} \\\\\n     &\\approx 0.6205 \\text{ AUD/EUR}\n\\end{aligned}\n\\]\nStep 2: Calculate the Change in the Forward Rate\nNow, find the change between the new forward rate and the initial forward rate:\n\\[\n\\begin{aligned}\n\\Delta F_t &= F'_t - F_t \\\\\n           &= 0.6205 - 0.55 \\\\\n           &\\approx 0.0705 \\text{ AUD/EUR}\n\\end{aligned}\n\\]\nThe forward exchange rate increases by approximately 0.0704 AUD/EUR as a result of the rise in the spot exchange rate."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#managing-fx-risk",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#managing-fx-risk",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Managing FX risk",
    "text": "Managing FX risk\nOn-balance-sheet hedging\n\nRequires duration matching to control exposure to foreign interest rate risk\nA direct match of foreign assets and liabilities can result in positive profits for the FI\n\nOff-balance-sheet hedging\n\nUses forwards, futures, options and swaps\nExample: hedging with forwards allows FI to offset uncertainty regarding the future spot rate on a currency"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#introduction-to-sovereign-risk",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#introduction-to-sovereign-risk",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Introduction to sovereign risk",
    "text": "Introduction to sovereign risk\n\nMismatches in the size and maturities of foreign assets and liabilities expose FIs to FX risk.\nBeyond FX risk, holding assets in a foreign country also exposes FIs to country or sovereign risk.\n\ne.g., when the foreign corporation may be unable to repay the principal or interest on a loan even if it would like to.\nthe government of the country in which a borrower is headquartered may prohibit or limit debt payments\n\nforeign currency shortages, adverse political reasons, and more."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#credit-risk-vs-sovereign-risk",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#credit-risk-vs-sovereign-risk",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Credit risk vs sovereign risk",
    "text": "Credit risk vs sovereign risk\n\nCredit Risk: This is the risk that a borrower (like a domestic firm) might refuse or be unable to repay its debt. If this happens, lenders can negotiate loan restructuring or, ultimately, pursue bankruptcy proceedings to recover assets. This type of risk is typically manageable through legal proceedings within the borrower’s own country.\nSovereign Risk: This arises when a government (such as the Greek government) intervenes, restricting a domestic corporation from repaying its foreign debts, regardless of the corporation’s financial health. Unlike credit risk, sovereign risk is largely out of the borrower’s control and independent of the borrower’s creditworthiness. In cases of sovereign risk, international lenders have limited legal options, as there’s no global court to enforce debt repayment or asset liquidation against a sovereign state.\n\n\nTherefore, lending decisions to parties in foreign countries require two steps:\n\ncredit quality assessment of borrower\nsovereign risk quality assessment of country"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#forms-of-sovereign-risk",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#forms-of-sovereign-risk",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Forms of sovereign risk",
    "text": "Forms of sovereign risk\nA sovereign country’s (negative) decisions on its debt obligations or the obligations of its public and private organizations may take two forms: repudiation and restructuring.\n\nDebt repudiation\n\nAn outright cancellation of all a borrower’s current and future foreign debt and equity obligations\nIn 1996, World Bank, IMF and major governments around the world forgave the debt of the world’s poorest, most heavily indebted countries (HIPCs)\nBy 2021, 36 countries had received debt relief under the HIPC initiative, 30 of them in Africa, which totaled a reduction of $76 billion on their outstanding debt\n\nDebt restructuring\n\nChange the contractual terms of a loan, such as maturity and interest payment\n\nDelay the payment\nPay less interest\n\nMost common form of sovereign risk"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#repudiation-vs-restructuring",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#repudiation-vs-restructuring",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Repudiation vs restructuring",
    "text": "Repudiation vs restructuring\nRepudiation was more common before World War II, while post World War II, restructuring is more likely.\n\nOne reason is that most postwar international debt has been bank loans, while before the war it was mostly foreign bonds.\nBondholders are diverse - hard to reach an agreement to changes in the contractual terms on a bond.\nFewer FIs involved in international lending syndicates.\nMany international loan contracts contain “cross-default” provisions: one loan default automatically triggers all loans’ default to prevent a country from selectively defaulting.\nBank bailouts for large banks create (mis)incentives."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#country-risk-evaluation",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#country-risk-evaluation",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Country risk evaluation",
    "text": "Country risk evaluation\nAn FI can rely on both outside evaluation services or develop its internal evaluation models for sovereign risk.\n\nOutside Evaluation Models\n\nThe Euromoney Country Risk Index\nThe Institutional Investor Credit Ratings\nOECD Country Risk Classifications\n\nInternal Evaluation Models\n\nStatistical models"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation",
    "text": "Statistical models for country risk evaluation\nMost common form of country risk assessment scoring models based on economical factors\n\npick a set of variables that may be important in explaining restructuring probabilities\ndevelop the scoring model\n\nCommonly used economic ratios:\n\nTotal debt service ratio (TDSR)\n\n\\[\n\\begin{aligned}\nTDSR &= \\frac{\\text{Total debt service}}{\\text{Exports}} \\\\\n     &= \\frac{\\text{Interest} + \\text{amortisation on debt}}{\\text{Exports}} \\\\\n\\end{aligned}\n\\]\nA country’s exports are its primary way of generating dollars and other currencies.\n\nThe higher the ratio, the higher sovereign risk.\n\n\n\n\n\n\n\nNote\n\n\nCheck data at World Bank’s DataBank."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation-contd",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation-contd",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation (cont’d)",
    "text": "Statistical models for country risk evaluation (cont’d)\n\nImport ratio (IR)\n\n\\[\nIR = \\frac{\\text{Total imports}}{\\text{Total FX reserves}}\n\\]\nImports to meet demands - sometimes even food is a vital import - requires FX reserves.\n\nThe higher the ratio, the higher sovereign risk.\n\n\n\n\n\n\n\nNote\n\n\nIn 2020, Greece’s IR was 626% while China’s IR aws 70%. Greece imported more goods and services than it had serves to pay for them."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation-contd-1",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation (cont’d)",
    "text": "Statistical models for country risk evaluation (cont’d)\n\nInvestment ratio (INVR)\n\n\\[\nINVR = \\frac{\\text{Real investment}}{\\text{GDP}}\n\\]\n\nThe higher the ratio, the lower sovereign risk (arguable)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation-contd-2",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation-contd-2",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation (cont’d)",
    "text": "Statistical models for country risk evaluation (cont’d)\n\nVariance of export revenue (VAREX)\n\n\\[\nVAREX = \\sigma^2_{ER}\n\\]\n\nThe higher the variance, the higher sovereign risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation-contd-3",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation-contd-3",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation (cont’d)",
    "text": "Statistical models for country risk evaluation (cont’d)\n\nDomestic money supply growth (MG)\n\n\\[\nMG = \\frac{\\Delta M}{M}\n\\]\n\nWeaken local currency by pushing up inflation rate.\nThe higher the growth, the higher sovereign risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation-contd-4",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#statistical-models-for-country-risk-evaluation-contd-4",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation (cont’d)",
    "text": "Statistical models for country risk evaluation (cont’d)\nDevelop a scoring model \\(f\\) as a function of the chosen economic variables:\n\\[\np = f(TDSR, IR, INVR, VAREX, MG, \\dots)\n\\]\nwhere \\(p\\) can be the probability of restructuring."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#off-balance-sheet-obs-activities",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#off-balance-sheet-obs-activities",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Off-balance-sheet (OBS) activities",
    "text": "Off-balance-sheet (OBS) activities\nOBS items are “off-balance-sheet” as they appear frequently as footnotes to financial statements.\nIn economics terms, OBS items are contingent assets and liabilities that affect the future shape of an FI’s balance sheet. They potentially can produce positive or negative future cash flows for an FI.\n\nThe true picture of net worth should include market value of on- and off-balance-sheet activities.\n\nIncentives to increase OBS activities:\n\nGenerate additional income\nAvoid regulatory costs or taxes\n\nReserve requirements\nDeposit insurance premiums\nCapital adequacy requirements"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#major-types-of-obs-activities",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#major-types-of-obs-activities",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Major types of OBS activities",
    "text": "Major types of OBS activities\n\nLoan commitment: Contractual commitment to make a loan up to a stated amount at a given interest rate in the future.\nLetters of credit: Contingent guarantees sold by an FI to underwrite the performance of the buyer of the guaranty.\nDerivative contract: Agreement between two parties to exchange a standard quantity of an asset at a predetermined price at a specified date in the future.\nWhen-issued trading: Trading in securities prior to their actual issue.\nLoans sold: Loans originated by an FI and then sold to other investors that (in some cases) can be returned to the originating institution in the future if the credit quality of the loans deteriorates."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#loan-commitments",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#loan-commitments",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Loan commitments",
    "text": "Loan commitments\n\nCommitment to make a loan up to a stated amount at a given interest rate in the future\nNowadays very popular, sometimes more so than spot loans\nCharge up-front fee and back-end fee\n\nThe upfront fee applies on the whole commitment size and the back-end fee applies on any unused balances at the end of the period.\n\n\n\n\n\n\n\nExample of the fees\n\n\nSuppose an FI gives an one-year $10 million loan commitment to a firm with an upfront fee of 1/8% and back-end fee of 1/4%.\nThe upfront fee is \\(\\$10,000,000 \\times 1/8\\% = \\$12,500\\).\nIf the firm takes down only $8 million over the year, the back-end fee is \\(\\$10,000,000\\times 1/4\\% = \\$5,000\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#loan-commitments-contd",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#loan-commitments-contd",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Loan commitments (cont’d)",
    "text": "Loan commitments (cont’d)\n\n\nFor a one-year loan commitment, let:\n\nBase rate \\(BR=12\\%\\)\nRisk premium \\(\\phi=2\\%\\)\nUpfront fee \\(f_1=1/8\\%\\)\nBack-end fee \\(f_2=1/4\\%\\)\nCompensating balance \\(b=10\\%\\)\nReserve requirements \\(RR=10\\%\\)\nAverage takedown rate \\(td=75\\%\\)\n\n\nThen, the promised return \\(1+k\\) of the loan commitment is\n\\[\n\\begin{aligned}\n1+k &= 1+ \\frac{f_1+f_2(1-td) + (BR+\\phi) td}{td - b\\times td (1-RR)} \\\\\n    &= 1+ \\frac{0.00125+0.0025(1-0.75) + (0.12+0.02) 0.75}{0.75 - 0.1\\times 0.75 (1-0.1)} \\\\\n    &= 1.1566\n\\end{aligned}\n\\]\nSo \\(k=15.66\\%\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#risks-associated-with-loan-commitments",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#risks-associated-with-loan-commitments",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Risks associated with loan commitments",
    "text": "Risks associated with loan commitments\n\nInterest rate risk\n\nOn fixed-rate loan commitments the bank is exposed to interest rate risk\nOn floating-rate commitments, there is still exposure to basis risk\n\nDraw-down risk\n\nUncertainty of timing of draw-downs exposes bank to risk\nBack-end fees are intended to reduce this risk\n\nCredit risk\n\nCredit rating of the borrower may deteriorate over the life of the commitment\nAddressed through ‘adverse material change in conditions’ clause\n\nAggregate funding risk\n\nDuring a credit crunch, bank may find it difficult to meet all of the commitments (compare to externality effect)\nBank may need to adjust its risk profile on the balance sheet in order to guard against future draw-downs on loan commitments"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#letter-of-credit",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#letter-of-credit",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Letter of credit",
    "text": "Letter of credit\n\nDocumentary (Commercial) letters of credit (LCs)\n\nContingent guarantees to underwrite the trade or commercial performance\nWidely used in both domestic and international trade\n\n\n\nCommercial LC\nStandby letters of credit (SLCs)\n\nCover contingencies potentially more severe and less predictable than those covered by LCs"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#risks-associated-with-letters-of-credit",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#risks-associated-with-letters-of-credit",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Risks associated with letters of credit",
    "text": "Risks associated with letters of credit\nThe buyer of the LC may fail to perform as promised under the contractual obligation\n\nDuring the GFC, many US firms were unable to pay their maturing commercial paper (CP) obligations in the US. The amount of potential defaults would have crippled already liquidity-strapped FIs that had written standby letters of credit backing the CP issues.\nIn response, the US Federal Reserve Board (central bank) announced a support mechanism for the CP market to provide liquidity to short-term funding markets, through which the Federal Reserve purchased CPs.\nThus rather than having to draw on FI letters of credit to pay the CP liabilities, the US government bailed out these securities and the FIs that were backing them."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#derivative-contract",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#derivative-contract",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Derivative contract",
    "text": "Derivative contract\n\nFIs can be either\n\nusers of derivative contracts for hedging and other purposes, or\ndealers that act as counterparties in trades with customers for a fee\n\nIn Australia, most banks act in both capacities\nFutures, forwards, swaps and options\n\nForward contracts involve substantial counterparty risk\nOther derivatives create far less default risk\nMarket risk"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#sale-of-when-issued-securities",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#sale-of-when-issued-securities",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Sale of when-issued securities",
    "text": "Sale of when-issued securities\n\nCommitments to buy and sell securities before they are issued: ‘when issued (WI) trading’\nExample: new issue of T-Notes announced by RBA\nBanks who bid in the T-Notes auction can trade them before the announcement of the successful bidders through forward sales.\nFIs may sell the yet-to-be-issued Treasury securities for forward delivery to customers in the secondary market at a margin above the price they expect to pay at the tender.\nRisk of ‘over-commitment’"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#loans-sold",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#loans-sold",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Loans sold",
    "text": "Loans sold\n\nFI originates loans and sells them to outside investors\nPotential outside investors\n\nOther banks\nInsurance companies\nUnit trusts\nCorporations\n\nLoans sold are an indication of FIs moving from asset-transformers to brokers\nRecourse:the ability to put an asset or loan back to the seller should the credit quality of that asset deteriorate\n\n‘No recourse’: loan buyer bears all default risk if loan goes bad\nWith recourse: long-term contingent credit risk for loan seller"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#role-of-obs-activities-in-reducing-risk",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#role-of-obs-activities-in-reducing-risk",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Role of OBS activities in reducing risk",
    "text": "Role of OBS activities in reducing risk\n\nOBS activities are not always risk-increasing activities\nIn many cases they are hedging activities designed to mitigate exposure to interest rate risk, foreign exchange risk etc.\nOBS activities can decrease an FI’s insolvency risk\nOBS activities are frequently a source of fee income, especially for the largest, most credit-worthy banks"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#suggested-readings",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Suggested readings",
    "text": "Suggested readings"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week11/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week11/index.html#references",
    "title": "AFIN8003 Week 11 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#introduction",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#introduction",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Introduction",
    "text": "Introduction\n\nLast week we discussed the liquidity risk of financial institutions (FIs), especially depositary institutions (DIs).\nWe understand that liquidity risk can arise from both asset side and liability side.\nDIs can insulate their balance sheets from liquidity risk by efficiently managing their liquid asset positions or managing the liability structure of their portfolios.\nMost DI managers incorporate both asset management and liability management as part of overall liquidity management strategy.\nThis week, we discuss the various liquid assets and liabilities a DI might use to manage liquidity risk, and the risk–return trade-off associated with various liability and liquidity strategies employed."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#source-of-liquidity",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#source-of-liquidity",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Source of liquidity",
    "text": "Source of liquidity\nHistorically, primary method of meeting cash demands: asset liquidity (stored liquidity)\n\nExamples: cash, treasury securities, certificates of deposits\n\nToday, primary method of meeting cash demands: liability liquidity / management (purchased liquidity)\n\nExamples: interbank market for exchange settled funds, repos, interbank market\n\nStock of liquid assets in an FI depends on\n\nFI’s willingness to trade off liquidity and returns\nFI’s ability to use liability liquidity\n\nNon-traditional ways of obtaining liquidity include\n\nsecuritisation\nuse of repurchase agreement markets\nuse of capital markets"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#liquid-asset-management",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#liquid-asset-management",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Liquid asset management",
    "text": "Liquid asset management\n\nLiquid assets are traded in a deep market\n\nEven large trading volumes will not impact on price\nLiquid assets include Treasury notes and Treasury bonds\n\nLiquid securities carry a comparatively lower interest rate: risk–return trade-off\nLow levels of liquidity expose an FI to greater illiquidity and withdrawal run risk\nLiquidity requirements are set to lessen the following risks\n\nrun on a bank\nmonetary policy\ntaxation implications\n\nreserve requirement tax: the cost of holding reserves when the central bank pays no—or below market—interest on these balances"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#composition-of-the-liquidity-asset-portfolio",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#composition-of-the-liquidity-asset-portfolio",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Composition of the liquidity asset portfolio",
    "text": "Composition of the liquidity asset portfolio\n\nThe composition of an FI’s liquid asset portfolio, especially with respect to cash and government securities, is partly determined by:\n\nearnings consideration\nminimum liquid-asset reserve requirements imposed by the central bank\n\nHistorically, many countries had imposed reserve ratios1\nGovernment securities act as secondary reserves (buffer reserves)\n\nIn times of a liquidity crisis, when significant drains on cash reserves occur, these securities can be turned into cash quickly and with very little loss of principal value because of the deep nature of the markets in which these assets are traded.\n\n\nSee last week’s note."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#risk-return-trade-off-for-liquid-assets",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#risk-return-trade-off-for-liquid-assets",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Risk-return trade-off for liquid assets",
    "text": "Risk-return trade-off for liquid assets\n\nManaging the securities portfolio is an integral part of liquidity management for financial institutions\nThe conflict between and the balance of the risk of illiquidity and the desire to maintain a high investment return is at the heart of management of the liquid asset portfolio\n\nTrade off the benefits and costs of holding liquid assets\n\nCash immediacy versus reduced return\n\n\nThe determinants of an FI’s optimal liquid asset ratio depend on a number of factors:\n\nThe variability of deposit inflows and outflows\nThe yield on non-liquid assets.\nThe liquidation costs of highly non-liquid assets.\nHigher interest rates paid on purchased funds/liabilities in the short-term money market, or in utilising the RBA liquidity facilities, will increase the desired liquidity asset/cash ratio"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#risk-return-trade-off-for-liquid-assets-contd",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#risk-return-trade-off-for-liquid-assets-contd",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Risk-return trade-off for liquid assets (cont’d)",
    "text": "Risk-return trade-off for liquid assets (cont’d)\n\nDay-to-day liquidity management means that a DI faces the risk of either undershooting or overshooting the required liquidity requirement on any given day.\n\nUndershooting the regulatory required liquidity ratios (e.g., LCR, NSFR) may involve specified additional charges—penalties for not complying with regulations.\nThe cost of overshooting or holding cash reserves in excess of the minimum required, depends on whether the DI perceives its prudent level of reserves to meet expected and unexpected deposit withdrawals to be higher or lower than its regulatory requirement.1\n\nThe management of a DI’s exchange settlement account (ESA) at the RBA is critical.\n\n\n\n\n\n\n\nNote\n\n\nESA is an account held at the Reserve Bank of Australia by financial institutions to settle financial obligations arising from the clearing of payments.\n\n\n\nRBA pays ‘cash target rate minus 10 basis points’ interest on ESA balances."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#the-cash-market-and-exchange-settlement-account-esa",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#the-cash-market-and-exchange-settlement-account-esa",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "The cash market and Exchange Settlement Account (ESA)",
    "text": "The cash market and Exchange Settlement Account (ESA)\nThe cash market is where banks lend and borrow funds from each other, typically on an overnight basis. These funds can be used to:\n\nMeet liquidity needs: Banks may borrow funds to ensure they meet short-term liquidity requirements, such as the ESA balances.\nSupport lending activities: Banks may also use borrowed funds to support ongoing lending activities.\nFacilitate settlement of transactions: The funds can help banks settle large-scale interbank transactions efficiently.\n……\n\nImportantly,\n\nThe price of funds in this market is the interest rate on these interbank loans, which is called the cash rate in Australia.\nThe quantity traded in this market is called the Exchange Settlement (ES) balance - the balance of DI’s deposit accounts at the RBA, the ESA."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#the-cash-market-esa-and-repo-transactions",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#the-cash-market-esa-and-repo-transactions",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "The cash market, ESA, and repo transactions",
    "text": "The cash market, ESA, and repo transactions\nRBA sets a target for the cash rate, it is often referred to as a “tool” of monetary policy.\nPrior to the COVID-19 recession,\n\nthe cash rate target was the RBA’s only active monetary policy tool.\nthe RBA managed the supply of ES balances so that it met estimated demand and the cash rate was close to its target.\nthe RBA achieved cash rate target through open market operations, particularly through repurchase agreements (repos).\n\n\n\n\n\n\n\n\nRepo transactions of RBA\n\n\nA repo is a transaction with two parts.\n\nIn the first part, the Reserve Bank could lend ES balances to a bank and receive a bond in exchange. This increases the supply of ES balances available to banks.\nIn the pre-arranged second part, the transaction is reversed. The Reserve Bank returns the bond and receives back the ES balances, which decreases the supply of ES balances.\n\n\n\n\n\nAfter the introduction of the package of policy measures in response to the COVID-19 recession,\n\nES balances substantially increased.\nthe RBA, as a result, no longer conducts daily open market operations to manage ES balances."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#repo-transactions-to-manage-liquidity-es-balance",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#repo-transactions-to-manage-liquidity-es-balance",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Repo transactions to manage liquidity (ES balance)",
    "text": "Repo transactions to manage liquidity (ES balance)\n\nTwo sources of exchange settlement liquidity for Australian DIs provided by RBA repos\n\nIntra-day repo: a facility that allows a DI to utilise RBA repos to obtain intra-day liquidity, with the repo reversed later in the same day\nOvernight repo: a facility that allows a DI to use RBA repos in order to obtain liquidity overnight to fund its liquidity settlement needs\n\nAfter introduction of same day settlement, RBA also introduced open RBA repo.\n\nOpen RBA repo: an RBA repurchase agreement with no specified end date\n\nWith Basel III reforms, starting on 1 January 2015, the committed liquidity facility is also introduced.\n\nCommitted liquidity facility: a facility providing secured line of credit from the central bank allowed under Basel III in regimes which do not have sufficient liquid assets to meet the Basel III liquidity reforms"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#the-changing-dynamics",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#the-changing-dynamics",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "The changing dynamics",
    "text": "The changing dynamics\nSince COVID-19, the RBA significantly adjusted its monetary operations, moving away from repos as the primary tool for managing liquidity. Banks now manage their ESA balances primarily through other mechanisms:\n\nTerm Funding Facility (TFF): Introduced during the pandemic, the TFF allowed banks to access longer-term funding at very low rates. It helped banks manage funding needs over the pandemic period.\nStanding Facility: Banks can still access liquidity via the RBA’s standing liquidity facility, where they can borrow overnight at a penalty rate if their ESA balances fall short.\nInterbank Cash Market: Banks continue to borrow and lend among themselves in the interbank cash market to manage daily fluctuations in their ESA balances.\nRepo Transactions in the Private Market. While the RBA no longer conducts open market repos, banks and other financial institutions still use repo transactions with each other as a way to manage liquidity and secure short-term funding. These private market repos are similar in structure to the RBA’s past operations but are conducted bilaterally between financial institutions.\nLiquidity Management via Government Bond Purchases: The RBA engaged in large-scale government bond purchases to inject liquidity into the financial system. This action increased the level of reserves in the banking system, reducing the immediate need for repo operations."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#liability-management",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#liability-management",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Liability management",
    "text": "Liability management\n\nClose link to liquidity management\nOverall aim of liability management: to construct a low-cost and low–withdrawal-risk liability portfolio\nProblems\n\nLow-cost liabilities often carry high withdrawal risk: e.g., demand deposits\nLow withdrawal risk often comes with high cost: e.g., certificates of deposit (CDs)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#liability-management-contd",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#liability-management-contd",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Liability management (cont’d)",
    "text": "Liability management (cont’d)\nDeposit liabilities\n\nCheque account and other demand deposits\nSavings account\nCash management account (CMA) / investment savings accounts\nFixed-term deposits\nNegotiable certificates of deposits (NCDs)\n\nNon-deposit liabilities\n\nInterbank funds\nRepurchase agreements (Repos)\nCovered bonds\nOther borrowings\nBank accepted bills\nCommercial bills or non-bank bills\nCommercial paper or promissory notes\nSubordinated debt, medium-term notes and long-term borrowings"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Choice of liability structure",
    "text": "Choice of liability structure\nNow we turn to a more detailed discussion of the withdrawal risk and funding cost characteristics of the major liabilities of a modern DI."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-demand-deposits",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-demand-deposits",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Choice of liability structure: demand deposits",
    "text": "Choice of liability structure: demand deposits\nWithdrawal risk:\n\nHigh degree of withdrawal risk\n\nCosts:\n\nLow\nSince 1930, in U.S., demand deposits paid zero explicit interest!\nSince 2011, such prohibition was repealed. DIs are now allowed but not required to interest on demand deposits. Few of them do.\nThis does not mean that demand deposits are free to DIs.\n\nServices associated with providing checkable accounts consume costly labor and capital.\nCompetition resulted in implicit interest.\n\nDIs can recapture costs by charging fee such as cost per cheque cleared or electronic transaction.\n\nDepositors receives a “subsidy” when such fees do not fully cover the DI’s cost of providing these services.\n\n\n\\[\n\\text{Average implicit interest rate (IIR)} = \\frac{\\text{DI's average management cost per account – average fees earned per account}}{\\text{average annual size of account}}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#example-average-implicit-interest-rate",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#example-average-implicit-interest-rate",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Example: average implicit interest rate",
    "text": "Example: average implicit interest rate\nSuppose it costs a DI 15 cents to clear a cheque but it charges a fee of only 10 cents per cheque cleared. In this case, the customer receives a 5 cent subsidy per cheque. We can calculate implicit yields for each service, or an average implicit interest rate, for each current deposit account.\nSuppose that:\n\nDI’s average management costs per account per annum = $150\nAverage fees earned per account per annum = $100\nAverage annual size of account = $1200\n\nThen,\n\\[\n\\text{Average implicit interest rate (IIR)} = \\frac{150-100}{1200} = 4.166\\%\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#example-gross-interest-rate",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#example-gross-interest-rate",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Example: gross interest rate",
    "text": "Example: gross interest rate\nConsider the following case:\n\nA depositor holds on average $250 per month for the first three months of the year, $500 per month for the next three months, and $1000 per month for the final six months of the year in a demand deposit account.\nThe account pays 5 per cent per annum if the minimum balance is $500 or more, and it pays no interest if the account falls below $500.\nThe depositor makes an average of 50 internet transactions per month and pays a service fee of 10 cents for each transaction, although it costs the bank 15 cents to process each transaction.\n\nThe account holder’s gross interest return, consisting of implicit plus explicit interest, is:\n\\[\n\\begin{aligned}\n\\text{Gross interest return} &= \\text{Explicit interest} + \\text{Implicit interest} \\\\\n&=\\$500(0.05)(0.25)+\\$1000(0.05)(0.5)+(\\$0.15−\\$0.10)(50)(12) \\\\\n&=\\$6.25+\\$25+\\$30=\\$61.25\n\\end{aligned}\n\\]\nSuppose the minimum balance was lowered from $500 to $250 and internet service fees were lowered from 10 cents to 5 cents per transaction. Then:\n\\[\n\\begin{aligned}\n\\text{Gross interest return} &= \\text{Explicit interest} + \\text{Implicit interest} \\\\\n&=\\$250(0.05)(0.25)+(\\$500)(0.05)(0.25)+\\$1000(0.05)(0.5)+(\\$0.15−\\$0.05)(50)(12) \\\\\n&=\\$3.125+\\$6.25+\\$25+\\$60 =\\$94.375\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-interest-bearing-cheque-accounts",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-interest-bearing-cheque-accounts",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Choice of liability structure: interest-bearing cheque accounts",
    "text": "Choice of liability structure: interest-bearing cheque accounts\nWithdrawal risk:\n\nLower degree of withdrawal risk compared to current accounts\n\nMinimum balance requirements\n\n\nCosts:\n\nComparably higher cost: three pricing mechanisms\n\nImplicit interest payments\nMinimum balance requirements\nExplicit interest payments\n\nGross interest return = explicit interest + implicit interest"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-savings-account",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-savings-account",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Choice of liability structure: savings account",
    "text": "Choice of liability structure: savings account\nWithdrawal risk:\n\nLower withdrawal risk compared to cheque accounts\n\nRestrictions on withdrawals (e.g., limited monthly withdrawals, notice period)\nTypically held for long-term savings purposes\nFewer transactional services offered\n\n\nCosts:\n\nVery small implicit interest payments\nExplicit interest payments to account holders"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-mmdas",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-mmdas",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Choice of liability structure: MMDAs",
    "text": "Choice of liability structure: MMDAs\nIn U.S., since 1982, DIs can use money market deposit accounts (MMDAs) as an additional liability instrument.\n\nCompetition with money market mutual funds offered by groups such as Vanguard and Fidelity.\nMMDAs are checkable but subject to restrictions.\n\nWithdrawal risk:\n\nLower due to the restrictions on checking and transfers\n\nCosts:\n\nHigher explicit interest\n\nIn Australia, BOQ together with DDH Graham offers MMDA. Cash management accounts (CMAs) are more popular."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-cma-investment-savings-account",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-cma-investment-savings-account",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Choice of liability structure: CMA / investment savings account",
    "text": "Choice of liability structure: CMA / investment savings account\nInvestment savings accounts (or cash management accounts) are high denomination savings accounts that have no specified maturity date but require high minimum balances (e.g. $10 000) and minimum transaction size (e.g. $500).\n\nThe funds are available on call.\nRelatively low degree of withdrawal risk.\nCosts: higher interest than basic savings accounts, mitigated by fees charged\n\n\n\n\n\n\n\n\n\n\nCash Management Account (CMA)\nInvestment Savings Account (ISA)\n\n\n\n\nPurpose\nManaging cash flow with frequent transactions\nParking cash temporarily for investments\n\n\nLiquidity\nHigh liquidity with frequent access\nModerate liquidity; fewer withdrawal restrictions\n\n\nInterest Rate\nLower interest rates due to focus on transactions\nHigher interest rates as a savings vehicle for investment purposes\n\n\nTransaction Features\nIncludes cheque books, debit cards, online banking\nLimited to transfers; no transactional features\n\n\nTarget Audience\nIndividuals or businesses needing to manage cash flow\nInvestors looking to earn interest on cash waiting to be invested"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-term-and-fixed-time-deposits-retail-cds",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-term-and-fixed-time-deposits-retail-cds",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Choice of liability structure: term and fixed-time deposits / retail CDs",
    "text": "Choice of liability structure: term and fixed-time deposits / retail CDs\nFixed-maturity instruments.\nWithdrawal risk:\n\nVery low: early withdrawal penalties\n\nCosts:\n\nHigh explicit interest\n\n\n\n\n\n\n\nNote\n\n\nFor example, Bank of America’s PDS."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-negotiable-certificates-of-deposits-ncds",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-negotiable-certificates-of-deposits-ncds",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Choice of liability structure: negotiable certificates of deposits (NCDs)",
    "text": "Choice of liability structure: negotiable certificates of deposits (NCDs)\nTime deposits with fixed maturity and face values &gt; $100 000 with varying maturities.\nNegotiable instruments: an instrument that can be sold in the secondary market thereby transferring ownership.\n\nLow withdrawal risk\nThe rates are market driven =&gt; Comparatively lower cost due to generally high credit rating of issuer\n\n\n\n\n\n\n\nNote\n\n\nNowadays banks offer more comprehensive solutions.\nFor example, CBA offers “Investment Guarantee”, a fixed term investment that is composed of a series of underlying securities, which are either a bill of exchange (e.g., bank accepted bill) or a NCD."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-non-deposit-liabilities",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-non-deposit-liabilities",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Choice of liability structure: non-deposit liabilities",
    "text": "Choice of liability structure: non-deposit liabilities\nInterbank funds\n\nShort-term un-collateralised loans between FIs\nRollover risk\nCost: short-term money market rate\n\nRepurchase agreements (repos)\n\nCollateralised interbank transactions\nHighly liquid and flexible source of funds\nYield generally below the market interbank rate due to collateralised nature"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-non-deposit-liabilities-contd",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-non-deposit-liabilities-contd",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Choice of liability structure: non-deposit liabilities (cont’d)",
    "text": "Choice of liability structure: non-deposit liabilities (cont’d)\nCovered bonds\n\nBonds issued by a bank, backed by a pool of assets that remain on the balance sheet of the issuing bank\nAvailable for Australian DIs after legislative change in 2011, with a cap at 8 per cent of DI assets.\nSafest form of bank debt\nTypically carry a higher credit rating than that of their issuer DI\n\n\n\n\n\n\n\nNote\n\n\nCovered bond is more of a feature in Australia (APS 121 Covered Bonds).\nFor example, the CBA’s covered bonds program."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-non-deposit-liabilities-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#choice-of-liability-structure-non-deposit-liabilities-contd-1",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Choice of liability structure: non-deposit liabilities (cont’d)",
    "text": "Choice of liability structure: non-deposit liabilities (cont’d)\nOther Borrowing\n\nBank accepted bills (BAB)\nCommercial bills (or non-bank bills)\nCommercial paper or promissory notes\nSubordinated debt, medium-term notes and long-term borrowings"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#liability-and-liquidity-management-in-insurance-companies",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#liability-and-liquidity-management-in-insurance-companies",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Liability and liquidity management in insurance companies",
    "text": "Liability and liquidity management in insurance companies\n\nInsurance companies require liquidity to meet claims and unexpected policy surrenders.\nIdeally, liquidity is managed through premiums received on new and existing contracts.\nHigh-frequency claims, like during a severe hurricane season, may force asset liquidation at lower-than-market value.\nDiversifying risk in insurance contracts reduces liquidity risk (e.g., covering different types of disasters).\nInsurers can hold marketable assets (e.g., government bonds, corporate bonds, stocks) to cover claim payments when premium income is insufficient."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#liability-and-liquidity-management-in-other-financial-institutions",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#liability-and-liquidity-management-in-other-financial-institutions",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Liability and liquidity management in other financial institutions",
    "text": "Liability and liquidity management in other financial institutions\n\nSecurities firms, investment banks, and finance companies face liquidity risk if they rely on short-term financing (e.g., commercial paper, bank loans) and investors hesitate to roll over funds.\n\nFor securities firms,\n\nMain funding sources include repurchase agreements, bank loans, and short positions in securities.\nLiquidity management requires enough cash and liquid resources to underwrite new securities and resell them to investors.\n\nFor investment banks (and securities firms),\n\nLiability management involves financing an inventory of securities to act as a market maker.\n\nFor finance companies,\n\nMain funding sources include commercial paper and long-term debt.\nNeed liquidity to fund loan requests and commitments promptly."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#liquidity-regulation-in-australia",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#liquidity-regulation-in-australia",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Liquidity regulation in Australia",
    "text": "Liquidity regulation in Australia\n\nIn Australia, liquidity requirements set out by APRA\nAPS 210 (released in 2000) aims to ensure sufficient liquidity in FIs to meet obligations as they fall due\n\nAPRA determines whether an ADI is classified either (check suggested readings APS 210):\n\na liquidity coverage ratio (LCR) ADI (effective from 1 Jan 2015) or\nan ADI subject to the minimum liquidity holdings (MLH) regime for the purpose of APS 210 (effective from 1 January 2014)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#lcr-adi",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#lcr-adi",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "LCR ADI",
    "text": "LCR ADI\n\nThe major and larger banks fall into the LCR group\nAn LCR ADI must undertake scenario analysis on a regular basis.\nThe scenarios must at a minimum include the LCR (from 1 January 2015) and the “going concern” scenario.\nThe LCR requirement aims to ensure that DIs maintain an adequate level of unencumbered high-quality liquid assets (HQLA) that can be readily converted into cash to meet its liquidity needs for a 30-day period under a significantly severe liquidity stress scenario.\nAn LCR ADI must also meet the NSFR requirements."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#mlh-adi",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#mlh-adi",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "MLH ADI",
    "text": "MLH ADI\n\nSmaller ADIs fall in the MLH regime.\nRequired to maintain a minimum holding of 9% of its liabilities in specific liquid assets.\nAll debt securities must be eligible for repurchase agreement with the RBA and must not be subordinated.\nAn MLH ADI must ensure that it has the operational capacity to liquidate any securities held as liquid assets within two business days.\nPractically, the ADIs in the MLH regime must set a trigger ratio above the 9 per cent minimum."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#depositor-protection",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#depositor-protection",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Depositor protection",
    "text": "Depositor protection\n\nDeposit Insurance is a mechanism designed to protect DIs from liquidity crises\n\nIn the US, Federal Deposit Insurance Corporation (FDIC) was created in 1933 in wake of banking panics\nMany countries in the world have established an explicit deposit insurance scheme\n\nIn October 2008, Australia introduced the Financial Claims Scheme (FCS) as well as a temporary wholesale guarantee to provide explicit guarantee arrangements for Australian DI deposits and wholesale funding\n\nThe FCS initially provided a guarantee of deposit balances up to $1 million per depositor per institution\nThe new and permanent cap of $250 000 per person per institution was introduced from 1 February 2012\nAPRA is responsible for the administration of the FCS"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#other-australian-depositor-protection-mechanisms",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#other-australian-depositor-protection-mechanisms",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Other Australian depositor protection mechanisms",
    "text": "Other Australian depositor protection mechanisms\n\nGuarantee scheme for large deposits and wholesale funding\n\nGuaranteed deposit balances greater than $1 million and funding instruments with a maturity of 5 years or less\nAvailable to branches of foreign-owned banks\nClosed in March 2010 after the recovery of global funding conditions\n\nFinancial Claims Scheme—Policyholders Compensation Facility\n\nSimilar as FCS for DIs\nAvailable to general insurers authorised by APRA"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#suggested-readings",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nHow RBA implements monetary policy.\nRBA Exchange Settlement Account Policy.\nRBA Standing Facilities.\nCovered bonds in Australia.\nPrudential Standard APS 210 Liquidity."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week10/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week10/index.html#references",
    "title": "AFIN8003 Week 10 - Liability and Liquidity Management",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#teaching-staff",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#teaching-staff",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Teaching staff",
    "text": "Teaching staff\n\n\n\nUnit convener: Dr. Mingze Gao.\nLecturer in Finance, MQBS.\nPhD in Finance (USyd), Grad.Cert. in Computing (UNSW), BCom (Hon) in Finance (USyd), BCom in Econometrics and Finance (USyd).\nPostdoctoral Research Fellow (USyd), 2021-2023.\nResearch in banking and corporate finance.\n\nContact:\n\nRoom 554, 4ER.\nEmail: mingze.gao@mq.edu.au\nWebsite: https://mingze-gao.com"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#about-this-course",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#about-this-course",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "About this course",
    "text": "About this course\nCourse description:\n\nThis unit applies finance theory to the context of operational decision-making and risk management in banking and financial intermediation.\nThe major decision areas for banking management are covered within a regulatory and corporate responsibility framework.\nMajor risks of banks and financial intermediation are being examined.\n\nKey approaches:\n\nResearch-informed teaching.\nAustralian focus with global evidence.\nPriority on bank risk management."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#course-materials",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#course-materials",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Course materials",
    "text": "Course materials\nThe course materials are prepared based on several sources. Additional references are provided at the end of each week’s slides.\n\nSaunders, Cornett, and Erhemjamts (2023)\nFreixas and Rochet (2023)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#weekly-topics",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#weekly-topics",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Weekly topics",
    "text": "Weekly topics\n\nIntroduction to banking and financial intermediation\nRisks and regulation\nCapital management and adequacy\nInterest rate risk\nMarket risk\nCredit risk I: individual loan risk\nMidterm exam\nCredit risk II: loan portfolio and concentration risk\nLiquidity risk\nLiability and liquidity management\nSovereign risk, foreign exchange risk, and off-balance-sheet risk\nLoan sales and securitisation\nEmerging topics in bank risk management"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#assessments",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#assessments",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Assessments",
    "text": "Assessments\nThere are three assessments in this course.\n\n\n\n\n\n\n\n\n\nAssessment\nWeight\nHurdle\nWhen\n\n\n\n\nMidterm exam\n20%\nNo\nWeek 7\n\n\nIndividual assignment\n30%\nNo\nDue in Week 12\n\n\nFinal exam\n50%\nNo\nUniversity Examination Period"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#financial-system",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#financial-system",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Financial system",
    "text": "Financial system\nA financial system encompasses various financial intermediaries, markets, regulators, and infrastructure in the generation and distribution of financial resources.\n\nA well developed smoothly functioning facilitates the efficient life-cycle allocation of household consumption and the efficient allocation of physical capital to its most productive use in the business sector (Merton 1993).\nRobert Merton, Nobel laureate (1997)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#financial-intermediation",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#financial-intermediation",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Financial intermediation",
    "text": "Financial intermediation\nFinancial intermediation is part of the financial system.\n\nIt is the process by which financial intermediaries, such as banks, facilitate the flow of funds between savers and borrowers.\nBanks are a major part of financial intermediation.\n\nBanks were essentially the only provider of financial intermediation.\nSince 1970s, dramatic development development of the financial market:\n\nOther intermediaries performing similar functions of banks.\nFinTech, bigtech in money and credit services.\nCryptocurrencies, central bank digital currencies.\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#why-is-banking-and-financial-intermediation-necessary",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#why-is-banking-and-financial-intermediation-necessary",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Why is banking and financial intermediation necessary?",
    "text": "Why is banking and financial intermediation necessary?\nA historical perspective:\n\nFinance is critical in real economic activities.\n\nExcessive debt levels and liquidity constraints could lead to downward spirals in economic activity, as witnessed during the Great Depression (Fisher 1933)1\n\n“Finance is a veil”, late 50s to early 70s.\n\nIn a frictionless market, firm value is not affected by its capital structure so that financial intermediaries can be redundant (Modigliani and Miller 1958).\n\nFinance is relevant, since 70s.\n\nMarket frictions amplify economic cycles, particularly during downturns. Monetary factors alone are insufficient to explain the Great Depression’s depth and persistence - it’s more because of the collapse of the bank credit (Bernanke 1983, the “financial accelerator”).\n\n\nNobel prize in economics started in 1969. Irving Fisher died in 1947. He would have won a Nobel prize."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#why-is-banking-and-financial-intermediation-necessary-1",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#why-is-banking-and-financial-intermediation-necessary-1",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Why is banking and financial intermediation necessary?",
    "text": "Why is banking and financial intermediation necessary?\nA banking analogue of the Modigliani and Miller (1958) theorem showing that banks are useless with perfect financial markets.\n\nAn economy of firms, households, banks and a bond market.\n\nHouseholds consume, and lend through banks or through the bond market.\nFirms produce, and borrow from banks or from households through the bond market.\nBanks borrow from households and lend to firms.\n\n\nIn a competitive equilibrium, banks make zero profit and have no impact on other agents’ decisions. Firms are indifferent between bank credit and bonds.\n\nBanks and bond market are perfect substitutes in a market without frictions."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#why-is-banking-and-financial-intermediation-necessary-2",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#why-is-banking-and-financial-intermediation-necessary-2",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Why is banking and financial intermediation necessary?",
    "text": "Why is banking and financial intermediation necessary?\nThe existence of banks (and other financial intermediaries) must be justified by their roles in mitigating market frictions.\n\nInformation asymmetry.\n…\n\nFrom an industrial organization perspective, the structure and competition of banking sector should have a unique impact on the economy, which warrants for regulation.\n\nThe services provided by banks to borrowers and savers must be costly.\n\nMonitoring costs.\nLiquidity costs.\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#empirical-evidence",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#empirical-evidence",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Empirical evidence",
    "text": "Empirical evidence\n\n\nFigure 1: The share of financial sector of economic output is relatively stable"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#importance-of-banks-and-financial-intermediaries",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#importance-of-banks-and-financial-intermediaries",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Importance of banks and financial intermediaries",
    "text": "Importance of banks and financial intermediaries\nWe start this banking course by studying the importance of banks in improving the efficient allocation of financial resources in the economy.\n\nSpecifically, why market frictions necessitate banks.\nA simple look at the Diamond and Dybvig (1983) model."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#an-economy-without-financial-intermediaries",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#an-economy-without-financial-intermediaries",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "An economy without financial intermediaries",
    "text": "An economy without financial intermediaries\nThe Diamond and Dybvig (1983) model\n\n\n\n\n\n\nFigure 2: A simple diagram of an economy without financial intermediaries\n\n\n\nSome frictions render this setup unappealing.\n\nHouseholds are uncertain about when they will need their money. They might need it either in the short term or in the long term.\nFirms need long-term capital in production.\nBanks1 are best positioned to perform maturity transformation.\n\nWe later define what is a bank."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#model-setup",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#model-setup",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Model setup",
    "text": "Model setup\nThe Diamond and Dybvig (1983) model\nLet’s see a simplified Diamond and Dybvig (1983) model:1\n\nThree dates, \\(t=0,1,2.\\)\nEach household has initial goods of 1 unit at \\(t=0\\).\n\nThey can invest long-term to earn \\(R&gt;1\\) at \\(t=2\\) for consumption, or\nstore it for consumption at \\(t=1\\) or \\(t=2\\), which remains 1 unit.\nIf they choose to liquidate the long-term investment at \\(t=1\\), they get \\(l&lt;1\\) (costly liquidation).\n\nHousehold do not know whether they need to consume early at \\(t=1\\).\n\nA sudden need for money, e.g., medical bills (note there that we do not introduce insurance - but banks can provide such liquidity insurance).\nKey assumption.\n\n\nDouglas Diamond and Philip Dybvig won the Nobel price in 2022, together with Ben Bernanke."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#model-implications",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#model-implications",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Model implications",
    "text": "Model implications\nThe Diamond and Dybvig (1983) model\nNot bothered by math, the implications are:\n\n\nWe can determine the theoretical optimal allocation.\nWithout transactions between agents, the allocation is inefficient.\nWith transactions (financial market/bond market), the allocation is still not efficient.\n\nConsumption can be transferred between \\(t=1\\) and \\(t=2\\).\nLiquidation costs avoided.\n\nThe optimal allocation can be achieved with competitive banks offering deposit contracts and investing in the long-term.\n\nA bank simultaneously take deposits from the public and grant loans to borrowers.\nTransform short-term deposits to long-term assets."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#maturity-transformation-by-bank",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#maturity-transformation-by-bank",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Maturity transformation by bank",
    "text": "Maturity transformation by bank\nThe Diamond and Dybvig (1983) model\n\n\nFigure 3: A simple diagram of bank’s maturity transformation\n\nThis structure, however, gives rise to bank runs where everyone withdraws at \\(t=1\\).\n\nThe Silicon Valley Bank (SVB) failure in March 2023 is a typical bank run.\n\nNo other risks considered."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#beyond-maturity-transformation",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#beyond-maturity-transformation",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Beyond maturity transformation",
    "text": "Beyond maturity transformation\nAsset transformation, risk transformation and liquidity transformation.\n\nBanks make investments in borrowers - primary claims - illiquid and risky.\nSavers deposit in banks - secondary claims - liquid and low risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#information-frictions",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#information-frictions",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Information frictions",
    "text": "Information frictions\nBanks do more than maturity transformation.\nBanks are also better positioned to mitigate informational frictions in the market due to economies of scale.\n\nThe cost advantages by spreading the costs over a large number of customers, transactions, and output.\nThe costs arise from all aspects of lending process: screening, monitoring, and auditing; all of which can be costly for individual household lenders."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#information-asymmetry-and-costs",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#information-asymmetry-and-costs",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Information asymmetry and costs",
    "text": "Information asymmetry and costs\n\nScreening costs in the context of adverse selection (Broecker 1990).\n\nBorrower knows better about its quality than lenders.\nOccurs before a loan is made.\n\nMonitoring costs in the context of moral hazard (Holmstrom and Tirole 1997).\n\nBorrower could engage in opportunistic behaviour with private benefits at the cost of lenders.\nOccurs after a loan is made.\n\nAuditing costs in the context of borrower failing to meet contractual obligations.\n\nRenegotiate loan terms, recover loan value, etc.\nOccurs in case of non-compliance."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#banks-as-delegated-monitor",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#banks-as-delegated-monitor",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks as delegated monitor",
    "text": "Banks as delegated monitor\nDiamond (1984) model, overly simplified:\n\n\\(n\\) large borrowers, each requires \\(1\\) unit of funds and costs \\(K\\) to monitor, and\n\\(nm\\) small savers each with \\(1/m\\) units of funds (\\(m&gt;1\\)); a total of \\(n\\) units of funds.\nTotal monitoring costs is \\(nmK\\) if savers individually monitor, but\n\\(mK\\) if the bank acts as the monitor on behalf of savers.\n\n\n\nFigure 4: A simple diagram of bank as delegated monitor"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#banks-as-delegated-monitor-1",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#banks-as-delegated-monitor-1",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks as delegated monitor",
    "text": "Banks as delegated monitor\nEconomies of scale is evident:\n\nTotal monitoring costs reduced from \\(nmK\\) to \\(mK\\).\nDelegated monitoring reduces unnecessary duplication of monitoring costs.\nThe more savers, the lower the cost per saver.\n\nA caveat. It must be that the cost of delegation is smaller than the benefits gained from economies of scale. The delegated monitor needs to be monitored, too.\n\nRequirement is that the bank needs to be sufficiently diversified (Diamond 1984)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#the-holmstrom1997-model",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#the-holmstrom1997-model",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "The Holmstrom and Tirole (1997) model",
    "text": "The Holmstrom and Tirole (1997) model\nKey insights:\n\nFirms with profitable projects will still be credit rationed if they do not have sufficient internal capital - they will not be able to raise capital from the market.\nBanks can alleviate this problem by providing credit to firms and monitoring borrowers.\nBanks improve the market."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#changing-dynamics",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#changing-dynamics",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Changing dynamics",
    "text": "Changing dynamics\nFinTech, bigtech, and more\n\nTraditional “banks”, taking deposits and grant loans, are facing increasing challenges.\nGlobal competition with other banks.\nCompetition with nonbanks or “shadow banks”.\n\nMany of banks’ functions can be now performed by nonbanks.\nFor example, FinTech firms may better reduce information asymmetry through screening and monitoring based on big data and advanced technologies (AI/ML), improved and customized services, and reduced cost of search and match with platform economy.\nMore importantly, nonbanks are not regulated or less regulated than banks.\n\nCentral bank digital currencies (CBDC).\n\nIncreased funding costs for banks if households hold CBDC instead of bank deposits.\n\nTechnological advancement.\n\nOnline/mobile banking simplifies transfer of funds.\n\nTransition from “originate and hold” to “originate and distribute” business model."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#types-of-financial-institutions",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#types-of-financial-institutions",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Types of financial institutions",
    "text": "Types of financial institutions\nThe Australian’s central bank, Reserve Bank of Australia (RBA), classifies financial institutions into broadly three categories:1\n\nAuthorised depository-taking institutions (ADI)\nNon-ADI financial institutions\nInsurers and fund managers\n\nhttps://www.rba.gov.au/fin-stability/fin-inst/main-types-of-financial-institutions.html"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#authorised-depository-taking-institutions-adi",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#authorised-depository-taking-institutions-adi",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Authorised depository-taking institutions (ADI)",
    "text": "Authorised depository-taking institutions (ADI)\nFinancial institutions authorised by the Australia Prudential Regulation Authority (APRA) to carry out financial intermediation are called authorised depository institutions (ADIs).\n\nThese depository-taking institutions (DIs) are the focus of this course.\nThree DI groups in Australia: banks, building societies and credit unions.\n\n\n\n\nTable 1: Typical balance sheet of a DI\n\n\n\n\n\nAssets\nLiabilities and Equity\n\n\n\n\nLoans\nDeposits\n\n\nOther assets\nOther liabilities\n\n\n\nEquity"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#banks",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#banks",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks",
    "text": "Banks\nDepositary-taking institutions (DI)\n\nBanks are the largest depository institutions in terms of size.\nMajor difference between banks and credit unions/savings institutions: banks have more varied assets and liabilities.\nDifferences in operating characteristics and profitability across size classes - for instance, with regards to the size of the commercial loan portfolio."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#largest-banks-globally",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#largest-banks-globally",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Largest banks globally",
    "text": "Largest banks globally\nLargest banks by total assets in 2024, according to S&P Global Market Intelligence:\n\n\n\n\n\n\n\n\n\nRank\nCompany\nHeadquarter\nTotal assets ($B)\n\n\n\n\n1\nIndustrial and Commercial Bank of China Ltd.\nChina\n6,303.44\n\n\n2\nAgricultural Bank of China Ltd.\nChina\n5,623.12\n\n\n3\nChina Construction Bank Corp.\nChina\n5,400.28\n\n\n4\nBank of China Ltd.\nChina\n4,578.28\n\n\n5\nJPMorgan Chase & Co.\nUS\n3,875.39\n\n\n6\nBank of America Corp.\nUS\n3,180.15\n\n\n7\nHSBC Holdings PLC\nUK\n2,919.84\n\n\n8\nBNP Paribas SA\nFrance\n2,867.44\n\n\n9\nMitsubishi UFJ Financial Group Inc.\nJapan\n2,816.77\n\n\n10\nCrédit Agricole Group\nFrance\n2,736.95\n\n\n\n…\n\n\n\n\n42\nCommonwealth Bank of Australia\nAustralia\n868.74"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#banks-in-australia",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#banks-in-australia",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks in Australia",
    "text": "Banks in Australia\nFour major banks: CBA, ANZ, NAB, and Westpac.\n\nnational focus, “four pillars policy”\noffer corporate and retail banking services in Australia, NZ and Papua New Guinea\nthey also operate in Asia, the US and the UK\nfocus on lending (around 70 per cent).\n\nOther major banks: Macquarie Bank, Bendigo and Adelaide Bank, Bank of Queensland, Suncorp, AMP Bank, etc.\nRegional banks\n\nregional focus with operations across state borders\nlarge proportion of assets invested in residential housing loans due to their origins as building societies\nfocus on lending"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#banks-in-australia-funding-composition",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#banks-in-australia-funding-composition",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks in Australia: funding composition",
    "text": "Banks in Australia: funding composition\n\n\nFigure 5: Funding composition of banks in Australia"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#banks-in-australia-net-interest-margin",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#banks-in-australia-net-interest-margin",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks in Australia: net interest margin",
    "text": "Banks in Australia: net interest margin\n\n\nFigure 6: NIM of banks in Australia"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#banks-in-australia-non-performing-assets",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#banks-in-australia-non-performing-assets",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks in Australia: non-performing assets",
    "text": "Banks in Australia: non-performing assets\n\n\nFigure 7: Non-performing assets of banks in Australia"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#credit-unions-and-building-societies",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#credit-unions-and-building-societies",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Credit unions and building societies",
    "text": "Credit unions and building societies\nDepositary-taking institutions (DI)\nCredit Unions\n\nMutual cooperative organisations that provide deposit facilities, personal and housing loans and payments services to their members, who are usually linked by way of some common bond\nPrimarily provide deposit facilities, personal and housing loans and payments services\nMembers are usually linked by a common bond, such as a trade union or locality\nIn 2014 there were 84 credit unions in Australia, compared to 348 in 1992\n\nBuilding Societies\n\nDIs that traditionally were mutually owned, but are increasingly issuing share capital\nDepositors are members of the society  \nIn 2014 there were 9 building societies, compared to 31 in 1992\n\nBoth credit unions and building societies are subject to the same prudential regulations as banks.\nOnly 36 credit unions and building societies in 2023."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#non-adi-financial-institutions",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#non-adi-financial-institutions",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Non-ADI financial institutions",
    "text": "Non-ADI financial institutions\n\nMoney market corporations (broker-dealers)\n\nPrimarily wholesale credit market.\nInvesting, investment banking, market making, trading.\n\nFinance companies\n\nLoans to households and SMEs.\nFunding from debentures and unsecured notes.\n\nSecuritisers\n\nSpecial-purpose vehicles (SPVs) that issue securities backed by pools of assets (e.g. residential mortgage-backed securities)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#insurers-and-fund-managers",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#insurers-and-fund-managers",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Insurers and fund managers",
    "text": "Insurers and fund managers\n\nInsurance companies\n\nLife insurers: provide life, accident and disability insurance, annuities, investment and superannuation products.\nGeneral insurers: provide insurance for property, motor vehicles, employers’ liability, etc.\nHealth insurers: provide insurance for private health costs.\n\nMedibank, Bupa, HCF, etc.\n\n\nSuperannuation and approved deposit funds\nPublic unit trusts\nCash management trusts\nCommon funds\nFriendly societies"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#life-insurers-in-australia",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#life-insurers-in-australia",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Life insurers in Australia",
    "text": "Life insurers in Australia\nTop 10 life insurers by total assets in 2023:\n\n\n\n\n\n\n\n\nCompany\nTotal Assets\nShare\n\n\n\n\nResolution Life Australasia Limited (former AMP)\n25,636,094,000\n21.11%\n\n\nChallenger Life Company Limited\n25,025,565,000\n20.61%\n\n\nAIA Australia Limited\n14,999,640,516\n12.35%\n\n\nTAL Life Limited\n12,451,370,000\n10.25%\n\n\nZurich Australia Limited\n8,268,873,000\n6.81%\n\n\nMLC Limited\n6,775,456,183\n5.58%\n\n\nMunich Reinsurance Company of Australasia Limited\n5,401,974,315\n4.45%\n\n\nSwiss Re Life & Health Australia Limited\n3,454,823,000\n2.85%\n\n\nTAL Life Insurance Services Limited\n3,200,477,631\n2.64%\n\n\nHannover Life Re of Australasia Ltd\n3,053,576,000\n2.51%"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#superannuation-funds",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#superannuation-funds",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Superannuation funds",
    "text": "Superannuation funds\nAustralian governments have encouraged national savings over last decades through:\n\ntaxation incentives,\nlegislative requirements, and\naward superannuation.\n\nSector represents 30% of the assets of all FIs as at December 2021.\nManaged by:\n\nspecialist superannuation fund managers, e.g., UniSuper\nself-managed superannuation funds (SMSF)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#non-bank-financial-institutions-nbfis",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#non-bank-financial-institutions-nbfis",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Non-bank financial institutions (NBFIs)",
    "text": "Non-bank financial institutions (NBFIs)\n\nNon-bank FIs’ assets"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#suggested-readings",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nThe Financial Stability Review published semi-annually by the RBA.\n\nMost recent issue: March 2024."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week1/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week1/index.html#references",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nBernanke, Ben S. 1983. “Nonmonetary Effects of the Financial Crisis in the Propagation of the Great Depression.” The American Economic Review 73 (3): 257–76.\n\n\nBroecker, Thorsten. 1990. “Credit-Worthiness Tests and Interbank Competition.” Econometrica 58 (2): 429.\n\n\nDiamond, Douglas W. 1984. “Financial Intermediation and Delegated Monitoring.” The Review of Economic Studies 51 (3): 393–414.\n\n\nDiamond, Douglas W., and Philip H. Dybvig. 1983. “Bank Runs, Deposit Insurance, and Liquidity.” Journal of Political Economy 91 (3): 401–19.\n\n\nFisher, Irving. 1933. “The Debt-Deflation Theory of Great Depressions.” Econometrica 1 (4): 337.\n\n\nFreixas, Xavier, and Jean-Charles Rochet. 2023. Microeconomics of Banking. 3rd ed. MIT Press.\n\n\nHolmstrom, Bengt, and Jean Tirole. 1997. “Financial Intermediation, Loanable Funds, and the Real Sector.” Quarterly Journal of Economics 112 (3): 663–91.\n\n\nMerton, R C. 1993. Operation and Regulation in Financial Intermediation: A Functional Perspective. Edited by P Englund. Stockholm: Economic Council.\n\n\nModigliani, F, and M H Miller. 1958. “The Cost of Capital, Corporation Finance and the Theory of Investment.” The American Economic Review 48 (3): 261–97.\n\n\nSaunders, Anthony, Marcia Millon Cornett, and Otgo Erhemjamts. 2023. Financial Institutions Management ISE. 11th ed. McGraw Hill."
  },
  {
    "objectID": "posts/working-remotely-on-a-windows-machine-wsl-from-vscode-on-a-mac/index.html",
    "href": "posts/working-remotely-on-a-windows-machine-wsl-from-vscode-on-a-mac/index.html",
    "title": "Working Remotely on a Windows Machine from VSCode on a Mac",
    "section": "",
    "text": "Now I only need a MacBook (1.3 GHz dual-core i5) to do all my work anywhere, thanks to a powerful workstation provided by the university. Yet the workstation is based on Windows 10 and sitting behind the university VPN. I don’t want to use Remote Desktop every time I need to do some coding, so I decided to make it so I can code remotely on the workstation but from the lovely VSCode on my little MacBook."
  },
  {
    "objectID": "posts/working-remotely-on-a-windows-machine-wsl-from-vscode-on-a-mac/index.html#set-up-the-windows-10-host-machine",
    "href": "posts/working-remotely-on-a-windows-machine-wsl-from-vscode-on-a-mac/index.html#set-up-the-windows-10-host-machine",
    "title": "Working Remotely on a Windows Machine from VSCode on a Mac",
    "section": "1. Set up the Windows 10 host machine",
    "text": "1. Set up the Windows 10 host machine\nThe first step is to enable remote SSH login on the Windows machine. It is now super easy to do with the Windows Subsystem for Linux (WSL). I use the Ubuntu 18.04 LTS distro but other Linux distros should work just fine. This will be the remote environment that I work in. Then I follow the instruction in SSH on Windows Subsystem for Linux (WSL). The post is in great detail with step-by-step guidance. So I won’t repeat it again."
  },
  {
    "objectID": "posts/working-remotely-on-a-windows-machine-wsl-from-vscode-on-a-mac/index.html#set-up-the-vscode-on-mac",
    "href": "posts/working-remotely-on-a-windows-machine-wsl-from-vscode-on-a-mac/index.html#set-up-the-vscode-on-mac",
    "title": "Working Remotely on a Windows Machine from VSCode on a Mac",
    "section": "2. Set up the VSCode on Mac",
    "text": "2. Set up the VSCode on Mac\nThe second step is to install the Remote-SSH extension on VSCode. Then simply ssh into the Ubuntu environment on Windows 10 host machine using the username and password created for the Ubuntu distro. In my case is sshmyusername@asgard.econ.usyd.edu.au. A password prompt will of course kindly show up."
  },
  {
    "objectID": "posts/working-remotely-on-a-windows-machine-wsl-from-vscode-on-a-mac/index.html#use-ssh-key-to-avoid-using-password-login",
    "href": "posts/working-remotely-on-a-windows-machine-wsl-from-vscode-on-a-mac/index.html#use-ssh-key-to-avoid-using-password-login",
    "title": "Working Remotely on a Windows Machine from VSCode on a Mac",
    "section": "3. Use SSH key to avoid using password login",
    "text": "3. Use SSH key to avoid using password login\nThe annoying thing is that each time the window reloads and when I start VSCode, I need to manually type in my lengthy password. The better way must be using a SSH key instead.\nTo do so, open up the Terminal on the Mac and run:\nssh-keygen\nA public-private key pair will be generated as ~/.ssh/id_rsa.pub and ~/.ssh/id_rsa. Then we need to tell the host machine that this key can be used to identify myself so i can skip entering password next time:\nssh-copy-id myusername@asgard.econ.usyd.edu.au\nIt will ask for the password on the host machine to confirm I am who I am. But after this, starting VSCode will never ask my password again. What a relief!"
  },
  {
    "objectID": "posts/working-remotely-on-a-windows-machine-wsl-from-vscode-on-a-mac/index.html#lastly",
    "href": "posts/working-remotely-on-a-windows-machine-wsl-from-vscode-on-a-mac/index.html#lastly",
    "title": "Working Remotely on a Windows Machine from VSCode on a Mac",
    "section": "Lastly…",
    "text": "Lastly…\nBecause the host machine is inside the university network, I need to first connect to the university VPN, otherwise the host address asgard.econ.usyd.edu.au will not resolve. Still, it’s really great that I can code and run my programs remotely on the powerful 8-core 16-thread machine without feeling the hotness and noise, which turns out to be really important in the summer of Australia……"
  },
  {
    "objectID": "posts/what-it-takes-to-be-a-ceo/index.html",
    "href": "posts/what-it-takes-to-be-a-ceo/index.html",
    "title": "What it takes to be a CEO? A fun survey of literature",
    "section": "",
    "text": "Taking up the position of CEO means more than pressure from the board and investors. You’ll also face heavy scrutiny from academia. Whether or not a firm’s hiring and compensation committees use them as a reference, here are some of the findings that you may want to be aware of."
  },
  {
    "objectID": "posts/what-it-takes-to-be-a-ceo/index.html#upon-birth",
    "href": "posts/what-it-takes-to-be-a-ceo/index.html#upon-birth",
    "title": "What it takes to be a CEO? A fun survey of literature",
    "section": "Upon birth",
    "text": "Upon birth\nThere are many things determined when you’re born. It’ll be naive to think that they matter less than anything else. A starter example is the Journal of Financial Economics paper “Are CEOs born leaders? Lessons from traits of a million individuals” by Adams, Keloharju and Knupfer (2018).\n\n1. Birthday (month)\nBirth month affects school entry, which affects whether you are relatively older in the class. If you are born after the cutoff month, you’ll have to wait for another year for entry. But this extra year buys you some more time to develop, which makes you more confident than the younger peers. This increased confidence is linked to adult labor market outcomes. Bai, Ma, Mullally and Solomon (2019 JFE) find that in mutual fund industry, it’s associated with better stock selection and fund performance. These relatively older fund managers also appear more confident in photographs and display more confident behaviours: making larger bets, window dressing their holdings less, and so on.\n\n\n2. Birth order\nThe birth order also matters: negative associations between birth order and intelligence level have been found in numerous studies. More frankly, first born kids tend to have higher IQ scores. Kristensen and Bjerkedal (2007 Science) show that this is more dependent on social rank in the family where they receive more-favorable family interaction and stimulation. However, birth order is still the most prominent observable factor. Custodio and Siegel (2018) published a working paper where they find CEOs are more likely to be the first-born child of their family, and the results hold for both family and non-family firms, though thankfully the advantage of being first-born seems to decay over time.\n\n\n3. Gender\nStudies on CEO gender difference and its relation with firm risk-taking, capital allocation, accounting conservatism, corporate social responsibility, and so on are plenty. Genearlly it is shown that male executives are overconfident relative to female executives (Huang and Kisgen, 2013 JFE), and we know that overconfidence is not necessarily a good thing. Firms run by female CEOs use lower leverage and have less volative earnings, (Faccio, Marchica and Mura 2016 JCF), and there are a lot more differences in terms of firm operational, financial, and M&A performances. Tate and Yang (2015 JFE) show that female leaders cultivate more female-friendly cultures inside their firms. Moreover, (having) a female director may bring a firm more access to external finance. Goldman Sachs announced on 23 January 2020 that they won’t take companies public anymore unless they have at least one “diverse” board member.\n\n\n4. Hometown\nEveryone has some sort of hometown biases as well as hometown advantages. For example, Jiang, Qian and Yonker (2019 JFQA) find that CEOs are over twice as likely to acquire targets located in the states of their childhood homes than similar targets elsewhere. Smaller such deals are on average destorying shareholder value but bigger ones tend to be value enhancing. They conclude that CEOs may seek private benefits when acquiring small targets in their hometown but can also avoid poor deals due to hometown advantages. In a Chinese study, Kong, Pan, Tian and Zhang (2020 JCF) show that CEO’s hometown connections increase access to trade credit and such effect is more pronounced for non-SOEs and firms in poor regions. In another Chinese study on commercial banks, Bian, Ji and Zhang (2019 JBF) find that a higher degree of dialect similarity between chairman and the CEO is associated with a higher ROA, ROE and a lower cost-to-income ratio, but is not with bank risks, CEO pay or lower pay-performance sensitivity. They conclude that speaking a similar dialect with the chairman doesn’t undermine monitoring and reduces agency costs.\n\n\n5. Cultural heritage\nThe place where you’re born has even more profound implications through cultural heritage. Nguyen, Hagendorff and Eshraghi (2018 RFS) show that following shocks to industry competition, firms led by CEOs who are second- or third-generation immigrants are associated with a 6.2% higher profitability compared with the average firm. Their analysis attributes this effect to various cultural values that prevail in a CEO’s ancestral country of origin. Through an epidemiological approach, Liu (2016 JFE) show that a corruption culture of corporate insiders’ country of ancestry is associated with higher likelihood of earnings management, accounting fraud, option backdating and opportunistic insider trading."
  },
  {
    "objectID": "posts/what-it-takes-to-be-a-ceo/index.html#early-in-life",
    "href": "posts/what-it-takes-to-be-a-ceo/index.html#early-in-life",
    "title": "What it takes to be a CEO? A fun survey of literature",
    "section": "Early in life",
    "text": "Early in life\nMany early life experiences are closely linked to natural and family endowment, yet others may be random and exogenous. Either way, early life experience is something that will have an impact on CEO behaviours later on.\n\n1. Education\nNo doubt education matters for everyone including CEO. Custodio and Metzger (2014 JFE) find that financial expert CEOs tend to be hired by more mature firms. Firms with financial expert CEOs hold less cash, more debt and engage in more share repurchases. They are able to raise external funds even when credit conditions are tight and their investments are less sensitive to cash flows. On the other hand, CEOs with an engineering (or scientific) education display higher investment-cash flow sensitivity (Malmendier and Tate (2005 JFE)). Similar findings appear in banking sector as shown by King, Srivastav and Williams (2016 JCF) focusing on CEO’s MBA quality. Moreover, education offers more than just knowledge and skills. Although Khanna, Kim and Lu (2015 JF) do not find evidence that connections and network ties developed during education are associated with corporate fraud, such CEO connectedness certainly affect information sharing, investments and so on. Wang and Yin (2018 JCF) find that CEOs tend to initiate more, larger and better M&A deals where target firms are headquarted in those states where they received their undergraduate and graduate degrees.\n\n\n2. Disaster experience\nPeople are shaped by their experiences and disasters are a major one. Several Chinese studies have shown that CEOs who have experienced famine are more risk-averse and hold more cash. They conduct less takeovers, but the M&A deals tend to perform better when they do according to Zhang (2017 PBFJ). Such risk aversion can sometimes be good as Hu, Li and Luo (2019 PBFJ) find that firms governed by CEOs experienced great famine have higher market value during crisis. But generally speaking this effect is mitigated by higher education background and is weaker in SOEs, as well as for CEOs who also experienced economic reform, which is shown to increase CEO’s risk tolerance by Hao, Wang, Chou and Ko (2018 IRF). American CEOs, for sure, are no exception. A famous Journal of Finance paper “what doesn’t kill you will only make you more risk-loving” by Bernile, Bhagwat and Rau (2016) concludes like its title. But more importantly, CEOs who experienced fatal disasters without extremely negative consequences lead firms more aggressively, whereas CEOs who witness the extreme downside of disasters behave more conservatively.\n\n\n3. Academic, military and other experiences\nApart from previous industry experience, researchers also examined the role of many other executive experiences. Shen, Lan, Xiong, Lv and Jian (2019 Economic Modelling) find that top management team’s academic experience promotes corporate innovations and attribute the effect to improved internal control level and reduced information asymmetry. Benmelech and Frydman (2015 JFE) find that military service could make CEOs pursue lower coporate investment, and military CEOs are less likely to be involved in corporate fraudulent activity, performing better during industry downturns."
  },
  {
    "objectID": "posts/what-it-takes-to-be-a-ceo/index.html#personality-traits",
    "href": "posts/what-it-takes-to-be-a-ceo/index.html#personality-traits",
    "title": "What it takes to be a CEO? A fun survey of literature",
    "section": "Personality traits",
    "text": "Personality traits\n\n1. Masculinity\nMasculinity is a long-studied factor in many fields of research and there’re also many interesting papers specifically on male CEOs. Since CEO testosterone levels cannot be tested directly, a common proxy in the literature is the facial width-to-height ratio (fWHR). Jia, Van Lent and Zeng (2014 JAR) find that a higher fWHR of a male CEO, representing more masculine faces, is associated with more misreporting, predicts his firm’s likelihood of being subject to SEC enforcement action and incidence of insider trading and option backdating. They also find that executive’s facial masculinity is associated the likelihood of being named as a perpetrator by SEC. In a forthcoming European Financial Management paper by Kamiya, Kim and Park (2018), male CEOs’ facial masculinity is found to be related to higher stock return volatility, higher financial leverage and more M&A activities. A paper at the 2018 Academy of Managment Annual Meeting by Joshi, Misangyi, Rizzi and Neely (2018), however, find that masculinity does not have a direct effect on the firm’s operational performance. The researchers also find that masculinity worked to the detriment of CEOs in female-dominated industries; less masculine CEOs also performed poorly in highly male-dominated environments.\n\n\n2. Sensation-seeking, corruption and frugality\nIn “desperate” search for proxies and signals of CEO/manager quality and traits, studies have turned to some really interesting areas such as the cars they drive and whether they can fly airplanes. Brown, Lu, Ray and Teo (2018 JF) show that sensation-seeking hedge fund managers who own powerful sports cars take on more investment risks but do not deliver higher returns. “Red Ferrari syndrome”, as described by Business Insider, February 2016. Unfortunately, some investors themselves are susceptible to sensation seeking and hence fuel the demand for such managers. Mironov (2015 JFE) has an interesting study and finds that if you can get away from a traffic violation through bribe, as a manager, you may deliver some outperformance through, for instance, tax evasion, because corruption sometimes promotes efficiency.\nSunder, Sunder and Zhang (2017 JFE) look at pilot CEOs who fly airplanes as a hobby and find that they are significantly associated with better corporate innovation outcomes. They conclude that sensation seeking combines risk taking with a desire to pursue novel experiencecs and has been associated with creativity. Davidson, Dey and Smith (2015 JFE) even hired private investigators to collect data on executives’ legal infractions and ownership of real estate, boats, luxury vehicles and motocycles. They find no direct evidence of a relation between executives’ frugality and the propensity to perpetrate fraud. But there will be a relatively loose control environment characterized by relatively high and increasing probabilities of other insiders perpetrating fraud and unintentional material reporting errors during unfrugal CEOs’ reigns.\n\n\n3. Creativity and innovation\nOne in five U.S. high-technology firms are led by CEOs with hands-on innovation experience as inventors. Islam and Zein (2020 JFE) show that firms led by “Inventor CEOs” are associated with higher quality innovation, especially when the CEO is a high-impact inventor. During an inventor CEO’s tenure, firms file a greater number of patents and more valuable patents in technology classes where the CEO’s hands-on experience lies. It is possible that such inventor CEOs are more capable of evaluating, selecting and executing innovative investment projects."
  },
  {
    "objectID": "posts/what-it-takes-to-be-a-ceo/index.html#family-marriage-and-fidelity",
    "href": "posts/what-it-takes-to-be-a-ceo/index.html#family-marriage-and-fidelity",
    "title": "What it takes to be a CEO? A fun survey of literature",
    "section": "Family, marriage and fidelity",
    "text": "Family, marriage and fidelity\n\n1. Newborns and loss of family members\n“Corporate executives managing some of the largest public companies in the U.S. are shaped by their daughters”. Cronqvist and Yu (2017 JFE) find that when a firm’s CEO has a daughter, the corporate social responsibility rating (CSR) is about 9.1% higher, compared to a median firm. This finding perhaps reveals another plausibly exogenous determinant of CEO’s styles. On the other hand, a loss of important family member poses a significant negative shock. In the 2020 AFA Annual Meeting, I encountered a paper by Liu, Shu, Sulaeman and Yeung (2019) who find that after deaths in the family, bereaved managers take significantly less risk. Firms managed by bereaved CEOs exhibit lower capital expenditures, fewer acquisitions, lower debt issuance and lower CEO ownership after the bereavement events.\n\n\n2. Marriage, divorce and (in)fidelity\nWhile previous studies focused on the cultural background of the CEOs themselves, another paper I encountered in AFA Annual Meeting by Antoniou, Cuculiza, Kumar and Yang (2019) incorporates CEO spouses into the research. They show that the high uncertainty avoidance of CEO spouses will influence CEOs’ personal uncertainty avoidance, and then lead to less corporate risk-taking. Larcker, McCall and Tayan (2013) show that CEO’s divorce is impactful because it causes loss of control due to sale of stocks for divorce settlement, affects productivity, and attitude towards defaults.\nOne final interesting paper I want to mention to conclude this post is “the geography of financial misconduct” by Parsons, Sulaeman and Titman (2018 JF). In 2015, the website Ashley Madison, whose target clients are married people seeking an extramarital affair, was hacked and there was a leak of 40 million user account data of name, address and billing information. The researchers use the data to measure the intensity of spousal infidelity of a local area and find that financial misconducts are strongly related to unfaithfulness in the city."
  },
  {
    "objectID": "posts/what-it-takes-to-be-a-ceo/index.html#final-note",
    "href": "posts/what-it-takes-to-be-a-ceo/index.html#final-note",
    "title": "What it takes to be a CEO? A fun survey of literature",
    "section": "Final note",
    "text": "Final note\nThis short survey of CEO literature is not meant to be comprehensive, but to list a few very interesting papers that I find fun to read. I guess the message is that being a CEO means a lot more than managing the firm and stakeholders, and shareholders also need to open their minds and eyes.\n\nA funny example. Next time hiring a CEO, other things equal, maybe you’ll want a female immigrant who is the first-born kid and born in August, attended certain schools in certain areas, experienced natural disasters, served in military before, has a daughter and no sports cars, knows how to fly airplanes, loyal to her spouse from certain countries, and whose all family members are live and well…"
  },
  {
    "objectID": "posts/uninitialized-variable-in-c/index.html",
    "href": "posts/uninitialized-variable-in-c/index.html",
    "title": "Uninitialized Variable in C",
    "section": "",
    "text": "Uninitialized variable in C can be anything (most of the time). I find, in some cases, we can know the value of an uninitialized variable and thus maybe exploit it.\n\nThe example code below compiled with gcc, without optimization, exits successfully. Very interesting!\n#include &lt;assert.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid f(int n) {\n  // Declare and init `a` with the value of n\n  // This would push n on the stack memory\n  int a = n;\n  return;\n  // f() returns,\n  // but `a` leaves on the stack a garbage value n\n}\n\nvoid g(int n) {\n  // Declare but do no initialize `x` so\n  // `x` may be of anything...?\n  int x;\n  assert(x == n);  // Should fail here if `x` is not n\n}\n\nint main() {\n  for (int i = INT_MIN; i &lt; INT_MAX; i++) {\n    f(i);  // However, if we call f() and g() sequentially...\n    g(i);  // The local variable `x` in g() will always be i,\n           // which is the garbage value left by f() on the stack.\n  }\n  // This program will end peacefully\n  return 0;\n}\nWe can also try to “contaminate” the stack by filling it with a value, e.g.,\n#include &lt;assert.h&gt;\n#include &lt;memory.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid f(uint8_t n) {\n  // Try to \"contaminate\" the stack with value n\n  uint8_t arr[BUFSIZ];\n  memset(arr, n, BUFSIZ * sizeof(uint8_t));\n}\n\nvoid g(uint8_t n) {\n  uint8_t x;\n  assert(x == n);\n  printf(\"uninitialized x is %d\\n\", x);\n  uint8_t y;\n  assert(y == n);  // uninitialized y is also n\n}\n\nint main() {\n  for (uint8_t i = 0; i &lt; UINT8_MAX; i++) {\n    f(i);\n    g(i);\n  }\n  // This program will end peacefully!\n  return 0;\n}\nAs a result, the uninitialized local variables x and y both have the same value of n because f(n) writes many n on the stack.\nStudying C is real fun!\n\n\n\n Back to top"
  },
  {
    "objectID": "posts/translog-cost-function-estimation/index.html",
    "href": "posts/translog-cost-function-estimation/index.html",
    "title": "Translog Cost Function Estimation",
    "section": "",
    "text": "This post focuses on the translog cost function. I discuss the linear homogeneity constraint, the technique to impose the constraint, and its estimation via\nCode examples are provided, too."
  },
  {
    "objectID": "posts/translog-cost-function-estimation/index.html#translog-cost-function",
    "href": "posts/translog-cost-function-estimation/index.html#translog-cost-function",
    "title": "Translog Cost Function Estimation",
    "section": "Translog Cost Function",
    "text": "Translog Cost Function\nThe translog cost function is used to approximate potentially very complex cost functions, and hence complex underlying production functions due to the duality between production maximization and cost minimization.\nIn a general form, the translog cost function \\(\\ln C(Q, W)\\) as a function of output \\(Q\\) and a vector of \\(n\\) input prices \\(W\\) is represented as\n\\[\n\\begin{align}\n\\ln C(Q, W) &= \\beta_0 + \\beta_1 \\ln Q + \\frac{1}{2} \\beta_2 (\\ln Q)^2 \\\\\n&+ \\sum_{i=1}^{n} \\gamma_i \\ln W_i + \\frac{1}{2} \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\theta_{ij} \\ln W_i \\ln W_j \\nonumber \\\\\n&+ \\sum_{i=1}^{n} \\phi_i \\ln Q \\ln W_i \\nonumber\n\\end{align}\n\\tag{1}\\]"
  },
  {
    "objectID": "posts/translog-cost-function-estimation/index.html#linear-homogeneity-constraint",
    "href": "posts/translog-cost-function-estimation/index.html#linear-homogeneity-constraint",
    "title": "Translog Cost Function Estimation",
    "section": "Linear Homogeneity Constraint",
    "text": "Linear Homogeneity Constraint\nIn economic theory, a cost function is often assumed to be linearly homogeneous in input prices. This means that if all input prices \\(W_i\\) are scaled by a constant \\(\\lambda &gt; 0\\), the total cost \\(C\\) should also scale by the same constant \\(\\lambda\\). Mathematically, this is expressed as:\n\\[\n\\begin{equation}\nC(Q, \\lambda W) = \\lambda C(Q, W)\n\\end{equation}\n\\tag{2}\\]\nLinear homogeneity Equation 2 is an important property because it ensures that the cost function is consistent with the idea of constant returns to scale in prices.\n\nImplications for parameters\nIf we take the total differential of the log cost, holding output constant, we have,\n\\[\n\\begin{equation}\nd\\ln C = \\sum_{i=1}^{n} \\gamma_i d\\ln W_i+ \\frac{1}{2}\\sum_{i=1}^{n}\\sum_{j=1}^{n} \\theta_{ij} \\ln W_j d\\ln W_i + \\sum_{i=1}^{n}\\phi_i \\ln Q d\\ln W_i\n\\end{equation}\n\\]\nBy assumption, all input prices scale by the same factor \\(\\lambda\\) so that \\(d\\ln W_i\\) is the same across all \\(n\\) inputs. Therefore, we can factor it out, which gives,\n\\[\n\\begin{equation}\nd\\ln C = d\\ln \\bar{W} \\sum_{i=1}^{n} \\gamma_i + d\\ln \\bar{W}^2 \\frac{1}{2}\\sum_{i=1}^{n}\\sum_{j=1}^{n} \\theta_{ij} + d\\ln \\bar{W} \\ln Q \\sum_{i=1}^{n}\\phi_i\n\\end{equation}\n\\]\nTo ensure \\(\\frac{d\\ln C}{d\\ln \\bar{W}}=1\\) hence linear homogeneity in the translog cost function, the following conditions must be met:\n\\[\n\\begin{align}\n\\label{eq:linear-homogeneity-req1}\n\\sum_{i=1}^{n} \\gamma_i &= 1 \\\\\n\\sum_{j=1}^{n} \\theta_{ij} &= 0 \\quad \\text{for all } i \\\\\n\\sum_{i=1}^{n} \\phi_{i} &= 0\n\\end{align}\n\\tag{3}\\]\nBy imposing these constraints, we ensure that the estimated translog cost function is linearly homogeneous in input prices, which is a desirable property from both a theoretical and empirical standpoint.\n\n\n\n\n\n\nDo NOT forget to impose the constraint!\n\n\n\nZardkoohi, Rangan, and Kolari (1986) published a 3-page paper on the Journal of Finance, essentially pointing out that some previous studies estimating translog cost functions forgot to impose the linear homogeneity constraint…"
  },
  {
    "objectID": "posts/translog-cost-function-estimation/index.html#technique-to-impose-linear-homogeneity-constraint",
    "href": "posts/translog-cost-function-estimation/index.html#technique-to-impose-linear-homogeneity-constraint",
    "title": "Translog Cost Function Estimation",
    "section": "Technique to Impose Linear Homogeneity Constraint",
    "text": "Technique to Impose Linear Homogeneity Constraint\nBut thankfully we have an easy technique to avoid constrained optimization.\nScaling the cost \\(C\\) and input prices \\(W_i\\) by one of the input prices, say \\(W_1\\), is a common technique to impose the linear homogeneity constraint in translog cost functions. The scaled version of the translog cost function can be written as:\n\\[\n\\begin{align}\n\\label{eq:scaled-translog-cost}\n\\ln\\left(\\frac{C}{W_1}\\right) &= \\beta_0 + \\beta_1 \\ln Q + \\frac{1}{2} \\beta_2 (\\ln Q)^2 \\\\\n&+ \\sum_{i=2}^n \\gamma_i \\ln\\left(\\frac{W_i}{W_1}\\right) + \\frac{1}{2} \\sum_{i=2}^n \\sum_{j=2}^n \\theta_{ij} \\ln\\left(\\frac{W_i}{W_1}\\right) \\ln\\left(\\frac{W_j}{W_1}\\right) \\nonumber \\\\\n&+ \\sum_{i=2}^{n} \\phi_i \\ln Q \\ln \\left(\\frac{W_i}{W_1}\\right) \\nonumber\n\\end{align}\n\\tag{4}\\]\nWhy does it satisfies linear homogeneity? Let me work it out one by one.\n\nFirst, \\(\\sum \\gamma = 1\\)\nWe can manipulate Equation 4 a bit and find that,\n\\[\n\\begin{align}\n\\ln C &= \\beta_0 + \\beta_1 \\ln Q + \\frac{1}{2} \\beta_2 (\\ln Q)^2 + \\ln W_1 + \\sum_{i=2}^n \\gamma_i \\ln\\left(\\frac{W_i}{W_1}\\right) + \\dots \\\\\n&= \\beta_0 + \\beta_1 \\ln Q + \\frac{1}{2} \\beta_2 (\\ln Q)^2 + {\\color{blue}\\left(1-\\sum_{i=2}^n \\gamma_i\\right)} \\ln W_1 + \\sum_{i=2}^n {\\color{blue}\\gamma_i} \\ln W_i + \\dots\n\\end{align}\n\\]\nClearly, the sum of coefficients of \\(\\ln W_i\\) is 1, satisfying the linear homogeneity requirement Equation 3.\n\n\nSecond, \\(\\sum \\phi = 0\\)\nFocusing the part \\(\\sum_{i=2}^{n} \\phi_i \\ln Q \\ln \\left(\\frac{W_i}{W_1}\\right)\\) in Equation 4, we can find that,\n\\[\n\\sum_{i=2}^{n} \\phi_i \\ln Q \\ln \\left(\\frac{W_i}{W_1}\\right) =\\sum_{i=2}^{n} {\\color{blue}\\phi_i} \\ln Q \\ln W_i {\\color{blue}- \\sum_{i=2}^{n} \\phi_i} \\ln Q \\ln W_1\n\\]\nClearly, the sum of coefficients of the cross-terms \\(\\ln Q \\ln W_i\\) is 0.\n\n\nThird, \\(\\sum \\theta = 0\\)\nBy the same rationale as above, we should be able to prove it as well. I didn’t manually verify, but it should work out as expected.\n\n\n\n\n\n\nTip\n\n\n\nIn summary, by using this scaling technique, we can estimate the translog cost function in a way that automatically satisfies the linear homogeneity constraints, making the estimation process more efficient.\nAfter all, constrained optimization is difficult…"
  },
  {
    "objectID": "posts/translog-cost-function-estimation/index.html#ols-or-sfa-efficiency-consideration",
    "href": "posts/translog-cost-function-estimation/index.html#ols-or-sfa-efficiency-consideration",
    "title": "Translog Cost Function Estimation",
    "section": "OLS or SFA? Efficiency Consideration",
    "text": "OLS or SFA? Efficiency Consideration\nNow that we’ve established that we can estimate Equation Equation 4 to ensure linear homogeneity constraint. Given a firm-year panel, we can simply estimate the following model:\n\\[\n\\begin{align}\n\\label{eq:model-to-estimate}\n\\ln\\tilde{C}_{mt} &= \\beta_0 + \\beta_1 \\ln Q_{mt} + \\frac{1}{2} \\beta_2 (\\ln Q_{mt})^2 \\\\\n&+ \\sum_{i=2}^n \\gamma_i \\ln\\tilde{W}_{imt} + \\frac{1}{2} \\sum_{i=2}^n \\sum_{j=2}^n \\theta_{ij} \\ln\\tilde{W}_{imt} \\ln\\tilde{W}_{jmt} \\nonumber \\\\\n&+ \\sum_{i=2}^{n} \\phi_i \\ln Q \\ln \\tilde{W}_{imt} + \\epsilon_{mt} \\nonumber\n\\end{align}\n\\tag{5}\\]\nwhere \\(m\\) indexes the firm, \\(t\\) represents time. \\(\\tilde{C}_{mt}=\\frac{C_{mt}}{W_{1mt}}\\) and \\(\\tilde{W}_{imt}=\\frac{W_{imt}}{W_{1mt}}\\) are the scaled total costs and input prices.\nWe can of course use OLS to estimate Equation 5. However, this approach means that we do not accounting for differences in efficiency among different firms. Specifically, OLS assumes that the error term (\\(\\epsilon_{mt}\\)) in Equation 5 is just random noise.\nOn the other hand, we can model \\(\\epsilon_{mt}=v_{mt}+u_{mt}\\) such that random error \\(v_{mt}\\) is i.i.d. normal with mean zero and variance \\(\\sigma^2_{v}\\). The \\(u_{mt}\\) term denotes the systematic deviations from the optimal cost due to inefficiency. \\(u_{mt}\\) can be modeled to be i.i.d. half-normal and variance \\(\\sigma^2_{u}\\) independent of \\(v_{mt}\\). This approach is basically a Stochastic Frontier Analysis (SFA), which can be estimated via MLE. An influential example is Koetter, Kolari, and Spierdijk (2012).\n\n\n\n\n\n\nSFA: pooled or panel?\n\n\n\nThere are many further considerations when applying SFA, for example, whether a pooled “cross-sectional” SFA or a panel SFA. The former assumes a single efficient frontier for all firm-years, while the latter assumes a time-varying frontier. Moreover, in a panel SFA, we can further assume a time-invariant firm inefficiency, or a time-decaying firm inefficiency.\nBased on my limited reading, it seems that the literature typically does not use panel SFA. I do not attempt to discuss which one to use, but will provide code examples for all."
  },
  {
    "objectID": "posts/translog-cost-function-estimation/index.html#trend-or-time-fixed-effects",
    "href": "posts/translog-cost-function-estimation/index.html#trend-or-time-fixed-effects",
    "title": "Translog Cost Function Estimation",
    "section": "Trend or Time Fixed Effects",
    "text": "Trend or Time Fixed Effects\nIn the literature, it is also very common to include either trend or time fixed effects in model Equation 5.\nIf we include trend, the model to estimate is:\n\\[\n\\begin{align}\n\\label{eq:model-to-estimate-trend}\n\\ln\\tilde{C}_{mt} &= \\beta_0 + \\beta_1 \\ln Q_{mt} + \\frac{1}{2} \\beta_2 (\\ln Q_{mt})^2 \\\\\n&+ \\sum_{i=2}^n \\gamma_i \\ln\\tilde{W}_{imt} + \\frac{1}{2} \\sum_{i=2}^n \\sum_{j=2}^n \\theta_{ij} \\ln\\tilde{W}_{imt} \\ln\\tilde{W}_{jmt} \\nonumber \\\\\n&+ \\sum_{i=2}^{n} \\phi_i \\ln Q \\ln \\tilde{W}_{imt} {\\color{blue}+ \\eta_0 trend + \\eta_1 trend^2 } \\nonumber\\\\\n&{\\color{blue}+ \\eta_2 trend \\ln Q_{mt} + \\sum_{i=2}^n \\omega_{i} trend \\ln\\tilde{W}_{imt} }+ \\epsilon_{mt} \\nonumber\n\\end{align}\n\\tag{6}\\]\nIf we include time fixed effects, the model to estimate is:\n\\[\n\\begin{align}\n\\label{eq:model-to-estimate-fe}\n\\ln\\tilde{C}_{mt} &= \\beta_0 + \\beta_1 \\ln Q_{mt} + \\frac{1}{2} \\beta_2 (\\ln Q_{mt})^2 \\\\\n&+ \\sum_{i=2}^n \\gamma_i \\ln\\tilde{W}_{imt} + \\frac{1}{2} \\sum_{i=2}^n \\sum_{j=2}^n \\theta_{ij} \\ln\\tilde{W}_{imt} \\ln\\tilde{W}_{jmt} \\nonumber \\\\\n&+ \\sum_{i=2}^{n} \\phi_i \\ln Q \\ln \\tilde{W}_{imt}  {\\color{blue}+ \\tau_t} + \\epsilon_{mt} \\nonumber\n\\end{align}\n\\tag{7}\\]"
  },
  {
    "objectID": "posts/translog-cost-function-estimation/index.html#a-note-on-marginal-cost",
    "href": "posts/translog-cost-function-estimation/index.html#a-note-on-marginal-cost",
    "title": "Translog Cost Function Estimation",
    "section": "A Note on Marginal Cost",
    "text": "A Note on Marginal Cost\n\\[\n\\begin{align}\nMC = \\frac{\\partial C}{\\partial Q} &= \\frac{\\partial C}{\\partial \\ln C}\\frac{\\partial \\ln C}{\\partial \\ln Q}\\frac{\\partial \\ln Q}{\\partial Q} = \\frac{C}{Q}\\frac{\\partial \\ln C}{\\partial \\ln Q}\n\\end{align}\n\\]\nThe marginal cost for bank \\(m\\) at time \\(t\\) is then obtained as\n\\[\n\\begin{align}\nMC = \\frac{C}{Q}\\frac{\\partial \\ln C}{\\partial \\ln Q} = \\frac{C}{Q}\\frac{\\partial (\\ln \\tilde{C} + \\ln W_1) }{\\partial \\ln Q} = \\frac{C}{Q}\\frac{\\partial \\ln \\tilde{C} }{\\partial \\ln Q}\n\\end{align}\n\\]"
  },
  {
    "objectID": "posts/translog-cost-function-estimation/index.html#some-related-papers",
    "href": "posts/translog-cost-function-estimation/index.html#some-related-papers",
    "title": "Translog Cost Function Estimation",
    "section": "Some related papers",
    "text": "Some related papers\n\nBeck, De Jonghe, and Schepens (2013)\nBerger, Klapper, and Turk-Ariss (2009)\nShaffer and Spierdijk (2020)"
  },
  {
    "objectID": "posts/translog-cost-function-estimation/index.html#code-examples",
    "href": "posts/translog-cost-function-estimation/index.html#code-examples",
    "title": "Translog Cost Function Estimation",
    "section": "Code Examples",
    "text": "Code Examples\nHere I demonstrate how to estimate translog function for banks. Specifically, I start with the bank-year data from BankScope downloaded via WRDS.\nkeep if ctrycode == \"US\"\nkeep if special == \"Commercial banks\"\n// Use year-end data\nkeep if closdate == mdy(12, 31, year(closdate))\nkeep if 2015&lt;=year(closdate) & year(closdate)&lt;=2020\n// Unit can be \"0\", \"th\", etc. \n// Most credit unions use \"0\" unit; Commercial banks use \"th\" (thousands)\nkeep if unit == \"th\"\n// C1: statement of a mother bank integrating the statements of its controlled \n// subsidiaries or branches with no unconsolidated companion\nkeep if consol == \"C1\"\n\ngen year = year(closdate)\nencode bvdidnum, gen(bvdid)\nxtset bvdid year\n\nrename data91100 total_assets\nrename data72500 staff_expenses\nrename data72800 total_operating_expenses\nrename data72700 other_operating_expenses\nrename data72600 other_admin_expenses\nrename data91300 total_customer_deposits\nrename data82450 total_interest_customer_deposits\n\ngen Q  = total_assets\ngen C  = total_operating_expenses\ngen W1 = staff_expenses / total_assets\ngen W2 = total_interest_customer_deposits / total_customer_deposits\ngen W3 = (other_operating_expenses+other_admin_expenses) / total_assets\n\nwinsor2 Q C W1 W2 W3, cut(1 99) replace\n\n// Scale cost and input prices\ngen C_s  = C / W1\ngen W2_s = W2 / W1\ngen W3_s = W3 / W1\n\ngen logQ  = log(Q)\ngen logC  = log(C_s)\ngen logW2 = log(W2_s)\ngen logW3 = log(W3_s)\nNow it comes to the estimation. In some cases, like the one below with time fixed effects, Stata may fail to start the MLE process with an error “initial values not feasible”.\nfrontier logC c.logQ##(c.logQ c.logW2 c.logW3) c.logW2#c.logW3 i.year, cost\nAccording to this Stata mail list, the reason is because Stata uses a method of moments estimator to find the starting values for MLE. For some datasets, especially those with almost no inefficiency effect, these starting values will not be feasible.\nThe solution, as I summarize, is to supply the starting values using from() (for half-normal or exponential models) or ufrom() (for truncated-normal model). Specifically,\n\nUse a simple linear regression to get starting values for the coefficients.\nUse the natural log of the square of RMSE as the starting value for lnsig2v parameter, the natural log of variance of the idiosyncratic error.\nUse a small positive number, say 0.1, as the starting value for the lnsig2u parameter, the natural log of the variance of the log of the inefficiency term.\n\n// A simple linear regression\nglobal rhs = \"c.logQ##(c.logQ c.logW2 c.logW3) c.logW2#c.logW3 i.year\"\nregress  logC ${rhs}\n// matrix b0_hnormal is [b..., lnsig2v, lnsig2u]\nmatrix b0_hnormal = e(b), ln(e(rmse)^2) , .1\nThen, estimate SFA with the given starting values b0_hnormal. I additionally specify options difficult to automatically switch optimization algorithm. iter option may be used to limit the maximum number of iterations.\nfrontier logC ${rhs}, cost from(b0_hnormal, copy) dist(hnormal) difficult iter(25)\nThis time the estimation successfully complete. We can compute the margin cost MC as\ngen MC = C/Q * (_b[logQ] + 2*_b[logQ#logQ]*logQ + _b[logQ#logW2]*logW2 + _b[logQ#logW3]*logW3)\nIf we use trend model instead, the above becomes\ngen trend = year - 2015\n\nglobal rhs = \"c.logQ##(c.logQ c.logW2 c.logW3) c.logW2#c.logW3 c.trend c.trend#c.trend c.trend#c.logQ c.trend#(c.logW2 c.logW3)\"\nregress  logC ${rhs}\n\n// matrix b0 is [b..., lnsig2v, lnsig2u]\nmatrix b0_hnormal = e(b), ln(e(rmse)^2) , .1\n\nfrontier logC ${rhs}, cost from(b0_hnormal, copy) dist(hnormal) difficult iter(25)\n\ngen MC_trend = C/Q * (_b[logQ] + 2*_b[logQ#logQ]*logQ + _b[logQ#logW2]*logW2 + _b[logQ#logW3]*logW3 + _b[trend#logQ]*trend)\nIn this case, MC and MC_trend have a correlation of 1.0, so the two models (time fixed effects and trend) are basically the same.\nPanel SFA can be done via xtfrontier in Stata (xtfrontier assumes truncated-normal).\nglobal rhs = \"c.logQ##(c.logQ c.logW2 c.logW3) c.logW2#c.logW3\"\nregress  logC ${rhs}\n// matrix b0_xtfront is [b..., lnsigma2, lgtgamma, mu]\n// see Stata help xtfrontier for the meaning of the params\nmatrix b0_xtfront = e(b), ln(e(rmse)^2) , .1 , .1\n\nxtfrontier logC ${rhs}, cost ti from(b0_xtfront, copy) difficult iter(25)\nNote that with panel SFA, the ti option specifies a time-invariant firm inefficient. Yet the inefficiency estimate is again highly correlated with the pooled SFA."
  },
  {
    "objectID": "posts/technology-diversity/index.html",
    "href": "posts/technology-diversity/index.html",
    "title": "Technology Diversity",
    "section": "",
    "text": "This posts constructs the firm-year technology diversity measure as in Hsu et al. (2018)."
  },
  {
    "objectID": "posts/technology-diversity/index.html#introduction",
    "href": "posts/technology-diversity/index.html#introduction",
    "title": "Technology Diversity",
    "section": "Introduction",
    "text": "Introduction\nIn Hsu et al. (2018), a firm’s technology diversity is measured by the concentration of its patents over a set of technology categories. Specifically, a firm-year’s technology diversity score is 1 minus the HHI based on the distribution of technology categories for which a firm’s patents are filed in the most recent three years (i.e., 1 minus the sum of the squared percentages of patents in individual technology categories) multiplied by an adjustment factor that is the patent number divided by the patent number minus 1.1\n1 This adjustment factor aims to correct the downward bias of diversification measures when the number of patents is small, as suggested by Hall, Jaffe, and Trajtenberg (2001).\n\n\n\n\n\nExample\n\n\n\nIf a firm has the following patents in the most recent three years:\n\n\n\nPatent\nTechnology Category\n\n\n\n\nA\nX\n\n\nB\nY\n\n\nC\nY\n\n\n\nThe firm’s 1 minus the HHI based on the distribution of technology categories is \\(1-[(\\frac{1}{3})^2+(\\frac{2}{3})^2]=0.444\\).\nGiven the adjustment factor, 0.444 is then multiplied by \\(\\frac{3}{2}\\) so that the diversity score is 0.667.\n\n\nIn Hsu et al. (2018), a total of 6 technology categories is used: (a) chemical, (b) computer and communications, (c) drugs and medical, (d) electrical and electronics, (e) mechanical, and (f) others, as classified by Hall, Jaffe, and Trajtenberg (2001).\nHowever, now is 2024, the patent classification systems have evolved into the Cooperative Patent Classification (CPC). With CPC, a patent’s classification code may look like: C07D 203/00. The first letter is the Section Symbol. The next two is a 2-digit number for Class, followed by a single letter for Subclass. The remainder is Main Group Symbol and Subgroup Symbol.\nWhat best resembles Hsu et al. (2018) is the use of Section, or the first letter. Therefore, we will have a total of 9 technology categories whilst Hsu et al. (2018) have 6. Specifically, the table below tabulates the technology categories.\n\n\n\n\n\n\n\n\nLetter\nCPC Section\nIPC Section\n\n\n\n\nA\nHuman Necessities\nHuman Necessities\n\n\nB\nPerforming Operations; Transporting\nPerforming Operations; Transporting\n\n\nC\nChemistry; Metallurgy\nChemistry; Metallurgy\n\n\nD\nTextiles; Paper\nTextiles; Paper\n\n\nE\nFixed Construction\nFixed Construction\n\n\nF\nMechanical Engineering; Lighting; Heating; Weapons; Blasting Engines or Pumps\nMechanical Engineering; Lighting; Heating; Weapons; Blasting Engines or Pumps\n\n\nG\nPhysics\nPhysics\n\n\nH\nElectricity\nElectricity\n\n\nY\nGeneral Tagging of New Technological Developments; General Tagging of Cross-over technologies spanning over several sections of the IPC; technical subjects covered by former USPC cross reference art collections and digest"
  },
  {
    "objectID": "posts/technology-diversity/index.html#patent-data",
    "href": "posts/technology-diversity/index.html#patent-data",
    "title": "Technology Diversity",
    "section": "Patent data",
    "text": "Patent data\nThe goto source for U.S. firm’s patent data is Kogan et al. (2017), which can be download via GitHub. This well-known KPSS dataset contains many features and is more than enough for the calculation of technology diversity.\nSimply download and unzip the datasets and below is my code to produce the technology diversity measure."
  },
  {
    "objectID": "posts/technology-diversity/index.html#stata-code",
    "href": "posts/technology-diversity/index.html#stata-code",
    "title": "Technology Diversity",
    "section": "Stata Code",
    "text": "Stata Code\nThis code runs fairly fast making use of Mata.\n/*\n  This Stata code calculates the Technology Diversity score measure in \n  Hsu et al. (2018 REStat) using the KPSS patent data.\n  Download and unzip the KPSS data to the current working directory.\n  \n  Author: Mingze Gao\n  Date: 2024-07-20\n  For detail, see https://mingze-gao.com/posts/technology-diversity/\n  \n  Paramters:\n  - use_primary_cpc: Set to 1 to use only the primary CPC, 0 to use all\n  \n  Note:\n  1. This code uses the patents granted, not patents filed.\n  2. This code uses CPC section code to define 9 technology categories.\n     In Hsu et al. (2018), a total of 6 categories were used.\n  3. A patent can have multiple CPC codes. For example, \n     Patent 1570692 has the following CPC codes:\n     E05F5/025;Y10T16/628;Y10T16/6285;E05Y2900/531\n     If we use only primary CPC, it would be 1 E.\n     If we use all CPC codes, it would be 2 E and 2 Y.\n */\n\n/******************************************************************************/\n**# Paramters & Setup\n/******************************************************************************/\nlocal use_primary_cpc = 1 // Set to 0 to use all CPC codes\n \nconfirm file \"KPSS_2022.csv\"\nconfirm file \"Match_patent_cpc_2022.csv\"\n\ncwf default\nclear all\n\n/******************************************************************************/\n**# CPC technology categories\n/******************************************************************************/\ncap frame drop cpc\nmkf cpc\ncwf cpc\nimport delimited \"Match_patent_cpc_2022.csv\", clear\n\ncap drop cpc_*\nforeach section of newlist a b c d e f g h y {\n    gen cpc_`section' = 0\n}\n\nputmata cpc*\nmata:\nfor (i=1; i&lt;=rows(cpc); i++) {\n    if (st_local(\"use_primary_cpc\") == 0) {\n        s = ustrsplit(cpc[i], \";\")\n        for (j=1; j&lt;=cols(s); j++) {\n            sec = substr(s[j], 1, 1)\n            if (sec==\"A\") cpc_a[i] = cpc_a[i] + 1\n            else if (sec==\"B\") cpc_b[i] = cpc_b[i] + 1\n            else if (sec==\"C\") cpc_c[i] = cpc_c[i] + 1\n            else if (sec==\"D\") cpc_d[i] = cpc_d[i] + 1\n            else if (sec==\"E\") cpc_e[i] = cpc_e[i] + 1\n            else if (sec==\"F\") cpc_f[i] = cpc_f[i] + 1\n            else if (sec==\"G\") cpc_g[i] = cpc_g[i] + 1\n            else if (sec==\"H\") cpc_h[i] = cpc_h[i] + 1\n            else if (sec==\"Y\") cpc_y[i] = cpc_y[i] + 1\n        }\n    } else {\n        sec = substr(cpc[i], 1, 1)\n        if (sec==\"A\") cpc_a[i] = cpc_a[i] + 1\n        else if (sec==\"B\") cpc_b[i] = cpc_b[i] + 1\n        else if (sec==\"C\") cpc_c[i] = cpc_c[i] + 1\n        else if (sec==\"D\") cpc_d[i] = cpc_d[i] + 1\n        else if (sec==\"E\") cpc_e[i] = cpc_e[i] + 1\n        else if (sec==\"F\") cpc_f[i] = cpc_f[i] + 1\n        else if (sec==\"G\") cpc_g[i] = cpc_g[i] + 1\n        else if (sec==\"H\") cpc_h[i] = cpc_h[i] + 1\n        else if (sec==\"Y\") cpc_y[i] = cpc_y[i] + 1\n    }   \n}\nend\n\ngetmata cpc_a cpc_b cpc_c cpc_d cpc_e cpc_f cpc_g cpc_h cpc_y, update\n\n\n/******************************************************************************/\n**# Match to firm\n/******************************************************************************/\ncwf default\nmkf kpss\n// Patent, permno, issue year\nframe kpss {\n    import delimited \"KPSS_2022.csv\", clear\n    keep patent_num permno issue_date\n    tostring issue_date, replace format(%20.0f)\n    gen edatevar = date(issue_date,\"YMD\")\n    format edatevar %td\n    drop issue_date\n    rename edatevar issue_date\n    gen year = year(issue_date)\n}\ncap frame drop kpss2\nframe copy kpss kpss2\nframe copy kpss2 y  \nframe copy kpss2 y1 \nframe copy kpss2 y2 \nframe y {\n    tempfile y\n    save `y'\n}\nframe y1 {\n    replace year = year + 1\n    tempfile y1\n    save `y1'\n}\nframe y2 {\n    replace year = year + 2\n    tempfile y2\n    save `y2'\n}\n// Permno-year w/o gap\nframe kpss {\n    keep permno year\n    duplicates drop\n    xtset permno year\n    tsfill\n}\n\nframe copy kpss pat0 // patents granted in the current year t\nframe copy kpss pat1 // patents granted in the year t-1\nframe copy kpss pat2 // patents granted in the year t-2\n\nframe pat0 {\n    merge 1:m permno year using `y', nogen keep(match)\n    tempfile pat0\n    save `pat0'\n}\nframe pat1 {\n    merge 1:m permno year using `y1', nogen keep(match)\n    tempfile pat1\n    save `pat1'\n}\nframe pat2 {\n    merge 1:m permno year using `y2', nogen keep(match)\n    tempfile pat2\n    save `pat2'\n}\n\ncwf default\nappend using `pat0'\nappend using `pat1'\nappend using `pat2'\n\nsort permno year\n\ngen patent_issue_year = year(issue_date)\ndrop issue_date\n\n\n/******************************************************************************/\n**# Calculate technology diversity\n/******************************************************************************/\nfrlink m:1 patent_num, frame(cpc) gen(cpc_link)\nfrget cpc_*, from(cpc_link)\ndrop cpc_link\n\ncollapse (sum) cpc_* (count) patent_num, by(permno year)\n\nxtset permno year\ntsfill\n\negen __total = rowtotal(cpc*)\nreplace __total = . if patent_num == .\n\nforeach cpc of varlist cpc_a-cpc_y {\n    replace `cpc' = `cpc' / __total\n    replace `cpc' = `cpc' * `cpc'\n}\n\negen hhi = rowtotal(cpc*)\nreplace hhi = . if patent_num == .\n\ngen _1m_hhi = 1 - hhi\n\ngen technology_diversity = _1m_hhi * (patent_num) / (patent_num-1)\n\nreplace patent_num = 0 if patent_num == .\n\n// For firms that have only one patent, set the score to 0\nreplace technology_diversity = 0 if patent_num == 1\n\n// For firmw without patents, set the score to 0\nreplace technology_diversity = 0 if patent_num == 0\n\nkeep permno year patent_num technology_diversity\n\nlabel var patent_num            \"Patents granted in the previous 3 years\"\nlabel var technology_diversity  \"Technology Diversity\"\n\n// Clean up\nframe drop kpss* pat* y y1 y2\n\n\nexit\n\n\n/******************************************************************************/\n**# Additional stuff\n/******************************************************************************/\ncwf default\ncap frame drop extra\nframe copy default extra\ncwf extra\n\nsu technology_diversity, d  \n\nhist technology_diversity if technology_diversity &gt; 0\n\nkeep if technology_diversity &gt; 0\n\ncollapse (mean) mean = technology_diversity ///\n         (median) p50 = technology_diversity ///\n         (p25) p25 = technology_diversity   ///\n         (p75) p75 = technology_diversity ///\n         (count) n = permno, by(year)\n\n\ntsset year\n\ntwoway ///\n (tsline mean, lcolor(stred)) ///\n (tsline p25, lcolor(blue) lpattern(dash)) ///\n (tsline p75, lcolor(blue) lpattern(dash)) ///\n (tsline p50, lcolor(black) lpattern(dot)) ///\n (tsline n, fcolor(gray%10) lcolor(none) recast(bar) yaxis(2)) ///\n , ///\n yline(0, lwidth(vvthin) lpattern(dash) extend) ///\n ylabel(, format(%9.2f) nogrid) ttitle(, size(zero)) ///\n ytitle(\"\", axis(2)) ///\n tlabel(, nogrid) title(\"Technology Diversity 1926 - 2022\", size(medium) span) ///\n legend(rows(1) order(1 \"Mean\" 2 \"25/75th percentiles\" 4 \"Median\" 5 \"# Firms\") ///\n        pos(12) lcolor(none) region(fcolor(none))) ///\n name(timeseries, replace) ///\n note(\"Based on the sample with non-zero Technology Diversity score.\")\n\ngraph export \"timeseries.png\", name(timeseries) replace as(png)\nThe distribution of firms’ technology diversity over the period is plotted below.\n\n\n\nTechnology Diversity from 1926 to 2022\n\n\n\n\n\n\n\n\nMultiple CPC codes\n\n\n\nBecause a patent can have multiple CPC codes, using all CPC codes means that a patent can be assigned to multiple technology categories. This in general does not cause a major problem, but could lead to a firm’s technology diversity score to be larger than 1.\nConsider a firm with two patents granted in the recent years, the adjustment factor would be 2, effectively doubling (1-HHI). When the two patents yield a HHI smaller than 0.5, the firm’s Technology Diversity score would be greater than 1. It occurs when the two patents belong to say 3 technology categories.\nIn Hsu et al. (2018), the maximum Technology Diversity score is 1. It is hence very likely that a patent can belong to only one category. Therefore, I set the default parameter use_primary_cpc to 1.\n\n\nSomewhat interestingly, in the recent decades firms’ technology diversity seems to be declining. Put differently, firms are increasingly specialized in their technology space. My current working projects involve some use of firm technology diversity."
  },
  {
    "objectID": "posts/technology-diversity/index.html#other-measures",
    "href": "posts/technology-diversity/index.html#other-measures",
    "title": "Technology Diversity",
    "section": "Other measures",
    "text": "Other measures\nSome other measures of “technology diversity” include, for example, Miller (2006), which is a little harder to construct and skipped."
  },
  {
    "objectID": "posts/stata/packages/index.html",
    "href": "posts/stata/packages/index.html",
    "title": "Stata - Packages",
    "section": "",
    "text": "Antigravity!\nIf you’ve ever used Python, you may know that it’s famous for its simplicity and the many packages available for use. Good news is, Stata is no different. We can install a wide range of Stata packages easily and then use them to achieve a ton of things.\nThis post briefly explains where to find, how to install and update Stata packages.",
    "crumbs": [
      "Stata Workshop",
      "Stata - Packages"
    ]
  },
  {
    "objectID": "posts/stata/packages/index.html#stata-packages",
    "href": "posts/stata/packages/index.html#stata-packages",
    "title": "Stata - Packages",
    "section": "Stata packages",
    "text": "Stata packages\nIn a nutshell, installing and using Stata packages are as simple as the following two lines of code (and a line of output):\n. ssc install nicewords\n. nicewords\nAbsolutely excellent!\nSpecifically, we use the builtin command ssc to install a package named nicewords in the first line, and then execute the command nicewords in the second line, which randomly prints some nice words.\nGenerally, a package can provide one or more Stata commands to use, depending on the complexity of the task it solves.",
    "crumbs": [
      "Stata Workshop",
      "Stata - Packages"
    ]
  },
  {
    "objectID": "posts/stata/packages/index.html#where-to-find-stata-packages",
    "href": "posts/stata/packages/index.html#where-to-find-stata-packages",
    "title": "Stata - Packages",
    "section": "Where to find Stata packages",
    "text": "Where to find Stata packages\n\nssc - Statistical Software Components Archive\nStata packages are hosted at the Statistical Software Components (SSC) Archive, which is often called the Boston College Archive and provided by http://repec.org. This explains the example above where we used the command ssc to manage (install) packages.\nWe can find recently added packages with . ssc new, and the top 10 most popular packages on SSC with . ssc hot. In fact, the top 10 for December 2022 are:\n\n\n\nRank\n# hits\nPackage\nAuthor(s)\n\n\n\n\n1\n63836.7\noutreg2\nRoy Wada\n\n\n2\n54131.9\nestout\nBen Jann\n\n\n3\n33531.3\nwinsor2\nYujun Lian\n\n\n4\n32575.0\nasdoc\nAttaullah Shah\n\n\n5\n23632.8\ngrstyle\nBen Jann\n\n\n6\n21866.9\nreghdfe\nSergio Correia\n\n\n7\n17123.1\nftools\nSergio Correia\n\n\n8\n16163.0\nlogout\nRoy Wada\n\n\n9\n16161.3\nfastgini\nZurab Sajaia\n\n\n10\n13942.7\ncoefplot\nBen Jann\n\n\n\n\n\nnet - e.g., GitHub\nApart from SSC, some packages are available on other websites like GitHub. A growing trend is that package authors publish their code repositories on GitHub, which contain the devlopment version of the packages.",
    "crumbs": [
      "Stata Workshop",
      "Stata - Packages"
    ]
  },
  {
    "objectID": "posts/stata/packages/index.html#how-to-install-and-update-packages",
    "href": "posts/stata/packages/index.html#how-to-install-and-update-packages",
    "title": "Stata - Packages",
    "section": "How to install and update packages",
    "text": "How to install and update packages\nssc install is pretty much all we need. For example, to install the package reghdfe:\n. ssc install reghdfe\nFor packages outside SSC, we can install them using net. As an example, I have a package specurve on GitHub, which can be installed by:\n. net install specurve, from(\"https://raw.githubusercontent.com/mgao6767/specurve/master\")\nTo update an existing package, we can add the option replace to the above command:\n. ssc install reghdfe, replace\n. net install specurve, replace from(\"https://raw.githubusercontent.com/mgao6767/specurve/master\")\nAlternatively, we can use ado update:\n. ado update, update // for community-contributed packages\n. ado update, update ssconly // for SSC only",
    "crumbs": [
      "Stata Workshop",
      "Stata - Packages"
    ]
  },
  {
    "objectID": "posts/stata/packages/index.html#some-packages-of-my-choice",
    "href": "posts/stata/packages/index.html#some-packages-of-my-choice",
    "title": "Stata - Packages",
    "section": "Some packages of my choice",
    "text": "Some packages of my choice\n\nreghdfe and ivreghdfe\nreghdfe is among the top 10 Stata packages as we’ve seen above. It allows for multiple fixed effects in linear regressions, while the builtin xtreg allows only one fixed effect. It’s gold!\nivreghdfe is essentially reghdfe plus ivreg2, which allows us to include multiple fixed effects in instrumental variable regressions.\n\n\nestout and outreg2\nestout is also a top 10 Stata package that provides tools to make regression tables. We’ve seen an example from the previous post. I highly recommend, too!\noutreg2 does a similar job in a simpler way. Yet if we want finer controls estout is perhaps better, in my humble opinion.\n\n\nwinsor and winsor2\nData is often noisy with extreme values or impossible values recorded by mistake. In some fields of research, we try to mitigate such concern by winsorization. Note that they may yield different results due to their different approaches in determining percentile values.",
    "crumbs": [
      "Stata Workshop",
      "Stata - Packages"
    ]
  },
  {
    "objectID": "posts/specification-curve-analysis/index.html",
    "href": "posts/specification-curve-analysis/index.html",
    "title": "Specification Curve Analysis",
    "section": "",
    "text": "More often than not, empirical researchers need to argue that their chosen model specification reigns. If not, they need to run a battery of tests on alternative specifications and report them. The problem is, researchers can fit a few tables each with a few models in the paper at best, and it’s extremely hard for readers to know whether the reported results are being cherry-picked.\n\nSo, why not run all possible model specifications and find a concise way to report them all?"
  },
  {
    "objectID": "posts/specification-curve-analysis/index.html#motivation",
    "href": "posts/specification-curve-analysis/index.html#motivation",
    "title": "Specification Curve Analysis",
    "section": "",
    "text": "More often than not, empirical researchers need to argue that their chosen model specification reigns. If not, they need to run a battery of tests on alternative specifications and report them. The problem is, researchers can fit a few tables each with a few models in the paper at best, and it’s extremely hard for readers to know whether the reported results are being cherry-picked.\n\nSo, why not run all possible model specifications and find a concise way to report them all?"
  },
  {
    "objectID": "posts/specification-curve-analysis/index.html#the-specification-curve",
    "href": "posts/specification-curve-analysis/index.html#the-specification-curve",
    "title": "Specification Curve Analysis",
    "section": "The Specification Curve",
    "text": "The Specification Curve\nThe idea of specification curve is a direct answer to the question provided by Simonsohn, Simmons, and Nelson (2020).1\n1 Special thanks to Rawley Heimer from Boston College who visited our discipline in 2019 and introduced the Specification Curve Analysis to us in the seminar on research methods.To intuitively explain this concept, below is the Figure 2 from Gao, Leung, and Qiu (2021), which is used to show the robustness of an substitution effect of organization capital on executive pay-for-performance sensitivity. Therefore, the estimated coefficients for the variable of interest OC are expected to be negative across different model specifications.\n\n\n\n\n\n\nFigure 1: The original figure in Gao, Leung, and Qiu (2021). This plot was made using a previous version of specurve.\n\n\n\nThe plot is made up of two parts. The upper panel plots the coefficient estimates of OC in various model specifications, in descending order, and the associated 95% confidence intervals. Sample sizes of each model are plotted as bars at the bottom of the upper panel. For simplicity, we annotate only the maximum and minimum coefficient estimates, as well as the threshold of zero. The lower panel reports the exact specification for each model, where colored dots indicate the choices from various specification alternatives. Both panels share the same x-axis of model number.\nTo interpret this specification curve, for example, OC has an estimated coefficient of −0.11 in the first model, which uses the natural logarithm of DELTA_MGMT (a measure of executive pay-for-performance sensitivity) as the dependent variable, and control variables as in the baseline model, including industry fixed effects and year fixed effects, clustering standard errors at the firm level, and is estimated on the full sample.\nFurther, the ordered nature of the curve implies that this is the minimum estimated impact of OC on ln(DELTA_MGMT), whereas the maximum estimated coefficient is doubled at −0.22 when the industry fixed effects are replaced with the more conservative firm fixed effects and estimated on the sample excluding global financial crisis period. More importantly, in all specifications, we find the coefficient estimates of OC to be statistically significant. Using an alternative measure of executive pay-for-performance sensitivity as the dependent variable, again, has minimal impact on the documented substitution effect of OC.\nThis specification curve reports a total of 2*2*4*1*2=32 specifications:\n\n2 choices of dependent variables (as alternative measures of executive pay-for-performance sensitivity)\n2 choices of controls variables (controlling for managerial ability at the cost of reduced sample size)\n4 choices of fixed effects\n1 choice of standard error clustering\n2 choices of sample periods\n\nBeyond reporting all estimates from hundreds and thousands of models, the more appealing point of specification curve is that we can identify the most impactful factors in specifying the model. As the models are sorted by the coefficient estimates, the distribution of dots in the lower panel can reveal whether certain specification choices drive the results.\n\nAlternative measures of executive pay-for-performance sensitivity do not affect the main findings.\nThe inclusion of additional control variable of managerial ability does not affect the main findings.\nThe industry and year fixed effects seem to lead to weaker coefficient estimates for the variable of interest, albeit the more conservative firm and year fixed effects lead to stronger ones. This is very important.\nThe main findings hold with and without the global financial crisis (GFC) period.\n\nOf course, even 32 models cannot exhaust all possible specifications. Nevertheless, by addressing the most critical ones, we are able to use one specification curve plot to convince readers that our findings are robust."
  },
  {
    "objectID": "posts/specification-curve-analysis/index.html#specurve---stata-command-for-specification-curve-analysis",
    "href": "posts/specification-curve-analysis/index.html#specurve---stata-command-for-specification-curve-analysis",
    "title": "Specification Curve Analysis",
    "section": "specurve - Stata command for specification curve analysis",
    "text": "specurve - Stata command for specification curve analysis\nI developed a Stata command specurve for specification curve analysis. It is written in Stata Mata and has no external dependencies.2 The source code is available at GitHub.\n2 Previous versions depend on Stata 16’s Python integration.\nInstallation\nRun the following command in Stata:\nnet install specurve, from(\"https://raw.githubusercontent.com/mgao6767/specurve/master\") replace"
  },
  {
    "objectID": "posts/specification-curve-analysis/index.html#example-usage-output",
    "href": "posts/specification-curve-analysis/index.html#example-usage-output",
    "title": "Specification Curve Analysis",
    "section": "Example usage & output",
    "text": "Example usage & output\n\nRegressions with reghdfe\n. use \"http://www.stata-press.com/data/r13/nlswork.dta\", clear\n(National Longitudinal Survey.  Young Women 14-26 years of age in 1968)\n\n. copy \"https://mingze-gao.com/specurve/example_config_nlswork_reghdfe.yml\" ., replace\n\n. specurve using example_config_nlswork_reghdfe.yml, saving(specurve_demo)\n\n\n\nexample_reghdfe\n\n\n\n\nIV regressions with ivreghdfe\n. copy \"https://mingze-gao.com/specurve/example_config_nlswork_ivreghdfe.yml\" ., replace\n. specurve using example_config_nlswork_ivreghdfe.yml, cmd(ivreghdfe) rounding(0.01) title(\"IV regression with ivreghdfe\")\n\n\n\nexample_ivreghdfe\n\n\nCheck help specurve in Stata for a step-by-step guide.\n\n\nPost estimation\nEstimation results are saved in the frame named “specurve”.\nUse frame change specurve to check the results.\nUse frame change default to switch back to the original dataset."
  },
  {
    "objectID": "posts/quantlib-yield-curve/index.html",
    "href": "posts/quantlib-yield-curve/index.html",
    "title": "QuantLib - Yield Curve",
    "section": "",
    "text": "I’m using QuantLib to build a simulation software. This series will be a collection of notes for using QuantLib and C++ in financial instruments pricing, and perhaps some other random things."
  },
  {
    "objectID": "posts/quantlib-yield-curve/index.html#yield-curve",
    "href": "posts/quantlib-yield-curve/index.html#yield-curve",
    "title": "QuantLib - Yield Curve",
    "section": "Yield Curve",
    "text": "Yield Curve\n\nFlat Yield Curve\nThe simplest yield curve is a flat one. Let’s build one flat yield curve as at June 20, 2024, with an interest rate of 0.03 compounded annually.\n#include &lt;iostream&gt;\n#include &lt;ql/quantlib.hpp&gt;\n1#include \"utils.cpp\"\n\nusing namespace QuantLib;\n\nint main(int, char*[]) {\n  Date today = Date(20, June, 2024);  // Thursday\n  Rate interestRate = 0.03;\n\n  auto flatForwardRates = ext::make_shared&lt;FlatForward&gt;(\n2      today,\n      interestRate, \n3      ActualActual(ActualActual::Bond),\n      Compounded, Annual);\n\n4  RelinkableHandle&lt;YieldTermStructure&gt; flatTermStructure(flatForwardRates);\n\n  Table table({{\"Date\", \"Time From Reference\", \"Zero Rate\", \"Discount Factor\"}});\n\n5  for (size_t dt = 0; dt &lt; 10; dt++) {\n    Date date = today + dt;\n    Time time = flatTermStructure-&gt;timeFromReference(date);\n    std::ostringstream dateStream;\n    dateStream &lt;&lt; date;\n    std::string dateStr = dateStream.str();\n    std::string timeElapsed = std::to_string(time);\n    std::string zeroRate =\n        std::to_string(flatTermStructure-&gt;zeroRate(time, Compounded, Annual));\n    std::string df = std::to_string(flatTermStructure-&gt;discount(date));\n\n    table.push_back({dateStr, timeElapsed, zeroRate, df});\n  }\n\n  const int columnWidth = 20;\n  printTableWithBorders(table, columnWidth);\n\n  return 0;\n}\n\n1\n\nSee below for utils.cpp.\n\n2\n\nReference date for this (flat) yield curve.\n\n3\n\nDay counter.\n\n4\n\nMake a handle of the yield curve. This handle can be “relinked” to others.\n\n5\n\nData from this flat yield curve for the next 10 (calendar) days.\n\n\nThe output below is as expected. Time since reference date is a fraction of year. The zero date (annually compounded) at any given date is 0.03.\n+--------------------+--------------------+--------------------+--------------------+\n|                Date| Time From Reference|           Zero Rate|     Discount Factor|\n+--------------------+--------------------+--------------------+--------------------+\n|     June 20th, 2024|            0.000000|            0.030000|            1.000000|\n|     June 21st, 2024|            0.002740|            0.030000|            0.999919|\n|     June 22nd, 2024|            0.005479|            0.030000|            0.999838|\n|     June 23rd, 2024|            0.008219|            0.030000|            0.999757|\n|     June 24th, 2024|            0.010959|            0.030000|            0.999676|\n|     June 25th, 2024|            0.013699|            0.030000|            0.999595|\n|     June 26th, 2024|            0.016438|            0.030000|            0.999514|\n|     June 27th, 2024|            0.019178|            0.030000|            0.999433|\n|     June 28th, 2024|            0.021918|            0.030000|            0.999352|\n|     June 29th, 2024|            0.024658|            0.030000|            0.999271|\n+--------------------+--------------------+--------------------+--------------------+\n\n\nInterpolated Yield Curve\nA more realistic case is that the yield curve is not flat. For example, the plot below shows the U.S. Treasury par yield curve rates at June 20, 2024. An inverted shape. Further, the curve is not continuous. We need to interpolate the curve to fill the gaps so that we can get the zero rate and discount factor for any given date, as at the reference date of the curve.\n\n\n\nU.S. Treasury par yield curve rates at June 20, 2024\n\n\nMaturity\nYield\n\n\n\n\n1 Mo\n5.42\n\n\n2 Mo\n5.46\n\n\n3 Mo\n5.5\n\n\n4 Mo\n5.46\n\n\n6 Mo\n5.37\n\n\n1 Yr\n5.1\n\n\n2 Yr\n4.7\n\n\n3 Yr\n4.45\n\n\n5 Yr\n4.26\n\n\n7 Yr\n4.25\n\n\n10 Yr\n4.25\n\n\n20 Yr\n4.49\n\n\n30 Yr\n4.39\n\n\n\n\ndata = FileAttachment(\"treasury-rates-2024-06-20.csv\").csv({ typed: true })\n\nPlot.plot({\n  caption: \"U.S. Treasury par yield curve rates at June 20, 2024. An inverted shape.\",\n  x: {padding: 0.4, label: \"Maturity\"},\n  y: {padding: 0.4, label: \"Yield (%)\", domain: [0, 7]},\n  grid: true,\n  marks: [\n    Plot.ruleY([0]),\n    Plot.ruleX([0]),\n    Plot.dot(data, {x: \"Maturity\", y: \"Yield\", stroke: \"blue\", sort: {x: null}}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSo, the purpose now is to build a yield curve using the given par rates for distinct maturities.\n\n\n\n\n\n\nNote\n\n\n\nSpecifically, Treasury securities with a maturity of 1 year and below are discounted securities, sometimes named zero coupon bond (ZCB). Treasuries with longer maturities pay semiannual coupons. We need to make use of these facts when building the yield curve.\n\n\nThe following is an example code that deliberately spells out everything.\n#include &lt;iostream&gt;\n#include &lt;ql/quantlib.hpp&gt;\n\n#include \"utils.cpp\"\n\nusing namespace QuantLib;\n\nint main(int, char *[]) {\n  Date today = Date(20, June, 2024);  // Thursday\n  Integer fixingDays = 0;\n  Integer settlementDays = 1;\n  Date settlementDate = today + settlementDays * Days;\n  Calendar calendar = UnitedStates(UnitedStates::GovernmentBond);\n  DayCounter zcBondsDayCounter = ActualActual(ActualActual::ISDA);\n\n1  std::vector&lt;ext::shared_ptr&lt;RateHelper&gt;&gt; bondInstruments;\n\n  // ZCB\n  auto zcbRate1m = ext::make_shared&lt;SimpleQuote&gt;(.0542);\n  auto zcbRate2m = ext::make_shared&lt;SimpleQuote&gt;(.0546);\n  auto zcbRate3m = ext::make_shared&lt;SimpleQuote&gt;(.055);\n  auto zcbRate4m = ext::make_shared&lt;SimpleQuote&gt;(.0546);\n  auto zcbRate6m = ext::make_shared&lt;SimpleQuote&gt;(.0537);\n  auto zcbRate1y = ext::make_shared&lt;SimpleQuote&gt;(.051);\n\n  auto zcb1m = ext::make_shared&lt;DepositRateHelper&gt;(\n      Handle&lt;Quote&gt;(zcbRate1m), 1 * Months, fixingDays, calendar,\n      ModifiedFollowing, true, zcBondsDayCounter);\n  auto zcb2m = ext::make_shared&lt;DepositRateHelper&gt;(\n      Handle&lt;Quote&gt;(zcbRate2m), 2 * Months, fixingDays, calendar,\n      ModifiedFollowing, true, zcBondsDayCounter);\n  auto zcb3m = ext::make_shared&lt;DepositRateHelper&gt;(\n      Handle&lt;Quote&gt;(zcbRate3m), 3 * Months, fixingDays, calendar,\n      ModifiedFollowing, true, zcBondsDayCounter);\n  auto zcb4m = ext::make_shared&lt;DepositRateHelper&gt;(\n      Handle&lt;Quote&gt;(zcbRate4m), 4 * Months, fixingDays, calendar,\n      ModifiedFollowing, true, zcBondsDayCounter);\n  auto zcb6m = ext::make_shared&lt;DepositRateHelper&gt;(\n      Handle&lt;Quote&gt;(zcbRate6m), 6 * Months, fixingDays, calendar,\n      ModifiedFollowing, true, zcBondsDayCounter);\n  auto zcb1y = ext::make_shared&lt;DepositRateHelper&gt;(\n      Handle&lt;Quote&gt;(zcbRate1y), 12 * Months, fixingDays, calendar,\n      ModifiedFollowing, true, zcBondsDayCounter);\n\n2  bondInstruments.push_back(zcb1m);\n  bondInstruments.push_back(zcb2m);\n  bondInstruments.push_back(zcb3m);\n  bondInstruments.push_back(zcb4m);\n  bondInstruments.push_back(zcb6m);\n  bondInstruments.push_back(zcb1y);\n\n  // Coupon bonds\n  Real faceAmount = 100.0;\n\n  // Par yields so bond prices are 100\n3  auto quote2yr = ext::make_shared&lt;SimpleQuote&gt;(100.0);\n  auto quote3yr = ext::make_shared&lt;SimpleQuote&gt;(100.0);\n  auto quote5yr = ext::make_shared&lt;SimpleQuote&gt;(100.0);\n  auto quote7yr = ext::make_shared&lt;SimpleQuote&gt;(100.0);\n  auto quote10yr = ext::make_shared&lt;SimpleQuote&gt;(100.0);\n  auto quote20yr = ext::make_shared&lt;SimpleQuote&gt;(100.0);\n  auto quote30yr = ext::make_shared&lt;SimpleQuote&gt;(100.0);\n\n4  RelinkableHandle&lt;Quote&gt; quoteHandle2yr;\n  RelinkableHandle&lt;Quote&gt; quoteHandle3yr;\n  RelinkableHandle&lt;Quote&gt; quoteHandle5yr;\n  RelinkableHandle&lt;Quote&gt; quoteHandle7yr;\n  RelinkableHandle&lt;Quote&gt; quoteHandle10yr;\n  RelinkableHandle&lt;Quote&gt; quoteHandle20yr;\n  RelinkableHandle&lt;Quote&gt; quoteHandle30yr;\n\n  quoteHandle2yr.linkTo(quote2yr);\n  quoteHandle3yr.linkTo(quote3yr);\n  quoteHandle5yr.linkTo(quote5yr);\n  quoteHandle7yr.linkTo(quote7yr);\n  quoteHandle10yr.linkTo(quote10yr);\n  quoteHandle20yr.linkTo(quote20yr);\n  quoteHandle30yr.linkTo(quote30yr);\n\n  Date issueDate = today;\n  // 2yr Treasury Note\n5  Schedule schedule2yr(issueDate, issueDate + 2 * Years, Period(Semiannual),\n                       UnitedStates(UnitedStates::GovernmentBond), Following,\n                       Following, DateGeneration::Backward, false);\n\n6  auto bond2yr = ext::make_shared&lt;FixedRateBond&gt;(\n      settlementDays, faceAmount, schedule2yr, std::vector&lt;Real&gt;(1, .047),\n      ActualActual(ActualActual::Bond));\n\n7  auto bondHelper2yr = ext::make_shared&lt;BondHelper&gt;(quoteHandle2yr, bond2yr);\n\n  // 3yr Treasury Note\n  Schedule schedule3yr(issueDate, issueDate + 3 * Years, Period(Semiannual),\n                       UnitedStates(UnitedStates::GovernmentBond), Following,\n                       Following, DateGeneration::Backward, false);\n\n  auto bond3yr = ext::make_shared&lt;FixedRateBond&gt;(\n      settlementDays, faceAmount, schedule3yr, std::vector&lt;Real&gt;(1, .0445),\n      ActualActual(ActualActual::Bond));\n\n  auto bondHelper3yr = ext::make_shared&lt;BondHelper&gt;(quoteHandle3yr, bond3yr);\n\n  // 5yr Treasury Note\n  Schedule schedule5yr(issueDate, issueDate + 5 * Years, Period(Semiannual),\n                       UnitedStates(UnitedStates::GovernmentBond), Following,\n                       Following, DateGeneration::Backward, false);\n\n  auto bond5yr = ext::make_shared&lt;FixedRateBond&gt;(\n      settlementDays, faceAmount, schedule5yr, std::vector&lt;Real&gt;(1, .0426),\n      ActualActual(ActualActual::Bond));\n\n  auto bondHelper5yr = ext::make_shared&lt;BondHelper&gt;(quoteHandle5yr, bond5yr);\n\n  // 7yr Treasury Note\n  Schedule schedule7yr(issueDate, issueDate + 7 * Years, Period(Semiannual),\n                       UnitedStates(UnitedStates::GovernmentBond), Following,\n                       Following, DateGeneration::Backward, false);\n\n  auto bond7yr = ext::make_shared&lt;FixedRateBond&gt;(\n      settlementDays, faceAmount, schedule7yr, std::vector&lt;Real&gt;(1, .0425),\n      ActualActual(ActualActual::Bond));\n\n  auto bondHelper7yr = ext::make_shared&lt;BondHelper&gt;(quoteHandle7yr, bond7yr);\n\n  // 10yr Treasury Bond\n  Schedule schedule10yr(issueDate, issueDate + 10 * Years, Period(Semiannual),\n                        UnitedStates(UnitedStates::GovernmentBond), Following,\n                        Following, DateGeneration::Backward, false);\n\n  auto bond10yr = ext::make_shared&lt;FixedRateBond&gt;(\n      settlementDays, faceAmount, schedule10yr, std::vector&lt;Real&gt;(1, .0425),\n      ActualActual(ActualActual::Bond));\n\n  auto bondHelper10yr = ext::make_shared&lt;BondHelper&gt;(quoteHandle10yr, bond10yr);\n\n  // 20yr Treasury Bond\n  Schedule schedule20yr(issueDate, issueDate + 20 * Years, Period(Semiannual),\n                        UnitedStates(UnitedStates::GovernmentBond), Following,\n                        Following, DateGeneration::Backward, false);\n\n  auto bond20yr = ext::make_shared&lt;FixedRateBond&gt;(\n      settlementDays, faceAmount, schedule20yr, std::vector&lt;Real&gt;(1, .0449),\n      ActualActual(ActualActual::Bond));\n\n  auto bondHelper20yr = ext::make_shared&lt;BondHelper&gt;(quoteHandle20yr, bond20yr);\n\n  // 30yr Treasury Bond\n  Schedule schedule30yr(issueDate, issueDate + 30 * Years, Period(Semiannual),\n                        UnitedStates(UnitedStates::GovernmentBond), Following,\n                        Following, DateGeneration::Backward, false);\n\n  auto bond30yr = ext::make_shared&lt;FixedRateBond&gt;(\n      settlementDays, faceAmount, schedule30yr, std::vector&lt;Real&gt;(1, .0439),\n      ActualActual(ActualActual::Bond));\n\n  auto bondHelper30yr = ext::make_shared&lt;BondHelper&gt;(quoteHandle30yr, bond30yr);\n\n8  bondInstruments.push_back(bondHelper2yr);\n  bondInstruments.push_back(bondHelper3yr);\n  bondInstruments.push_back(bondHelper5yr);\n  bondInstruments.push_back(bondHelper7yr);\n  bondInstruments.push_back(bondHelper10yr);\n  bondInstruments.push_back(bondHelper20yr);\n  bondInstruments.push_back(bondHelper30yr);\n\n  // Curve building\n  DayCounter termStructureDayCounter = ActualActual(ActualActual::ISDA);\n  auto bondDiscountingTermStructure =\n      ext::make_shared&lt;PiecewiseYieldCurve&lt;Discount, LogLinear&gt;&gt;(\n          settlementDate, bondInstruments, termStructureDayCounter);\n\n9  RelinkableHandle&lt;YieldTermStructure&gt; discountingTermStructure;\n  discountingTermStructure.linkTo(bondDiscountingTermStructure);\n\n  // Results\n\n  Table table(\n      {{\"Date\", \"Time From Reference\", \"Zero Rate\", \"Discount Factor\"}});\n\n  std::vector&lt;int&gt; months;\n\n  for (size_t dt = 0; dt &lt; 12; dt++) {\n    months.push_back(dt);\n  }\n  for (size_t dt = 12; dt &lt; 12 * 30 + 1; dt += 12) {\n    months.push_back(dt);\n  }\n\n  for (auto &dt : months) {\n    Date date = settlementDate + dt * Months;\n    Time time = discountingTermStructure-&gt;timeFromReference(date);\n    std::ostringstream dateStream;\n    dateStream &lt;&lt; date;\n    std::string dateStr = dateStream.str();\n    std::string timeElapsed = std::to_string(time);\n    std::string zeroRate = std::to_string(\n        discountingTermStructure-&gt;zeroRate(time, Compounded, Annual, true));\n    std::string df = std::to_string(discountingTermStructure-&gt;discount(date));\n\n    table.push_back({dateStr, timeElapsed, zeroRate, df});\n  }\n\n  const int columnWidth = 20;\n  printTableWithBorders(table, columnWidth);\n\n  return 0;\n}\n\n1\n\nThis vector of RateHelper is used to build the curve.\n\n2\n\nThe short end of the yield curve is based on deposit rates or ZCB rates.\n\n3\n\nThese are the market prices (quotes) of Treasury Notes/Bonds.\n\n4\n\nQuote handle that can be relinked to different data sources.\n\n5\n\nSchedule describes the (coupon) cash flow schedule.\n\n6\n\nThe bond specification.\n\n7\n\nBondHelper associates the market price (quote) and the bond specification.\n\n8\n\nThe long end of the yield curve is based on Treasury coupon bonds.\n\n9\n\nThis Relinkablehandle is what we use.\n\n\nThe output is as below. It is easy to tell that the zero rates are varying and interpolated from the known par yields.\n+--------------------+--------------------+--------------------+--------------------+\n|                Date| Time From Reference|           Zero Rate|     Discount Factor|\n+--------------------+--------------------+--------------------+--------------------+\n|     June 21st, 2024|            0.000000|            0.055565|            1.000000|\n|     July 21st, 2024|            0.081967|            0.055565|            0.995577|\n|   August 21st, 2024|            0.166667|            0.055743|            0.991000|\n|September 21st, 2024|            0.251366|            0.056006|            0.986396|\n|  October 21st, 2024|            0.333333|            0.055739|            0.982082|\n| November 21st, 2024|            0.418033|            0.055132|            0.977816|\n| December 21st, 2024|            0.500000|            0.054630|            0.973756|\n|  January 21st, 2025|            0.584849|            0.053851|            0.969790|\n| February 21st, 2025|            0.669781|            0.053046|            0.965974|\n|    March 21st, 2025|            0.746493|            0.052476|            0.962540|\n|    April 21st, 2025|            0.831425|            0.051969|            0.958752|\n|      May 21st, 2025|            0.913616|            0.051567|            0.955101|\n|     June 21st, 2025|            0.998548|            0.051222|            0.951343|\n|     June 21st, 2026|            1.998548|            0.047458|            0.911499|\n|     June 21st, 2027|            2.998548|            0.044888|            0.876634|\n|     June 21st, 2028|            4.000000|            0.043644|            0.842926|\n|     June 21st, 2029|            4.998548|            0.042903|            0.810602|\n|     June 21st, 2030|            5.998548|            0.042862|            0.777438|\n|     June 21st, 2031|            6.998548|            0.042833|            0.745630|\n|     June 21st, 2032|            8.000000|            0.042847|            0.714883|\n|     June 21st, 2033|            8.998548|            0.042858|            0.685488|\n|     June 21st, 2034|            9.998548|            0.042869|            0.657250|\n|     June 21st, 2035|           10.998548|            0.043443|            0.626426|\n|     June 21st, 2036|           12.000000|            0.043923|            0.597007|\n|     June 21st, 2037|           12.998548|            0.044328|            0.569049|\n|     June 21st, 2038|           13.998548|            0.044675|            0.542362|\n|     June 21st, 2039|           14.998548|            0.044977|            0.516926|\n|     June 21st, 2040|           16.000000|            0.045241|            0.492649|\n|     June 21st, 2041|           16.998548|            0.045473|            0.469578|\n|     June 21st, 2042|           17.998548|            0.045680|            0.447556|\n|     June 21st, 2043|           18.998548|            0.045866|            0.426567|\n|     June 21st, 2044|           20.000000|            0.046033|            0.406533|\n|     June 21st, 2045|           20.998548|            0.045761|            0.390795|\n|     June 21st, 2046|           21.998548|            0.045513|            0.375644|\n|     June 21st, 2047|           22.998548|            0.045288|            0.361081|\n|     June 21st, 2048|           24.000000|            0.045080|            0.347062|\n|     June 21st, 2049|           24.998548|            0.044890|            0.333626|\n|     June 21st, 2050|           25.998548|            0.044715|            0.320692|\n|     June 21st, 2051|           26.998548|            0.044552|            0.308259|\n|     June 21st, 2052|           28.000000|            0.044401|            0.296291|\n|     June 21st, 2053|           28.998548|            0.044260|            0.284820|\n|     June 21st, 2054|           29.998548|            0.044129|            0.273778|\n+--------------------+--------------------+--------------------+--------------------+"
  },
  {
    "objectID": "posts/quantlib-yield-curve/index.html#utils",
    "href": "posts/quantlib-yield-curve/index.html#utils",
    "title": "QuantLib - Yield Curve",
    "section": "Utils",
    "text": "Utils\n\n\nutils.cpp\n\n#include &lt;iomanip&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n\ntypedef std::vector&lt;std::vector&lt;std::string&gt;&gt; Table;\n\n// Function to print a table with borders and a header line\nvoid printTableWithBorders(const Table& table, int colWidth) { \n  auto printLine = [&](char c) {\n    std::cout &lt;&lt; \"+\";\n    for (int i = 0; i &lt; table[0].size(); ++i)\n      std::cout &lt;&lt; std::string(colWidth, c) &lt;&lt; \"+\";\n    std::cout &lt;&lt; std::endl;\n  };\n  printLine('-');\n  for (size_t i = 0; i &lt; table.size(); ++i) {\n    for (const auto& cell : table[i])\n      std::cout &lt;&lt; \"|\" &lt;&lt; std::setw(colWidth) &lt;&lt; std::right &lt;&lt; cell;\n    std::cout &lt;&lt; \"|\\n\";\n    if (i == 0) printLine('-');\n  }\n  printLine('-');\n}"
  },
  {
    "objectID": "posts/probability-of-informed-trading/index.html",
    "href": "posts/probability-of-informed-trading/index.html",
    "title": "Probability of Informed Trading (PIN)",
    "section": "",
    "text": "Note\n\n\n\nThis post was originally published on my old blog in March 2018 in Chinese. Translation is provided by ChatGPT-4.\nIn the market microstructure literature, Easley et al. (1996) proposed a trading model that can decompose the bid-ask spread. The most commendable aspect of this model is the introduction of the “Probability of Informed Trading,” or PIN, which serves as a means of measuring the informational component in the spread. As the name suggests, under ideal conditions, PIN can reflect the probability of informed trading in a market with market maker.\nIn this post, I attempt to comb through the modeling process in the Easley et al. (1996) paper and discuss how to handle the objective function in maximum likelihood estimation to avoid overflow errors during computation."
  },
  {
    "objectID": "posts/probability-of-informed-trading/index.html#model",
    "href": "posts/probability-of-informed-trading/index.html#model",
    "title": "Probability of Informed Trading (PIN)",
    "section": "Model",
    "text": "Model\nAssume that the buy and sell orders of informed and uninformed traders follow independent Poisson processes, and the following tree diagram describes the entire trading process:\n\n\n\n\n\n\nFigure 2: Theoretical model of PIN\n\n\n\n\nOn each trading day, there is a probability of \\(P=\\alpha\\) that new information will appear, and obviously a probability of \\(P=(1-\\alpha)\\) that there will be no new information.\nThe probability of new information being bearish is \\(P=\\delta\\), and the probability of it being bullish is \\(P=(1-\\delta)\\).\n\nIf the news is bearish, the arrival rate of buy orders on that day is \\(\\varepsilon\\), and the arrival rate of sell orders is \\((\\varepsilon+\\mu)\\).\nIf the news is bullish, the arrival rate of buy orders on that day is \\((\\varepsilon+\\mu)\\), and the arrival rate of sell orders is \\(\\varepsilon\\).\n\nWhen there is no new information, the arrival rate of both buy and sell orders is \\(\\varepsilon\\)."
  },
  {
    "objectID": "posts/probability-of-informed-trading/index.html#trading-process",
    "href": "posts/probability-of-informed-trading/index.html#trading-process",
    "title": "Probability of Informed Trading (PIN)",
    "section": "Trading Process",
    "text": "Trading Process\nNext, assume that the market maker is a Bayesian, that is, he will update his understanding of the overall market status, especially whether there is new information on that day, by observing trades and trading rates. Suppose each trading day is independent, \\(P(t)=(P_n(t), P_b(t), P_g(t))\\) is the market maker’s prior probability perception, where \\(n\\) represents no new information, \\(b\\) represents bearish bad news, and \\(g\\) represents bullish good news, so \\(P(t)=(1-\\alpha, \\alpha\\delta, \\alpha(1-\\delta))\\).\nLet \\(S_t\\) be the event of a sell order arriving at time \\(t\\), and \\(B_t\\) be the event of a buy order arriving at time \\(t\\). Also, let \\(P(t|S_t)\\) be the updated probability perception of the market maker after observing a sell order arriving at time \\(t\\) based on the existing information. Then, according to Bayes’ theorem, if there is no new information at time \\(t\\) and the market maker observes a sell order, the posterior probability \\(P_n(t|S_t)\\) should be:\n\\[\n\\begin{equation} P_n(t|S_t)=\\frac{P_n(t)\\varepsilon}{\\varepsilon+P_b(t)\\mu}\\end{equation}\n\\]\nSimilarly, if there is bearish information and the market maker observes a sell order at time \\(t\\), the posterior probability \\(P_b(t|S_t)\\) should be:\n\\[\n\\begin{equation} P_b(t|S_t)=\\frac{P_b(t)(\\varepsilon+\\mu)}{\\varepsilon+P_b(t)\\mu}\\end{equation}\n\\]\nIf there is bullish information and the market maker observes a sell order at time \\(t\\), the posterior probability \\(P_g(t|S_t)\\) should be:\n\\[\n\\begin{equation}\nP_g(t|S_t)=\\frac{P_g(t)\\varepsilon}{\\varepsilon+P_b(t)\\mu}\n\\end{equation}\n\\]\nThus, the expected zero-profit bid price at time \\(t\\) on day \\(i\\) should be the conditional expectation of the asset value based on historical information and observing sell order at this time, that is,\n\\[\n\\begin{equation}\nb(t)=\\frac{P_n(t)\\varepsilon V^*_i+P_b(t)(\\varepsilon+\\mu)\\underline{V}_i+P_g(t)\\varepsilon\\overline{V}_i}{\\varepsilon+P_b(t)\\mu}\n\\end{equation}\n\\]\nHere, \\(V_i\\) is the value of the asset at the end of day \\(i\\), and let the asset value be \\(\\overline{V}_i\\) when there is positive news, \\(\\underline{V}_i\\) when there is negative news, and \\(V^*_i\\) when there is no news, with \\(\\underline{V}_i &lt; V^*_i &lt; \\overline{V}_i\\).\nAt this point, the ask price should be:\n\\[\n\\begin{equation} a(t)=\\frac{P_n(t)\\varepsilon V^*_i+P_b(t)\\varepsilon\\underline{V}_i+P_g(t)(\\varepsilon+\\mu)\\overline{V}_i}{\\varepsilon+P_g(t)\\mu}\\end{equation}\n\\]\nLet’s associate these bid and ask prices with the expected asset value at time \\(t\\). Considering that the conditional expectation of the asset value at this time is:\n\\[\n\\begin{equation} E[V_i|t]=P_n(t)V^*_i+P_b(t)\\underline{V}_i+P_g(t)\\overline{V}_i\\end{equation}\n\\]\nwe can write the above \\(b(t)\\) and \\(a(t)\\) as:\n\\[\n\\begin{equation} b(t)=E[V_i|t]-\\frac{\\mu P_b(t)}{\\varepsilon+\\mu P_b(t)}(E[V_i|t]-\\underline{V}_i)\\end{equation}\n\\]\n\\[\n\\begin{equation} a(t)=E[V_i|t]+\\frac{\\mu P_g(t)}{\\varepsilon+\\mu P_g(t)}(\\overline{V}_i-E[V_i|t])\\end{equation}\n\\]\nThus, the bid-ask spread is \\(a(t)-b(t)\\), which is:\n\\[\n\\begin{equation} a(t)-b(t)=\\frac{\\mu P_g(t)}{\\varepsilon+\\mu P_g(t)}(\\overline{V}_i-E[V_i|t])+\\frac{\\mu P_b(t)}{\\varepsilon+\\mu P_b(t)}(E[V_i|t]-\\underline{V}_i)\\end{equation}\n\\]\nThis indicates that the bid-ask spread at time \\(t\\) is actually:\n\nThe probability of a buy order being an informed trade \\(\\times\\) the expected loss due to the informed buyer + the probability of a sell order being an informed trade \\(\\times\\) the expected loss due to the informed seller\n\nTherefore, the probability that any trade at time \\(t\\) is based on asymmetric information from informed traders is the sum of these two probabilities:\n\\[\n\\begin{equation} PIN(t)=\\frac{\\mu P_g(t)}{\\varepsilon+\\mu P_g(t)}+\\frac{\\mu P_b(t)}{\\varepsilon+\\mu P_b(t)}=\\frac{\\mu(1-P_n(t))}{\\mu(1-P_n(t))+2\\varepsilon}\\end{equation}\n\\]\nIf no information event occurs (\\(P_n(t)=1\\)) or there are no informed trades (\\(\\mu=0\\)), both \\(PIN\\) and the bid-ask spread should be zero. If the probabilities of positive and negative news are equal, i.e., \\(\\delta=1-\\delta\\), the bid-ask spread can be simplified to:\n\\[\n\\begin{equation} a(t)-b(t)=\\frac{\\alpha\\mu}{\\alpha\\mu+2\\varepsilon}[\\overline{V}_i-\\underline{V}_i]\\end{equation}\n\\]\nAnd our \\(PIN\\) measure is simplified to:\n\\[\n\\begin{equation} PIN(t)=\\frac{\\alpha\\mu}{\\alpha\\mu+2\\varepsilon}\\end{equation}\n\\]"
  },
  {
    "objectID": "posts/probability-of-informed-trading/index.html#model-estimation",
    "href": "posts/probability-of-informed-trading/index.html#model-estimation",
    "title": "Probability of Informed Trading (PIN)",
    "section": "Model Estimation",
    "text": "Model Estimation\nAfter the model is established, let’s talk about the parameter estimation of this model. The parameters we need to estimate, \\(\\theta=(\\alpha, \\delta, \\varepsilon, \\mu)\\), are actually very difficult to estimate. This is because we cannot directly observe them, and can only observe the arrival of buy and sell orders. In this model, the daily buy and sell orders are assumed to follow one of the three Poisson processes. Although we don’t know which process it is specifically, the overall idea is: more buy orders imply potential good news, more sell orders imply potential bad news, and overall buying and selling will decrease when there is no new information. With this idea in mind, we can try to estimate \\(\\theta\\) using the maximum likelihood estimation method.\nFirst, according to the trading model shown in the diagram, assume that there is bad news on a certain day, then the arrival rate of sell orders is \\((\\mu+\\varepsilon)\\), which means both informed and uninformed traders participate in selling. The arrival rate of buy orders is \\(\\varepsilon\\), that is, only uninformed traders will continue to buy. Therefore, the probability of observing a sequence of trades with \\(B\\) buy orders and \\(S\\) sell orders in a period of time is:\n\\[\n\\begin{equation}\ne^{-\\varepsilon} \\frac{\\varepsilon^B}{B!} e^{-(\\mu+\\varepsilon)} \\frac{(\\mu+\\varepsilon)^S}{S!}\n\\end{equation}\n\\]\nIf there is good news on a certain day, the probability of observing a sequence of trades with \\(B\\) buy orders and \\(S\\) sell orders in a period of time is:\n\\[\n\\begin{equation}\ne^{-\\varepsilon} \\frac{\\varepsilon^B}{B!} e^{-\\varepsilon} \\frac{\\varepsilon^S}{S!}\n\\end{equation}\n\\]\nIf there is no new information on a certain day, the probability of observing a sequence of trades with \\(B\\) buy orders and \\(S\\) sell orders in a period of time is:\n\\[\n\\begin{equation}\ne^{-(\\mu+\\varepsilon)} \\frac{(\\mu+\\varepsilon)^B}{B!} e^{-\\varepsilon} \\frac{\\varepsilon^S}{S!}\n\\end{equation}\n\\]\nSo, the probability of observing a total of \\(B\\) buy orders and \\(S\\) sell orders on a trading day should be the weighted average of the above three possibilities, and the weights here are the probabilities of each possibility. Therefore, we can write out the likelihood function:\n\\[\n\\begin{align}\nL((B, S)| \\theta)=  &(1-\\alpha)e^{-\\varepsilon} \\frac{\\varepsilon^B}{B!} e^{-\\varepsilon} \\frac{\\varepsilon^S}{S!} \\\\\n&+ \\alpha\\delta  e^{-\\varepsilon} \\frac{\\varepsilon^B}{B!} e^{-(\\mu+\\varepsilon)} \\frac{(\\mu+\\varepsilon)^S}{S!} \\\\\n&+ \\alpha(1-\\delta) e^{-(\\mu+\\varepsilon)} \\frac{(\\mu+\\varepsilon)^B}{B!} e^{-\\varepsilon} \\frac{\\varepsilon^S}{S!}\n\\end{align}\n\\]\nHence, the objective function of the maximum likelihood function is:\n\\[\n\\begin{equation}\nL(D|\\theta)=\\prod_{i=1}^{N}L(\\theta|(B_i, S_i))\n\\end{equation}\n\\]"
  },
  {
    "objectID": "posts/probability-of-informed-trading/index.html#bottomline",
    "href": "posts/probability-of-informed-trading/index.html#bottomline",
    "title": "Probability of Informed Trading (PIN)",
    "section": "Bottomline",
    "text": "Bottomline\nThe problem seems to end here. With the objective function, it seems to be all set as long as you program it and pay attention to the parameter boundaries. However, the real challenge comes next, because if you really write the objective function like this and run it, you will inevitably encounter an overflow error. After all, this function is filled with powers and factorials. Even if the time element is chosen very small, some highly liquid assets will still have hundreds of transactions within a few seconds. Therefore, both \\(B!\\), \\(S!\\), and \\((\\mu+\\varepsilon)^B\\) can beautifully crash your program. So, further processing of the objective function here is extremely important.\nBy observing equation (16), the three terms in the likelihood function can actually extract a common factor \\(e^{-2\\varepsilon}(\\mu+\\varepsilon)^{B+S}/(B!S!)\\)! After extracting this common factor, you can also substitute \\(x\\equiv \\frac{\\varepsilon}{\\mu+\\varepsilon}\\in [0, 1]\\) into it. The transformed likelihood function, after taking the logarithm, will be in the form:\n\\[\n\\begin{align}\nl((B, S)| \\theta)=&\\ln(L((B, S)| \\theta))\\\\\n=&-2\\varepsilon+(B+S)\\ln(\\mu+\\varepsilon) \\\\\n&+\\ln((1-\\alpha)x^{B+S}+\\alpha\\delta e^{-\\mu}x^B + \\alpha(1-\\delta)e^{-\\mu}x^S) \\\\\n&-\\ln(B!S!)\n\\end{align}\n\\]\nNow, since the last term \\(\\ln(B!S!)\\) does not affect the parameter estimation at all, it can be safely excluded. The remaining part can perfectly avoid overflow. Personally, I think the brilliant move here is the introduction of \\(x\\equiv \\frac{\\varepsilon}{\\mu+\\varepsilon}\\in [0, 1]\\), which prevents the overflow error caused by \\((\\mu+\\varepsilon)&gt;1\\)."
  },
  {
    "objectID": "posts/probability-of-informed-trading/index.html#python-code",
    "href": "posts/probability-of-informed-trading/index.html#python-code",
    "title": "Probability of Informed Trading (PIN)",
    "section": "Python code",
    "text": "Python code\nSee my implementation here: https://frds.io/measures/probability_of_informed_trading/."
  },
  {
    "objectID": "posts/never-use-a-brain-wallet/index.html",
    "href": "posts/never-use-a-brain-wallet/index.html",
    "title": "Never Use a Brain Wallet",
    "section": "",
    "text": "Among many reasons why people find it hard to use cryptocurrency there’s a simple one – memorising the private key is too hard. So, people invented brain wallet, which turns a string of words into a private key and thus wallet.\nIt’s genius in that now a user needs only to memorise whatever he or she used to create the wallet. You can turn your name, phone number, DoB, favourite quote, lover’s home address, …, literally anything into a cryptocurrency wallet. However, this also means that if someone else successfully guessed the passphrase you used, they can sweep all the coins you have!"
  },
  {
    "objectID": "posts/never-use-a-brain-wallet/index.html#python-brain-wallet-for-bitcoin",
    "href": "posts/never-use-a-brain-wallet/index.html#python-brain-wallet-for-bitcoin",
    "title": "Never Use a Brain Wallet",
    "section": "Python brain wallet for Bitcoin",
    "text": "Python brain wallet for Bitcoin\nAfter a little bit of research, I’ve put together a simple brain wallet Python script that turns any input string to a legal Bitcoin private key and its address.\nimport codecs\nimport hashlib\nimport ecdsa\n\n\nclass BrainWallet:\n\n    @staticmethod\n    def generate_address_from_passphrase(passphrase):\n        private_key = str(hashlib.sha256(\n            passphrase.encode('utf-8')).hexdigest())\n        address =  BrainWallet.generate_address_from_private_key(private_key)\n        return private_key, address\n\n    @staticmethod\n    def generate_address_from_private_key(private_key):\n        public_key = BrainWallet.__private_to_public(private_key)\n        address = BrainWallet.__public_to_address(public_key)\n        return address\n\n    @staticmethod\n    def __private_to_public(private_key):\n        private_key_bytes = codecs.decode(private_key, 'hex')\n        # Get ECDSA public key\n        key = ecdsa.SigningKey.from_string(\n            private_key_bytes, curve=ecdsa.SECP256k1).verifying_key\n        key_bytes = key.to_string()\n        key_hex = codecs.encode(key_bytes, 'hex')\n        # Add bitcoin byte\n        bitcoin_byte = b'04'\n        public_key = bitcoin_byte + key_hex\n        return public_key\n\n    @staticmethod\n    def __public_to_address(public_key):\n        public_key_bytes = codecs.decode(public_key, 'hex')\n        # Run SHA256 for the public key\n        sha256_bpk = hashlib.sha256(public_key_bytes)\n        sha256_bpk_digest = sha256_bpk.digest()\n        # Run ripemd160 for the SHA256\n        ripemd160_bpk = hashlib.new('ripemd160')\n        ripemd160_bpk.update(sha256_bpk_digest)\n        ripemd160_bpk_digest = ripemd160_bpk.digest()\n        ripemd160_bpk_hex = codecs.encode(ripemd160_bpk_digest, 'hex')\n        # Add network byte\n        network_byte = b'00'\n        network_bitcoin_public_key = network_byte + ripemd160_bpk_hex\n        network_bitcoin_public_key_bytes = codecs.decode(\n            network_bitcoin_public_key, 'hex')\n        # Double SHA256 to get checksum\n        sha256_nbpk = hashlib.sha256(network_bitcoin_public_key_bytes)\n        sha256_nbpk_digest = sha256_nbpk.digest()\n        sha256_2_nbpk = hashlib.sha256(sha256_nbpk_digest)\n        sha256_2_nbpk_digest = sha256_2_nbpk.digest()\n        sha256_2_hex = codecs.encode(sha256_2_nbpk_digest, 'hex')\n        checksum = sha256_2_hex[:8]\n        # Concatenate public key and checksum to get the address\n        address_hex = (network_bitcoin_public_key + checksum).decode('utf-8')\n        wallet = BrainWallet.base58(address_hex)\n        return wallet\n\n    @staticmethod\n    def base58(address_hex):\n        alphabet = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n        b58_string = ''\n        # Get the number of leading zeros and convert hex to decimal\n        leading_zeros = len(address_hex) - len(address_hex.lstrip('0'))\n        # Convert hex to decimal\n        address_int = int(address_hex, 16)\n        # Append digits to the start of string\n        while address_int &gt; 0:\n            digit = address_int % 58\n            digit_char = alphabet[digit]\n            b58_string = digit_char + b58_string\n            address_int //= 58\n        # Add '1' for each 2 leading zeros\n        ones = leading_zeros // 2\n        for one in range(ones):\n            b58_string = '1' + b58_string\n        return b58_string"
  },
  {
    "objectID": "posts/never-use-a-brain-wallet/index.html#easily-cracking-a-wallet",
    "href": "posts/never-use-a-brain-wallet/index.html#easily-cracking-a-wallet",
    "title": "Never Use a Brain Wallet",
    "section": "Easily “cracking” a wallet",
    "text": "Easily “cracking” a wallet\nLet me show you some really easy-to-guess passphrases and their associated private keys and addresses. As an example, the code below uses “password” as the input passphrase and derives the private key and address from it.\npassphrase = 'password'\nwallet = BrainWallet()\nprivate_key, address = wallet.generate_address_from_passphrase(passphrase)\nprint(f'passphrase: {passphrase}')\nprint(f'private key: {private_key}')\nprint(f'address: {address}')\nThe output is:\npassphrase: password\nprivate key: 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8\naddress: 16ga2uqnF1NqpAuQeeg7sTCAdtDUwDyJav\nAs at May 22, 2019, this address has 45,014 transactions with a total of 0.3563 BTC (of course the balance is zero)! You can check its current balance at blockchain.com. Also, congratulations, you are now one of the many owners of this address/wallet. So next time you observe some coins transfered to it, you’ll be able to use it as well (though I don’t suggest you to do so)!"
  },
  {
    "objectID": "posts/never-use-a-brain-wallet/index.html#some-other-cracked-wallets",
    "href": "posts/never-use-a-brain-wallet/index.html#some-other-cracked-wallets",
    "title": "Never Use a Brain Wallet",
    "section": "Some other “cracked” wallets",
    "text": "Some other “cracked” wallets\nI explored a little bit more and it’s surprising to find out how easy it is to crack a wallet this way. Below is a table of some passphrases and their associated keys and addresses.\n\n\n\n\nPassphrase\nPrivate Key\nAddress\nUsed\n\n\n\n\nsatoshi\nda2876b3eb31edb4436fa4650673fc6f01f90de2f1793c4ec332b2387b09726f\n1ADJqstUMBB5zFquWg19UqZ7Zc6ePCpzLE\nTrue\n\n\nbitcoin\n6b88c087247aa2f07ee1c5956b8e1a9f4c7f892a70e324f1bb3d161e05ca107b\n1E984zyYbNmeuumzEdqT8VSL8QGJi3byAD\nTrue\n\n\nhello world\nb94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9\n1CS8g7nwaxPPprb4vqcTVdLCuCRirsbsMb\nTrue\n\n\ntesting\ncf80cd8aed482d5d1527d7dc72fceff84e6326592848447d2dc0b0e87dfc9a90\n1JdDsbYYRSpsTnBVgenruULVeUjt5z6WnR\nTrue\n\n\ngod\n5723360ef11043a879520412e9ad897e0ebcb99cc820ec363bfecc9d751a1a99\n1KxmSmcMTmPvU1qSLYpJLrqnSzBoQ53NXN\nTrue\n\n\nterminator\naa802f654e3ae7aaa1b73f8724056a05e2691accea8dd90057916080f84d7e93\n18kvt3D6K1CG8MxGP6ke7q6vLU5NGpLZdR\nTrue\n\n\nabc\nba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad\n1NEwmNSC7w9nZeASngHCd43Bc5eC2FmXpn\nTrue\n\n\n\n\nAnd a lot of swear words are used as well, but I’m just going to skip them.\nApart from the single world and short phrases, some people do use famous quotes. As an example, see this one from A Tale of Two Cities:\n\nit was the best of times it was the worst of times\n\nIts private key is af8da705bfd95621983e5cf4232ac1ca0c79b47122e3defd8a98fa9a4387d985 and its address is 17WenQJaYvqCNumebQU54TsixWtQ1GQ4ND. It has received 1 BTC in total but again the balance is zero, lol."
  },
  {
    "objectID": "posts/never-use-a-brain-wallet/index.html#concluding-remark",
    "href": "posts/never-use-a-brain-wallet/index.html#concluding-remark",
    "title": "Never Use a Brain Wallet",
    "section": "Concluding remark",
    "text": "Concluding remark\nNever use a brain wallet. Because if you can think of it, someone else might also be able to come up with same passphrase. But, if you are comfortable or absolutely sure that your passphrase is secret, feel free to use the script above and make yourself a wallet. 😏"
  },
  {
    "objectID": "posts/merton-dd/index.html",
    "href": "posts/merton-dd/index.html",
    "title": "Estimate Merton Distance-to-Default",
    "section": "",
    "text": "Merton (1974) Distance to Default (DD) model is useful in forecasting defaults. This post documents a few ways to empirically estimate Merton DD (and default probability) as in Bharath and Shumway (2008)."
  },
  {
    "objectID": "posts/merton-dd/index.html#the-merton-model",
    "href": "posts/merton-dd/index.html#the-merton-model",
    "title": "Estimate Merton Distance-to-Default",
    "section": "The Merton Model",
    "text": "The Merton Model\nThe total value of a firm follows geometric Brownian motion,\n\\[\n\\begin{equation}\ndV = \\mu Vdt+\\sigma_V VdW\n\\end{equation}\n\\tag{1}\\]\nwhere,\n\n\\(V\\) is the total value of the firm\n\\(\\mu\\) is the expected return on V (continuously compounded)\n\\(\\sigma_V\\) is the volatility of firm value\n\\(dW\\) is a standard Wiener process\n\nAssuming the firm has one discount bond maturing in \\(T\\) periods, the equity of the firm can be viewed as a call option on the underlying value of the firm with a strike price equal to the face value of the firm’s debt and a time-to-maturity of \\(T\\).\nThe equity value of the firm is hence a function of the firm’s value (Black-Scholes-Merton model):\n\\[\n\\begin{equation}\nE=V\\mathcal{N}(d_1)-e^{-rT}F\\mathcal{N}(d_2)\n\\end{equation}\n\\tag{2}\\]\nwhere,\n\n\\(E\\) is the market value of the firm’s equity\n\\(F\\) is the face value of the firm’s debt\n\\(r\\) is the risk-free rate\n\\(\\mathcal{N}(\\cdot)\\) is the cumulative standard normal distribution function\n\nand,\n\\[\n\\begin{equation}\nd_1 = \\frac{\\ln(V/F)+(r+0.5\\sigma_V^2)T}{\\sigma_V \\sqrt{T}}\n\\end{equation}\n\\tag{3}\\]\nwith \\(d_2 = d_1-\\sigma_V \\sqrt{T}\\).\nMoreover, the volatility of the firm’s equity is related to the volatility of the firm’s value, which follows from Ito’s lemma,\n\\[\n\\begin{equation}\n\\sigma_E = \\left(\\frac{V}{E}\\right)\\frac{\\partial E}{\\partial V}\\sigma_V\n\\end{equation}\n\\tag{4}\\]\nIn the Black-Scholes-Merton model, \\(\\frac{\\partial E}{\\partial V}=\\mathcal{N}(d_1)\\), so that\n\\[\n\\begin{equation}\n\\sigma_E = \\left(\\frac{V}{E}\\right)\\mathcal{N}(d_1)\\sigma_V\n\\end{equation}\n\\tag{5}\\]\nWe observe from the market:\n\n\\(E\\), the equity value of the firm, the call option value\n\\(\\sigma_E\\), the volatility of equity\n\nWe then infer and solve for:\n\n\\(V\\), the total value of the firm\n\\(\\sigma_V\\), the volatility of firm value\n\nOnce we have \\(V\\) and \\(\\sigma_V\\), the distance to default (DD) can be calculated as\n\\[\n\\begin{equation}\nDD=\\frac{\\ln(V/F)+ (\\mu-0.5\\sigma_V^2)T}{\\sigma_V\\sqrt{T}}\n\\end{equation}\n\\tag{6}\\]\nwhere,\n\n\\(\\mu\\) is an estimate of the expected annual return of the firm’s assets\n\nThe implied probability of default, or expected default frequency (EDF, registered trademark of Moody’s KMV), is\n\\[\n\\begin{equation}\n\\pi_{Merton} = \\mathcal{N}\\left(-DD\\right)\n\\end{equation}\n\\tag{7}\\]"
  },
  {
    "objectID": "posts/merton-dd/index.html#estimation",
    "href": "posts/merton-dd/index.html#estimation",
    "title": "Estimate Merton Distance-to-Default",
    "section": "Estimation",
    "text": "Estimation\n\nAn iterative approach\nTo estimate \\(\\pi_{Merton}\\), an iterative procedure can be applied instead of solving Equation 2 and Equation 5 simultaneously (see Crosbie and Bohn (2003), Vassalou and Xing (2004), Bharath and Shumway (2008), etc.).\n\nSet the initial value of \\(\\sigma_V=\\sigma_E[E/(E+F)]\\).\nUse this value of \\(\\sigma_V\\) and equation (2) to infer the market value of firm’s assets every day for the previous year.\nCalculate the implied log return on assets each day, based on which generate new estimates of \\(\\sigma_V\\) and \\(\\mu\\).\nRepeat steps 2 to 3 until \\(\\sigma_V\\) converges, i.e., the absolute difference in adjacent estimates is less than \\(10^{-3}\\).\nUse \\(\\sigma_V\\) and \\(\\mu\\) in equations (6) and (7) to calculate \\(\\pi_{Merton}\\).\n\n\n\nA naïve approach\nA naïve approach by Bharath and Shumway (2008) that does not solve Equation 2 and Equation 5 is constructed as below.\n\nApproximate the market value of debt with the face value of debt, so that \\(D=F\\).\nApproximate the volatility of debt as \\(\\sigma_D=0.05+0.25\\sigma_E\\), where 0.05 represents term structure volatility and 25% of equity volatility is included to allow for volatility associated with default risk.\nApproximate the total volatility as \\(\\sigma_V = \\frac{E}{E+D} \\sigma_E + \\frac{D}{E+D} \\sigma_D\\)\nApproximate the return on firm’s assets with the firm’s stock return over the previous year \\(r_{it-1}\\).\n\nThe naïve distance to default is then\n\\[\n\\begin{equation}\n\\text{naïve } DD=\\frac{\\ln[(E+F)/F]+ (r_{it-1}-0.5\\sigma_V^2)T}{\\sigma_V\\sqrt{T}}\n\\end{equation}\n\\tag{8}\\]\nand the naïve default probability is\n\\[\n\\begin{equation}\n\\pi_{\\text{naïve}} = \\mathcal{N}(-\\text{naïve } DD)\n\\end{equation}\n\\tag{9}\\]"
  },
  {
    "objectID": "posts/merton-dd/index.html#code",
    "href": "posts/merton-dd/index.html#code",
    "title": "Estimate Merton Distance-to-Default",
    "section": "Code",
    "text": "Code\nThe naïve method is too simple and skipped for now.\nHere I discuss the iterative approach.\n\nOriginal SAS code in Bharath and Shumway (2008)\nThe original code is enclosed in the SSRN version of Bharath and Shumway (2008), and was available on Shumway’s website.\nHowever, there are two issues in this version of code:\n\nThe initial value of \\(\\sigma_V\\) is not set to \\(\\sigma_E[E/(E+F)]\\) as described in the paper.\nIt does not use the past year’s data but the past month.\n\nAt line 36, cdt=100*year(date)+month(date) accidentally restricts the “past year” daily stock returns to the “past month” later. Note that at line 42-43 it merges by permno and cdt, where cdt refers to a certain year-month. We can pause the program after this data step to confirm that indeed there is only a month of data for each permno.\nA correction is to change line 36 to cdt=100*&yyy.+&mmm.;.\n\n\nOther issues are minor and harmless.\nA copy of this version can be found here on GitHub.\n\n\nMy code\nBased on the original SAS code in Bharath and Shumway (2008), I made some edits and below is a fully self-contained SAS code that executes smoothly. Note that I’ve corrected the above issues.\n\nNote:\nThe interest rate data from FRB on WRDS stopped in April 2020. See here.\nTo get estimates post 2020, we need to manually collect interest rate (3-month Treasury Bill) data and upload to WRDS. Then modify the relevant code, e.g. from line 96 to 117."
  },
  {
    "objectID": "posts/merge-compustat-and-crsp/index.html",
    "href": "posts/merge-compustat-and-crsp/index.html",
    "title": "Merge Compustat and CRSP",
    "section": "",
    "text": "Using the CRSP/Compustat Merged Database (CCM) to extract data is one of the fundamental steps in most finance studies. Here I document several SAS programs for annual, quarterly and monthly data, inspired by and adapted from several examples from the WRDS.1"
  },
  {
    "objectID": "posts/merge-compustat-and-crsp/index.html#ready-to-use-code",
    "href": "posts/merge-compustat-and-crsp/index.html#ready-to-use-code",
    "title": "Merge Compustat and CRSP",
    "section": "Ready-to-use code",
    "text": "Ready-to-use code\nDownload the Compustat/CRSP gvkey-permco-permno link table without duplicates.\n%let wrds=wrds-cloud.wharton.upenn.edu 4016;\noptions comamid=TCP remote=WRDS;\nsignon username=_prompt_;\n\nrsubmit;\n\n%let year_start = 1990;\n%let year_end = 2020;\n\nproc sql;\n  create table lnk as select * from crsp.ccmxpf_lnkhist where\n  linktype in (\"LU\", \"LC\") and\n  /* Extend the period to deal with fiscal year issues */\n  /* Note that the \".B\" and \".E\" missing value codes represent the   */\n  /* earliest possible beginning date and latest possible end date   */\n  /* of the Link Date range, respectively.                           */\n   (&year_end.+1 &gt;=year(linkdt) or linkdt=.B) and\n   (&year_start.-1 &lt;=year(linkenddt) or linkenddt=.E)\n    /* primary link assigned by Compustat or CRSP */\n  and linkprim in (\"P\", \"C\")\n    order by gvkey, linkdt;\nquit;\n\nproc sql;\n  create table mydata as select * from lnk, \n    comp.funda (keep=gvkey fyear tic cik datadate indfmt datafmt popsrc consol) as cst \n  where\n    indfmt='FS' /* FS - Financial Services ('INDL' for industrial ) */\n    and datafmt='STD' /* STD - Standardized */\n    and popsrc='D' /* D - Domestic (USA, Canada and ADRs)*/\n    and consol='C' /* C - Consolidated. Parent and Subsidiary accounts combined */\n    and lnk.gvkey=cst.gvkey\n    and (&year_start. &lt;=fyear &lt;=&year_end.) and (linkdt &lt;=cst.datadate or linkdt=.B)\n    and (cst.datadate &lt;=linkenddt or linkenddt=.E);\nquit;proc sql;\n  create table mydata as select * from lnk, comp.funda (keep=gvkey fyear tic cik\n    datadate indfmt datafmt popsrc consol) as cst where\n    datafmt='STD' and popsrc='D' and consol='C' and lnk.gvkey=cst.gvkey\n    and (&year_start. &lt;=fyear &lt;=&year_end.) and (linkdt &lt;=cst.datadate or linkdt=.B)\n    and (cst.datadate &lt;=linkenddt or linkenddt=.E);\nquit;\n\n/* Verify that we have unique gvkey-permco and gvkey-permno links */\nproc sort data=mydata nodupkey; by lpermco gvkey datadate; run;\nproc sort data=mydata nodupkey; by lpermno gvkey datadate; run;\n\ndata gvkey_permco_permno; set mydata;\n   rename lpermno=permno;\n   rename lpermco=permco;\nrun;\n\nproc download data=gvkey_permco_permno out=gvkey_permco_permno; run;\n\nendrsubmit;\nsignoff;"
  },
  {
    "objectID": "posts/merge-compustat-and-crsp/index.html#gvkey-permno-link-table",
    "href": "posts/merge-compustat-and-crsp/index.html#gvkey-permno-link-table",
    "title": "Merge Compustat and CRSP",
    "section": "GVKEY-PERMNO link table",
    "text": "GVKEY-PERMNO link table\nFirst, we need to create a GVKEY-PERMNO link table.\n%let beg_yr = 2000;\n%let end_yr = 2003;\n\nproc sql;\ncreate table lnk as\nselect *\nfrom crsp.ccmxpf_lnkhist\nwhere\n    /* See below for a description of the link types */\n    linktype in (\"LU\", \"LC\") and\n    /* Extend the period to deal with fiscal year issues */\n    /* Note that the \".B\" and \".E\" missing value codes represent the   */\n    /* earliest possible beginning date and latest possible end date   */\n    /* of the Link Date range, respectively.                           */\n    (&end_yr+1 &gt;= year(linkdt) or linkdt = .B) and \n    (&beg_yr-1 &lt;= year(linkenddt) or linkenddt = .E)\n    /* primary link assigned by Compustat or CRSP */\n    and linkprim in (\"P\", \"C\") \norder by \n    gvkey, linkdt;\nquit;\n\n\n\n\n\n\n\nLink Type\nDescription\n\n\n\n\nLC\nLink research complete (after extensive research by CRSP). Standard connection between databases.\n\n\nLU\nLink is unresearched by CRSP. It is established by comparing the Compustat and historical CRSP CUSIPs. LU represents the most popular link type.\n\n\nLS\nLink valid for this security only.2\n\n\nLX\nLink to a security that trades on foreign exchange not included in CRSP data.\n\n\nLD\nDuplicate link to a security. Two GVKEYs map to a single PERMNO (PERMCO) during the same period, and this link should not be used. Almost all of these cases happened before 1990.\n\n\nLN\nPrimary link exists but Compustat does not have prices.3\n\n\nNR\nNo link available; confirmed by research.\n\n\nNU\nNo link available; not yet confirmed.\n\n\n\n2 Other CRSP PERMNOs with the same PERMCO will link to other GVKEYs. LS links mainly relate to ETFs where a single CRSP PERMCO links to multiple Compustat GVKEYs. In Compustat, even though they may belong to the same investment company (e.g. ISHARES), ETFs are presented with different GVKEYs and CRSP flags this situation.3 Prices are used to check the accuracy of the link. For linktype LN there is no price information available even on a quarterly or annual basis. The user will have to decide whether or not to include these links.According to WRDS’s support page:\n\nPrimary link types (LC, LU and LS) account for 41% of the links in CCM.\nSecondary link types (LX, LD and LN) account for only 2%.\nNon-matching link types (NR and NU) account for the rest 57%, which is expected because of the different coverage of the two databases.\n\nGenerally, using LC and LU should be sufficient."
  },
  {
    "objectID": "posts/merge-compustat-and-crsp/index.html#compustat-annual-and-crsp",
    "href": "posts/merge-compustat-and-crsp/index.html#compustat-annual-and-crsp",
    "title": "Merge Compustat and CRSP",
    "section": "Compustat Annual and CRSP",
    "text": "Compustat Annual and CRSP\nExample ccmfunda.sas.\nproc sql;\ncreate table mydata as \nselect *\nfrom lnk, comp.funda (keep=gvkey fyear datadate indfmt datafmt popsrc consol sale) as cst\nwhere indfmt= 'INDL' \nand datafmt='STD' \nand popsrc='D' \nand consol='C' \nand lnk.gvkey = cst.gvkey\nand (&beg_yr &lt;= fyear &lt;= &end_yr) \nand (linkdt &lt;= cst.datadate or linkdt = .B) \nand (cst.datadate &lt;= linkenddt or linkenddt = .E);\nquit;"
  },
  {
    "objectID": "posts/merge-compustat-and-crsp/index.html#compustat-quarterly-and-crsp",
    "href": "posts/merge-compustat-and-crsp/index.html#compustat-quarterly-and-crsp",
    "title": "Merge Compustat and CRSP",
    "section": "Compustat Quarterly and CRSP",
    "text": "Compustat Quarterly and CRSP\nExample ccmfundq.sas.\nproc sql;\ncreate table mydata as \nselect *\nfrom lnk, comp.fundq (keep=gvkey fyearq datadate indfmt datafmt popsrc consol saley saleq) as cst\nwhere indfmt= 'INDL' \nand datafmt='STD' \nand popsrc='D' \nand consol='C' \nand lnk.gvkey = cst.gvkey\nand (&beg_yr &lt;= fyearq &lt;= &end_yr) \nand (linkdt &lt;= cst.datadate or linkdt = .B) \nand (cst.datadate &lt;= linkenddt or linkenddt = .E);\nquit;"
  },
  {
    "objectID": "posts/legao-to-make-your-own-lego-mosaics/index.html",
    "href": "posts/legao-to-make-your-own-lego-mosaics/index.html",
    "title": "LeGao to Make Your Own LEGO Mosaics",
    "section": "",
    "text": "I made an online app that turns a picture into a LEGO mosaic: mingze-gao.com/legao.\n\nA few weeks ago, I went to the new LEGO flagship store at Bondi with my fiancée, Sherry, and we were impressed by the LEGO Mosaics – Sydney Harbour Bridge and Opera House in sunset, designed by Ryan McNaught.\n\n\n\nLEGO Sydney Bridge (credit: jaysbrickblog.com)\n\n\nThis mosaic is made of 62,300 bricks and took 282 hours to build. Every single pixel is a 1x1 LEGO brick! We love it so much so that I’m thinking of making one myself and use it to decorate a wall in our apartment in the future.\nTo begin this endeavour, I’ll need a handy tool to convert pictures to LEGO mosaic so that I can have a preview and the data to assemble later. It turns out that there’s already an open-source library named legofy for this job. So I borrowed it and wrote a small Flask app on my server to do the magic.\nI wrote the frontend using React and Ant Design, and picked up the React Hooks along the way. It was great fun. I named it using a combination of LEGO and my surname Gao, so, LeGao.\nNow, LeGao is served at mingze-gao.com/legao. A preview is as below:\n\n\n\nLeGao-1\n\n\nUsers can upload an image(&lt;5MB) and decide on which palette to use and how many 1x1 bricks the output image should have for its longest axis. This is useful when we need to make a LEGO mosaic in real world, as a 1x1 brick’s dimension is about 8mm x 8mm.\n\n\n\nLeGao-2\n\n\nThe output image can be downloaded, no problem. All images will be deleted from my server after 5 minutes since upload/creation for privacy concern and the fact that my server doesn’t have a big storage.\nLeGao also tells you about how many bricks you’ll need to assemble the mosaic, if you really want to. Then you can easily order the bricks online or visit a store to purchase them all~\n\n\n\n Back to top"
  },
  {
    "objectID": "posts/kalman-filter/index.html",
    "href": "posts/kalman-filter/index.html",
    "title": "Kalman Filter",
    "section": "",
    "text": "This is a note as I study and understand Kalman filter. It does NOT derive Kalman filter but explains it to the best of my ability. A handwritten Python code to estimate Kalman filter is provided because I’d like to practice its implementation, but I recommend using established program/software for better numerical stability and performance."
  },
  {
    "objectID": "posts/kalman-filter/index.html#intuition",
    "href": "posts/kalman-filter/index.html#intuition",
    "title": "Kalman Filter",
    "section": "Intuition",
    "text": "Intuition\nImagine we are estimating the true inflation rate, \\(x_t\\), a state of the economy that is unobservable. We rely on two pieces of information:\n\nA prediction using past information \\(\\hat{x}_{t|t-1}\\): Based on a model that projects inflation trends.\nA new observation \\(z_t\\): A noisy indicator like a market survey or a bond yield linked to inflation.\n\nBut both have limitations. The model’s predication can be uncertain, and the observation includes noise. A naturally simple yet elegant solution would be to combine the two by weighing them based on their accuracy, therefore updating the estimate of the true inflation rate \\(\\hat{x}_{t|t}\\):\n\\[\n\\hat{x}_{t|t} = (1-w_t) \\hat{x}_{t|t-1} + w_t z_t,\n\\tag{1}\\]\nwhere \\(w_t\\in[0,1]\\) represents the weight given to new measurement \\(z_t\\).\nIt’s almost surely that we will place more weights on whichever component that is more precise!\n\n\\(w_t \\to 1\\) if our measurement \\(z_t\\) is known to be very good, but the model’s prediction is not.\n\\(w_t \\to 0\\) if our measurement \\(z_t\\) is very noisy, but the model’s prediction is quite accurate.\n\nIn this way, \\(w_t\\) dynamically adjusts how much weight to give each source based on their relative uncertainties. As a result, the updated estimate \\(\\hat{x}_{t|t}\\) optimally combines the predicted state and the noisy observation, improving our estimate of the true inflation rate over time.\nAlso, we can rearrange Equation 1 to get \\[\n\\hat{x}_{t|t} = \\hat{x}_{t|t-1} + w_t (z_t - \\hat{x}_{t|t-1}).\n\\tag{2}\\]\nThis means that the updated estimate is our best model estimate based on past information plus an adjustment for the difference between the observation and the model estimate.\n\n\n\n\n\n\nCaution\n\n\n\nNote that, however, the measurement \\(z_t\\) does NOT necessarily have the same scale as the state \\(x_t\\).\nIn our example, the true inflation rate may be an annualized percentage, but our measurement could be, for instance, the proportion of survey responses that believe inflation is higher than target, or even the trading volume of Bitcoin! Therefore they are not directly comparable such that \\((z_t - \\hat{x}_{t|t-1})\\) is not necessarily correct. In practice, we need to account for this difference and will discuss it below."
  },
  {
    "objectID": "posts/kalman-filter/index.html#a-more-elaborated-presentation",
    "href": "posts/kalman-filter/index.html#a-more-elaborated-presentation",
    "title": "Kalman Filter",
    "section": "A more elaborated presentation",
    "text": "A more elaborated presentation\nNow let’s move on to a more elaborated presentation and proceed to the basic Kalman filter. For pedagogical simplicity, we start with a univariate (or 1-dimensional) case, i.e., there is only one unobservable state variable \\(x_t\\) and we observe one indicator \\(z_t\\).\n\nThe setup\nFirst, there are two equations, namely the state transition equation Equation 3 and the measurement equation Equation 4.\n\nState transition equation:\nThis equation reflects our model, or how we perceive the unobservable state to evolve over time. However, there is some uncertainty \\(\\omega_t\\). \\[\nx_t = F_t x_{t-1} + \\omega_t\n\\tag{3}\\]\n\n\\(x_t\\): The unobserved true state (e.g., the true inflation rate).\n\n\\(F_t\\): The factor linking the previous state \\(x_{t-1}\\) to the current state.\n\n\\(\\omega_t\\): Process noise (uncertainty in the model), \\(\\omega_t \\sim  \\mathcal{N}(0, Q_t)\\).\n\nMeasurement equation:\nThis equation describes how our observed measurement is related to unobservable true state. Because it is a measurement, there is also uncertainty or noise \\(u_t\\). \\[\nz_t = H_t x_t + u_t\n\\tag{4}\\]\n\n\\(z_t\\): The observed measurement (e.g., a survey or bond yield).\n\n\\(H_t\\): The factor linking the true state \\(x_t\\) to the observation.\n\n\\(u_t\\): Measurement noise (error in the observed data), \\(u_t \\sim \\mathcal{N}(0, R_t)\\).\n\n\nWe assume the process noise \\(\\omega_t\\) and measurement noise \\(u_t\\) are independent.\n\n\nPredicting the state\nAt time \\(t\\), we can use the model Equation 3 to make a prediction of the true state based on the previous best estimate \\(\\hat{x}_{t-1|t-1}\\) which yields \\(\\hat{x}_{t|t-1}\\):1 \\[\n\\hat{x}_{t|t-1} = F_t \\hat{x}_{t-1|t-1}.\n\\tag{5}\\] - \\(\\hat{x}_{t-1|t-1}\\): The previous best (updated) estimate of the state.\n- \\(\\hat{x}_{t|t-1}\\): The model’s prediction for the current state.\n1 Note that the uncertainty \\(w_t\\) has a zero mean.\n\n\n\n\n\nNote\n\n\n\nWhen making model prediction at \\(t\\), we use the updated estimate at time \\(t-1\\), i.e., \\(\\hat{x}_{t-1|t-1}\\).\nThis should not be confused with the model estimate before updating at \\(t-1\\), i.e., \\(\\hat{x}_{t-1|t-2}\\), which is the model prediction at \\(t-1\\) using information from \\(t-2\\).\n\n\nWhile the state evolves predictably through \\(F_t\\), the process uncertainty \\(\\omega_t\\) adds noise. Given that it has a zero mean, it does not shift the model prediction, but increases the uncertainty.\nLet \\(P_{t|t}\\) denote the variance of the prediction at \\(t\\), the uncertainty (variance) in this prediction is:2 \\[\n\\text{Variance of predicted state} = P_{t|t-1} = F_t^2 P_{t-1|t-1} + Q_t.\n\\tag{6}\\] - \\(P_{t-1|t-1}\\): Variance of the previous estimate.\n- \\(Q_t\\): Variance of the process noise \\(\\omega_t\\).\n2 Note that \\(\\text{Var}(aX) = a^2 \\text{Var}(X)\\).\n\nState update\nAlso at time \\(t\\), we can observe \\(z_t\\) which is a noisy measurement of the unobservable true state \\(x_t\\). Our goal is to combine the predicted state \\(\\hat{x}_{t|t-1}\\) and the new observation \\(z_t\\) to get the best estimate of the true state \\(\\hat{x}_{t|t}\\).\nWhen the measurement \\(z_t\\) is received, it provides new information about the state \\(x_t\\). The difference between the observed measurement and the predicted measurement is called the innovation: \\[\n\\text{Innovation} = z_t - H_t \\hat{x}_{t|t-1}.\n\\tag{7}\\] where \\(H_t \\hat{x}_{t|t-1}\\) is the predicted measurement based on the predicted state.3\n3 As discussed earlier, because the measurement does not necessarily have the same scale as the state, we cannot directly use \\((z_t - \\hat{x}_{t|t-1})\\) as the innovation. Note that in Equation 4, \\(H_t\\) is used to map the state to the measurement space.This term quantifies how much the measurement differs from what the model expects. However, it is noisy, and its uncertainty is: \\[\n\\text{Variance of innovation} = R_t,\n\\tag{8}\\] where \\(R_t\\) is the variance of the measurement noise \\(u_t\\).\nFrom the intuition section, we know that the updated state estimate \\(\\hat{x}_{t|t}\\) should take the form of \\[\n\\hat{x}_{t|t} = \\hat{x}_{t|t-1} + k_t (z_t - H_t \\hat{x}_{t|t-1}),\n\\tag{9}\\] where \\(k_t\\) is a factor deciding how much weight to give the innovation based on its reliability.\n\n\n\n\n\n\nKalman Gain\n\n\n\nThis \\(k_t\\) is called Kalman Gain and determines how much to trust the new measurement versus the prediction.\nIt is very much similar to the weight \\(w_t\\) we had earlier in Equation 1 and Equation 2. This change of notation is to highlight that it takes into account that the estimated state does not necessarily have the same scale as the innovation (difference in actual and predicted measurements).\nFor example, the estimated inflation is an annualized percentage, but our measurement could be the frequency of newspapers mentioning the word “inflation” or even the trading volume of Bitcoin.\n\n\n\n\nKalman gain\nThe Kalman gain \\(k_t\\) determines how much weight to give the measurement relative to the prediction. It is derived to minimize the variance of the updated state estimate \\(\\hat{x}_{t|t}\\), and it is computed as: \\[\nk_t = \\frac{P_{t|t-1} H_t}{H_t^2 P_{t|t-1} + R_t}.\n\\tag{10}\\]\n\n\\(P_{t|t-1}\\) is the variance of the predicted state as in Equation 6.\n\\(H_t\\) is the scaling factor that maps the state to the measurement space, which appears in Equation 4.\n\\(R_t\\) is the variance of innovation as in Equation 8.\n\nSo, the numerator \\(P_{t|t-1} H_t\\) maps the predicted state uncertainty into the measurement space. It reflects how much of the measurement uncertainty comes from the state prediction. The denominator \\(H_t^2 P_{t|t-1} + R_t\\) is the total uncertainty in the measurement, combining both predicted uncertainty and measurement noise.\nTherefore,\n\nIf the measurement noise \\(R_t\\) is small, the Kalman gain \\(k_t\\) is larger, so we trust the measurement more.\n\nIf the predicted uncertainty \\(P_{t|t-1}\\) is large, \\(k_t\\) is also larger, prioritizing the new measurement.\n\nConversely, if \\(R_t\\) is large (noisy measurement), \\(k_t\\) is small, favoring the prediction.\n\n\n\nVariance update\nFurther, new measurement not only helps us to update and refine our estimate of the state, it can also reduce the uncertainty of our estimation. Once Kalman gain \\(k_t\\) is computed, the variance of the updated state estimate is \\[\n\\text{Variance of updated estimate} = P_{t|t} = (1 - k_t H_t) P_{t|t-1}.\n\\tag{11}\\] This formula reflects the reduction in uncertainty after incorporating the new measurement.\n\n\n\n\n\n\nWhy \\(k_t\\) and \\(k_t H_t\\) show up in different places? A ChatGPT answer\n\n\n\nIn state update Equation 9, \\(k_t\\) is used for adjustment. In variance update Equation 11, \\(k_t H_t\\) is used. The difference arises because state updates and uncertainty updates deal with different quantities:\n\nState Update: The correction is applied directly to the predicted state. \\(k_t\\) alone is sufficient because it determines how much of the innovation (in measurement space) should influence the state estimate.\nVariance Update: The correction adjusts the uncertainty in the predicted state. \\(k_t H_t\\) is needed because uncertainty is transformed differently — it depends on both the Kalman gain and how strongly the state affects the measurement (via \\(H_t\\))."
  },
  {
    "objectID": "posts/kalman-filter/index.html#kalman-filter",
    "href": "posts/kalman-filter/index.html#kalman-filter",
    "title": "Kalman Filter",
    "section": "Kalman filter",
    "text": "Kalman filter\nNow I’m changing to matrix notations to allow for multiple states and measurements.\nTo begin with, a system’s internal dynamics and observed outputs can be treated separately in systems theory and Kalman filter.\n\nState space\nThe state space represents the system’s internal, unobserved dynamics — the variables we want to estimate but cannot directly measure. These are often called hidden states or latent states.4\n4 Suppose we are tracking the true inflation rate. This is the “state” of the system. It evolves over time due to economic forces, but we cannot observe it directly.The state equation describes how the state evolves over time, often including random noise to reflect uncertainty: \\[\nX_t = F_t X_{t-1} + \\omega_t\n\\]\n\n\\(X_t\\): the vector of true states at time \\(t\\).\n\\(F_t\\): the transition factor describing how the states evolve.\n\\(\\omega_t\\): process noise with a zero mean and covariance matrix \\(Q_t\\).\n\nThe state space contains all the information needed to describe the system’s internal behavior.\n\n\nMeasurement space\nThe measurement space is the observable part of the system — the variables we can measure directly, but which may be noisy or indirectly related to the state.5\n5 Suppose we measure inflation using a price index. This is the “measurement” and is influenced by the true inflation rate, but it also includes random noise.The measurement equation describes how observed measurements are related to unobservable states: \\[\nZ_t = H_t X_t + u_t\n\\]\n\n\\(Z_t\\): the observed measurement at time \\(t\\).\n\\(H_t\\): the relationship between the state and the measurement (e.g., scaling factor).\n\\(u_t\\): measurement noise with a mean of zero and covariance matrix \\(R_t\\).\n\nThe measurement space is what we observe directly but may not fully capture the true state due to noise or incomplete representation.\n\n\n\n\n\n\nKalman filter in a nutshell\n\n\n\nThe Kalman filter works by reconciling the state space (hidden, unobservable variables) with the measurement space (noisy observations) to improve our estimate of the state. It does so through two main steps:\n\nPrediction: Uses the state equation to estimate the next state and its uncertainty, based on prior information.\nUpdate: Refines this estimate by incorporating new observations from the measurement equation, weighing them based on their accuracy.\n\n\n\n\n\nPrediction step\nIn the prediction step, the Kalman filter estimates the state \\(X_t\\) at time \\(t\\) based on the previous state \\(X_{t-1}\\):\n\\[\n\\hat{X}_{t|t-1} = F_t \\hat{X}_{t-1|t-1}\n\\]\n\n\\(\\hat{X}_{t|t-1}\\): the predicted state based on the system’s dynamics, or a prior state estimate before incorporating new measurement.\n\nThe associated uncertainty (variance) in the prediction is updated as: \\[\nP_{t|t-1} = F_t P_{t-1|t-1} F_t^\\top + Q_t\n\\]\n\n\\(P_{t|t-1}\\): the predicted covariance matrix of the state.\n\n\n\nUpdate step\nThe update step adjusts the predicted state \\(\\hat{X}_{t|t-1}\\) using new observations \\(Z_t\\) to compute the updated state \\(\\hat{X}_{t|t}\\), or a posterior state estimate: \\[\n\\hat{X}_{t|t} = \\hat{X}_{t|t-1} + K_t \\big(Z_t - H_t \\hat{X}_{t|t-1} \\big)\n\\]\n\n\\(Z_t - H_t \\hat{X}_{t|t-1}\\): the innovation or measurement residual, representing the difference between the actual and predicted measurement.\n\\(K_t\\): the Kalman gain, which determines how much weight is given to the innovation.\n\nThe Kalman gain is computed as: \\[\nK_t = P_{t|t-1} H_t^\\top \\big(H_t P_{t|t-1} H_t^\\top + R_t \\big)^{-1}\n\\]\n\n\nUpdated covariance\nOnce the state is updated, the covariance of the state estimate \\(P_{t|t}\\) is also revised: \\[\nP_{t|t} = \\big(I - K_t H_t \\big) P_{t|t-1}\n\\]\nHere, \\(I - K_t H_t\\) scales the uncertainty reduction, where \\(K_t H_t\\): accounts for how much the measurement improves the state estimate.\nThis ensures that the updated covariance reflects the combined effect of the prediction and measurement steps.\n\n\n\n\n\n\nRecursive nature of the Kalman filter\n\n\n\nThe Kalman filter is recursive, meaning it processes data one step at a time, making it computationally efficient. Each new measurement refines the state estimate and covariance, which are then used for the next prediction."
  },
  {
    "objectID": "posts/kalman-filter/index.html#estimation-of-the-kalman-filter",
    "href": "posts/kalman-filter/index.html#estimation-of-the-kalman-filter",
    "title": "Kalman Filter",
    "section": "Estimation of the Kalman filter",
    "text": "Estimation of the Kalman filter\n\nGeneral steps\nAfter we have parameterized the system, using the Kalman filter to estimate states means that we are to estimate:\n\n\\(F_t\\): State transition matrix\n\\(H_t\\): Measurement matrix\n\\(Q_t\\): Covariance of process noise\n\\(R_t\\): Covariance of measurement noise\n\nAdditionally, we need to set an initial state estimate:\n\nInitial state estimate \\(\\hat{X}_{0|0}\\): the starting point of the state variable chosen based on prior knowledge or historical averages.\nInitial covariance matrix \\(P_{0|0}\\).\n\nIn some cases, \\(F_t, H_t, Q_t, R_t\\) can be directly specified based on domain knowledge or theoretical models. More often, we use Maximum Likelihood Estimation (MLE) to estimate noise covariances \\(Q_t\\) and \\(R_t\\), which involves:\n\nForward filtering:\n\nApply the Kalman filter to compute the likelihood of observed data at each time step.\nThe likelihood depends on the measurement residual \\(z_t - H_t \\hat{X}_{t|t-1}\\) and its variance \\(S_t = H_t P_{t|t-1} H_t^\\top + R_t\\).\n\nThe log-likelihood is given by: \\[\n\\log L = -\\frac{1}{2} \\sum_{t=1}^T \\Big[N \\log (2\\pi) + \\log |S_t| + (z_t - H_t \\hat{X}_{t|t-1})^\\top S_t^{-1} (z_t - H_t \\hat{X}_{t|t-1}) \\Big]\n\\] where \\(N\\) is the dimension of observation.6\n\n6 For example, a system’s unobservable true states may be 10-dimensional or it has 10 state variables at any given time. Our measurement or observation may be 5-dimensional, i.e., we observe 5 different metrics of the system. In this case, \\(N=5\\).\nParameter optimization:\n\nAdjust \\(Q_t\\) and \\(R_t\\) to maximize \\(\\log L\\).\nNumerical optimization methods like gradient ascent or expectation-maximization (EM) are commonly used.\n\n\n\n\nExample and code\nSuppose we model a 1-D true state \\(X_t\\) using a random walk: \\[\nX_t = X_{t-1} + \\omega_t, \\quad \\omega_t \\sim \\mathcal{N}(0, Q)\n\\]\nAnd the 1-D observation \\(Z_t\\) as: \\[\nZ_t = X_t + u_t, \\quad u_t \\sim \\mathcal{N}(0, R)\n\\]\nSteps to estimate \\(Q\\) and \\(R\\):\n\nStart with initial guesses for \\(Q\\) and \\(R\\).\nRun the Kalman filter to compute the likelihood of observed \\(Z_t\\) values.\nAdjust \\(Q\\) and \\(R\\) to maximize the likelihood.\n\n\nPython\nHere’s a handwritten simple example for MLE in Python:\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom numpy.linalg import det, inv\nfrom scipy.optimize import minimize\n\nrng = np.random.default_rng(1024)\n\n# Simulate data\ndim_x = 1 # Number of unobservable true states\ndim_z = 1 # Dimension of observations\nn_steps = 100  # Number of time steps\nF = np.array([[1.0]])  # State transition\nH = np.array([[1.0]])  # Observation model\nQ = np.array([[0.5]])  # Process noise covariance\nR = np.array([[1.0]])  # Measurement noise covariance\n\n# Generate true states and noisy observations\nX = np.zeros((dim_x, n_steps))\nZ = np.zeros((dim_z, n_steps))\nfor t in range(1, n_steps):\n    X[:,t] = F @ X[:,t-1] + rng.multivariate_normal(np.zeros(dim_x), Q)\n    Z[:,t] = H @ X[:,t] + rng.multivariate_normal(np.zeros(dim_z), R)\n\n# Define the Kalman filter functions\ndef kalman_predict(x, P, F, Q):\n    x_pred = F @ x\n    P_pred = F @ P @ F.T + Q\n    return x_pred, P_pred\n\ndef kalman_update(x_pred, P_pred, z, H, R):\n    S = H @ P_pred @ H.T + R\n    K = P_pred @ H.T @ inv(S)\n    x_upd = x_pred + K @ (z - H @ x_pred)\n    P_upd = (np.eye(len(P_pred)) - K @ H) @ P_pred\n    return x_upd, P_upd, S\n\ndef run_kalman_filter(Q, R, F, H, x0, P0, Z):\n    Q = np.array([[Q]])  # Process noise covariance\n    R = np.array([[R]])  # Measurement noise covariance\n    x, P = x0, P0\n\n    log_likelihood = 0\n    log_2pi = np.log(2 * np.pi)\n    for z in Z[0,:]:\n        x_pred, P_pred = kalman_predict(x, P, F, Q)\n        x, P, S = kalman_update(x_pred, P_pred, z, H, R)\n        innovation = z - H @ x_pred\n        l = -0.5 * (dim_z * log_2pi + np.log(det(S)) + innovation.T @ inv(S) @ innovation)\n        log_likelihood += l\n    return -log_likelihood  # Negative log-likelihood to minimize\n\n# Define objective function for parameter estimation\ndef objective(params, F, H, x, P, Z):\n    Q, R = params\n    return run_kalman_filter(Q, R, F, H, x, P, Z)\n\n# Initial guess for the parameters: [Q, R]\ninitial_params = [0.1, 0.1]\nx0 = np.array([[0]])  # Initial state estimate\nP0 = np.array([[1]])  # Initial covariance\n\n# Minimize the log-likelihood with bounds to ensure Q and R are positive\nresult = minimize(\n    objective,\n    initial_params,\n    args=(F, H, x0, P0, Z,),\n    method='L-BFGS-B',\n    bounds=[(1e-5, None), (1e-5, None)]\n)\n\nestimated_Q, estimated_R = result.x\n\n# Run the Kalman filter with the estimated parameters\nestimated_Q = np.array([[estimated_Q]])\nestimated_R = np.array([[estimated_R]])\nx_est = np.zeros((dim_x, n_steps))\nP_est = np.zeros((dim_x, dim_x, n_steps))\nx, P = x0, P0\nfor t in range(n_steps):\n    x_pred, P_pred = kalman_predict(x, P, F, estimated_Q)\n    x, P, _ = kalman_update(x_pred, P_pred, Z[:,t], H, estimated_R)\n    x_est[:,t] = x\n    P_est[:,:,t] = P\n\n# Plot the true states and estimates\nplt.figure(figsize=(9, 6))\nplt.plot(Z[0], 'o', label='Observations', color='b', alpha=0.3)\nplt.plot(X[0], label='True State', color='b', linestyle='dashed')\nplt.plot(x_est[0], label='Estimated State', color='r')\nplt.xlabel('Time step')\nplt.ylabel('Value')\nplt.legend()\nplt.title('Kalman Filter: True State, Observations, and Estimated State')\nplt.annotate(f'True Q: {Q[0,0]:.2f}', xy=(0.05, 0.95), xycoords='axes fraction', fontsize=12, verticalalignment='top')\nplt.annotate(f'True R: {R[0,0]:.2f}', xy=(0.05, 0.90), xycoords='axes fraction', fontsize=12, verticalalignment='top')\nplt.annotate(f'Estimated Q: {estimated_Q[0,0]:.2f}', xy=(0.05, 0.85), xycoords='axes fraction', fontsize=12, verticalalignment='top')\nplt.annotate(f'Estimated R: {estimated_R[0,0]:.2f}', xy=(0.05, 0.80), xycoords='axes fraction', fontsize=12, verticalalignment='top')\nplt.show()\n\n\n\n\n\n\n\n\n\n\nMatlab\nI also tested 3 ways of estimating the parameters of Kalman filter in Matlab.\n\nHandwritten.\nss model with handwritten log-likelihood.\nssm model without handwritten log-likelihood.\n\nResults of estimates are basically the same. So I guess I can comfortably use my handwritten ones since they are easier to understand and extend if for example noises are correlated."
  },
  {
    "objectID": "posts/identify-retail-investors/index.html",
    "href": "posts/identify-retail-investors/index.html",
    "title": "Identify Retail Investors",
    "section": "",
    "text": "Retail investors and their trading behaviour attract many research interests. One strand of literature uses proprietary datasets to identify retail investors. The other uses algorithms. A recent JF paper Boehmer et al. (2021) proposes a simple one based only on the trade price, which also signs the trade direction effectively. Even more interestingly, I just read a follow-up work forthcoming on JF by Barber et al. (forthcoming) (SSRN). The authors placed 85,000 retail trades themselves to validate the Boehmer et al. (2021) algorithm."
  },
  {
    "objectID": "posts/identify-retail-investors/index.html#boehmer_tracking_2021-algorithm",
    "href": "posts/identify-retail-investors/index.html#boehmer_tracking_2021-algorithm",
    "title": "Identify Retail Investors",
    "section": "Boehmer et al. (2021) algorithm",
    "text": "Boehmer et al. (2021) algorithm\nA quick summary of the background info and the algorithm:\n\nIn the U.S., retail investors’ marketable orders are typically not executed on exchanges but filled from a broker’s own inventory.\nThese orders are publicly reported to a Financial Industry Regulatory Authority (FINRA) TRF, which is included in the TAQ consolidated tape with an exchange code D.\nThese orders often receive minor price improvements (like 0.01, 0.1, or 0.2 cent) relative to the national best bid or offer (NBBO).\nSEC Rule 606 requires brokers to provide summary statistics on their order-routing practices for orders not directed to exchanges, which are mostly retail and often receive price improvement.\nInstitutional orders, in contrast, are typically executed on exchanges or dark pools and priced in round pennies, except for midpoint trades.\n\nTherefore, the algorithm to identify retail transactions is simply:\n\nRetail seller transactions are reported on a TRF at prices slightly above a round penny.\nRetail buyer transactions are at prices slightly below a round penny.\nTransactions at round pennies or near half-pennies are not classified as retail.\n\nFor example, for a trade with exchange code D on TAQ,\n\nif trade price is 10.21 (round penny), it is non-retail.\nif trade price is 10.211 (slightly above a round penny), it is a retail sell.\nif trade price is 10.209 (slightly below a round penny), it is a retail buy.\nif trade price is 10.214, 10.215, or 10.216 (near half-penny), it is non-retail."
  },
  {
    "objectID": "posts/identify-retail-investors/index.html#barber-et-al.-2023-experiment",
    "href": "posts/identify-retail-investors/index.html#barber-et-al.-2023-experiment",
    "title": "Identify Retail Investors",
    "section": "Barber et al. (2023) experiment",
    "text": "Barber et al. (2023) experiment\nI find this very interesting. The authors actually conduct an experiment by actually placing 85,000 retail trades themselves to validate the Boehmer et al. (2021) algorithm. They find that the algorithm identifies 35% of their trades as retail, incorrectly signs 28% of identified trades.\nThere is no need to summarize the paper here. SSRN link is here."
  },
  {
    "objectID": "posts/get-bank-holding-company-financials/index.html",
    "href": "posts/get-bank-holding-company-financials/index.html",
    "title": "Bank Holing Company Financials from FR Y-9C",
    "section": "",
    "text": "A SAS macro used to extract BHC data."
  },
  {
    "objectID": "posts/get-bank-holding-company-financials/index.html#extract-bhc-balance-sheet-data",
    "href": "posts/get-bank-holding-company-financials/index.html#extract-bhc-balance-sheet-data",
    "title": "Bank Holing Company Financials from FR Y-9C",
    "section": "Extract BHC balance sheet data",
    "text": "Extract BHC balance sheet data\nThis is the SAS macro I write to consolidate and extract BHC’s balance sheet data from WRDS Bank Regulatory database. It creates a bhcf dataset in the work directory.\n%macro bhc_financials(loopdatestart,loopdateend);\n    /* Specify the variables to extract */\n    %let vars=rssd9999 rssd9001 rssd9007 rssd9008 bhck2170 bhck3210;\n    %let loopdatestart=%sysfunc(inputn(&loopdatestart,anydtdte9.));\n    %let loopdateend=%sysfunc(inputn(&loopdateend,anydtdte9.));\n    %let dif=%sysfunc(intck(month,&loopdatestart,&loopdateend));\n    %let dats=;\n    %do i=0 %to &dif;\n        %let date=%sysfunc(intnx(month,&loopdatestart,&i,e));\n        %let month=%sysfunc(month(&date),z2.);\n        %let year=%sysfunc(year(&date));\n        %if &month=3 or &month=6 or &month=9 or &month=12 %then %do;\n        %let dats=&dats bank.bhcf&year&month;\n        %end;\n    %end;\n    %put &dats;\n    data bhcf(keep=&vars); set &dats; \n        rssd9999 = input(put(rssd9999, 8.), yymmdd10.);/* reporting date */\n        rssd9007 = input(put(rssd9007, 8.), yymmdd10.);/* date start */\n        rssd9008 = input(put(rssd9008, 8.), yymmdd10.);/* date end */\n        format rssd9999 date9.;\n        format rssd9007 date9.;\n        format rssd9008 date9.;\n        where rssd9999 between rssd9007 and rssd9008;\n    run;\n%mend bhc_financials;\n\n%bhc_financials(01jan1990,01dec2000);\n\n\n\n\n\n\nNote\n\n\n\nRSSD dates are not always available, in which case lines 18-24 should be removed."
  },
  {
    "objectID": "posts/get-bank-holding-company-financials/index.html#merge-with-compustatcrsp",
    "href": "posts/get-bank-holding-company-financials/index.html#merge-with-compustatcrsp",
    "title": "Bank Holing Company Financials from FR Y-9C",
    "section": "Merge with Compustat/CRSP",
    "text": "Merge with Compustat/CRSP\nThe firm identifier in the Y-9C data is RSSD9001. To merge the BHC’s balance sheet data with Compustat/CRSP, I use the PERMCO-RSSD link table by the Federal Reserve Bank of New York.1 I saved the most recent copy in my server, and formatted it so that it can used directly. It is available at https://mingze-gao.com/data/download/crsp_20181231.csv.\n1 Link table%let beg_yr = 1986;\n%let end_yr = 2018;\n\nproc sql;\ncreate table lnk as\nselect *\nfrom crsp.ccmxpf_lnkhist\nwhere\n    linktype in (\"LU\", \"LC\") and\n    (&end_yr+1 &gt;= year(linkdt) or linkdt = .B) and \n    (&beg_yr-1 &lt;= year(linkenddt) or linkenddt = .E)\norder by \n    gvkey, linkdt;\nquit;\n\n\n/* PERMCO-RSSD link table by New York FED */\nfilename csv url \"https://mingze-gao.com/data/download/crsp_20181231.csv\";\nproc import datafile=csv out=work.crsp_20181231 dbms=csv replace; run;\nproc sql;\ncreate table gvkey_permno_permco_rssd as \n    select *\nfrom lnk join crsp_20181231 as fed\non lnk.lpermco=fed.permco;\nquit;\n\n\n\n\n\n\nNote\n\n\n\nPlease run these programs on the WRDS cloud. You’ll need to modify them in order to run locally with SAS/Connect."
  },
  {
    "objectID": "posts/garch-estimation/index.html",
    "href": "posts/garch-estimation/index.html",
    "title": "GARCH Estimation",
    "section": "",
    "text": "This post details GARCH(1,1) model and its estimation manually in Python, compared to using libraries and in Stata. For GJR-GARCH(1,1), see my documentation on frds.io."
  },
  {
    "objectID": "posts/garch-estimation/index.html#garch11-model",
    "href": "posts/garch-estimation/index.html#garch11-model",
    "title": "GARCH Estimation",
    "section": "GARCH(1,1) Model",
    "text": "GARCH(1,1) Model\nThe GARCH(1,1) (Generalized Autoregressive Conditional Heteroskedasticity) model is a commonly used model for capturing the time-varying volatility in financial time series data. The model can be defined as follows:\n\nReturn equation\nThere are many ways to specify return dynamics. Let’s focus on the simplest one assuming a constant mean.\n\\[\nr_t = \\mu + \\epsilon_t\n\\]\nHere \\(r_t\\) represents the return at time \\(t\\), and \\(\\mu\\) is the mean return.\n\n\nShock equation\n\\[\n\\epsilon_t = \\sigma_t \\cdot z_t\n\\]\nIn this equation, \\(\\epsilon_t\\) is the shock term, \\(\\sigma_t\\) is the conditional volatility, and \\(z_t\\) is a white noise error term with zero mean and unit variance (\\(z_t \\sim N(0,1)\\)).\n\n\n\n\n\n\nNote\n\n\n\nWe can also assume that the noise term follows a different distribution, such as Student-t, and modify the likelihood function below accordingly.\n\n\n\n\nVolatility equation\n\\[\n\\sigma_t^2 = \\omega + \\alpha \\cdot \\epsilon_{t-1}^2 + \\beta \\cdot \\sigma_{t-1}^2\n\\]\nHere \\(\\sigma_t^2\\) is the conditional variance at time \\(t\\), and \\(\\omega\\), \\(\\alpha\\), \\(\\beta\\) are parameters to be estimated. This equation captures how volatility evolves over time.\n\n\n\n\n\n\nThe unconditional variance and persistence\n\n\n\nThe unconditional variance, often denoted as \\(\\text{Var}(\\epsilon_t)\\) or \\(\\sigma^2\\), refers to the long-run average or steady-state variance of the return series. It is the variance one would expect the series to revert to over the long term, and it doesn’t condition on any past information.\nFor a GARCH(1,1) model to be stationary, the persistence, sum of \\(\\alpha\\) and \\(\\beta\\), must be less than 1 (\\(\\alpha + \\beta &lt; 1\\)). Given this condition, the unconditional variance \\(\\sigma^2\\) can be computed as follows:\n\\[\n\\sigma^2 = \\frac{\\omega}{1 - \\alpha - \\beta}\n\\]\nIn this formulation, \\(\\omega\\) is the constant or “base” level of volatility, while \\(\\alpha\\) and \\(\\beta\\) determine how shocks to returns and past volatility influence future volatility. The unconditional variance provides a long-run average level around which the conditional variance oscillates.\n\n\n\n\nLog-likelihood function\nThe likelihood function for a GARCH(1,1) model is used for the estimation of parameters \\(\\mu\\), \\(\\omega\\), \\(\\alpha\\), and \\(\\beta\\). Given a time series of returns \\(\\{ r_1, r_2, \\ldots, r_T \\}\\), the likelihood function \\(L(\\mu, \\omega, \\alpha, \\beta)\\) can be written as:\n\\[\nL(\\mu, \\omega, \\alpha, \\beta) = \\prod_{t=1}^{T} \\frac{1}{\\sqrt{2\\pi \\sigma_t^2}} \\exp\\left(-\\frac{(r_t-\\mu)^2}{2\\sigma_t^2}\\right)\n\\]\nTaking the natural logarithm of \\(L\\), we obtain the log-likelihood function \\(\\ell(\\mu, \\omega, \\alpha, \\beta)\\):\n\\[\n\\ell(\\mu, \\omega, \\alpha, \\beta) = -\\frac{1}{2} \\sum_{t=1}^{T} \\left( \\log(2\\pi)  + \\log(\\sigma_t^2) + \\frac{(r_t-\\mu)^2}{\\sigma_t^2} \\right)\n\\]\nThe parameters \\(\\mu, \\omega, \\alpha, \\beta\\) can then be estimated by maximizing this log-likelihood function."
  },
  {
    "objectID": "posts/garch-estimation/index.html#estimation",
    "href": "posts/garch-estimation/index.html#estimation",
    "title": "GARCH Estimation",
    "section": "Estimation",
    "text": "Estimation\nNow let’s use an example to showcase the estimation of GARCH(1,1).\nimport pandas as pd\n\ndf = pd.read_stata(\"https://www.stata-press.com/data/r18/stocks.dta\", convert_dates=['date'])\ndf.set_index(\"date\", inplace=True)\nThe dataframe df is like below, with daily returns for stocks “toyota”, “nissan” and “honda”. Notice that there are gaps in the date, but variable t is without gaps.\n&gt;&gt;&gt; df.head()\n            t    toyota    nissan     honda\ndate\n2003-01-02  1  0.015167  0.029470  0.031610\n2003-01-03  2  0.004820  0.008173  0.002679\n2003-01-06  3  0.019959  0.013064 -0.001606\n2003-01-07  4 -0.013323 -0.007444 -0.011318\n2003-01-08  5 -0.027001 -0.018857 -0.016945\nWe focus on the returns of “toyota”, and scale returns to percentage returns for better optimization results.\nreturns = df[\"toyota\"].to_numpy() * 100\n\nEstimation using arch library\nIt’s remarkably easy to estimate GARCH(1,1) with the arch library.\nfrom arch import arch_model\n\nmodel = arch_model(returns, mean='Constant', vol='GARCH', p=1, q=1)\nmodel.fit()\nWe have the following outputs.\nIteration:      1,   Func. Count:      6,   Neg. LLF: 353027828870.51434\nIteration:      2,   Func. Count:     14,   Neg. LLF: 5686315977.791412\nIteration:      3,   Func. Count:     23,   Neg. LLF: 288989718.5625958\nIteration:      4,   Func. Count:     29,   Neg. LLF: 3757.5687528616645\nIteration:      5,   Func. Count:     35,   Neg. LLF: 6165.184701734164\nIteration:      6,   Func. Count:     41,   Neg. LLF: 3751.933155975204\nIteration:      7,   Func. Count:     47,   Neg. LLF: 3748.8551639756433\nIteration:      8,   Func. Count:     52,   Neg. LLF: 3748.8245639433794\nIteration:      9,   Func. Count:     57,   Neg. LLF: 3748.8226971150325\nIteration:     10,   Func. Count:     62,   Neg. LLF: 3748.8215357459\nIteration:     11,   Func. Count:     67,   Neg. LLF: 3748.8215327016333\nIteration:     12,   Func. Count:     71,   Neg. LLF: 3748.8215327001894\nOptimization terminated successfully    (Exit mode 0)\n            Current function value: 3748.8215327016333\n            Iterations: 12\n            Function evaluations: 71\n            Gradient evaluations: 12\n                     Constant Mean - GARCH Model Results                      \n==============================================================================\nDep. Variable:                      y   R-squared:                       0.000\nMean Model:             Constant Mean   Adj. R-squared:                  0.000\nVol Model:                      GARCH   Log-Likelihood:               -3748.82\nDistribution:                  Normal   AIC:                           7505.64\nMethod:            Maximum Likelihood   BIC:                           7528.08\n                                        No. Observations:                 2015\nDate:                Tue, Sep 26 2023   Df Residuals:                     2014\nTime:                        21:36:03   Df Model:                            1\n                                  Mean Model                                 \n=============================================================================\n                 coef    std err          t      P&gt;|t|       95.0% Conf. Int.\n-----------------------------------------------------------------------------\nmu             0.0396  3.054e-02      1.297      0.195 [-2.025e-02,9.945e-02]\n                              Volatility Model                              \n============================================================================\n                 coef    std err          t      P&gt;|t|      95.0% Conf. Int.\n----------------------------------------------------------------------------\nomega          0.0279  1.374e-02      2.030  4.237e-02 [9.609e-04,5.484e-02]\nalpha[1]       0.0694  1.422e-02      4.884  1.039e-06 [4.157e-02,9.730e-02]\nbeta[1]        0.9217  1.601e-02     57.558      0.000     [  0.890,  0.953]\n============================================================================\n\nCovariance estimator: robust\nARCHModelResult, id: 0x1cb7b8f4460\n\n\n\n\n\n\nGARCH(1,1) in Stata\n\n\n\nTo estimate GARCH(1,1) in Stata, use the following code:\nuse https://www.stata-press.com/data/r18/stocks, clear\nreplace toyota = toyota * 100\narch toyota, arch(1) garch(1) vce(robust)\nOutputs are:\n(setting optimization to BHHH)\nIteration 0:   log pseudolikelihood = -4075.9402  \nIteration 1:   log pseudolikelihood = -3953.7987  \nIteration 2:   log pseudolikelihood = -3911.4597  \nIteration 3:   log pseudolikelihood = -3883.4575  \nIteration 4:   log pseudolikelihood = -3857.2121  \n(switching optimization to BFGS)\nIteration 5:   log pseudolikelihood =  -3837.462  \nIteration 6:   log pseudolikelihood = -3765.4267  \nIteration 7:   log pseudolikelihood = -3761.9975  \nIteration 8:   log pseudolikelihood = -3753.8487  \nIteration 9:   log pseudolikelihood = -3752.0844  \nIteration 10:  log pseudolikelihood =  -3751.921  \nIteration 11:  log pseudolikelihood = -3751.3856  \nIteration 12:  log pseudolikelihood =  -3749.877  \nIteration 13:  log pseudolikelihood = -3749.3108  \nIteration 14:  log pseudolikelihood = -3749.2614  \n(switching optimization to BHHH)\nIteration 15:  log pseudolikelihood =  -3749.249  \nIteration 16:  log pseudolikelihood = -3749.2487  \nIteration 17:  log pseudolikelihood = -3749.2487  \n\nARCH family regression\n\nSample: 1 thru 2015                             Number of obs     =       2015\n                                                Wald chi2(.)      =          .\nLog pseudolikelihood = -3749.249                Prob &gt; chi2       =          .\n\n------------------------------------------------------------------------------\n            |             Semirobust\n    toyota  | Coefficient  std. err.      z    P&gt;|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\ntoyota      |\n    _cons   |   .0403521   .0305032     1.32   0.186     -.019433    .1001373\n-------------+----------------------------------------------------------------\nARCH        |\n    arch    |\n        L1. |   .0703684   .0142609     4.93   0.000     .0424176    .0983192\n            |\n    garch   |\n        L1. |   .9204512   .0161376    57.04   0.000     .8888221    .9520802\n            |\n    _cons   |   .0284799   .0139792     2.04   0.042     .0010812    .0558786\n------------------------------------------------------------------------------\nThere are some differences in the estimates, potentially because of the optimization algorithms and/or initial parameters. Based on the log-likelihood, it seems arch results are marginally better.\n\n\n\n\nManual estimation\nLet’s try do this manually to see how we can use maximum likelihood estimation (MLE) to estimate the parameters.\n\n\n\n\n\n\nNote\n\n\n\nThis code below is not optimized. See the discussion later and source code of frds.algorithms.GARCHModel for a better version.\n\n\nfrom scipy.optimize import minimize\nimport numpy as np\n\n# Log-Likelihood function for GARCH(1, 1)\ndef garch_log_likelihood(params, returns):\n    mu, omega, alpha, beta = params\n    T = len(returns)\n    sigma2 = np.empty(T)\n    if alpha + beta &lt; 1:\n        sigma2[0] = omega / (1 - alpha - beta)\n    else:\n        sigma2[0] = omega / 0.001\n        \n    for t in range(1, T):\n        sigma2[t] = omega + alpha * (returns[t-1]-mu)**2 + beta * sigma2[t-1]\n        sigma2[t] = sigma2[t] if sigma2[t] &gt; 0 else 0.001\n        \n    log_likelihood = 0.5 * np.sum(np.log(2*np.pi*sigma2) + ((returns-mu)**2 / sigma2))\n    return log_likelihood\n\n# Persistence of GARCH(1,1) = alpha + beta has to be smaller than 1\ndef constraint_persistence(params):\n    _, _, alpha, beta = params\n    return 1.0 - (alpha + beta)\n\n# Initial parameter guess [mu, omega, alpha, beta]\ninitial_params = [returns.mean(), 0.05, 0.1, 0.88]\n\n# Run the optimizer to maximize the log-likelihood (minimize its negative)\nopt_results = minimize(garch_log_likelihood, initial_params, method=\"SLSQP\",\n                        args=(returns), \n                        bounds=[\n                            # No bounds for mu\n                            (-np.inf, np.inf),\n                            # Lower bound for omega \n                            # because sigma[0] may be equal to omega \n                            # if alpha+beta both are zero \n                            (0.001, np.inf), \n                            # Bounds for alpha and beta\n                            (0.0, 1.0), \n                            (0.0, 1.0)],\n                        constraints={'type': 'ineq', 'fun': constraint_persistence})\n\n# Extract the estimated parameters\nmu_hat, w_hat, alpha_hat, beta_hat = opt_results.x\n\nprint(f'Estimated parameters: \\n \\\n      mu={mu_hat}\\n \\\n      omega={w_hat}\\n \\\n      alpha={alpha_hat}\\n \\\n      beta={beta_hat}')\nprint(f\"Persistence: alpha+beta={alpha_hat+beta_hat}\")\nprint(f\"Log-likelihood: {-garch_log_likelihood(opt_results.x, returns)}\")\nThe outputs are\nEstimated parameters: \n       mu=0.040173898536452125\n       omega=0.02888320573536973\n       alpha=0.06838623740784693\n       beta=0.9214019468044863\nPersistence: alpha+beta=0.9897881842123332\nLog-likelihood: -3749.0392910447126\n\n\n\n\n\n\nCaution\n\n\n\nThe code above serves only demonstration purpose.\nIt appears that we have quite similar coefficient estimates from the above manual work to the arch results. However, we need to be super careful here because the choice of initial parameters has significant impact on the output.\nFurther, based on the log-likelihood, the manual estimation results are not as good as in arch: the log-likelihood is somewhere between the Iteration 6 and 7 out of 12 in the arch estimation.\nI checked a bit the source code of arch. The authors did a lot of work in selecting the optimal initial parameters and setting bounds on the conditional volalatilies. But here in the manual work, I relied on only rough guess in selecting initial values and did not attempt to compute bounds.\n\n\n\n\n\n\n\n\nNote\n\n\n\nI leave out the estimation of standard errors in this post.\n\n\n\n\nImprovements\nIn this part, I explore how to improve the estimation and enhance its numerical stability. Insights are drawn from the arch source code.\n\nInitial value of conditional variance\nNote that the conditional variance in a GARCH(1,1) model is:\n\\[\n\\sigma_t^2 = \\omega + \\alpha \\cdot \\epsilon_{t-1}^2 + \\beta \\cdot \\sigma_{t-1}^2\n\\]\nWe need a good starting value \\(\\sigma_0^2\\) to begin with, which can be estimated via the backcasting technique. Once we have that \\(\\sigma^2_0\\) through backcasting, we can proceed to calculate the entire series of conditional variances using the standard GARCH recursion formula.\nTo backcast the initial variance, we can use the Exponential Weighted Moving Average (EWMA) method, setting \\(\\sigma^2_0\\) to the EWMA of the sample variance of the first \\(n \\leq T\\) returns:\n\\[\n\\sigma^2_0 = \\sum_{t=1}^{n} w_t \\cdot r_t^2\n\\]\nwhere \\(w_t\\) are the exponentially decaying weights and \\(r_t\\) are residuals of returns, i.e., returns de-meaned by sample average. This \\(\\sigma^2_0\\) is then used to derive \\(\\sigma^2_1\\) the starting value for the conditional variance series.\n\n\nInitial value of \\(\\omega\\)\nThe starting value of \\(\\omega\\) is relatively straightforward. Notice that earlier we have jotted down the unconditional variance \\(\\sigma^2 = \\frac{\\omega}{1-\\alpha-\\beta}\\). Therefore, given a level of persistence (\\(\\alpha+\\beta\\)), we can set the initial guess of \\(\\omega\\) to be the sample variance times one minus persistence:\n\\[\n\\omega = \\hat{\\sigma}^2 \\cdot (1-\\alpha-\\beta)\n\\]\nwhere we use the known sample variance of residuals \\(\\hat{\\sigma}^2\\) as a guess for the unconditional variance \\(\\sigma^2\\). However, we still need to find good starting values for \\(\\alpha\\) and \\(\\beta\\).\n\n\nInitial value of \\(\\alpha\\) and \\(\\beta\\)\nUnfortunately, there is no better way to find good starting values for \\(\\alpha\\) and \\(\\beta\\) than a grid search. Luckily, this grid search can be relatively small.\nFirst, we don’t know ex ante the persistence level, so we need to vary the persistence level from some low values to some high values, e.g., from 0.1 to 0.98. Second, generally the \\(\\alpha\\) parameter is not too big, for example, ranging from 0.01 to 0.2.\nWe can permute combinations of the persistence level and \\(\\alpha\\), which naturally gives the corresponding \\(\\beta\\) and hence \\(\\omega\\). The “optimal” set of initial values of \\(\\omega, \\alpha, \\beta\\) is the one that gives the highest log-likelihood.1\n1 The initial value of \\(\\mu\\) is reasonably set to the sample mean return.\n\nVariance bounds\nAnother issue is that we want to ensure that in the estimation, condition variance does not blow up to infinity or becomes zero. Hence, we need to construct bounds for conditional variances during the GARCH(1,1) parameter estimation process.\nTo do this, we can calculate loose lower and upper bounds for each observation. Specifically, we can use sample variance of the residuals to compute global lower and upper bounds. We then use EWMA to compute the conditional variance for each time point. The EWMA variances are then adjusted to ensure they are within global bounds. Lastly, we scale the adjusted EWMA variances to form the variance bounds at each time.\nDuring the estimation process, whenever we compute the conditional variances based on the prevailing model parameters, we ensure that they are adjusted to be reasonably within the bounds at each time.\n\n\n\n\n\n\nNote\n\n\n\nSee frds.algorithms.GARCHModel for the full implementation of the above improvements."
  },
  {
    "objectID": "posts/fred/index.html",
    "href": "posts/fred/index.html",
    "title": "FRED - Federal Reserve Economic Data",
    "section": "",
    "text": "Since Stata 15, we can search, browse and import almost a million U.S. and international economic and financial time series made available by the St. Louis Federal Reserve’s Federal Research Economic Data. This post briefly explains this great feature.",
    "crumbs": [
      "Stata Workshop",
      "FRED - Federal Reserve Economic Data"
    ]
  },
  {
    "objectID": "posts/fred/index.html#prerequisite",
    "href": "posts/fred/index.html#prerequisite",
    "title": "FRED - Federal Reserve Economic Data",
    "section": "Prerequisite",
    "text": "Prerequisite\nBefore you start, you will need an API Key from FRED. Register one here\nThen in Stata, you can store this key permanently so you don’t need to provide again.1\n1 Replace _key_ with your actual API Key obtained.set fredkey _key_, permanently",
    "crumbs": [
      "Stata Workshop",
      "FRED - Federal Reserve Economic Data"
    ]
  },
  {
    "objectID": "posts/fred/index.html#gui-is-always-a-good-start",
    "href": "posts/fred/index.html#gui-is-always-a-good-start",
    "title": "FRED - Federal Reserve Economic Data",
    "section": "GUI is always a good start",
    "text": "GUI is always a good start\nAlternatively, click on menu File&gt;Import&gt;Fedearl Reserve Economic Data (FRED) will bring up the dialog as shown below.\n\n\n\n\n\n\nFigure 1: Set FRED key\n\n\n\nEnter API Key and you’ll be free to explore all the data series available on FRED.\n\n\n\n\n\n\nFigure 2: Import data from FRED database\n\n\n\nFor example, let’s see the CPI of Australia…\n\n\n\n\n\n\nFigure 3: Import Australia’s CPI data\n\n\n\nDescribe the data series, we can find many useful meta info.\n\n\n\n\n\n\nFigure 4: The window showing the description of Australia’s CPI data\n\n\n\n\n\n\n\n\n\nVintage\n\n\n\nNote that “vintage” section lists a number of dates, with each vintage referring a particular version of the data series at that point of time.\n\n\nIt may sound strange but an economic data series may be revised multiple times after it has been published. Potential reasons may be that later people collect more accurate information, or that there is a change of estimation method, etc.2\n2 For example, the CPI from 2005 to 2010 collected by a research as at 2011 may be different from the one collected as at 2023. Without specifying the data vintage, replicating a prior work can be hard.3 For example, a trading strategy using the revised GDP accessed today, instead of the vintage GDP, implicitly uses hindsight as the GDP series may have been revised to accommodate more accurate data obtained after release.Another tricky part is that ignoring vintages introduces look-ahead bias in analysis.3\nLet’s close the description, double click on the series and click on import. Another dialog will be shown to confirm some final details.\n\n\n\n\n\n\nFigure 5: Import data\n\n\n\nThe outputs will be like the following:\n. import fred AUSCPIALLQINMEI, daterange(2010-01-01 2023-08-08) aggregate(quarterly,avg)\n\nSummary\n--------------------------------------------------------------------------\nSeries ID                    Nobs    Date range                Frequency\n--------------------------------------------------------------------------\nAUSCPIALLQINMEI              53      2010-01-01 to 2023-01-01  Quarterly\n--------------------------------------------------------------------------\n# of series imported: 1\n   highest frequency: Quarterly\n    lowest frequency: Quarterly",
    "crumbs": [
      "Stata Workshop",
      "FRED - Federal Reserve Economic Data"
    ]
  },
  {
    "objectID": "posts/fred/index.html#programmatical-is-recipe-to-reproducibility",
    "href": "posts/fred/index.html#programmatical-is-recipe-to-reproducibility",
    "title": "FRED - Federal Reserve Economic Data",
    "section": "Programmatical is recipe to reproducibility",
    "text": "Programmatical is recipe to reproducibility\nWe don’t need to go through the GUI process every time. In fact, Stata already told us what the corresponding command is:\nimport fred AUSCPIALLQINMEI, daterange(2010-01-01 2023-08-08) aggregate(quarterly,avg)\nWe can simply put this line of code into our program.\nFor example, the code below generates a time-series chart for Australia’s CPI.\n// Import\nimport fred AUSCPIALLQINMEI, daterange(2010-01-01 2023-03-31) vintage(2023-05-10) aggregate(quarterly,avg) clear\nrename AUSCPIALLQINMEI_20230510 cpi_australia\n// Time format\ngen yrqtr = yq(year(daten),quarter(daten))\nformat yrqtr %tq\ntsset yrqtr\n// Set start of the period to 100\ngen cpi_ret = cpi_australia/L.cpi_australia - 1\nreplace cpi_australia = 100 if _n==1\nreplace cpi_australia = L.cpi_australia * (1+cpi_ret) if _n&gt;1\n// Plotting\ntwoway (tsline cpi_australia), title(\"Quarterly CPI of Australia 2010Q1-2023Q1\") ytitle(\"\") ttitle(\"\") note(\"Index 2010Q1=100. Source: FRED, 2023-05-10 vintage.\")\n\n\n\n\n\n\nFigure 6: Timeseries plot of Australia’s CPI data imported from the FRED database\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe code snippet above specifies the data vintage. Therefore, even if someone runs it 30 years from now, they will still get exactly the same data and plot as I do in 2023.",
    "crumbs": [
      "Stata Workshop",
      "FRED - Federal Reserve Economic Data"
    ]
  },
  {
    "objectID": "posts/fixed-income/introduction/index.html",
    "href": "posts/fixed-income/introduction/index.html",
    "title": "Introduction to Fixed Income Securities",
    "section": "",
    "text": "Fixed income securities are financial instruments that provide a fixed, or predictable, stream of income to investors. These securities typically take the form of bonds, but also include other investment types like certificates of deposit and preferred shares.\nFixed income securities are essentially loans made by an investor to an issuer. In exchange for the loan, the issuer agrees to pay the investor a specified rate of interest during the life of the bond and to repay the principal when it “matures,” or comes due.\n\n\nBy the type of issuer, there are\n\n\nGovernments issue bonds to borrow money. These bonds are considered among the safest investments, as they are backed by the taxing power of the government.1\n1 When we talk about “risk-free rate”, we largely refer to the yield of such government bonds.\n\n\nCompanies also issue bonds to finance their operations or projects. Corporate bonds are considered higher risk than government bonds, but they also typically pay a higher rate of interest.\n\n\n\nMunicipal bonds are issued by cities, states, or other local entities for various public purposes. These bonds often have tax advantages, making them attractive to certain investors.2\n2 In the U.S., generally, the interest on municipal bonds is exempt from federal income tax. The interest may also be exempt from state and local taxes if you reside in the state where the bond is issued. See investor.govIn terms of underlying asset, there are\n\n\n\nThese are bonds backed by loan receivables other than real estate, such as credit card debt, auto loans, student loans, or even royalties from music. In the case of ABS, a pool of these non-mortgage assets is packaged and sold to investors as securities. The principal and interest payments made by the borrowers on these underlying loans are then passed through to the investors.\n\n\n\nThese are investment products backed by home and commercial mortgage loans. These loans are packaged into securities and sold to investors. Similar to ABS, the principal and interest payments made by the borrowers are passed through to the investors. However, MBS are directly tied to the mortgage industry and are susceptible to the performance of the housing market.",
    "crumbs": [
      "Fixed Income",
      "Introduction to Fixed Income Securities"
    ]
  },
  {
    "objectID": "posts/fixed-income/introduction/index.html#what-are-fixed-income-securities",
    "href": "posts/fixed-income/introduction/index.html#what-are-fixed-income-securities",
    "title": "Introduction to Fixed Income Securities",
    "section": "",
    "text": "Fixed income securities are financial instruments that provide a fixed, or predictable, stream of income to investors. These securities typically take the form of bonds, but also include other investment types like certificates of deposit and preferred shares.\nFixed income securities are essentially loans made by an investor to an issuer. In exchange for the loan, the issuer agrees to pay the investor a specified rate of interest during the life of the bond and to repay the principal when it “matures,” or comes due.\n\n\nBy the type of issuer, there are\n\n\nGovernments issue bonds to borrow money. These bonds are considered among the safest investments, as they are backed by the taxing power of the government.1\n1 When we talk about “risk-free rate”, we largely refer to the yield of such government bonds.\n\n\nCompanies also issue bonds to finance their operations or projects. Corporate bonds are considered higher risk than government bonds, but they also typically pay a higher rate of interest.\n\n\n\nMunicipal bonds are issued by cities, states, or other local entities for various public purposes. These bonds often have tax advantages, making them attractive to certain investors.2\n2 In the U.S., generally, the interest on municipal bonds is exempt from federal income tax. The interest may also be exempt from state and local taxes if you reside in the state where the bond is issued. See investor.govIn terms of underlying asset, there are\n\n\n\nThese are bonds backed by loan receivables other than real estate, such as credit card debt, auto loans, student loans, or even royalties from music. In the case of ABS, a pool of these non-mortgage assets is packaged and sold to investors as securities. The principal and interest payments made by the borrowers on these underlying loans are then passed through to the investors.\n\n\n\nThese are investment products backed by home and commercial mortgage loans. These loans are packaged into securities and sold to investors. Similar to ABS, the principal and interest payments made by the borrowers are passed through to the investors. However, MBS are directly tied to the mortgage industry and are susceptible to the performance of the housing market.",
    "crumbs": [
      "Fixed Income",
      "Introduction to Fixed Income Securities"
    ]
  },
  {
    "objectID": "posts/fixed-income/introduction/index.html#why-invest-in-fixed-income-securities",
    "href": "posts/fixed-income/introduction/index.html#why-invest-in-fixed-income-securities",
    "title": "Introduction to Fixed Income Securities",
    "section": "Why invest in fixed income securities?",
    "text": "Why invest in fixed income securities?\nInvestors choose fixed income securities for several reasons:\n\nIncome: Fixed income securities provide regular interest payments, which can be an attractive source of income.\nPreservation of capital: When the bond matures, the full principal amount is returned to the investor. This makes bonds appealing for those looking to preserve their capital.\nDiversification: Including fixed income securities in a portfolio can help diversify investments and reduce risk.",
    "crumbs": [
      "Fixed Income",
      "Introduction to Fixed Income Securities"
    ]
  },
  {
    "objectID": "posts/fixed-income/introduction/index.html#who-invest-in-fixed-income-securities",
    "href": "posts/fixed-income/introduction/index.html#who-invest-in-fixed-income-securities",
    "title": "Introduction to Fixed Income Securities",
    "section": "Who invest in fixed income securities?",
    "text": "Who invest in fixed income securities?\nInvestors in fixed income securities come from a broad spectrum and include both individuals and institutions.\n\n\n\n\n\nMarket size of fixed income securities. Source: SIFMA\n\n\n\n“Although they usually attract less attention than equity markets, fixed-income markets are more than three times the size of global equity markets”, CFA Institute.\n\n\nIndividuals\nIndividual investors, particularly those in or nearing retirement, often invest in fixed-income securities as a way to preserve capital and generate a steady stream of income.\n\n\nInstitutions\n\nPension Funds: Pension funds invest heavily in fixed-income securities as they provide predictable returns which can be matched against their future payout obligations.\nInsurance Companies: Like pension funds, insurance companies have long-term, predictable liabilities and thus invest significantly in fixed-income securities to match these liabilities.\nMutual Funds: There are many mutual funds, known as bond funds, that specialize in investing in fixed-income securities.\nBanks and Financial Institutions: Banks and other financial institutions often invest in fixed-income securities as a way to generate a return on their excess capital and to help manage their interest rate risk.\nEndowments and Foundations: These entities often include fixed-income securities in their portfolios for diversification and income generation.\nCentral Banks: Central banks often hold domestic and foreign fixed-income securities as a part of their reserves and as a tool for implementing monetary policy.\n\nEach type of investor may have different investment objectives and constraints, and therefore might focus on different types of fixed-income securities (e.g., government bonds, corporate bonds, municipal bonds, etc.) based on their risk tolerance, income requirements, tax situation, and other factors.",
    "crumbs": [
      "Fixed Income",
      "Introduction to Fixed Income Securities"
    ]
  },
  {
    "objectID": "posts/fixed-income/introduction/index.html#features-of-a-bond",
    "href": "posts/fixed-income/introduction/index.html#features-of-a-bond",
    "title": "Introduction to Fixed Income Securities",
    "section": "Features of a bond",
    "text": "Features of a bond\n\nThe basics\nIn its simplest form, a bond may be specified by the following characteristics:3\n3 Bonds have many more features. We will focus on these for now and introduce others later.\nIssuer is the entity raising capital through bond issue.\nFace value is the nominal value of the bond, representing the amount the bondholder will receive at maturity, a.k.a. “par value” or “principal”.\nMaturity date is the date on which the bond will mature, and the issuer will return the bond’s face value to the bondholders.\nCoupon rate is the interest rate (fixed or variable) that the bond issuer agrees to pay to bondholders. It is usually expressed as a percentage of the bond’s face value, and the interest is paid periodically, typically semi-annually or annually.\n\nFor example, on March 17, 2021, Microsoft4 issued a $6,250,000,0005 aggregate principal amount of its 2.921%6 Notes7 due 20528 (the “2052 Notes”).\n4 Issuer5 Face value of the bond6 Coupon rate7 Maturity date8 The terms “bond” and “note” are often used interchangeably. Although typically “note” refers to those with shorter maturities (1 to 10 years) and “bond” refers to those with longer than 10 years of maturity, the difference is really more a matter of convention and industry terminology.9 Indenture is the legal contract between the bond issuer and the bondholder that outlines the terms and conditions of the bond, including the rights and responsibilities of both parties.The bond’s indenture9 also specifies that\n\nThe 2052 Notes will bear interest (computed on the basis of a 360-day year consisting of twelve 30-day months) from March 17, 2021 at the rate of 2.921% per annum, payable semi-annually in arrears.\n\nA sequence of cash flows between the bond issuer and investor is described below\n\n\n\n\n\nsequenceDiagram\n    autonumber\n    Issuer (bond seller)--&gt;&gt;Investor (bond buyer): Bond\n    Investor (bond buyer)-&gt;&gt;Issuer (bond seller): Price of bond\n    note right of Investor (bond buyer): We will figure out the price later\n\n    loop every 6 months until 2052\n        Issuer (bond seller)-&gt;&gt;Investor (bond buyer): Coupon (1/2 of 2.921% of face value)\n    end\n\n    Issuer (bond seller)-&gt;&gt;Investor (bond buyer): Return principal ($6,250,000,000)\n    Investor (bond buyer)--&gt;&gt;Issuer (bond seller): Redeem bond\n\n\n\n\n\n\n\n\nAdditional things\nA bond can be secured in that the issuer can pledge certain assets10 to “secure” the payments to investors. In case of defaults 😔, bondholders have a direct claim on the pledged assets.\n10 Real estate, equipment, or other valuable properties such as patents, etc.An unsecured bond (or “debenture”), on the other hand, relies solely on the issuer’s creditworthiness and ability to generate cash flow to repay bondholders. In case of defaults 😔, bondholders of unsecured bonds only have a claim on the issuer’s general assets.\nA bond has also a seniority. In case of defaults 😔, investors of more senior bonds can claim before investors of less senior bonds.11\n11 This “more or less senior” notion is vague. More precisely, a bond seniority table describes the ranking of bond seniority.A bond needs to specify the currency as well, along with many other things…\n\n\nEmbedded options\nA bond is plain vanilla when it has no embedded options, which can add a lot “flavour”.\n\n\n\n\n\n\nNote\n\n\n\nEmbedded options in bonds refer to features or provisions that give either the bond issuer or the bondholder the right to take certain actions under specific circumstances.\n\n\nEmbedded options provide added flexibility to the bond’s terms and can impact the bond’s cash flows and overall value. The three main types of embedded options found in bonds are:\n\nCall Option (Callable Bonds)\n\nCall option allows the bond issuer to redeem or “call back” the bonds before their scheduled maturity date.\nThe issuer may choose to call the bonds if prevailing interest rates decline, giving them an opportunity to refinance at a lower cost.\nWhen the bond is called, the bondholders receive the bond’s face value and any accrued interest up to that point.\nCallable bonds typically offer higher coupon rates compared to non-callable bonds to compensate investors for the risk of early redemption.\n\n\n\nPut Option (Puttable Bonds)\n\nPut option allows the bondholder to sell the bonds back to the issuer at a specified price before the scheduled maturity date.\nPuttable bonds provide the bondholders with an opportunity to exit their investment if they believe it is advantageous to do so, such as when interest rates rise.\nWhen exercised, the bondholder receives the bond’s face value, which may be different from the market price at the time of the put option exercise.\nPuttable bonds are relatively less common than callable bonds.\n\n\n\nConversion Option (Convertible Bonds)\n\nConversion option allows the bondholder to convert their bond into common shares of the issuing company. The conversion ratio specifies the number of shares the bondholder will receive per bond converted.\nConvertible bonds are considered hybrid securities because they possess attributes of both debt and equity. Until conversion, they behave like regular bonds, offering fixed coupon payments and a return of the principal at maturity. Upon conversion, they become equity instruments, representing ownership in the issuing company.",
    "crumbs": [
      "Fixed Income",
      "Introduction to Fixed Income Securities"
    ]
  },
  {
    "objectID": "posts/fixed-income/introduction/index.html#the-simplified-overview",
    "href": "posts/fixed-income/introduction/index.html#the-simplified-overview",
    "title": "Introduction to Fixed Income Securities",
    "section": "The (simplified) overview",
    "text": "The (simplified) overview\n\n\n\n\n\nsequenceDiagram\nautonumber\n    participant Issuer\n    participant Underwriter\n    participant Investors\n\n    rect rgba(0, 0, 255, .1)\n        note left of Issuer: Primary Market\n        Issuer-&gt;&gt;Underwriter: Request Bond Underwriting\n        Underwriter-&gt;&gt;Issuer: Analyze Issuer's Creditworthiness\n        Underwriter-&gt;&gt;Investors: Offer Bonds for Sale\n        Investors-&gt;&gt;Underwriter: Express Interest in Buying Bonds\n        Underwriter-&gt;&gt;Issuer: Finalize Bond Terms and Pricing\n        Investors-&gt;&gt;Underwriter: Place Orders for Bonds\n        Underwriter-&gt;&gt;Investors: Issue Bonds to Investors\n    end\n    rect rgba(0, 0, 255, .1)\n        note right of Investors: Secondary Market\n        Investors-&gt;&gt;Investors: Buy and Sell Bonds\n    end",
    "crumbs": [
      "Fixed Income",
      "Introduction to Fixed Income Securities"
    ]
  },
  {
    "objectID": "posts/fixed-income/bond-price-volatility/index.html",
    "href": "posts/fixed-income/bond-price-volatility/index.html",
    "title": "Bond Price Volatility (Sensitivity)",
    "section": "",
    "text": "A (plain vanilla) bond’s price \\(P\\) is nothing but a function of some input parameters, including coupon rate \\(C\\), time to maturity \\(t\\), yield \\(y\\), face value \\(F\\), among others:\n\\[\nP=f(C,t,y,F)\n\\]\nNow that we have discussed the pricing function \\(f\\) in the previous post, it is very natural to think about how \\(P\\) responds to changes in each of the input parameters. This is precisely an examination of the partial derivate of \\(f\\) with respect to (w.r.t.) its parameters.\nAdditionally, for a given bond, the coupon rate \\(C\\) and face value \\(F\\) will not change. That means we can primarily focus on a bond’s price sensitivity w.r.t. yield, and how the time to maturity \\(t\\) and other parameters affect such sensitivity.",
    "crumbs": [
      "Fixed Income",
      "Bond Price Volatility (Sensitivity)"
    ]
  },
  {
    "objectID": "posts/fixed-income/bond-price-volatility/index.html#price-sensitivity-to-yield",
    "href": "posts/fixed-income/bond-price-volatility/index.html#price-sensitivity-to-yield",
    "title": "Bond Price Volatility (Sensitivity)",
    "section": "Price sensitivity to yield",
    "text": "Price sensitivity to yield\nAs we have previously discussed, a bond’s price and its yield has an inverse, non-linear relationship. More importantly, the non-linearity shows that the same unit change in yield has different impacts on bond’s price: the higher the yield is, the smaller the impact of a given unit change in yield, other things equal.\n\nviewof maturity4 = Inputs.range(\n  [1, 30], \n  {value: 15, step: 1, label: \"Maturity (years):\"}\n)\nviewof couponRate4 = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.05, step: 0.01, label:\"Coupon rate:\"}\n)\nd = {\n  const f = 100;\n  let c, m;\n  c = couponRate4;\n  m = maturity4;\n  function pv(c, f, t, r) {\n    return c * (1 - (1+r)**(-t)) / r + f / (1+r)**(t)\n  }\n  const prices = {\"YTM\": [], \"Price\": []};\n  let coupon = f * c;\n  for (let ytm = 0.01; ytm &lt; 20; ytm++) {\n    let price = pv(coupon, f, m, ytm/100);\n    prices[\"YTM\"].push(ytm);\n    prices[\"Price\"].push(price);\n  }\n  return prices;\n}\n\ndata4 = transpose(d)\nPlot.plot({\n  caption: \"Assume $100 bond, annual coupons paid in arrears and effective annual discount rate.\",\n  x: {padding: 0.4, label: \"YTM (%)\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0, 100]),\n    Plot.ruleX([0]),\n    Plot.lineY(data4, {x: \"YTM\", y: \"Price\", stroke: \"blue\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis observation suggests that while the bond price is sensitive to yield, this sensitivity is not a constant.\n\n\n\n\n\n\nHow to measure the bond price sensitivity to yield?\n\n\n\nCan we quantify such sensitivity?\nYes. It’s nothing but the partial derivate of bond price \\(P=f(C,t,{\\color{red}y},F)\\) w.r.t. yield \\(\\color{red}y\\):\n\\[\n\\frac{\\partial P}{\\partial {\\color{red}y}}\n\\]",
    "crumbs": [
      "Fixed Income",
      "Bond Price Volatility (Sensitivity)"
    ]
  },
  {
    "objectID": "posts/fixed-income/bond-price-volatility/index.html#measure-of-price-yield-sensitivity-duration",
    "href": "posts/fixed-income/bond-price-volatility/index.html#measure-of-price-yield-sensitivity-duration",
    "title": "Bond Price Volatility (Sensitivity)",
    "section": "Measure of price-yield sensitivity: Duration",
    "text": "Measure of price-yield sensitivity: Duration\n\nMacaulay Duration\nLet’s take a closer look at the bond price sensitivity to yield \\(\\frac{\\partial P}{\\partial y}\\).\nRecall that bond price \\(P=f(C,t,{\\color{red}y},F)\\), so its partial derivative w.r.t. yield \\(\\color{red}y\\) is given by:\n\\[\n\\frac{\\partial P}{\\partial {\\color{red}y}} =\n\\frac{\\partial f}{\\partial {\\color{red}y}} =\n\\frac{\\partial}{\\partial {\\color{red}y}}{\\left[\\sum_{\\tau=1}^{n} \\frac{C}{(1+{\\color{red}y})^{\\tau}} + \\frac{F}{(1+{\\color{red}y})^n}\\right]}\n\\]\n\n\n\n\n\n\nBe not afraid - Ask ChatGPT to derive\n\n\n\n\n\nLet’s differentiate the expression with respect to \\(y\\) step by step:\n\\[\n\\begin{align*}\n\\frac{\\partial}{\\partial y} \\left[\\sum_{\\tau=1}^{n} \\frac{C}{(1+y)^{\\tau}} + \\frac{F}{(1+y)^n}\\right] &= \\sum_{\\tau=1}^{n} \\frac{\\partial}{\\partial y} \\left[\\frac{C}{(1+y)^{\\tau}}\\right] + \\frac{\\partial}{\\partial y} \\left[\\frac{F}{(1+y)^n}\\right] \\\\\n&= \\sum_{\\tau=1}^{n} \\left[-\\frac{C \\cdot \\tau}{(1+y)^{\\tau+1}}\\right] + \\left[-\\frac{F \\cdot n}{(1+y)^{n+1}}\\right] \\\\\n&= -\\sum_{\\tau=1}^{n} \\frac{C \\cdot \\tau}{(1+y)^{\\tau+1}} - \\frac{F \\cdot n}{(1+y)^{n+1}} \\\\\n&= -\\frac{1}{1+y}\\left[\\sum_{\\tau=1}^{n} \\frac{C \\cdot \\tau}{(1+y)^{\\tau}} + \\frac{F \\cdot n}{(1+y)^n}\\right]\n\\end{align*}\n\\]\n\n\n\nTherefore, the price’s sensitivity to yield is:\n\\[\n\\frac{\\partial P}{\\partial y}= -\\frac{1}{1+y}\\left[\\sum_{\\tau=1}^{n} \\frac{C \\cdot \\tau}{(1+y)^{\\tau}} + \\frac{F \\cdot n}{(1+y)^n}\\right]\n\\]\nThis formula is extremely interesting! Let’s see what I mean.\nCheck out the part \\(\\left[\\sum_{\\tau=1}^{n} \\frac{C \\cdot \\tau}{(1+y)^{\\tau}} + \\frac{F \\cdot n}{(1+y)^n}\\right]\\). It looks like we are multiplying the time period in each of the components in the original bond pricing formula - if we ignore the \\(\\tau\\) and \\(n\\) in the numerators, it is exactly the formula. If we divide it by the bond price \\(P\\), we have:\n\\[\n\\begin{align*}\n  &\\frac{1}{P}\\left[\\sum_{\\tau=1}^{n} \\frac{C \\cdot \\tau}{(1+y)^{\\tau}} + \\frac{F \\cdot n}{(1+y)^n}\\right] \\\\\n  &=\\left[\\sum_{\\tau=1}^{n} \\frac{C/(1+y)^{\\tau}}{P} \\cdot \\tau+ \\frac{F /(1+y)^n}{P}\\cdot n\\right] \\\\\n  &=\\sum_{\\tau=1}^{n} \\underbrace{\\frac{PV(\\tau\\text{-th coupon})}{P}}_{\\text{weight of coupon}} \\cdot \\tau+ \\underbrace{\\frac{PV(\\text{principal})}{P}}_{\\text{weight of principal}}\\cdot n \\\\\n  &=\\sum_{\\tau=1}^{n} w_{\\tau} \\cdot \\tau+ w_{F} \\cdot n \\equiv \\text{Macaulay Duration}\n\\end{align*}\n\\]\nThat is, a PV weighted average of time to receive a bond’s cashflows. Its name is Macaulay Duration.\nBack to the initial formula of bond price sensitivity to yield:\n\\[\n\\begin{align*}\n\\frac{\\partial P}{\\partial y} &= -\\frac{1}{1+y}\\left[\\sum_{\\tau=1}^{n} \\frac{C \\cdot \\tau}{(1+y)^{\\tau}} + \\frac{F \\cdot n}{(1+y)^n}\\right]\\\\\n&=-\\frac{1}{1+y} \\left[P\\times{\\text{Macaulay Duration}}\\right]\n\\end{align*}\n\\]\n\n\nModified Duration\nIf we define Modified Duration as\n\\[\n\\text{Modified Duration} = \\frac{\\text{Macaulay Duration}}{1+y}\n\\]\nthe above formula of bond price sensitivity to yield can be simplified to:\n\\[\n\\begin{align*}\n\\frac{\\partial P}{\\partial y}\n&=-\\frac{1}{1+y} \\left[P\\times{\\text{Macaulay Duration}}\\right] \\\\\n&=-P\\times{\\text{Modified Duration}}\n\\end{align*}\n\\]\n\n\nHow to use durations?\nWe can now use durations to approximate the dollar or percentage change in bond price given a small change in yield. Specifically, for a small change in yield \\(\\Delta y\\),\nthe dollar change in bond price \\(\\Delta P\\) is\n\\[\n\\Delta P = -P\\times \\text{Modified Duration} \\times \\Delta y\n\\]\nand the percentage change \\(\\frac{\\Delta P}{P}\\) is\n\\[\n\\frac{\\Delta P}{P} = - \\text{Modified Duration} \\times \\Delta y\n\\]\n\n\n\n\n\n\nPV01\n\n\n\nPeople are particularly interested in the price movement of a bond given a one-basis-point change in yield, or PV01, which is essentially \\(\\Delta P\\) given \\(\\Delta y=0.0001\\).\n\n\n\n\nDuration of a bond portfolio\nA good thing about duration is that it’s additive, meaning that the duration of a portfolio of bonds is simply the value-weighted average of individual bonds’ durations.",
    "crumbs": [
      "Fixed Income",
      "Bond Price Volatility (Sensitivity)"
    ]
  },
  {
    "objectID": "posts/fixed-income/bond-price-volatility/index.html#adjusting-for-convexity",
    "href": "posts/fixed-income/bond-price-volatility/index.html#adjusting-for-convexity",
    "title": "Bond Price Volatility (Sensitivity)",
    "section": "Adjusting for Convexity",
    "text": "Adjusting for Convexity\nEarlier we mentioned that the price-yield relationship is non-linear and convex. In simple terms, it means the sensitivity of bond price to yield is decreasing in yield, i.e., when yield is high, a given unit change in yield has a smaller impact on bond price.\nIntuitively, as yield increases, bond duration decreases. So, looking at the bond price sensitivity formulae above, we can notice that \\(\\partial y\\) should also change durations, which were assumed constant. This failure to adjust bond duration when computing the price change due to yield change leads to an underestimation of true price. We can correct it by adjusting for bond convexity.\n\n\n\n\n\n\nNote\n\n\n\nFrom the graph below, we can see that using only duration to approximate bond price is like assuming a linear price-yield relation. Given that the price-yield relation is convex, this means we would underestimate the bond price. The vertical difference between the curved line and dotted straight line is where adjustment for convexity comes in.\n\n\n\nviewof maturity = Inputs.range(\n  [1, 30], \n  {value: 15, step: 1, label: \"Maturity (years):\"}\n)\nviewof couponRate = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.06, step: 0.01, label:\"Coupon rate:\"}\n)\np = {\n  const f = 100;\n  function pv(c, f, t, r) {\n    return c * (1 - (1+r)**(-t)) / r + f / (1+r)**(t)\n  }\n  const prices = {\"YTM\": [], \"Price\": [], \"PriceApproxByDuration\": [], \"Duration\": []};\n  let coupon = f * couponRate;\n  let priceYTM6 = pv(coupon, f, maturity, 6/100);\n  let priceYTM6_p01 = pv(coupon, f, maturity, 6.01/100);\n  let priceYTM6_m01 = pv(coupon, f, maturity, 5.99/100);\n  let duration = (priceYTM6_m01 - priceYTM6_p01) / (2 * 0.01 * priceYTM6);\n//   let md = duration / (1+6/100);\n  for (let ytm = 0.1; ytm &lt; 20; ytm+=0.1) {\n    let price = pv(coupon, f, maturity, ytm/100);\n    prices[\"YTM\"].push(ytm);\n    prices[\"Price\"].push(price);\n    prices[\"PriceApproxByDuration\"].push(-priceYTM6*duration*(ytm-6)+priceYTM6);\n    prices[\"Duration\"].push(duration*priceYTM6);\n  }\n  return prices;\n}\ndata = transpose(p)\nPlot.plot({\n  caption: \"Assume $100 bond, annual coupons paid in arrears and current YTM of 6%.\",\n  x: {padding: 0.4, label: \"YTM (%)\"},\n  y: {domain: [0, 200]},\n  grid: true,\n  marks: [\n    Plot.ruleY([0, 100]),\n    Plot.ruleX([0, 6]),\n    // Plot.text(data, {x: 2, y: 20, text: (d) =&gt; (\"Duration: \" + d.Duration.toFixed(3)), textAnchor: \"start\", fontSize: 18}),\n    Plot.lineY(data, {x: \"YTM\", y: \"Price\", stroke: \"blue\"}),\n    Plot.lineY(data, {x: \"YTM\", y: \"PriceApproxByDuration\", stroke: \"red\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMathematically, notice that bond price \\(P\\) is a non-linear function \\(f\\) of yield \\(y\\) and many other parameters. Approximating \\(\\Delta P\\) using only its first partial derivative \\(\\frac{\\partial P}{\\partial y}\\) is of course not enough. We need to consider the second-order partial derivate, \\(\\frac{\\partial^2 P}{\\partial y^2}\\) too. This second derivative w.r.t. yield is exactly what we call the (dollar) convexity of a bond.\n\\[\n\\Delta P = \\underbrace{\\frac{\\partial P}{\\partial y}}_{\\text{related to duration}} \\cdot \\partial y + \\underbrace{\\frac{1}{2}\\frac{\\partial^2 P}{\\partial y^2}}_{\\text{related to convexity}} \\cdot (\\partial y)^2\n\\]\n\n\n\n\n\n\nWhy does it work? – Taylor Expansion\n\n\n\n\n\nThis is for the math-savvy. According to Taylor Expansion, the change in a function \\(f\\)’s value at a point \\(y\\) by \\(\\Delta y\\) is:\n\\[\nf(y+\\Delta y) - f(y) = f'(y) \\Delta y + \\frac{f''(y)}{2} (\\Delta y)^2 + \\cdots\n\\]\nwhere higher order terms are ignored because they are too small.\n\n\n\nAs such, approximating a bond price’s change can be better achieved using both duration and convexity.\n\nImpact of coupon rate on convexity\n\n\n\n\n\n\nIn the graph above, reduce coupon rate. What do you find?\n\n\n\nAdjusting only coupon rate, the bond’s yield and maturity stay unchanged. The bond price declines, duration goes up, though the slope of the tangent line at yield decreases.\n\n\nFor a given yield and maturity, the lower the coupon, the greater the convexity of a bond. This is because a greater portion of the bond value comes later, resulting a higher duration. A higher duration implies greater sensitivity of bond price to yield, so that for a given change in yield, the (percentage) change in price is greater – the bond’s convexity is higher.1\n1 Note that it does not necessarily mean that the price-yield curve is more convex! In the graph above, if we reduce coupon rate, the curve seems less convex than the baseline curve, but the low-coupon bond’s convexity is higher. Remember we need to scaled by the bond price, and the low-coupon bond’s price is lower.",
    "crumbs": [
      "Fixed Income",
      "Bond Price Volatility (Sensitivity)"
    ]
  },
  {
    "objectID": "posts/fixed-income/bond-price-volatility/index.html#approximating-duration-and-convexity",
    "href": "posts/fixed-income/bond-price-volatility/index.html#approximating-duration-and-convexity",
    "title": "Bond Price Volatility (Sensitivity)",
    "section": "Approximating duration and convexity",
    "text": "Approximating duration and convexity\nWhen a bond has embedded options, an analytical solution of bond price can be hard or impossible to get. The lack of an exact bond price function means that we will not be able to compute its partial derivatives, and we have to use approximations to gauge its duration and convexity.\n\nDuration approximation\nConceptually, (modified) duration captures the change in bond price given a small change in yield. So, we can approximate a bond’s duration by computing2 the average price changes given a small change in yield in both directions:\n2 If the exact pricing function is not available due to complex embedded options, we can try to use Monte Carlo simulations to compute an expected value.\\[\n\\begin{align*}\n\\text{approx. Modified Duration} &= \\underbrace{\\frac{1}{2} \\left[\\frac{P_{-}-P_0}{P_0} + \\frac{P_0 - P_+}{P_0}\\right]}_{\\text{avg. pct. price change}} \\times \\underbrace{\\frac{1}{\\Delta y}}_{\\text{per change in yield}} \\\\\n&= \\frac{P_--P_+}{2P_0\\cdot \\Delta y}\n\\end{align*}\n\\]\n\n\nConvexity approximation\nSimilarly and conceptually, bond convexity captures the asymmetric changes in price given a small change in yield to the positive and to the negative directions. So, we can approximate a bond’s (dollar) convexity by computing3 the difference in price changes given a small change in yield in both directions:\n3 Or by simulation.\\[\n\\begin{align*}\n\\text{approx. Convexity} &= \\underbrace{\\left[\\frac{P_{-}-P_0}{\\Delta y} - \\frac{P_0 - P_+}{\\Delta y}\\right]}_{\\text{diff. in price changes given yield change}} \\times \\underbrace{\\frac{1}{\\Delta y}}_{\\text{per change in yield}} \\\\\n&= \\frac{P_-+P_+-2P_0}{(\\Delta y)^2}\n\\end{align*}\n\\]\n\n\n\n\n\n\nReal world application\n\n\n\nImagine you’re a manager of a bond portfolio. Some bonds in the portfolio are exotic and have complex embedded options: this is very common.\nHow do you understand the risk of the portfolio, in terms of its value sensitivity to yield?\nYou can have a powerful computer program that continuously compute the approximate duration and convexity of each bond in the portfolio, perhaps using Monte Carlo simulations to value those bonds with embedded options. Therefore, you can have a real-time measure of the portfolio’s risk exposure to yield changes.",
    "crumbs": [
      "Fixed Income",
      "Bond Price Volatility (Sensitivity)"
    ]
  },
  {
    "objectID": "posts/estimate-organization-capital/index.html",
    "href": "posts/estimate-organization-capital/index.html",
    "title": "Estimate Organization Capital",
    "section": "",
    "text": "This post explains the estimation of organization capital (Gao, Leung, and Qiu 2021). As in Eisfeldt and Papanikolaou (2013), we obtain firm-year accounting data from the Compustat and compute the stock of organization capital for firms using the perpetual inventory method that recursively calculates the stock of OC by accumulating the deflated value of SG&A expenses."
  },
  {
    "objectID": "posts/estimate-organization-capital/index.html#organization-capital",
    "href": "posts/estimate-organization-capital/index.html#organization-capital",
    "title": "Estimate Organization Capital",
    "section": "Organization Capital",
    "text": "Organization Capital\n\\[\nOC_{i,t} = (1-\\delta_{OC})OC_{i,t-1} + \\frac{SGA_{i,t}}{CPI_t}\n\\tag{1}\\]\nwhere \\(SGA_{i,t}\\) is firm \\(i\\)’s SG&A expenses in year \\(t\\), \\(CPI_t\\) is the consumer price index, and \\(\\delta_{OC}\\) is the depreciation rate of OC stock, which is set to be 15% as used by the U.S. Bureau of Economic Analysis (BEA). The initial value of OC stock is set to:\n\\[\nOC_{i,0} = \\frac{SGA_{i,1}}{g+\\delta_{OC}}\n\\tag{2}\\]\nwhere \\(g\\) is the average real growth rate of firm-level SG&A expenses, which is 10% in Eisfeldt and Papanikolaou (2013) or specific for an industry-decade in Li, Qiu, and Shen (2018)."
  },
  {
    "objectID": "posts/estimate-organization-capital/index.html#code",
    "href": "posts/estimate-organization-capital/index.html#code",
    "title": "Estimate Organization Capital",
    "section": "Code",
    "text": "Code\nThis code estimates the organization capital for all Compustat firm-years.\nNote that it requires an external dataset of CPI. You need to name it cpiaucsl and store it in your WRDS home directory.\n\nLastly, if you use this code above, please consider citing the following article for which it was written.\n\nGao, M. Leung, H. and Qiu, B. (2021). Organization Capital and Executive Performance Incentives, Journal of Banking & Finance, 123, 106017."
  },
  {
    "objectID": "posts/download-sec-filings-from-edgar/index.html",
    "href": "posts/download-sec-filings-from-edgar/index.html",
    "title": "Download SEC Filings from EDGAR",
    "section": "",
    "text": "This post documents how to download SEC filings from EDGAR using edgar-analyzer, a Python program I wrote. It features:"
  },
  {
    "objectID": "posts/download-sec-filings-from-edgar/index.html#install-edgar-analyzer",
    "href": "posts/download-sec-filings-from-edgar/index.html#install-edgar-analyzer",
    "title": "Download SEC Filings from EDGAR",
    "section": "Install edgar-analyzer",
    "text": "Install edgar-analyzer\npip install edgar-analyzer\n\n\n\n\n\n\nWarning\n\n\n\nEDGAR has limitations on the download speed. While the program tries its best to adhere to the requirements, it may accidentally go above the limit, resulting a temporary or even permanent ban. Please use at your own risk."
  },
  {
    "objectID": "posts/download-sec-filings-from-edgar/index.html#download-index-files",
    "href": "posts/download-sec-filings-from-edgar/index.html#download-index-files",
    "title": "Download SEC Filings from EDGAR",
    "section": "Download index files",
    "text": "Download index files\nEDGAR started in 1994/1995. EDGAR provides quarterly index files since 1993Q1 (1) which contain the firm CIK, name, filing date, type, and URL of the filing.1\n1 The number of filings in 1993 is close to zero so we can start from 1994.We will use these index files to build a database so that we can more efficiently download the filings of our choice.\nFurther, EDGAR now requires download requests to supply identity info. We need to specify our name/institution and contact email in user agent. Otherwise, none of requests will work.\nThen, run the following command. Notice that we specify the beginning year as 2010 and output directory as “index” in the current working directory.\nedgar-analyzer download_index --user_agent \"MyCompany name@mycompany.com\" --output \"./index\" -b 2010\nAfter the index files are downloaded, we build a database of the index files for more efficient queries.\nedgar-analyzer build_database --inputdir \"./index\" --database \"edgar-idx.sqlite3\"\nAs at September 2023, the database’s size is about 3GB."
  },
  {
    "objectID": "posts/download-sec-filings-from-edgar/index.html#download-filings",
    "href": "posts/download-sec-filings-from-edgar/index.html#download-filings",
    "title": "Download SEC Filings from EDGAR",
    "section": "Download filings",
    "text": "Download filings\nNow we get to the actual filings download using the following command. Note that here we have specified to download 10-K filings using 4 threads.\nedgar-analyzer download_filings --user_agent \"MyCompany name@mycompany.com\" --output \"./output\" --database \"edgar-idx.sqlite3\" --file_type \"10-K\" -t 4\nSome extra notes:\n\nOnly filings not downloaded yet will be downloaded. This ensures that we do not repeatedly download the same filings multiple times if we restart the program.\nDownload speed will be auto throttled as per SEC’s fair use policy, irrespective of the number of threads specified. Multithreading beyond certain number will not increase download speed any further.\n\n\n\n\n\n\n\nTip\n\n\n\nYou can always use edgar-analyzer [subcommand] --help to check the docs."
  },
  {
    "objectID": "posts/download-sec-filings-from-edgar/index.html#extras",
    "href": "posts/download-sec-filings-from-edgar/index.html#extras",
    "title": "Download SEC Filings from EDGAR",
    "section": "Extras",
    "text": "Extras\nThe program additionally has some subcommands to perform certain textual analyses.\nJust a simple example of the job find_event_date. Based on the 1,491,368 8K filings (2004-2022), the table below shows the reporting lags (date of filing minus date of event).\nWe can find that most filings are filed on the same day as the event reported, and that over 99.99% of filings are filed within 4 calendar days (SEC requires 4 business days).\n\n\n\nFiling lag (calendar days)\nFrequency\nPercentage\nCumulative\n\n\n\n\n0\n1470089\n98.57%\n98.57%\n\n\n1\n20761\n1.39%\n99.97%\n\n\n2\n285\n0.02%\n99.98%\n\n\n3\n89\n0.01%\n99.99%\n\n\n4\n47\n0.00%\n99.99%\n\n\n5\n26\n0.00%\n100.00%\n\n\n6\n14\n0.00%\n100.00%\n\n\n7\n6\n0.00%\n100.00%\n\n\n8\n4\n0.00%\n100.00%\n\n\n9\n3\n0.00%\n100.00%\n\n\n10 or more\n44\n0.00%\n100.00%\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nThis tool is a work in progress and breaking changes may be expected."
  },
  {
    "objectID": "posts/difference-in-differences/index.html",
    "href": "posts/difference-in-differences/index.html",
    "title": "Difference-in-Differences Estimation",
    "section": "",
    "text": "Empirical researchers have been using difference-in-differences (DiD) estimation to identify an event’s Average Treatment effect on the Treated entities (ATT). This post is my understanding and a non-technical note of the DiD approach as it evolves over the past years, especially on the problems and solutions when multiple treatment events are staggered."
  },
  {
    "objectID": "posts/difference-in-differences/index.html#one-event-and-the-canonical-did",
    "href": "posts/difference-in-differences/index.html#one-event-and-the-canonical-did",
    "title": "Difference-in-Differences Estimation",
    "section": "One event and the canonical DiD",
    "text": "One event and the canonical DiD\nThe canonical DiD takes a \\(2\\times 2\\) form which involves 2 periods (before & after) and 2 groups (treated and untreated). Under the assumption of parallel trends (1), the most common approach to identify ATT is a two-way fixed effect (TWFE) linear regression.1\n1 Parallel trends assume that the change in the outcomes of treated group, in absence of the treatment, is the same as the change in the outcomes of the untreated group.Specifically, we would estimate the following model:\n\\[\n\\begin{equation}\n  Y_{it} = \\beta D_{it} + \\theta_t + \\gamma_{i} + \\varepsilon_{it}\n\\end{equation}\n\\]\nwhere \\(Y_{it}\\) is the outcome of interest for entity \\(i\\) at time \\(t\\), \\(D_{it}\\) is an indicator that takes the value of 1 if entity \\(i\\) has been treated at time \\(t\\)(1), \\(\\theta_t\\) is the time fixed effect and \\(\\gamma_i\\) is the entity fixed effect (2). Here, estimate of \\(\\beta\\) is interpreted as the ATT.2\n2 If we have separate \\(\\text{Treatment}_i\\) and \\(\\text{Post}_{t}\\) indicators, then \\(D_{it}=\\text{Treatment}_i \\times \\text{Post}_t\\). Note that the presence of time and entity fixed effects absorbs individual \\(\\text{Post}_t\\) and \\(\\text{Treatment}_{i}\\) variables in the model.This TWFE method works when\n\nThere is homogeneous treatment effect, i.e., the treatment effect is the same for all treated entities.\nThere is only one treatment event such that we have only two periods (before and after the treatment). In this case, TWFE is robust to treatment effect heterogeneity. That is, even though the treatment effect may not be the same for all treated entities, the estimated \\(\\beta\\) is numerically equal to the ATT.\n\n\n“What if there are multiple treatments at different times?”"
  },
  {
    "objectID": "posts/difference-in-differences/index.html#problems-of-twfe-with-multiple-events",
    "href": "posts/difference-in-differences/index.html#problems-of-twfe-with-multiple-events",
    "title": "Difference-in-Differences Estimation",
    "section": "Problems of TWFE with multiple events",
    "text": "Problems of TWFE with multiple events\nSuppose there are two treatment events. Let’s visualize the treatment status of three groups of entities, the Never-treated group N, the Early-treated group E and the Late-treated group L. Here I ignore the possibility that a group has always been treated.\n\n\n\n\n\ngantt\n    title Treatment Status\n    dateFormat YYYY\n    axisFormat %Y\n    section Group N\n        Untreated:done, 2010, 5y\n    section Group E\n        Untreated  :done, a1, 2010, 1y\n        Treated    :after a1, 4y\n    section Group L\n        Untreated :done, 2010, 3y\n        Treated : 2y\n\n\n Staggered treatment events \n\n\n\nGoodman-Bacon (2021) shows that, in this case, TWFE estimate of \\(\\beta\\) in Equation (1) above is in fact a (complicated) weighted-average of all possible \\(2\\times2\\) DiD estimates, which leads to bias:\n\n\nFor the event to group E (Early-treated):\n\nE vs N. No problem, controls are never treated.\nE vs L. No problem, controls have not yet been treated.\n\nFor the event to group L (Late-treated):\n\nL vs N. No problem, controls are never treated.\nL vs E. Problematic, controls have been treated (by another earlier event).(1)\n\n\n\n\nThis may not seem obvious given that group E would have \\(D_{it}=1\\) after 2011. But DiD is actually comparing the “before-after” differences in outcomes of entities whose treatment statuses just change to those whose treatment statuses do not change. The already-treated group E’s status stay unchanged from 2011 to 2014."
  },
  {
    "objectID": "posts/difference-in-differences/index.html#what-to-do-then-an-overview",
    "href": "posts/difference-in-differences/index.html#what-to-do-then-an-overview",
    "title": "Difference-in-Differences Estimation",
    "section": "What to do then? An overview",
    "text": "What to do then? An overview\nWhen there is a staggered adoption design, i.e., groups of entities receive treatments in a staggered way, there are a few modified DiD approaches that try to produce ATT estimates robust to the bias. But the key idea is to avoid including as controls the entities that have been previously treated, then find a good way to aggregate the many estimates as a result of multiple events. Here I discuss two approaches, namely stacked DiD and CS DiD.\nStacked DiD tries to solves the issue by essentially “selecting only good controls”. Specifically, for each treatment event, we construct a cohort of treated and untreated entities, where the “untreated” are those never treated and/or those not yet treated by any prior treatment. Cohorts are then stacked together in regression. To my knowledge, Gormley and Matsa (2011) and Gormley, Matsa, and Milbourn (2013) already use a stacked DiD. Some later papers using stacked DiD include, for example, Cengiz et al. (2019), Deshpande and Li (2019), among many others.\nCS DiD (Callaway and Sant’Anna 2021) groups entities by their treatment time and estimates each group’s ATT at each time period since its treatment to the end of the sample period, also using never treated entities or those not yet treated. The many group-time ATTs are then aggregated to various levels for understanding the treatment effect. As at August 2023, CS DiD has already been cited over 3,000 times based on Google Scholar."
  },
  {
    "objectID": "posts/difference-in-differences/index.html#stacked-did",
    "href": "posts/difference-in-differences/index.html#stacked-did",
    "title": "Difference-in-Differences Estimation",
    "section": "Stacked DiD",
    "text": "Stacked DiD\nCentre to stacked DiD is the idea of building cohorts of clean \\(2\\times2\\) DiD pairs, within each the entities used as controls are guaranteed to be not treated previously.\n\nFor a stacked DiD, we estimate a regression specification like below:\n\\[\n\\begin{equation}\n    Y_{ict} = \\beta_0 + \\beta_1 {Treat_{ic}\\times Post_{ct}} + \\beta_2 Treat_{ic} + \\beta_3 Post_{ct} + \\varepsilon_{ict}\n\\end{equation}\n\\]\nwhere\n\n\\(Treat_{ic}\\) is an indicator that equals 1 if entity \\(i\\) in cohort \\(c\\) is treated.\n\\(Post_{ct}\\) is an indicator that equals 1 if time period \\(t\\) in cohort \\(c\\) is after treatment event.\n\nAlternatively and preferably (?), replace \\(Treat_{ci}\\) and \\(Post_{ct}\\) with cohort-entity fixed effect \\(\\gamma_{ic}\\) and cohort-time fixed effect \\(\\theta_{ct}\\):\n\\[\n\\begin{equation}\n    Y_{ict} = \\beta D_{ict} + \\theta_{ct} + \\gamma_{ic} + \\varepsilon_{ict}\n\\end{equation}\n\\]\nwhere \\(D_{ict}\\equiv Treat_{ic}\\times Post_{ct}\\) is an indicator that equals 1 if entity \\(i\\) in cohort \\(c\\) has been treated at time \\(t\\).\n:: {.callout-note title=“Comparison with one-period TWFE”} Easy to notice that Equation (3) is very similar to Equation (1). Instead of using an entity-time level indicator \\(D_{it}\\) in TWFE Equation (1) to estimate ATT, stacked DiD uses an entity-cohort-time level indicator \\(D_{ict}\\). Time and entity fixed effects are also allowed to vary across cohorts. :::\nStacked DiD effectively pool together ATT estimates from only good \\(2\\times2\\) DiD pairs, thereby avoiding the bias caused by simple TWFE when treatment events are staggered.\nStacked DiD by construction causes duplication of observations since an entity-time can be used as control in different cohorts, which means observations in the stacked dataset can be correlated. We need to use proper clustering to address it, usually done by clustering at the entity level.\nAn event-study form of stacked DiD can further help identifying the time-varying treatment effects. Specifically, we replace the cohort-time \\(Post_{ct}\\) indicator with a series of cohort-time dummy variables, e.g., \\(\\{..., d^{-2}_{ct}, d^{-1}_{ct}, d^{0}_{ct}, d^{1}_{ct}, d^{2}_{ct}, ... \\}\\), where \\(d^{\\tau}_{ct}=1\\) if time \\(t\\) in cohort \\(c\\) is \\(\\tau\\) periods after (or before, if negative) the treatment. So, we will have\n\\[\n\\begin{equation}\n    Y_{ict} = \\sum_{\\tau} \\beta_{\\tau} \\left(Treat_{ic}\\times d^{\\tau}_{ct}\\right)\n            + \\theta_{ct} + \\gamma_{ic} + \\varepsilon_{ict}\n\\end{equation}\n\\]\nThe estimates \\(\\{\\beta_{\\tau}\\}\\) can describe the time-varying treatment effect, i.e., the difference between treated and control in outcome \\(Y\\), \\(\\tau\\) periods after the treatment."
  },
  {
    "objectID": "posts/difference-in-differences/index.html#callaway_2021",
    "href": "posts/difference-in-differences/index.html#callaway_2021",
    "title": "Difference-in-Differences Estimation",
    "section": "Callaway and Sant’Anna (2021)",
    "text": "Callaway and Sant’Anna (2021)\nCallaway and Sant’Anna (2021) (CS) DiD groups entities by their treatment time and estimates each group’s ATT at each time since treatment to the end of the sample period, similarly using never treated (or not yet treated) as control.\n\nHow it works?\nIntuitively, ATT (Average Treatment effect on the Treated) is an expected difference between ^^the outcome if treated^^ \\(Y(1)\\) and ^^the outcome if untreated^^ \\(Y(0)\\), for the treated entities (\\(D=1\\)).\n\\[\nATT = \\mathbb{E} \\left[Y_{t}(1)-Y_{t}(0)\\right|D=1]\n\\]\nCS DiD builds a group-time ATT, the expected difference in ^^the outcome if treated in group \\(g\\)^^ \\(Y(g)\\) and ^^the outcome if untreated^^ \\(Y(0)\\), for the treated entities in group \\(g\\) (\\(G=g\\)).\n\\[\nATT(g,t) = \\mathbb{E} \\left[Y_{t}(g)-Y_{t}(0)\\right|G=g]\n\\]\nThis is the average effect of participating in the treatment for entities in group \\(g\\) at time period \\(t\\).\n\n\n\n\n\n\nExample\n\n\n\nIn the example above, we will have many group-time ATTs:\n\n2011 group: \\(ATT^{g=2011}_{t=2010}\\), \\(\\color{blue}ATT^{g=2011}_{t=2011}\\), \\(\\color{blue}ATT^{g=2011}_{t=2012}\\), \\(\\color{blue}ATT^{g=2011}_{t=2013}\\), \\(\\color{blue}ATT^{g=2011}_{t=2014}\\), and \\(\\color{blue}ATT^{g=2011}_{t=2015}\\).\n2013 group: \\(ATT^{g=2013}_{t=2010}\\), \\(ATT^{g=2013}_{t=2011}\\), \\(ATT^{g=2013}_{t=2012}\\), \\(\\color{blue}ATT^{g=2013}_{t=2013}\\), \\(\\color{blue}ATT^{g=2013}_{t=2015}\\), and \\(\\color{blue}ATT^{g=2013}_{t=2015}\\).\n\nThe blue-coloured ATTs are of interest to us to study the treatment effect. We can aggregate these ATTs by group \\(g\\), by calendar time \\(t\\), by relative time to events, or to a single overal measure of the treatment effect.\n\n\nWith the many group-time ATT estimates, CS DiD then proposes several aggregation ways to highlight treatment effect heterogeneity or to overall treatment effect parameters, enabling studies on:\n\nHow do average treatment effects vary with length of exposure to the treatment?\nHow do average treatment effects vary across groups?\nWhat is the cumulative average treatment effect of the policy across all groups until some time \\(\\tilde{t}\\)?\nWhat is a general-purpose summary of the ATT?\n\n\n\nA bit more details\nTo me, CS DiD and stacked DiD share some similarities.\nStacked DiD select “good controls” into groups. While it will create many duplicates, we may use propensity score matching (PSM) to mitigate the problem, which also helps with the parallel trend assumption (conditional on covariates).\nCS DiD does not select “good controls” into groups. Instead, CS DiD estimates group-time ATTs by aggregating the “before-after” differences of entities base on entities’ treatment status and their propensity to be treated in the group, etc. For example, the inverse-probability-weighting estimand for \\(ATT(g,t)\\) is given by\n\\[\n\\begin{equation}\n    ATT(g,t) = \\mathbb{E} \\left[\\underbrace{\\left(\\frac{G_g}{\\mathbb{E}(G_g)}-\\frac{P_g}{\\mathbb{E}(P_g)}\\right)}_{\\text{weight}} \\times \\underbrace{(Y_t-Y_{g-1})}_{\\text{before-after diff}}\\right]\n\\end{equation}\n\\]\nwhere \\(P_g\\equiv\\frac{p_g(X)C}{1-p_g(X)C}\\) is like a propensity score ratio; \\(p_g(X)\\) is the propensity score of an entity being treated at the time defined by group \\(g\\), conditional on the pre-event covariates \\(X\\); \\(C=1\\) if an entity does not participate in the treatment and zero otherwise; \\(G_g=1\\) if an entity is in group \\(g\\) (i.e., treated at the time defined by group \\(g\\)) and zero otherwise.3\n3 In comparison, a TWFE DiD aggregates the “before-after” differences by giving a weight of +1 to treated entities and -1 to controls."
  },
  {
    "objectID": "posts/difference-in-differences/index.html#how-do-they-compare",
    "href": "posts/difference-in-differences/index.html#how-do-they-compare",
    "title": "Difference-in-Differences Estimation",
    "section": "How do they compare?",
    "text": "How do they compare?\n\n\n\n\n\n\nWarning\n\n\n\nThis is NOT a comprehensive test in terms of their performance. The stacked DiD code is written in a few minutes and so may contain errors.\n\n\nThe Stata -csdid- command comes very handy. I’m to use its help file and demo dataset to do some quick showcases.\n\nCS DiD\nuse https://friosavila.github.io/playingwithstata/drdid/mpdta.dta, clear\n\ncsdid lemp, ivar(countyreal) time(year) gvar(first_treat) method(dripw) wboot rseed(1) agg(simple)\nThe output is:\n............\nDifference-in-difference with Multiple Time Periods\n\n                                                         Number of obs = 2,500\nOutcome model  : least squares\nTreatment model: inverse probability\n---------------------------------------------------------------------\n            | Coefficient  Std. err.      t      [95% conf. interval]\n------------+--------------------------------------------------------\n        ATT |  -.0399513   .0121272    -3.29    -.0647386    -.015164\n---------------------------------------------------------------------\nControl: Never Treated\n\nSee Callaway and Sant'Anna (2021) for details\n\n\n\n\n\n\nAdditional results\n\n\n\n. estat all\nTest will be based on asymptotic VCoV\nIf you want aggregations based on WB, use option saverif() ad csdid_stats\nPretrend Test. H0 All Pre-treatment are equal to 0\nchi2(5) =     7.7912\np-value  =     0.1681\nAverage Treatment Effect on Treated\n------------------------------------------------------------------------------\n            | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        ATT |  -.0399513    .012034    -3.32   0.001    -.0635375    -.016365\n------------------------------------------------------------------------------\nATT by group\n------------------------------------------------------------------------------\n            | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n    GAverage |  -.0310183   .0123872    -2.50   0.012    -.0552967   -.0067399\n    G2004 |  -.0797491   .0263678    -3.02   0.002    -.1314291   -.0280692\n    G2006 |  -.0229095   .0167033    -1.37   0.170    -.0556475    .0098284\n    G2007 |  -.0260544   .0166554    -1.56   0.118    -.0586985    .0065896\n------------------------------------------------------------------------------\nATT by Calendar Period\n------------------------------------------------------------------------------\n            | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n    CAverage |  -.0417004   .0159719    -2.61   0.009    -.0730047   -.0103962\n    T2004 |  -.0105032    .023251    -0.45   0.651    -.0560744    .0350679\n    T2005 |  -.0704232   .0309848    -2.27   0.023    -.1311522   -.0096941\n    T2006 |   -.048816   .0201259    -2.43   0.015    -.0882619     -.00937\n    T2007 |  -.0370593   .0137471    -2.70   0.007    -.0640031   -.0101156\n------------------------------------------------------------------------------\nATT by Periods Before and After treatment\nEvent Study:Dynamic effects\n------------------------------------------------------------------------------\n            | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n    Pre_avg |   .0018283    .007657     0.24   0.811    -.0131791    .0168357\n    Post_avg |  -.0772398    .019965    -3.87   0.000    -.1163705   -.0381092\n        Tm3 |   .0305067   .0150336     2.03   0.042     .0010414    .0599719\n        Tm2 |  -.0005631   .0132916    -0.04   0.966    -.0266142    .0254881\n        Tm1 |  -.0244587   .0142364    -1.72   0.086    -.0523616    .0034441\n        Tp0 |  -.0199318   .0118264    -1.69   0.092    -.0431111    .0032474\n        Tp1 |  -.0509574   .0168935    -3.02   0.003     -.084068   -.0178468\n        Tp2 |  -.1372587   .0364357    -3.77   0.000    -.2086713   -.0658461\n        Tp3 |  -.1008114   .0343592    -2.93   0.003    -.1681542   -.0334685\n------------------------------------------------------------------------------\n\n\n\n\nStacked DiD\nFor stacked DiD, I use the following code.\nframe copy default events, replace\nframe change events\n\nkeep first_treat \nkeep if first_treat != 0\nduplicates drop\nsort first_treat\ndi \"3 events in 2004, 2006, 2007 respectively\"\n\ncap frame drop did\nmkf did\n\n// for each event, build a cohort\nforeach c of numlist 2004 2006 2007 {\n    di \"Building cohort `c'\"\n    keep if first_treat == `c'\n    di \"Treated\"\n    frame default {\n        preserve\n        keep if first_treat == `c'\n        tempfile treated\n        save `treated'\n        restore\n    }\n    di \"Controls (never treated)\"\n    frame default {\n        preserve\n        keep if (first_treat == 0)\n        replace treat = 0\n        tempfile untreated\n        save `untreated'\n        restore\n    }\n    di \"Add to DID frame\"\n    preserve\n    clear\n    append using `treated'\n    append using `untreated'\n    gen cohort_id = `c'\n    tempfile cohort\n    save `cohort'\n    frame did: append using `cohort'\n    restore\n}\n\ncwf did\n\ngen post = year&gt;=cohort_id\n\nreghdfe lemp c.treat#c.post, a(cohort_id#countyreal cohort_id#year) vce(cluster countyreal) noconst\nThe output is:\n(MWFE estimator converged in 2 iterations)\n\nHDFE Linear regression                            Number of obs   =      5,590\nAbsorbing 2 HDFE groups                           F(   1,    499) =       7.86\nStatistics robust to heteroskedasticity           Prob &gt; F        =     0.0052\n                                                  R-squared       =     0.9928\n                                                  Adj R-squared   =     0.9909\n                                                  Within R-sq.    =     0.0024\nNumber of clusters (countyreal) =        500      Root MSE        =     0.1434\n\n                             (Std. err. adjusted for 500 clusters in countyreal)\n--------------------------------------------------------------------------------\n               |               Robust\n          lemp | Coefficient  std. err.      t    P&gt;|t|     [95% conf. interval]\n---------------+----------------------------------------------------------------\nc.treat#c.post |  -.0406496   .0144972    -2.80   0.005    -.0691327   -.0121665\n--------------------------------------------------------------------------------\n\nAbsorbed degrees of freedom:\n----------------------------------------------------------------+\n            Absorbed FE | Categories  - Redundant  = Num. Coefs |\n------------------------+---------------------------------------|\n   cohort_id#countyreal |      1118        1118           0    *|\n         cohort_id#year |        15           0          15     |\n----------------------------------------------------------------+\n* = FE nested within cluster; treated as redundant for DoF computation\n\n\n\n\n\n\nAdditional results\n\n\n\nFor the treatment effect dynamics, I generate cohort-year relative time dummies:\ngen Tm3 = year-cohort_id==-3\ngen Tm2 = year-cohort_id==-2\ngen Tm1 = year-cohort_id==-1\ngen Tp0 = year-cohort_id==0\ngen Tp1 = year-cohort_id==1\ngen Tp2 = year-cohort_id==2\ngen Tp3 = year-cohort_id==3\n\nreghdfe lemp c.treat#c.(Tm3 Tm2 Tm1 Tp0-Tp3), a(cohort_id#countyreal cohort_id#year) vce(cluster countyreal) noconst\nThe output is:\n(MWFE estimator converged in 2 iterations)\n\nHDFE Linear regression                            Number of obs   =      5,590\nAbsorbing 2 HDFE groups                           F(   7,    499) =       3.69\nStatistics robust to heteroskedasticity           Prob &gt; F        =     0.0007\n                                                  R-squared       =     0.9928\n                                                  Adj R-squared   =     0.9909\n                                                  Within R-sq.    =     0.0050\nNumber of clusters (countyreal) =        500      Root MSE        =     0.1433\n\n                            (Std. err. adjusted for 500 clusters in countyreal)\n-------------------------------------------------------------------------------\n              |               Robust\n         lemp | Coefficient  std. err.      t    P&gt;|t|     [95% conf. interval]\n--------------+----------------------------------------------------------------\nc.treat#c.Tm3 |   .0224458   .0149578     1.50   0.134    -.0069423    .0518339\n              |\nc.treat#c.Tm2 |   .0222899    .019004     1.17   0.241    -.0150478    .0596276\n              |\nc.treat#c.Tm1 |  -.0001288   .0225506    -0.01   0.995    -.0444347    .0441771\n              |\nc.treat#c.Tp0 |  -.0189866   .0250632    -0.76   0.449    -.0682289    .0302557\n              |\nc.treat#c.Tp1 |  -.0460793   .0288162    -1.60   0.110    -.1026953    .0105367\n              |\nc.treat#c.Tp2 |  -.1320149   .0398577    -3.31   0.001    -.2103245   -.0537052\n              |\nc.treat#c.Tp3 |  -.0955675   .0420647    -2.27   0.024    -.1782132   -.0129217\n-------------------------------------------------------------------------------\n\nAbsorbed degrees of freedom:\n----------------------------------------------------------------+\n            Absorbed FE | Categories  - Redundant  = Num. Coefs |\n------------------------+---------------------------------------|\n   cohort_id#countyreal |      1118        1118           0    *|\n         cohort_id#year |        15           0          15     |\n----------------------------------------------------------------+\n* = FE nested within cluster; treated as redundant for DoF computation\n\n\nThis non-technical note aims to remind me of the big picture of DiDs. It’s not intended to give full explanation of the econometrics. I strongly suggest a reading of the related links for a better understanding of CS DiD."
  },
  {
    "objectID": "posts/decomposing-hhi-index/index.html",
    "href": "posts/decomposing-hhi-index/index.html",
    "title": "Decomposing Herfindahl–Hirschman (HHI) Index",
    "section": "",
    "text": "Herfindahl–Hirschman (HHI) Index is a well-known market concentration measure determined by two factors:\nIntuitively, having a hundred similar-sized gas stations in town means a far less concentrated environment than just one or two available, and when the number of firms is constant, their size distribution or variance determines the magnitude of market concentration.\nSince these two properties jointly determine the HHI measure of concentration, naturally we want a decomposition of HHI that can reflects these two dimensions respectively. This is particularly useful when two distinct markets have the same level of HHI measure, but the concentration may result from different sources. Note that here these two markets do not necessarily have to be industry A versus industry B, but can be the same industry niche in two geographical areas, for example.\nThus, we can think of HHI as the sum of the actual market state’s deviation from 1) all firms having the same size, and the deviation from 2) a fully competitive environment with infinite number of firms in the market. Some simple math can solve our problem."
  },
  {
    "objectID": "posts/decomposing-hhi-index/index.html#some-math",
    "href": "posts/decomposing-hhi-index/index.html#some-math",
    "title": "Decomposing Herfindahl–Hirschman (HHI) Index",
    "section": "Some math",
    "text": "Some math\nLet’s say in a market ther are \\(n\\) firms sized \\(x_1, x_2, ... x_n\\), thus we can describe the market using a \\(\\mathbb R_+^n\\) vector:\n\\[\n\\mathbf{x}=(x_1, x_2, ... x_n)\n\\]\nIn the first scenario where all firms’ sizes are equal, we can describe it with:\n\\[\n\\mathbf{\\bar{x}}=(\\bar{x}, \\bar{x}, ... \\bar{x})\n\\]\nwhere \\(\\bar{x}=\\frac{1}{n} \\sum_{i=1}^{n}x_i\\) is the average firm size.\nThe Euclidean distance between the point \\(\\mathbf{x}\\) and \\(\\mathbf{\\bar{x}}\\), denoted as \\(d(\\mathbf{x}, \\mathbf{\\bar{x}})\\), is thus\n\\[\nd(\\mathbf{x}, \\mathbf{\\bar{x}})=\\sqrt{ \\sum_{i=1}^{n} x_{i}^2 - n \\bar{x}^2 }\n\\]\nFor the ease of discussion, let’s consider the other spectrum of the second scenario where there’s only one firm in the market instead of infinite firms, assuming its size is the sum of all firms in the first scenario (i.e. its size is \\(n\\bar{x}\\)), we know that this market is the most concentrated state, \\(\\mathbf{x^*}\\). In other words, its distance to the market state in scenario one is the largest.\n\\[\n\\max_{x} d(\\mathbf{x}, \\mathbf{\\bar{x}})=d(\\mathbf{x^*}, \\mathbf{\\bar{x}}) =\n... = \\sqrt{ (n-1)n \\bar{x}^2 }\n\\]\nHence, the distance of any market state \\(\\mathbf{x}\\) to the first scenario, the equidistribution point \\(\\mathbf{\\bar{x}}\\), should lie between \\(0\\) to \\(d(\\mathbf{x^*}, \\mathbf{\\bar{x}})\\).\nThus we can derive a relative index of concentration (when \\(n&gt;1\\)) as \\(\\tau\\):\n\\[\n\\tau=\\frac{ d(\\mathbf{x}, \\mathbf{\\bar{x}}) }{ d(\\mathbf{x^*},\n\\mathbf{\\bar{x}}) } \\in [0, 1]\n\\]\nNow, given the definition of Herfindahl-Hirschman Index \\(H\\) that\n\\[\nH=\\sum_{i=1}^{n} (\\frac{x_i}{n\\bar{x}})^2\n\\]\nwe can get:\n\\[\n\\tau=\\sqrt{\\frac{n}{n-1}(H-\\frac{1}{n})} = \\sqrt{\\frac{nH-1}{n-1}}\n\\]\nHere comes the important implications. Recall that \\(\\tau\\) represents the ratio of the distance between a market state and the equidistribution point to the maximum possible distance given a total market size of \\(n\\bar{x}\\).\nWhen we observe a market state \\(\\mathbf{x}=(x_1, x_2, ... x_n)\\) at a given time, the total market size is fixed and thus \\(\\tau\\) is only varying with the distance between the observed actual market state and the equidistribution state where all firms have the same size. This implies that \\(\\tau\\) could be a measure of the first determinant of market concentration, i.e. the size distribution (variance) of firms.\nFurther, \\(\\tau\\) represents a sequence of functions whose limit is \\(\\sqrt{H}\\) as \\(n \\to +\\infty\\), when the market is in a fully competitive environment. Thus, given a \\(H'\\) from the knowledge of \\(n'\\) and \\(\\mathbf{x'}\\), we know there is one and only one matching \\(\\tau'\\) and its limit of \\(\\sqrt{H'}\\) in the fully competitive environment.\nThe graph below shows that \\(H\\) can therefore be decomposed into two components, that is\n\\[\nH = E_i + E_n\n\\]\nwhere \\(E_i = \\tau^2\\), and \\(E_n = H-\\tau^2\\).\nWe mentioned before that \\(\\tau\\) can be measure of the market concentration resulted from the size distribution (variance) of firms, such that \\(E_i=\\tau^2\\) can be an even better one since it’s smaller than \\(H\\), which enables us to measure the concentration contributed from the number of firms, measured by \\(E_n\\).\n\nThis decomposition is appealing also in that \\(E_n\\), from the graph above, effectively is the horizontal difference between the two curves, i.e. the ‘distance’ between the actual market state and the fully competitive market with infinite number of firms (scenario two).\nThus, it’s safe to say this decomposition produces two components explaining the observed market concentration, 1) \\(E_i\\), the inequality of firm sizes effect, and 2) \\(E_n\\), the number of firms effect.\nAnother finding from the graph is that with higher market concentration measured by \\(H\\), the relative importance of the two components is changing.\n\nWhen \\(H\\) is small, most of the concentration is resulted from \\(E_n\\) as highlighted below, which means the number of firms has a greater impact on market concentration.\nWhen \\(H\\) is larger, on the other hand, \\(E_i\\) contributes more to \\(H\\), which means the firm size inequality plays a bigger role in market concentration.\n\n\nA potential implication for regulators who are concerned about market concentration, I think, is to 1) focus more on reducing the entry barrier if the current concentration level is moderate, and to 2) focus more on antitrust if the concentration level is already high.\nAnother implication for researchers is that even though \\(H \\in [\\frac{1}{n}, 1]\\) is affected by the number of firms in a market, we should not attempt to use the \\(\\text{normalized HHI}=\\frac{H-1/n}{1-1/n} \\in [0,1]\\). The reason is now very simple and clear – the normalized HHI is nothing but \\(E_i=\\tau^2\\), which reflects only the market concentration due to the inequality of firm sizes. When we compare across markets or the same market over time, apparently a market with 1,000 firms has a different competitive landscape than a market with only 2 firms."
  },
  {
    "objectID": "posts/decomposing-hhi-index/index.html#acknowledgement",
    "href": "posts/decomposing-hhi-index/index.html#acknowledgement",
    "title": "Decomposing Herfindahl–Hirschman (HHI) Index",
    "section": "Acknowledgement",
    "text": "Acknowledgement\nThis post is largely a replicate of the paper “A Decomposition of the Herfindahl Index of Concentration” by Giacomo de Gioia in 2017."
  },
  {
    "objectID": "posts/correlated-random-effects/index.html",
    "href": "posts/correlated-random-effects/index.html",
    "title": "Correlated Random Effects",
    "section": "",
    "text": "Can we estimate the coefficient of gender while controlling for individual fixed effects? This sounds impossible as an individual’s gender typically does not vary and hence would be absorbed by individual fixed effects. However, Correlated Random Effects (CRE) may actually help.\nAt last year’s FMA Annual Meeting, I learned this CRE estimation technique when discussing a paper titled “Gender Gap in Returns to Publications” by Piotr Spiewanowski, Ivan Stetsyuk and Oleksandr Talavera. Let me recollect my memory and summarize the technique in this post."
  },
  {
    "objectID": "posts/correlated-random-effects/index.html#random-intercept-effect-model",
    "href": "posts/correlated-random-effects/index.html#random-intercept-effect-model",
    "title": "Correlated Random Effects",
    "section": "Random Intercept (Effect) Model",
    "text": "Random Intercept (Effect) Model\nConsider a random intercept model for a firm-year regression, e.g., to examine the relationship between firm performance, R&D expense, and whether the firm is VC-backed,\n\\[\n\\begin{equation}\n\\label{eq:random_effect_model}\ny_{it} = \\beta_0 + \\beta_1 x_{it} + \\beta_2 c_i + \\mu_i + \\varepsilon_{it}\n\\end{equation}\n\\tag{1}\\]\nwhere,\n\n\\(y_{it}\\) is firm-year level outcome variable, e.g., firm ROA\n\\(x_{it}\\) is firm-year level independent variable, e.g., firm R&D expense\n\\(c_i\\) is an time-invariant firm-level variable, e.g., if the firm is VC-backed\n\\(\\mu_i\\) is firm-level error and random intercept to capture the unobserved, time-invariant factors\n\\(\\varepsilon_{it}\\) is firm-year level error, assumed to be white noise and ignored in this post\n\nWe can estimate \\(\\beta_0\\), \\(\\beta_1\\), \\(\\beta_2\\) and \\(\\mu_i\\). Assuming that we’ve properly controlled for observable firm characteristics, \\(\\beta_1\\) tells the relationship between R&D expenditure and firm performance. \\(\\beta_2\\) tells the difference in firm performance between VC-backed and non-VC-backed firms.\nHowever, we cannot rely on \\(\\beta_2\\) to assert whether VC-back firms have better or worse performance. The drawback here is that we are unable to exhaustively control for all other time-invariant firm attributes that correlate with both firm performance and VC investment, thereby leading to biased \\(\\beta_2\\) estimate due to omitted variables.\nSimilarly, our estimate of \\(\\beta_1\\) may also be biased if some omitted firm-specific and time-invariant attributes correlate with both R&D expenditure and firm performance."
  },
  {
    "objectID": "posts/correlated-random-effects/index.html#fixed-effect-model",
    "href": "posts/correlated-random-effects/index.html#fixed-effect-model",
    "title": "Correlated Random Effects",
    "section": "Fixed Effect Model",
    "text": "Fixed Effect Model\nIf we subtract the “between” model\n\\[\n\\begin{equation}\n\\label{eq:between_model}\n\\bar{y}_{i} = \\beta_0 + \\beta_1 \\bar{x}_{it} + \\beta_2 c_i + \\mu_i + \\bar{\\varepsilon}_{i}\n\\end{equation}\n\\tag{2}\\]\nfrom Equation Equation 1, we have the fixed effect model in the demeaned form:\n\\[\n\\begin{equation}\n\\label{eq:demeaned_form}\n(y_{it} - \\bar{y}_i) = \\beta_1 (x_{it}-\\bar{x}_i) + (\\varepsilon_{it} - \\bar{\\varepsilon}_{i})\n\\end{equation}\n\\tag{3}\\]\nThe fixed effect model above removes the firm-level error \\(\\mu_i\\) so that the within effect (or fixed effect) estimate of \\(\\beta_1\\) is unbiased even if \\(E(\\mu_i|x_{it}) \\ne 0\\). This helps a lot and is why most of the time we control for firm fixed effects when estimating firm-year regressions.\nHowever, the firm-level variable \\(c_i\\) is also removed. It is now impossible to estimate \\(\\beta_2\\) as in the random intercept model. In fact, we can no longer estimate the effect of any firm-level time-invariant attributes after controlling for firm fixed effects."
  },
  {
    "objectID": "posts/correlated-random-effects/index.html#hybrid-model",
    "href": "posts/correlated-random-effects/index.html#hybrid-model",
    "title": "Correlated Random Effects",
    "section": "Hybrid Model",
    "text": "Hybrid Model\nSo, how to estimate both \\(\\beta_2\\) when firm fixed effects are controlled for?\nThe same question, if paraphrased differently, is how to estimate the within effect in a random intercept model.\nInterestingly, we can decompose the firm-year level variable \\(x_{it}\\) into two components, a between component \\(\\bar{x}_i\\) and a cluster component \\((x_{it}-\\bar{x}_i)\\), so that\n\\[\n\\begin{equation}\n\\label{eq:hybrid}\ny_{it} = \\beta_0 + \\beta_1 (x_{it}-\\bar{x}_i) + \\beta_2 c_i + \\beta_3 \\bar{x}_i + \\mu_i + \\varepsilon_{it}\n\\end{equation}\n\\tag{4}\\]\nIt is apparent that the \\(\\beta_1\\) estimate gives the within effect as in the fixed effect model, identical to \\(\\beta_1\\) in Equation 3.\nMoreover, the firm-level variable \\(c_i\\) is kept in the model and we can estimate \\(\\beta_2\\). The inclusion of cluster mean \\(\\bar{x}_i\\) corrects the estimate of \\(\\beta_2\\) for between-cluster differences in \\(x_{it}\\). Note that, however, for \\(\\beta_2\\) estimate to be unbiased, we still require \\(E(\\mu_i|x_{it},c_i)=0\\) and \\(\\mu_i|x_{it},c_i \\sim N(0,\\sigma^2_\\mu)\\)."
  },
  {
    "objectID": "posts/correlated-random-effects/index.html#correlated-random-effect-model",
    "href": "posts/correlated-random-effects/index.html#correlated-random-effect-model",
    "title": "Correlated Random Effects",
    "section": "Correlated Random Effect Model",
    "text": "Correlated Random Effect Model\nA related model is correlated random effect model (Wooldridge 2010) that relaxes the assumption of zero correlation between the firm-level error \\(\\mu_i\\) and firm-year variable \\(x_{it}\\).\nSpecifically, it assumes that \\(\\mu_i=\\pi\\bar{x}_i + v_i\\), so Equation 1 becomes\n\\[\n\\begin{align}\ny_{it} &= \\beta_0 + \\beta_1 x_{it} + \\beta_2 c_i + \\mu_i + \\varepsilon_{it} \\\\\n&= \\beta_0 + \\beta_1 x_{it} + \\beta_2 c_i + \\pi\\bar{x}_i + v_i + \\varepsilon_{it}\n\\end{align}\n\\]\nBy including the cluster mean \\(\\bar{x}_i\\), we can account for the correlation between the random effects \\(\\mu_i\\) and the independent variable \\(x_{it}\\) and obtain consistent estimates of the coefficients. The inclusion of \\(\\bar{x}_i\\) in the random intercept (effect) model makes the estimate for \\(\\beta_1\\) the same within effect (fixed-effect) estimate as in Equation 4.\nOf course, as the time-invariant firm-specific attribute \\(c_i\\) remains in the model, we can estimate \\(\\beta_2\\) as in the hybrid model."
  },
  {
    "objectID": "posts/correlated-random-effects/index.html#estimation",
    "href": "posts/correlated-random-effects/index.html#estimation",
    "title": "Correlated Random Effects",
    "section": "Estimation",
    "text": "Estimation\nNote that there are many caveats for estimating CRE.\nTo be discussed."
  },
  {
    "objectID": "posts/correlated-random-effects/index.html#further-readings",
    "href": "posts/correlated-random-effects/index.html#further-readings",
    "title": "Correlated Random Effects",
    "section": "Further Readings",
    "text": "Further Readings\nThis post is based on Within and between Estimates in Random-Effects Models: Advantages and Drawbacks of Correlated Random Effects and Hybrid Models.\nSome other suggested readings include:\n\nCorrelated random effects models with unbalanced panels.\nFitting and Interpreting Correlated Random-coefficient Models Using Stata.\nA correlated random effects approach to the estimation of models with multiple fixed effects."
  },
  {
    "objectID": "posts/compute-weekly-return-from-daily-crsp-data/index.html",
    "href": "posts/compute-weekly-return-from-daily-crsp-data/index.html",
    "title": "Compute Weekly Return from Daily CRSP Data",
    "section": "",
    "text": "Computing the weekly returns from the CRSP daily stock data is a common task but may be tricky sometimes. Let’s discuss a few different ways to get it done incorrectly and correctly."
  },
  {
    "objectID": "posts/compute-weekly-return-from-daily-crsp-data/index.html#incorrect-ways",
    "href": "posts/compute-weekly-return-from-daily-crsp-data/index.html#incorrect-ways",
    "title": "Compute Weekly Return from Daily CRSP Data",
    "section": "INCORRECT ways",
    "text": "INCORRECT ways\nLet me start with a few incorrect ways, which may seem perfectly okay at first glance. This part is important because it shows you how a small mistake can lead to hard-to-discover bugs.\n\nWeekly index return from daily data\n\nDate as the Friday of the weekDate as the last trading day of the week\n\n\nUsing intnx(), we can derive the Friday of the week given a date, as shown below.\nproc sql;\n/* Compute weekly marekt return from daily data */\ncreate table mktret_weekly as \nselect distinct date, \n  year(date) as Year,\n  week(date) as Week,\n  case when weekday(date)=6 then date\n  else intnx(\"week.6\",date,1) end as FridayOfWeek format=date9.,\n  (exp(sum(log(1+sprtrn)))-1)*100 as mktret label=\"Weekly SP500 Index Return (%)\"\nfrom crsp.dsi \nwhere \n  year(date) between &startyear. and &endyear.\ngroup by year(date), week(date) order by date;\nquit;\nNote that intnx(\"weekday.6\", date, 0) will give the last Friday, which is not what we want. We want the next Friday of the week for a given date, so we use intnx(\"weekday.6\", date, 1). The case...when... statement ensures that if the given date is already a Friday, we don’t go for the next one. Below is a sample output of the mktret_weekly table generated.\n\n\n\n\n\n\nExample output of mktret_weekly\n\n\n\n\n\n\n\n\nObs\nDate\nYear\nWeek\nFridayOfWeek\nmktret\n\n\n\n\n1\n19860102\n1986\n0\n03JAN1986\n-0.1893222\n\n\n2\n19860103\n1986\n0\n03JAN1986\n-0.1893222\n\n\n3\n19860106\n1986\n1\n10JAN1986\n-2.333080418\n\n\n4\n19860107\n1986\n1\n10JAN1986\n-2.333080418\n\n\n5\n19860108\n1986\n1\n10JAN1986\n-2.333080418\n\n\n6\n19860109\n1986\n1\n10JAN1986\n-2.333080418\n\n\n7\n19860110\n1986\n1\n10JAN1986\n-2.333080418\n\n\n8\n19860113\n1986\n2\n17JAN1986\n1.1992620931\n\n\n9\n19860114\n1986\n2\n17JAN1986\n1.1992620931\n\n\n\n\n\n\nWe can verify that the FridayOfWeek indeed gives the Friday of the week. Therefore, the final weekly dataset using Friday as the date identifier just need to keep FridayOfWeek and mktret.\nproc sql;\n/* Compute weekly marekt return from daily data */\ncreate table mktret_weekly as \nselect distinct\n  case when weekday(date)=6 then date else intnx(\"week.6\",date,1) end \n    as date format=date9. label=\"Friday of the Week\",\n  (exp(sum(log(1+sprtrn)))-1)*100 \n    as mktret label=\"Weekly SP500 Index Return (%)\"\nfrom crsp.dsi \nwhere \n  year(date) between &startyear. and &endyear.\ngroup by year(date), week(date) order by date;\nquit;\n\n\n\n\n\n\nExample output of mktret_weekly\n\n\n\n\n\n\n\n\nObs\ndate\nmktret\n\n\n\n\n1\n03JAN1986\n-0.1893222\n\n\n2\n10JAN1986\n-2.333080418\n\n\n3\n17JAN1986\n1.1992620931\n\n\n4\n24JAN1986\n-0.959555101\n\n\n5\n31JAN1986\n2.5916781551\n\n\n6\n07FEB1986\n1.3126828796\n\n\n\n\n\n\n\n\n%let startyear=1986;\n%let endyear=2019;\n\nproc sql;\n/* Compute weekly marekt return from daily data */\ncreate table mktret_weekly as \nselect distinct date, \n  (exp(sum(log(1+sprtrn)))-1)*100 as mktret label=\"Weekly SP500 Index Return (%)\"\nfrom crsp.dsi where year(date) between &startyear. and &endyear. \ngroup by year(date), week(date) \nhaving date=max(date) \norder by date;\nquit;\nNote here that it’s tempting to use having weekday(date)=6 to make sure the dates are all Friday. However, if Friday in a week is not the last trading day, then the weekly return will be missing. This is why here I use date=max(date) to ensure non-missing weekly returns. The date is the last trading day in any given week, consistent with the CRSP’s daily stock file.\nThe caveat here is that since the dates are the weekly last trading days, when merged with other weekly datasets, you should be very careful about whether the other dataset is using Friday or the last trading day per week as its date variable.\n\n\n\n\n\nWeekly stock return from daily data\nFollowing the same logic, we can calculate the weekly stock returns from daily CRSP data, where dates are aligned to the Friday of the week.\nproc sql;\n/* Stocks (ordinary shares only) in the financial sector */\ncreate table stocks as select distinct permno from crsp.stocknames\nwhere shrcd in (10, 11) and floor(siccd/100) between 60 and 67;\n\ncreate table stockrets_weekly as \nselect distinct permno,\n  case when weekday(date)=6 then date else intnx(\"week.6\",date,1) end \n    as date format=date9. label=\"Friday of the Week\",\n  (exp(sum(log(1+ret)))-1)*100 as ret label=\"Weekly Return (%)\"\nfrom crsp.dsf \nwhere \n  year(date) between &startyear. and &endyear.\n  and permno in (select * from stocks) \n  and prc&gt;0 and not missing(ret)\ngroup by year(date), week(date), permno order by permno, date;\nquit;\n\n\nWhat’s wrong?\nThe code above seems okay. We know that CRSP daily stock file contains many observations where the daily trading volume is 0, in which case the price is recorded as the negative bid-ask midpoint. Therefore, we restrict to only those with positive stock prices. So what’s the problem?\n\n\n\n\n\n\nThe problem is that a week can span two calendar years.\n\n\n\n\n\n\nFor example, check out the last week of 2019:\n\n\n\nMon\nTue\nWed\nThu\nFri\nSat\nSun\n\n\n\n\n30\n31\n1\n2\n3\n4\n5\n\n\n\n\nDec30 and Dec31 belong to week 53 of 2019, while the code above will use these two days’ returns to compute the weekly return and align the date to Jan03 of\n\n\n\nJan01 to Jan03 belong to week 0 of 2020, so the code above will use these three days’ returns to compute the weekly return and align the date to Jan03 of 2020.\n\nNow we have a mistake. A single week is broken into two because of the use of week() function in SAS. Another consequence is that when there’re many years of data, there will be a lot of duplicates."
  },
  {
    "objectID": "posts/compute-weekly-return-from-daily-crsp-data/index.html#correct-ways",
    "href": "posts/compute-weekly-return-from-daily-crsp-data/index.html#correct-ways",
    "title": "Compute Weekly Return from Daily CRSP Data",
    "section": "CORRECT ways",
    "text": "CORRECT ways\nNow let’s explore two ways that avoid this mistake. Although both generate the same result (there can be a few differences, see the caveat), the second one is much faster.\n\n1. Start with a list of dates (slow version)\nNow we can write some correct code to compute the weekly returns. We’ll generate a series of Fridays first, then we merge based on the past 5 calendar days. This will ensure all trading days with non-missing data will be included in the weekly return calculation, and correct the mistake mentioned above.\n%let start_date = 01Jan1986;\n%let end_date   = 31Dec2019;\n\n/* Generate a series of Fridays */\ndata fridays;\ndate=\"&start_date\"d;\ndo while (date&lt;=\"&end_date\"d);\n    if weekday(date)=6 then output;\n    date=intnx('day', date, 1, 's');\nend;\nformat date date9.;\nrun;\n\nWeekly index return from daily data (as at Friday)Weekly stock return from daily data (as at Friday)\n\n\nproc sql;\n/* Compute weekly index return from daily data */\ncreate table mktret_weekly as \nselect distinct a.date,\n  (exp(sum(log(1+sprtrn)))-1)*100 \n    as mktret label=\"Weekly SP500 Index Return (%)\"\nfrom fridays as a left join crsp.dsi as dsi\non dsi.date between intnx('day', a.date, -4) and a.date\ngroup by a.date\norder by a.date;\nquit;\n\n\nNote that this version is inefficient and takes a long time to run.\nproc sql;\n/* Stocks (ordinary shares) in the financial sector (2-digit SIC=60-67) */\ncreate table stocks as select distinct permno from crsp.stocknames\nwhere shrcd in (10, 11) and floor(siccd/100) between 60 and 67;\n\n/* Compute weekly stock return from daily data */\ncreate table stockrets_weekly as \nselect distinct a.date, dsf.permno, dsf.hsiccd,\n  (exp(sum(log(1+ret)))-1)*100 as ret label=\"Weekly Return (%)\"\nfrom fridays as a left join crsp.dsf as dsf\non dsf.date between intnx('day', a.date, -4) and a.date\n  and dsf.permno in (select * from stocks) \n  and dsf.prc&gt;0 and not missing(dsf.ret)\ngroup by dsf.permno, a.date\norder by dsf.permno, a.date;\nquit;\n\n\n\n\n\n2. Group using aligned dates (fast version with caveat)\nThis version uses a similar logic from the previous incorrect one, but it groups based on the aligned dates instead of year(date) and week(date).\nproc sql;\n/* Compute weekly stock return from daily data */\ncreate table stockrets_weekly2 as \nselect distinct permno, hsiccd,\n  case when weekday(date)=6 then date else intnx(\"week.6\",date,1) end \n    as date format=date9. label=\"Friday of the Week\",\n  (exp(sum(log(1+ret)))-1)*100 as ret label=\"Weekly Return (%)\"\nfrom crsp.dsf (keep=permno date ret prc shrout hsiccd)\nwhere \n  date between \"01Jan1986\"d and \"31Dec2019\"d\n  and permno in (select * from stocks) \n  and prc&gt;0 and not missing(ret)\ngroup by permno, calculated date order by permno, date;\nquit;\n\n\n\n\n\n\nCaveat\n\n\n\nIf the beginning and ending dates, \"01Jan1986\"d and \"31Dec2019\"d in the example, are not Fridays, then the first and last weekly returns for all stocks will be incorrect, because they are not using all the daily data in those weeks.\nTo fix this minor issue, simply extend the beginning and ending dates beyond your sample period by a few weeks."
  },
  {
    "objectID": "posts/centrifuge-problem/index.html",
    "href": "posts/centrifuge-problem/index.html",
    "title": "Centrifuge Problem",
    "section": "",
    "text": "Given a centrifuge with \\(n\\) holes, can we balance it with \\(k\\) (\\(1\\le k \\le n\\)) identical test tubes?\nThis is a simple yet interesting problem, very well illustrated by Numberphile and discussed by Matt Baker’s blog.\nThe now proved solution is that:\nBelow is my attempt to programmatically answer the centrifuge problem."
  },
  {
    "objectID": "posts/centrifuge-problem/index.html#method-1-naïve-dfs",
    "href": "posts/centrifuge-problem/index.html#method-1-naïve-dfs",
    "title": "Centrifuge Problem",
    "section": "Method 1: Naïve DFS",
    "text": "Method 1: Naïve DFS\nThe very first method literally follows the solution. For a given \\((n,k)\\) pair, check if \\(k\\) and \\(n-k\\) can be written as a linear combination of the prime divisors of \\(n\\) (with non-negative coefficients).\ndef is_linear_combination(x: int, prime_numbers: list) -&gt; bool:\n    \"\"\"Check if `x` can be written as a linear combination of prime numbers, i.e.,\n\n    x = b1*p1 + b2*p2 + b3*p3 + ... + bn*pn\n\n    where pi represents a prime number in `prime_numbers`, bi is a non-negative integer.\n    \"\"\"\n    # very naive and not optimized\n    for n in prime_numbers:\n        # n divides x \n        if x % n:\n            return True\n        # n does not divides x, check if the difference between x and multiples of n can be\n        # a linear combination of other remaining prime numbers\n        for i in range(x//n):\n            if is_linear_combination(x - i*n, [p for p in prime_numbers if p!=n]):\n                return True\n    return False \n\ndef centrifuge_naive(n: int, k: int) -&gt; bool:\n    \"\"\"Check if a `n`-hole centrifuge can be balanced with `k` identical test tubes.\n\n    True if both `k` and `n-k` can be written as a linear combination of the prime divisors of `n`.\n    \"\"\"\n    prime_divisors = get_prime_divisors(n) # simple cached function, skipped\n    return is_linear_combination(k, prime_divisors) and is_linear_combination(n-k, prime_divisors)\n\nSome Optimizations\nThe above method works just fine, but very slow if we want to compute the total number of solutions, instead of just checking whether a particular \\(k\\) works.\nThere can be a few optimizations, for example, we can compute only the lower half of \\(k\\)s:\nfrom functools import lru_cache\n\n@lru_cache(maxsize=None)\ndef centrifuge_naive(n: int, k: int) -&gt; bool:\n    prime_divisors = get_prime_divisors(n) # cached\n    if k &gt; n//2:\n        return centrifuge(n, n-k)\n    return is_linear_combination(k, prime_divisors) and is_linear_combination(n-k, prime_divisors)\nFurther, if \\(n\\) is a (large) prime number itself, we understand that all \\(1\\le k\\lt n\\) will not work. Similarly, if \\(n\\) is a power of prime number, we can bypass many values of \\(k\\) too.\n@lru_cache(maxsize=None)\ndef centrifuge_naive(n, k):\n    prime_divisors = get_prime_divisors(n)\n    # ...\n    # special case when n is power of prime\n    if len(prime_divisors) == 1:\n        p = prime_divisors[0]\n        return (k % p == 0) and ((n - k) % p == 0)\n    # ...\nAt certain point, we will realize that it would be faster to simply compute all possible \\(k\\)s instead of checking one by one whether a certain \\(k\\) can balance the centrifuge. This leads us to the second approach, which I call “bootstrap”."
  },
  {
    "objectID": "posts/centrifuge-problem/index.html#method-2-bootstrap",
    "href": "posts/centrifuge-problem/index.html#method-2-bootstrap",
    "title": "Centrifuge Problem",
    "section": "Method 2: Bootstrap",
    "text": "Method 2: Bootstrap\nThe bootstrap method is a variant of DFS, which essentially generates all possible \\(k\\) for a given \\(n\\) by exhausting the values from linear combinations of \\(n\\)’s prime divisors. The generated values should be between 2 and \\(n\\). Then we can tell if \\(k'\\) can balance the \\(n\\)-hole centrifuge by checking whether \\(k'\\) and \\(n-k'\\) are in the generated values.\ndef bootstrap(x, n, numbers, result):\n    \"\"\"Compute all linear combinations of the given numbers smaller than n\"\"\"\n    for p in numbers:\n        if p+x &gt; n:\n            break\n        for i in range((n-x) // p):\n            p_ = x + p * i # p_ &lt;= n\n            if not result[p_]:\n                # x + p*i has not been tested, and is a linear combination of given numbers \n                result[p_] = True\n                # check whether we can add multiples of remaining numbers\n                bootstrap(p_, n, [n2 for n2 in numbers if n2 != p], result)\n\ndef centrifuge_bootstrap(n: int, k: int) -&gt; bool:\n    prime_divisors = get_prime_divisors(n) # cached, `prime_divisors` is sorted\n    # result[k] represents whether k is valid, k=0...n\n    result = [True] + [False] * (n-1) + [True]\n    bootstrap(0, n, prime_divisors, result) # TODO: bootstrap only once for a given `n`\n    return result[k] and result[n-k]\nThis method invests some time in pre-computing all possible linear combinations of the prime divisors of \\(n\\). If we are only interested to see a particular \\((n,k)\\) pair, we can break out when we have done result[k] and result[n-k] in bootstrap()."
  },
  {
    "objectID": "posts/centrifuge-problem/index.html#method-3-dynamic-programming",
    "href": "posts/centrifuge-problem/index.html#method-3-dynamic-programming",
    "title": "Centrifuge Problem",
    "section": "Method 3: Dynamic Programming",
    "text": "Method 3: Dynamic Programming\nThe last method uses dynamic programming. We can use \\(f[k]\\)=True to represent that \\(k\\) is a linear combination of \\(n\\)’s prime divisors. A value \\(i\\) is either itself a prime divisor of \\(n\\) (and thus a linear combination of the prime divisors), or the sum of a \\(n\\)’s prime divisor \\(p\\) and \\((i-p)\\). In the latter case, if \\((i-p)\\) is a linear combination of \\(n\\)’s prime divisors, so is \\(p+(i-p)=i\\).\n!!! hint If \\((i-p)\\) is a linear combination of \\(n\\)’s prime divisors, i.e., \\(i-p=a_1p_1+a_2p_2+...+a_np_n\\), where \\(\\{p_i\\}\\) are the prime divisors of \\(n\\) and \\(\\{a_i\\}\\) are non-negative integers, then \\(i-p+p\\) is definitely a linear combination too: \\(p\\)’s coefficient becomes \\(a+1\\ge0\\).\nHence,\n\n\\(f[i] = f[i] \\text{ or } f[i-p]\\)\n\nThe boundary condition is \\(f[0]\\) = True, i.e., an empty centrifuge is balanced.\nThe whole function is extremely short:\ndef centrifuge_dp(n: int, k: int) -&gt; bool:\n    prime_divisors = get_prime_divisors(n) # cached, `prime_divisors` is sorted\n    f = [True] + [False] * n\n    for p in prime_divisors: # TODO: DP only once for a given `n`\n        for i in range(p, n+1):\n            f[i] = f[i] or f[i-p]\n    return f[k] and f[n-k]"
  },
  {
    "objectID": "posts/centrifuge-problem/index.html#performance-comparison",
    "href": "posts/centrifuge-problem/index.html#performance-comparison",
    "title": "Centrifuge Problem",
    "section": "Performance Comparison",
    "text": "Performance Comparison\nObviously, the Method 2 and 3 are much faster than the naïve Method 1. Method 3 does not even use recursion and is the fastest.\n\n\n\n\n\n\nNote\n\n\n\nA note there is that if we are to check all \\(1\\le k\\le n\\), e.g., [i for i in range(1, n+1) if centrifuge(n,i)], we need to make some adjustment to the functions above so as to bootstrap or perform DP only once for each \\(n\\). This is trivial."
  },
  {
    "objectID": "posts/centrifuge-problem/index.html#visualization",
    "href": "posts/centrifuge-problem/index.html#visualization",
    "title": "Centrifuge Problem",
    "section": "Visualization",
    "text": "Visualization\nBelow are some plots of balanced centrifuges. Note that for a particular value of \\(k\\), there can be more than one way to balance the centrifuge. Here, I illustrate only one.\n\n“6-hole”“10-hole”“12-hole”“12-hole”“20-hole”“24-hole”“33-hole”\n\n\nplot_centrifuge(6, \"6-hole-centrifuge.svg\")\n\n\n\n6-hole-centrifuge\n\n\n\n\nplot_centrifuge(10, \"10-hole-centrifuge.svg\")\n\n\n\n10-hole-centrifuge\n\n\n\n\nplot_centrifuge(12, \"12-hole-centrifuge.svg\")\n\n\n\n12-hole-centrifuge\n\n\n\n\nplot_centrifuge(18, \"18-hole-centrifuge.svg\")\n\n\n\n18-hole-centrifuge\n\n\n\n\nplot_centrifuge(20, \"20-hole-centrifuge.svg\")\n\n\n\n20-hole-centrifuge\n\n\n\n\nplot_centrifuge(24, \"24-hole-centrifuge.svg\")\n\n\n\n24-hole-centrifuge\n\n\n\n\nplot_centrifuge(33, \"33-hole-centrifuge.svg\")\n\n\n\n33-hole-centrifuge\n\n\n\n\n\n\nPython code\nThe code to generate the plots above:\nfrom functools import lru_cache\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n\n@lru_cache(maxsize=None)\ndef prime_divisors(n):\n    \"\"\"Return list of n's prime divisors\"\"\"\n    primes = []\n    p = 2\n    while p**2 &lt;= n:\n        if n % p == 0:\n            primes.append(p)\n            n //= p\n        else:\n            p += 1 if p % 2 == 0 else 2\n    if n &gt; 1:\n        primes.append(n)\n    return primes\n\n\ndef centrifuge(n):\n    \"\"\"Return a list of which the k-th element represents if k tubes can balance the n-hole centrifuge\"\"\"\n    F = [True] + [False] * n\n    for p in prime_divisors(n):\n        for i in range(p, n + 1):\n            F[i] = F[i] or F[i - p]\n    return [F[k] and F[n - k] for k in range(n + 1)]\n\n\ndef factorize(k: int, nums: list) -&gt; list:\n    \"\"\"Given k, return the list of numbers from the given numbers which add up to k.\n    The given numbers are guaranteed to be able to generate k via a linear combination.\n\n    Examples:\n        &gt;&gt;&gt; factorize(5, [2, 3])\n        [2, 3]\n        &gt;&gt;&gt; factorize(6, [2, 3])\n        [2, 2, 2]\n        &gt;&gt;&gt; factorize(7, [2, 3])\n        [2, 2, 3]\n    \"\"\"\n\n    def _factorize(k, nums, res: list):\n        for p in nums:\n            if k % p == 0:\n                res.extend([p] * (k // p))\n                return True\n            else:\n                for i in range(1, k // p):\n                    if _factorize(k - p * i, [n for n in nums if n != p], res):\n                        res.extend([p] * i)\n                        return True\n        return False\n\n    res = []\n    _factorize(k, nums, res)\n    return res\n\n\n@lru_cache(maxsize=None)\ndef centrifuge_k(n, k):\n    \"\"\"Given (n, k) and that k balances a n-hole centrifuge, find the positions of k tubes\"\"\"\n    if n == k:\n        return [True] * n\n    factors = factorize(k, prime_divisors(n))\n    pos = [False] * n\n\n    def c(factors: list, pos: list) -&gt; bool:\n        if sum(pos) == k:\n            return True\n        if not factors:\n            return False\n        p = factors.pop(0)\n        pos_wanted = [n // p * i for i in range(p)]\n        for offset in range(n):\n            pos_rotated = [(i + offset) % n for i in pos_wanted]\n            # the intended positions of the p tubes are all available\n            if not any(pos[i] for i in pos_rotated):\n                # claim the positions\n                for i in pos_rotated:\n                    pos[i] = True\n                if not c(factors, pos):\n                    # unclaim the positions\n                    for i in pos_rotated:\n                        pos[i] = False\n                else:\n                    return True\n        # all rotated positions failed, add p back to factors to place later\n        factors.append(p)\n\n    c(factors, pos)\n    return pos\n\n\ndef plot_centrifuge(n, figname=\"centrifuge.svg\"):\n    ncols = max(int(n**0.5), 1)  # minimum 1 column\n    nrows = n // ncols if n % ncols == 0 else n // ncols + 1\n    height = 3 if nrows == ncols else 2\n    width = 2\n    fig, axes = plt.subplots(nrows, ncols, figsize=(height * nrows, width * ncols))\n    z = np.exp(2 * np.pi * 1j / n)\n\n    theta = np.linspace(0, 2 * np.pi, 20)\n    radius = 1 / (ncols + nrows)\n    a = radius * np.cos(theta)\n    b = radius * np.sin(theta)\n\n    cent = centrifuge(n)\n    for nr in range(nrows):\n        for nc in range(ncols):\n            k = nr * ncols + nc + 1\n            axis = axes[nr, nc] if ncols &gt; 1 else axes[nr]\n            if k &gt; n:\n                axis.axis(\"off\")\n                continue\n            # draw the n-holes\n            for i in [z**i for i in range(n)]:\n                axis.plot(a + i.real, b + i.imag, color=\"b\" if cent[k] else \"gray\")\n            # draw the k tubes\n            if cent[k]:\n                if k &gt; n // 2:\n                    pos = [not b for b in centrifuge_k(n, n - k)]\n                else:\n                    pos = centrifuge_k(n, k)\n                for i, ok in enumerate(pos):\n                    i = z**i\n                    if ok:\n                        axis.fill(a + i.real, b + i.imag, color=\"r\")\n\n            axis.set_aspect(1)\n            axis.set(xticklabels=[], yticklabels=[])\n            axis.set(xlabel=None)\n            axis.set_ylabel(f\"k={k}\", rotation=0, labelpad=10)\n            axis.tick_params(bottom=False, left=False)\n\n    fig.suptitle(f\"$k$ Test Tubes to Balance a {n}-Hole Centrifuge\")\n    fig.text(0.1, 0.05, \"Red dot represents the position of test tubes.\")\n    plt.savefig(figname)\n    plt.close(fig)\n\n\nif __name__ == \"__main__\":\n    for n in range(6, 51):\n        print(f\"Balancing {n}-hole centrifuge...\")\n        plot_centrifuge(n, f\"{n}-hole-centrifuge.png\")\n\n\nDownload plots of balanced centrifuges\n\n\n\n\n\n\nMore plots\n\n\n\nYou can download the Python code and all plots of balanced \\(n\\)-hole centrifuge, \\(6\\le n\\le50\\), which I calculated using the code above."
  },
  {
    "objectID": "posts/bloomberg-bquant/index.html",
    "href": "posts/bloomberg-bquant/index.html",
    "title": "Bloomberg BQuant (BQNT)",
    "section": "",
    "text": "Bloomberg is developing a new function in the Terminal, called BQuant, BQNT&lt;GO&gt;, under the Bloomberg Anywhere license. I happen to be able to test it thanks to a fund manager and find it could be a future way of using Bloomberg Terminal."
  },
  {
    "objectID": "posts/bloomberg-bquant/index.html#background",
    "href": "posts/bloomberg-bquant/index.html#background",
    "title": "Bloomberg BQuant (BQNT)",
    "section": "Background",
    "text": "Background\nBloomberg recently made JupyterLab available inside the Terminal and invited partners to test it out. This function is named BQuant, or BQNT&lt;GO&gt;, which is still under heavy development, but the idea is just great. Jupyter notebooks inside Bloomberg Terminal! Just before this news, I was helping a fund manager in writing some alert programs that do some analysis on equity market and then send email notifications, which didn’t go well because first it is very easy to breach the data limit using Bloomberg API (blpapi) and second I wasn’t very comfortable about the presentation of analysis results. I was using poor HTML code in emails and didn’t find a convenient way to insert plots and figures. Besides, I was also writing some back testing code to evaluate potential trading strategies. But still there’s a concern as I won’t be working there full time and they probably won’t have a permanent programmer, so if they want to alter parameters a little bit it’ll be a problem.\nBut things happen, with BQNT or more specifically the Jupyter notebook, I can make an interactive UI-based application without worrying about the data limit issue, as they also provide a new data retrieval interface, BQL, Bloomberg Query Language. In the past, pulling data through blpapi is basically retrieving data from the Terminal. But BQL, something like SQL, is to submit the query request to Bloomberg’s server and get the data directly from server, which also enables basic calculations so as to further reduce the size of data being pulled out. Then, BQNT comes with pre-installed bqplot and some wrappers of libraries like ipwidgets, which makes visualization much easier and interactive. As BQNT is a customized JupyterLab, output cells can be maximized and code hided. The result is just like a single-page application.\n\n\n\nTearsheet of Bloomberg BQuant\n\n\nThe tearsheet above shows some basic features of BQNT, and of course there are more. There’s a gallery in the Terminal with several demos showing what BQNT can make, including portfolio performance report, security filtering, trading strategy back test, etc., quite inspiring.\nWith a quick play, I was able to write a multi-security back test of William %R based strategy with trailing stop. All input parameters can be varied using sliders, dropdowns, calendars and etc. There is also an autocomplete security selection widget to assist you in defining the universe. Plots and tables can be aligned nicely using HBox and VBox… So, I’m impressed, really.\nI can foresee that in the future, users of Bloomberg Terminal can have BQNT powered applications tailored to their needs. For example, I want to know the stock volatility and price plot together with some commodity futures orderbook info. BQNT may give you the app. But of course, I’ve only a rough guess and there could be many possibles and impossibles ahead of BQNT. I’m a big fan, though."
  },
  {
    "objectID": "posts/bloomberg-bquant/index.html#my-work",
    "href": "posts/bloomberg-bquant/index.html#my-work",
    "title": "Bloomberg BQuant (BQNT)",
    "section": "My Work",
    "text": "My Work\n\nBQL for Data Retrieval\nWe know there’s a blpapi available already. Using this API one can pull data from a Terminal to Excel, Python, etc. But there is a limit on the frequency or total queries allowed in a certain period, which however isn’t clear. As Bloomberg doesn’t allow local storage of its data, if we need to retrieve a sizeable data too many times, there will be an issue.\nThe good thing about BQNT is that it comes with a new query system – so called BQL. It allows simple calculations done on the server side so as to reduce the size of data transferred. And, people in Bloomberg said, by using BQL we are not very likely to face any data limit issue again. I haven’t done much stress tests so I can’t tell whether there is still a limit or not.\n\nSome Quick Examples\nGet all component stocks of an index:\nimport bql\nbq = bql.Service()\nsecurities = bq.univ.members('AS31 Index')\nGet OHLC data of all component stocks:\nfrom bql.util import get_time_series\nstart_date = '2017-01-01'\nend_date = '2018-01-01'\ndata = get_time_series(securities, ['PX_LAST', 'PX_OPEN', 'PX_HIGH', 'PX_LOW'], start_date, end_date)\nIf I want to know the industry sector of these stock, all I need is:\nreq = bql.Request(securities, bq.data.industry_sector())\ndata_industry = bql.combined_df(bq.execute(req))\nThe returned data is a pandas.DataFrame, which is just awesome!\n\n\n\nCustomised JupyterLab\nJupyter Notebook has always been a favourite environment in data science. No need to say much. A JupyterLab inside Bloomberg Terminal together with BQL, basically the core idea of BQNT, is no doubt fantastic. For quants who need to do a lot of testings on trading ideas, filtering of securities, etc., this integrated environment is absolutely a good place to sort everything out. Moreover, files in BQNT are synced under a BBA license, you can easily pick up your work from any Terminal. In our meeting today, the size of this free cloud storage is said to be about 250MB but may be upgraded.\nFor fund managers or traders who want only a ready-to-use application, they can have some programmers to make one for them. The BQNT team kindly demonstrated a beta feature, where a ‘consumer view’ can be shared to others, which hides all Jupyter Notebook related parts and is really the final output alone — just like the Calculator on Windows.\n\n\nThe %R Backtesting App\nThis App I wrote replicates BT&lt;GO&gt; in its back testing outputs, but comes with more flexibility such as trailing stop loss, which isn’t available in BT&lt;GO&gt;. It serves as a demo of BQNT powered application, validating current beta.\nThe objectives of the app are:\n\nto perform %R strategy on a single security as well as on all components of an index;\nto provide both quantitative and qualitative back testing results;\nbe friendly to any user with zero programming knowledge.\n\n\nMain UI\nThe main UI provides a short description of the trading strategy under back test, followed by a control panel where we can specify benchmark, underlying, time range, % parameters as well as trailing stop loss percentage. I also put a progress bar and status bar below for more immediate feedback.\n\n\n\n\nMain UI (I should probably not center the table)\n\n\n\n\n\nOutputs\nIf the underlying selected is a single security, e.g. CBA AU Equity, the simple back test output is something like below. An InteractiveLinePlot linked with a subplot to show equity evolution in selection; a LinePlot for the price series of the security with markers for enters and exits; and a LinePlot for the %R indicator.\n\n\n\n\nOutput Single Security\n\n\n\nIf the underlying selected is an index, e.g. AS31 Index, the back test is performed on each individual component of the index and results are presented below. A KDEPlot shows the distribution of total return, max return and min return, followed by a ToggleButtons to show All, Positive only and Negative only. Equity Return by industry sector and the benchmark return are sorted and plotted below.\n\n\n\n\nOutput Multisecurity 1\n\n\n\nThen there is the detailed DataGrid for all calculated metrics of all securities and of each industry sectors, just like the output in BT&lt;GO&gt;. Results can be exported to a spreadsheet which will be conveniently stored in the BQNT platform, or the ‘cloud’ of size 250MB in total. A qualitative summary of this particular back test is provided in the end.\n\n\n\n\nOutput Multisecurity 2\n\n\n\nThis App is by no means a finished work. I basically tried to mix in as many different things as possible. The end product should be one such that provides a condensed and conclusive opinion after each run, considering that its users may be those fund managers who do not want to get their hands dirty."
  },
  {
    "objectID": "posts/bloomberg-bquant/index.html#other-thoughts",
    "href": "posts/bloomberg-bquant/index.html#other-thoughts",
    "title": "Bloomberg BQuant (BQNT)",
    "section": "Other Thoughts",
    "text": "Other Thoughts\nIn my chat with Bloomberg BQNT team, I visioned BQNT powered apps may be the future way of using Bloomberg. For one, with more internal integration worked out, like the current one with PORT&lt;GO&gt;, surely users can use these UI-based apps to get jobs done. The good thing is that it can put everything you need together in one place, and only those you need. Once consumer view is rolled out, this will be more evident. They also are developing a scheduling module which will run Notebooks automatically, although at an additional cost.\nAnother thing I suggested is a marketplace for those BQNT powered apps. Say, I’ve developed a market analysis application on BQNT, maybe I can put it for sale on the marketplace so someone else won’t need to reinvent the wheel. It can also foster a community around BQNT, if any. The only downside is that BQNT is accessible only under BBA licence, which isn’t cheap. Individual programmers / quants may not be able to afford it, and those in big institutions may not have the time and right to build and sell apps on it. This kinda sucks.\nI can see the huge potential of BQNT, which if operates well can be the new way of using Bloomberg Terminal — the learning curve of Terminal is really too steep for many current and potential users, and they don’t get very much out of it. But, if there are many ready-to-use UI-based applications for their customised needs, things definitely will be better. Unfortunately, BQNT is not open-source, and the access to it is very limited (BBA licence), I don’t believe there will be an active community and hence a marketplace of a variety of apps."
  },
  {
    "objectID": "posts/beta-unlevered-and-levered/index.html",
    "href": "posts/beta-unlevered-and-levered/index.html",
    "title": "Beta - Unlevered and Levered",
    "section": "",
    "text": "Beta is a measure of market risk. This post tries to explain the unlevered and levered betas."
  },
  {
    "objectID": "posts/beta-unlevered-and-levered/index.html#unlevered-firm-u",
    "href": "posts/beta-unlevered-and-levered/index.html#unlevered-firm-u",
    "title": "Beta - Unlevered and Levered",
    "section": "Unlevered Firm u",
    "text": "Unlevered Firm u\nIf a firm has no debt, it’s all equity-financed and thus its equity’s beta \\(\\beta_{E}\\) equals its asset’s beta \\(\\beta_{A}\\). This beta is also the unlevered beta, \\(\\beta_{\\text{unlevered}}\\), since it’s unaffected by leverage. The unlevered beta measures the market risk exposure of the firm’s shareholders. Let’s call this firm \\(u\\), Hence, we have:\n\\[\n\\beta_{\\text{unlevered}}=\\beta_E^u=\\beta_A^u\n\\tag{1}\\]\nThis equality says that in an unlevered firm, the unlevered beta equals its equity beta and its asset beta."
  },
  {
    "objectID": "posts/beta-unlevered-and-levered/index.html#levered-firm-l",
    "href": "posts/beta-unlevered-and-levered/index.html#levered-firm-l",
    "title": "Beta - Unlevered and Levered",
    "section": "Levered Firm l",
    "text": "Levered Firm l\nIf the same firm is partly financed by debt, let’s call it firm \\(l\\). The asset of the levered firm \\(l\\) is financed by both equity and debt, and hence the asset’s market risk is from both equity and debt. The asset’s beta is a weighted average of its equity beta and debt beta.\n\\[\n\\beta_A^l = \\frac{E}{E+D(1-t)} \\beta_E^l + \\frac{D(1-t)}{E+D(1-t)} \\beta_D^l\n\\tag{2}\\]\n\n\n\n\n\n\nNote\n\n\n\n\\(\\beta_A^l\\) measures the change in the return on a portfolio of all firm \\(l\\)’s securities (debt and equity) for each additional one percent change in the market return.\n\n\nThis part is not very hard to understand. The beta of a portfolio is the weighted average beta of its constituents. If you believe that debt beta is zero since the value of debt may not be affected by the equity market, then \\(\\beta_D^l=0\\) and Equation 2 can be simplified to:\n\\[\n\\begin{align}\n\\beta_A^l &= \\frac{E}{E+D(1-t)} \\beta_E^l \\\\\n    &= \\frac{1}{1+\\frac{D}{E}(1-t)} \\beta_E^l\n\\end{align}\n\\tag{3}\\]\nHowever, this firm’s shareholders are now more exposed to the market risk than before, because leverage increases the variation in the payoff to shareholders. This means the equity’s beta of this levered firm is higher than the equity’s beta of the unlevered firm, i.e. \\(\\beta_E^l&gt;\\beta_E^u\\).\nNote that, the levered beta \\(\\beta_{\\text{levered}}\\) that we talk about refers to \\(\\beta_E^l\\), which is the equity beta of the levered firm \\(l\\)."
  },
  {
    "objectID": "posts/beta-unlevered-and-levered/index.html#unlevered-vs-levered",
    "href": "posts/beta-unlevered-and-levered/index.html#unlevered-vs-levered",
    "title": "Beta - Unlevered and Levered",
    "section": "Unlevered vs Levered",
    "text": "Unlevered vs Levered\nOn the other hand, firm \\(u\\) and firm \\(l\\) differ only in capital structure whilst both have the same asset. Let’s say we have a portfolio of firm \\(u\\)’s asset and the other portfolio of firm \\(l\\)’s asset, then these two portfolios should have the same expected return and market risk exposure.1 This means the two portfolios have the same beta, implying:\n1 Modigliani-Miller theorem states that the capital structure should not affect a firm’s value.\\[\\begin{equation}\\beta_A^u = \\beta_A^l \\end{equation} \\tag{4}\\]\nIf we substitue in the definition of unlevered and levered beta (Equation 1 and Equation 3):\n\\[\n\\begin{equation}\n\\beta_{\\text{unlevered}} =  \\frac{1}{1+\\frac{D}{E}(1-t)} \\beta_{\\text{levered}}\n\\end{equation}\n\\tag{5}\\]\nor\n\\[\n\\begin{equation} \\beta_{\\text{levered}} =  \\left( 1+\\frac{D}{E}(1-t) \\right)\n\\beta_{\\text{unlevered}} \\end{equation}\n\\tag{6}\\]\nThis is the formula that we use to lever and unlever beta.2\n2 This Equation 6 is also named Hamada Equation, where we assumed a zero debt beta. It draws on the Modigliani-Miller theorem on capital structure, and appeared in Prof. Robert Hamada’s paper “The Effect of the Firm’s Capital Structure on the Systematic Risk of Common Stocks” in the Journal of Finance in 1972."
  },
  {
    "objectID": "posts/beta-unlevered-and-levered/index.html#further-clarification",
    "href": "posts/beta-unlevered-and-levered/index.html#further-clarification",
    "title": "Beta - Unlevered and Levered",
    "section": "Further Clarification",
    "text": "Further Clarification\nThe equity beta of a firm with debts is levered. To remove the impact of leverage on shareholders’ market risk exposure, we need to unlever this beta in order to get the unlevered beta. This unlevered beta is also called the asset beta.\nNote that the asset beta is a syncronym for unlevered beta. It is not, however, the asset’s beta \\(\\beta_A^l\\) when the firm is leveraged. This convention is confusing indeed, so throughout this post, I’m using asset’s beta to refer to the beta of a portfolio of all securities (debt and equity) of the levered firm."
  },
  {
    "objectID": "posts/beta-unlevered-and-levered/index.html#notations",
    "href": "posts/beta-unlevered-and-levered/index.html#notations",
    "title": "Beta - Unlevered and Levered",
    "section": "Notations",
    "text": "Notations\n\n\\(\\beta_E^u\\): the equity’s beta of the unlevered firm\n\\(\\beta_A^u\\): the asset’s beta of the unlevered firm\n\\(\\beta_E^l\\): the equity’s beta of the levered firm\n\\(\\beta_D^l\\): the debt’s beta of the levered firm\n\\(\\beta_A^l\\): the asset’s beta of the levered firm\n\\(D\\): the size of the firm’s debt\n\\(E\\): the size of the firm’s equity\n\\(t\\): the tax rate\n\\(\\beta_{\\text{unleverd}}\\): unlevered beta, the equity (asset) beta of the unlevered version of the firm\n\\(\\beta_{\\text{leverd}}\\): levered beta, the equity beta of the levered version of the firm"
  },
  {
    "objectID": "posts/accumulator-option-pricing/index.html",
    "href": "posts/accumulator-option-pricing/index.html",
    "title": "Accumulator Option Pricing",
    "section": "",
    "text": "An accumulator is a financial derivative that is sometimes known as “I kill you later”. This post attempts to explain how it is structured and price it via Monte Carlo simulations in Python."
  },
  {
    "objectID": "posts/accumulator-option-pricing/index.html#overview-of-accumulator",
    "href": "posts/accumulator-option-pricing/index.html#overview-of-accumulator",
    "title": "Accumulator Option Pricing",
    "section": "1. Overview of Accumulator",
    "text": "1. Overview of Accumulator\nLike all derivatives, there are two parties involved in an accumulator, the buyer and the seller, both agree on a strike price that is usually at a discount to the prevailing market price of the underlying security at the time of contract origination.\n\nThe buyer has the obligation to buy certain amount of the underlying security at the predetermined strike price.\nThe seller has the obligation to sell the specified amount of the underlying security at the strike price to the buyer.\n\nThe accumulator is settled periodically throughout its term. At each settlement:\n\nIf the market price of the underlying security is above the predetermined knock-out price, the contract is terminated.\nIf the market price of the underlying security is between the knock-out price and the strike price, the buyer “accumulates” the underlying security at the strike price.\nIf the market price of the underlying security is below the strike price, the buyer is obligated to buy the underlying security at the strike price at 2 (or more) times of the predetermined amount."
  },
  {
    "objectID": "posts/accumulator-option-pricing/index.html#an-example-6-month-accumulator",
    "href": "posts/accumulator-option-pricing/index.html#an-example-6-month-accumulator",
    "title": "Accumulator Option Pricing",
    "section": "2. An Example 6-month Accumulator",
    "text": "2. An Example 6-month Accumulator\nLet’s make up an example so as to illustrate how it works.\n\n2.1. Month 0\nSuppose that I bought an accumulator from Sherry the seller today, where the underlying security is TSC (hypothetical ticker), currently trading at $100. The strike price is $90 and the knock-out price is $105. The amount of stocks that I can buy is 1,000 in each settlement. The accumulator lasts for 6 months and settles monthly.\n\n\n2.2. Month 1\nAt the end of month 1, the market price of TSC is $102, which is between the strike price ($90) and the knock-out price ($105). I can buy 1,000 shares from Sherry at the strike price of $90 each and make a profit of \\((\\$102-\\$90)\\times 1000=\\$12,000\\).\n\n\n2.3. Month 2\nAt the end of month 2, the market price of TSC is $95, which is between the strike price ($90) and the knock-out price ($105). I can buy 1,000 shares from Sherry at the strike price of $90 each and make a profit of \\((\\$95-\\$90)\\times1000=\\$5,000\\).\n\n\n2.4. Month 3\nAt the end of month 3, the market price of TSC is $85, which is below the strike price ($90). I have to buy 2,000 shares from Sherry at the strike price of $90, making a loss of \\((\\$90-\\$85)\\times2000=\\$10,000\\).\n\n\n2.5. Month 4\nAt the end of month 4, the market price of TSC is $88, which is below the strike price ($90). I have to buy 2,000 shares from Sherry at the strike price of $90, making a loss of \\((\\$90-\\$88)\\times2000=\\$4,000\\).\n\n\n2.6. Month 5\nAt the end of month 5, the market price of TSC is $106, which is above the knock-out price, so the contract is terminated immediately. I cannot make any profit from Sherry any longer."
  },
  {
    "objectID": "posts/accumulator-option-pricing/index.html#some-observations",
    "href": "posts/accumulator-option-pricing/index.html#some-observations",
    "title": "Accumulator Option Pricing",
    "section": "3. Some Observations",
    "text": "3. Some Observations\nIn the example above:\n\nI’ve accumulated in total of 6,000 shares of TSC at a cost of $90 per share. This implies that an accumulator is like a forward contract and helps the buyer lock in the cost of acquiring the underlying security (why it’s also known as share forward accumulator).\nAs long as the share price is between the strike price and knock-out price, the buyer can accumulate shares at a discount.\nThe 6-month accumulator terminates in 5 months because of the knock out and so the seller’s loss is limited.\nWhen the share price is below the strike price, the buyer accumulates more shares but at a loss.\n\nAll these taken together, we can find that the buyer has:\n\na limited upside potential because the potential gain is capped by the knock-out price and zero when knocked out, and\na disproportional (limited) downside in that any loss is amplified by the doubled amount of shares he or she has to purchase from the seller when share price is below the strike.\n\nBut this is not the full story. Another hidden feature is that while the accumulator is terminated when the share price is above the knock-out price, the contract does not terminate when the buyer is at a loss until it matures. So, even though the maximum losses of both the buyer and the seller are fixed, but they differ significantly and disproportionately.\nIf so, why would anyone become interested in buying the contract? Potentially it’s because the strike is set to be lower at market price, therefore at the beginning the buyers always feel like they are taking advantages. They may also think that once the price increases to above the knock-out level, which might be set to slightly higher than market price, the contract is terminated so they are free of any loss.\nHowever, the buyers often underestimate the probability of a price decline and how big the impact it will have on accumulator buyers. The “I kill you later” earns its name for a reason."
  },
  {
    "objectID": "posts/accumulator-option-pricing/index.html#some-math",
    "href": "posts/accumulator-option-pricing/index.html#some-math",
    "title": "Accumulator Option Pricing",
    "section": "4. Some Math …",
    "text": "4. Some Math …\nLet’s make some notations.\n\nStrike price is \\(K\\)\nShare price at time \\(t\\) is \\(S_t\\)\nKnock-out price is \\(K^+\\)\nThe amount of shares to buy is:\n\n\\(A\\) when \\(K&lt;S_t&lt;K^+\\), and\n\\(cA\\) when \\(S_t&gt;K^+\\), where \\(c&gt;1\\)\n\nThere are \\(N\\) settlements\n\nSo at each settlement, the payoff matrix conditional on the contract not terminated in the previous settlement is:\n\n\n\nShare Price\nBuyer’s Payoff\nSeller’s Payoff\n\n\n\n\n\\(S_t&gt;K^+\\)\n0\n0\n\n\n\\(K\\le S_t\\le K^+\\)\n\\(A(S_t-K)\\ge0\\)\n\\(-A(S_t-K)\\le0\\)\n\n\n\\(S_t&lt;K\\)\n\\(c A(S_t-K)&lt;0\\)\n\\(-cA(S_t-K)&gt;0\\)\n\n\n\nHowever, deriving a closed-end analytical solution is not easy since there are many settlements in the contract and the total payoff is path-dependent (the knock out).1\n1 There is a conference paper in 2009 discussing the issue and the PDF version is available here."
  },
  {
    "objectID": "posts/accumulator-option-pricing/index.html#a-simulation-approach",
    "href": "posts/accumulator-option-pricing/index.html#a-simulation-approach",
    "title": "Accumulator Option Pricing",
    "section": "5. … A Simulation Approach",
    "text": "5. … A Simulation Approach\nI am to going to use Monte Carlo simulations to find out the distribution of buyer’s payoff.\n\n5.1. Assumptions\nFor simplicity, I’m going to make the following assumptions:\n\nthe share price when the contract is signed \\(S_t=100\\).\nthe strike price and the knock-out price are symmetric around $100.\n\nthe strike price \\(K=100-k\\)\nthe knock-out price \\(K^+=100+k\\)\n\nthe contract lasts for a year with 12 settlements and each month end.\nthe amount of shares to buy in each settlement:\n\n\\(A=1,000\\) if the share price at settlement is between the strike price and the knock-out price.\n\\(A=2,000\\) if the share prices settlement is below the strike price.\n\nthe monthly stock returns follow a normal distribution with mean zero and a standard deviation of \\(\\sigma\\).\n\nThen, there are only two variables: \\(k\\) and \\(\\sigma\\) that I will need to vary!\n\n\n5.2. Core Code\nThe simulation code I write below leverages Numba to speed up the calculation.\nFor 1 million simulations per pair of \\((k, \\sigma)\\), it takes about 2 seconds on my laptop with JIT and almost 1 minute without it.\nimport numpy as np\nfrom collections import OrderedDict\nfrom numba import int32, float32\nfrom numba.experimental import jitclass\n\n\n@jitclass(OrderedDict({\n    'times': int32,\n    'strike_price': float32,\n    'knock_out_price': float32,\n    'volatility': float32\n}))\nclass FastSimulation:\n\n    def __init__(self, times, strike_price, knock_out_price, volatility):\n        self.times = times\n        self.strike_price = strike_price\n        self.knock_out_price = knock_out_price\n        self.volatility = volatility\n\n    def run(self):\n        np.random.seed(1)\n        buyer_payoffs = []\n        for i in range(self.times):\n            # generate 12 monthly returns from a normal distribution\n            # written this way as size parameter is not supported by numba\n            returns = [np.random.normal(\n                loc=0, scale=self.volatility)/100 + 1 for _ in range(12)]\n            # convert returns to a price array\n            prices = np.asarray(returns).cumprod() * 100\n            payoff = 0\n            for price in prices:\n                # the accumulator is terminated immediately\n                if price &gt; self.knock_out_price:\n                    break\n                payoff += self.buyer_payoff(price)\n            buyer_payoffs.append(payoff)\n        return buyer_payoffs\n\n    def buyer_payoff(self, share_price):\n        \"Buyer payoff conditional on the accumulator not terminated\"\n        if share_price &gt; self.knock_out_price:\n            return 0\n        payoff = 1000 * (share_price - self.strike_price)\n        if self.strike_price &lt;= share_price &lt;= self.knock_out_price:\n            return payoff\n        else:\n            return payoff * 2\n\n\n5.3. Results\nNumbers are boring. So here I put two plots showing the distribution of the buyer’s payoffs. The Python code to generate the plots is as below (1000 simulations).\n\n\n\n\n\n\nPlotting code\n\n\n\n\n\nimport plotly.figure_factory as ff\nimport plotly.graph_objs as go\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\n\ninit_notebook_mode(connected=True)\n\nhist_data, group_labels = [], []\n\nfor v in range(1, 6):\n    hist_data.append(FastSimulation(times=1_000, strike_price=95, knock_out_price=105, volatility=v).run())\n    group_labels.append(f'Volatility = {v}%')\n    \ncolors = ['#75b0ec', '#338be3', '#34669c', '#344054', '#161c25']\n\n# Create distplot with curve_type set to 'normal'\nfig = ff.create_distplot(hist_data, group_labels, show_hist=False, colors=colors, curve_type=\"kde\")\n\n# Add title\nfig['layout'].update(title='Accumulator With Strike Price of 95 and Knock-Out Price of 105 | MingzeGao', \n                    xaxis=dict(title=\"Buyer's Payoff\", range=[-700e3, 300e3]), yaxis=dict(title='Probability'))\n\n# Plot!\niplot(fig)\n\n\n\n\n\n\n\\(k=5\\) and \\(v\\in [1..5]\\)\n\n\n\n\n\n\\(k=10\\) and \\(v\\in [1..5]\\)\n\n\n\n\n6. Discussion\nApparently, the accumulator is a very interesting and sometimes evil derivative. From the plots above we can notice several things:\n\nWhen volatility is low, an accumulator gives the buyer an opportunity to accumulate shares at a discount and therefore positive payoffs.\nWhen volatility is high, the buyer’s payoff distribution becomes increasingly negatively skewed.\nThe maximum potential payoff is capped and decreasing in volatility but VaR is increasing in the volatility.\n……\n\nHence, as a buyer of an accumulator, you win small with low volatility but lose big and huge with high volatility. I don’t think any rational investor would like to take the long position. However, we do find exceptions, like CITIC Limited lost HK$15 billion in accumulators back in 2008."
  },
  {
    "objectID": "legao/index.html",
    "href": "legao/index.html",
    "title": "LeGao",
    "section": "",
    "text": "LeGao\n            \n            \n    \n    \n        This page has been moved. If you are not redirected, click here to go to the new page.\n    \n  \n\n\n\n Back to top"
  },
  {
    "objectID": "cv/index.html",
    "href": "cv/index.html",
    "title": "CV",
    "section": "",
    "text": "CV\n            \n            \n    \n    \n        If you are not redirected, please click here to download the PDF file.\n    \n  \n\n\n\n Back to top"
  },
  {
    "objectID": "apps/legao/index.html",
    "href": "apps/legao/index.html",
    "title": "LeGao to make your own LEGO Pixel Art",
    "section": "",
    "text": "Note\n\n\n\nThis app is still under development to replace the previous version.\n\n\nNotably, all processing is now performed in your browser so no image will be uploaded anywhere.\n\n\n\n    \n    \n    LeGao to make your own LEGO Pixel Art\n        \n\n\n        \n      Drop image here or click to select.\n      Your image will NOT be uploaded. The processing is only done in your browser.\n    \n    \n        \n        Longest Dimension: 50\n        \n        \n            \n                Use Color Palette \n            \n        \n    \n    \n        \n        \n        \n    \n    Download Image\n    \n\n    \n\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Mingze Gao",
    "section": "",
    "text": "Mingze Gao, aka Adrian, is a Lecturer in Finance at the Macquarie Business School (MQBS). With a focus on banking and corporate finance, his work has been published at journals including Journal of Banking & Finance, Finance Research Letters, and/or presented at leading conferences such as WFA, SFS Cavalcade, EFA (poster), FMA, FIRN, and AFBC. He serves as an ad hoc referee at multiple ABDC-A*/A journals. He is an elected academic staff member of the MQBS Faculty Board and the Deputy Director of the Macquarie University FinTech and Banking Research Centre. He also holds a visiting fellow position at the University of Sydney.\n\n\n\nCV, Google Scholar, SSRN, and Faculty Profile.\nSome of his open-source works include, for example,\n\nphds.io, a literature search engine targeting top finance and econ journals.\nbrms, a GUI-based bank risk management simulation framework.\nfrds, a Python library for financial research.\nspecurve, a Stata command for specification curve analysis.\nedgar-analyzer, a CLI tool to download SEC filings from EDGAR.\nmktstructure - a CLI tool to download Refinitiv Tick History data and compute some measures.\n\n\n\n\n2017 - 2021 Ph.D. in Finance, University of Sydney\n2022 - 2023 Graduate Certificate in Computing, University of New South Wales\n2016 - 2016 B.Com (Honours) in Finance, University of Sydney\n2013 - 2015 B.Com in Econometrics and Finance, University of Sydney\n\n\n\n\n\nOffice: Room 549, 4 Eastern Road, Macquarie University.\nEmail: mingze.gao@mq.edu.au\n\n\n\n\n\n2025-05-01: I’m now the Deputy Director of Macquarie University FinTech and Banking Research Centre, a newly established Faculty Research Centre, where I also leads the stream Digital Infrastructure and Platforms.\n2024-11-30: A new working paper on AI adoption disparity and supply chain dynamics uploaded to SSRN.\n2024-09-09: PhDs.io has been moved to a more powerful server with performance upgrade and a redesign.\n\n\n\n\n  \n        \n            \n        \n        \n        \n            \n              Search on PhDs.io\n            \n        \n  \n\n\n2024-08-08: Invited by the Brattle Group and recorded a podcast on our award-winning paper. It’s now available on Apple Podcasts and Spotify.\n2024-07-26: Super excited to receive the MQBS Early Career Researcher Support Scheme 2025-2026!\n2024-06-18: Glad to receive the Data Horizons Research Funding 2024 at the Macquarie University. Great team work!\n2024-02-07: My paper “Borrower Technology Similarity and Bank Loan Contracting” with Yunying Huang, Steven Ongena and Eliza Wu has been accepted for presentation at the SFS Cavalcade 2024.\n2024-01-02: My new position as a Lecturer in Finance at the Macquarie Business School starts!\n2023-11-23: Incredibly honoured to receive the FIRN 2023 The Brattle Group Best Paper Award for my paper “Lone (Loan) Wolf Pack Risk” with Iftekhar Hasan, Buhui Qiu and Eliza Wu.\n2023-11-21: Glad to present and discuss at the 2023 FIRN Annual Meeting held at Hobart!\n2023-10-24: I made my own literature search engine PhDs.io. First version is online.\n2023-09-18: I had the privilege of serving as a discussant at the 2023 FIRN-ANU Banking and Financial Stability Conference.\n2023-08-16: My paper “Borrower Technology Similarity and Bank Loan Contracting” with Yunying Huang, Steven Ongena and Eliza Wu has been selected as a semifinalist for the Best Paper Awards of FMA Annual Meeting 2023. Winners TBA.\n2023-07-27: I will join Macquarie University as a Lecturer in Finance. Contract signed. Starting January 2024.\n2023-06-27: I presented my paper “Lone (Loan) Wolf Pack Risk” at the WFA 2023 at San Francisco.\n\n\n\n\nI am seeking ideal candidates with a keen interest in financial intermediation and corporate finance. Priority will be given to students who have strong analytical skills and demonstrate proficiency in Stata, SAS, R, Python, and machine learning.\nIf you are interested, please send your CV and research proposal to my email.\n\n\n\nI write about many topics, taking a random walk away finance. Some recent ones are listed below.\n\n\n\n\n\nDate\n\n\nTitle\n\n\n\n\n\n\nJan 20, 2025\n\n\nDeveloping a Bank Simulation Software\n\n\n\n\nNov 28, 2024\n\n\nKalman Filter\n\n\n\n\nSep 9, 2024\n\n\nPhDs.io\n\n\n\n\nJul 20, 2024\n\n\nTechnology Diversity\n\n\n\n\nJun 30, 2024\n\n\nQuantLib - Yield Curve\n\n\n\n\n\nNo matching items\n\n\nRead more"
  },
  {
    "objectID": "index.html#education",
    "href": "index.html#education",
    "title": "Mingze Gao",
    "section": "",
    "text": "2017 - 2021 Ph.D. in Finance, University of Sydney\n2022 - 2023 Graduate Certificate in Computing, University of New South Wales\n2016 - 2016 B.Com (Honours) in Finance, University of Sydney\n2013 - 2015 B.Com in Econometrics and Finance, University of Sydney"
  },
  {
    "objectID": "index.html#contact",
    "href": "index.html#contact",
    "title": "Mingze Gao",
    "section": "",
    "text": "Office: Room 549, 4 Eastern Road, Macquarie University.\nEmail: mingze.gao@mq.edu.au"
  },
  {
    "objectID": "index.html#news",
    "href": "index.html#news",
    "title": "Mingze Gao",
    "section": "",
    "text": "2025-05-01: I’m now the Deputy Director of Macquarie University FinTech and Banking Research Centre, a newly established Faculty Research Centre, where I also leads the stream Digital Infrastructure and Platforms.\n2024-11-30: A new working paper on AI adoption disparity and supply chain dynamics uploaded to SSRN.\n2024-09-09: PhDs.io has been moved to a more powerful server with performance upgrade and a redesign.\n\n\n\n\n  \n        \n            \n        \n        \n        \n            \n              Search on PhDs.io\n            \n        \n  \n\n\n2024-08-08: Invited by the Brattle Group and recorded a podcast on our award-winning paper. It’s now available on Apple Podcasts and Spotify.\n2024-07-26: Super excited to receive the MQBS Early Career Researcher Support Scheme 2025-2026!\n2024-06-18: Glad to receive the Data Horizons Research Funding 2024 at the Macquarie University. Great team work!\n2024-02-07: My paper “Borrower Technology Similarity and Bank Loan Contracting” with Yunying Huang, Steven Ongena and Eliza Wu has been accepted for presentation at the SFS Cavalcade 2024.\n2024-01-02: My new position as a Lecturer in Finance at the Macquarie Business School starts!\n2023-11-23: Incredibly honoured to receive the FIRN 2023 The Brattle Group Best Paper Award for my paper “Lone (Loan) Wolf Pack Risk” with Iftekhar Hasan, Buhui Qiu and Eliza Wu.\n2023-11-21: Glad to present and discuss at the 2023 FIRN Annual Meeting held at Hobart!\n2023-10-24: I made my own literature search engine PhDs.io. First version is online.\n2023-09-18: I had the privilege of serving as a discussant at the 2023 FIRN-ANU Banking and Financial Stability Conference.\n2023-08-16: My paper “Borrower Technology Similarity and Bank Loan Contracting” with Yunying Huang, Steven Ongena and Eliza Wu has been selected as a semifinalist for the Best Paper Awards of FMA Annual Meeting 2023. Winners TBA.\n2023-07-27: I will join Macquarie University as a Lecturer in Finance. Contract signed. Starting January 2024.\n2023-06-27: I presented my paper “Lone (Loan) Wolf Pack Risk” at the WFA 2023 at San Francisco."
  },
  {
    "objectID": "index.html#mresphd-students",
    "href": "index.html#mresphd-students",
    "title": "Mingze Gao",
    "section": "",
    "text": "I am seeking ideal candidates with a keen interest in financial intermediation and corporate finance. Priority will be given to students who have strong analytical skills and demonstrate proficiency in Stata, SAS, R, Python, and machine learning.\nIf you are interested, please send your CV and research proposal to my email."
  },
  {
    "objectID": "index.html#recent-posts",
    "href": "index.html#recent-posts",
    "title": "Mingze Gao",
    "section": "",
    "text": "I write about many topics, taking a random walk away finance. Some recent ones are listed below.\n\n\n\n\n\nDate\n\n\nTitle\n\n\n\n\n\n\nJan 20, 2025\n\n\nDeveloping a Bank Simulation Software\n\n\n\n\nNov 28, 2024\n\n\nKalman Filter\n\n\n\n\nSep 9, 2024\n\n\nPhDs.io\n\n\n\n\nJul 20, 2024\n\n\nTechnology Diversity\n\n\n\n\nJun 30, 2024\n\n\nQuantLib - Yield Curve\n\n\n\n\n\nNo matching items\n\n\nRead more"
  },
  {
    "objectID": "posts/100-bitcoins-forgone-for-science/index.html",
    "href": "posts/100-bitcoins-forgone-for-science/index.html",
    "title": "100 Bitcoins Forgone for Science",
    "section": "",
    "text": "This post is just another piece of my serious nonsense. All of a sudden, I wanted to know how many Bitcoins I could have mined since 2012? This is because I’ve known Bitcoin since its existence in 2009, but have never really put any effort in mining. Instead, I was fascinated by the idea of using distributed (volunteer) computing to solve scientific problems. For example, BOINC and related projects like World Community Grid are using the computing power donated from around the world to find effective treatments for cancer and HIV/AIDS, low-cost water filtration systems and new materials for capturing solar energy efficiently, etc. I was one of the many volunteers for a long time, even before the genesis block of Bitcoin.\nAn interesting question is, what if I didn’t donate my computers to volunteer computing, but used them in Bitcoin instead? How many Bitcoins I could have mined? To solve this question, I started from looking at my contribution history of the World Community Grid (it’s awesome that the full history is available).\n\n\n\n\nHistorical WCG Points\n\n\nAccording to WCG’s website, 7 WCG Point are equal to 1 BOINC credit, which represents 1/100 day of CPU time on a reference computer that does 1,000 MFLOPS based on the Whetstone benchmark.\nHowever, the definition of BOINC credit has been changed to 1/200 day of CPU time since 2010, though on WCG’s website it still says the total WCG Points divided by 700 gives the number of GigaFLOPs. I’m going to stick to the WCG’s website for now.\nSuppose I’ve got one WCG Point today, then it means my computer has spent 1/700 day of CPU time, i.e. 123 seconds, at a computing rate of 1 GigaFLOP/second. So, if I can convert GigaFLOPs to Bitcoin hashrate, the problem will be quite easy.\nHowever, FLOPs cannot be converted to hashrate in a simple manner as Bitcoin hashes are about integer math, totally different from floating point operations. I’m just going to use a very rough estimate that 1 hash results 12.7k FLOPs (source: BitcoinTalk thread, CoinDesk), so that\n\n1 WCG Point implies mining at a speed of 78.7kH/s for 123 seconds. – a very rough estimate\n\nThen, if I received 1k Points a day, it might be safe to say I’ve been mining for about 123k seconds at a speed of 78.7kH/s, which translates to an average daily hashrate of 112kH/s or 0.112MH/s.\nI did some math and found that it seems in June 2012 my hashrate was as high as 0.006% of the whole network, though one year later it’s effectively 0%. lol.\n\n\n\nHashrate comparison\n\n\nNext step will be calculating how many Bitcoins I could have mined based on the hashrate history.\nTaking into account the average block time and the controlled supply of Bitcoin (table below), I plot the daily average number of blocks and Bitcoins generated in this period.\n\n\n\nDate reached\nBlock\nReward Era\nBTC/block\nEnd BTC % of Limit\n\n\n\n\n2009-01-03\n0\n1\n50.00\n12.500%\n\n\n2010-04-22\n52500\n1\n50.00\n25.000%\n\n\n2011-01-28\n105000\n1\n50.00\n37.500%\n\n\n2011-12-14\n157500\n1\n50.00\n50.000%\n\n\n2012-11-28\n210000\n2\n25.00\n56.250%\n\n\n2013-10-09\n262500\n2\n25.00\n62.500%\n\n\n2014-08-11\n315000\n2\n25.00\n68.750%\n\n\n2015-07-29\n367500\n2\n25.00\n75.000%\n\n\n2016-07-09\n420000\n3\n12.50\n78.125%\n\n\n2017-06-23\n472500\n3\n12.50\n81.250%\n\n\n2018-05-29\n525000\n3\n12.50\n84.375%\n\n\n\n\n\n\nBlock rate\n\n\nBased my average hashrate and the historical network hashrate, the plot below shows how many Bitcoins I could have mined if I didn’t denote my computers’ computing power to the World Community Grid but to Bitcoin mining – 14.8 Bitcoins!\n\n\n\nBitcoins forgone\n\n\nOkay, problem solved.\nIf I’ve really mined these 14.8 Bitcoins, then I’ll probably have a shot at becoming a millionaire, if again I could hold them and time the market perfectly. At Bitcoin’s highest historical price in Australian dollar, 14.8 Bitcoins are roughly 380,505 dollars. Even if I follow the redefined BOINC credit, I still could have mined half of the 14.8 Bitcoins and potentially pocketed 190k dollars.\nI’ve also participated in more than just World Community Grid, including some famous ones like SETI@Home and Einstein@Home. Below are two certificates of contributed computing power.\n\n\n\nSETI\n\n\n\n\n\nEinstein\n\n\nSo together I’ve put in about 2.28 quintillion, or 2.28E18, FLOPs into these two projects.\nThe funny thing is that I’ve put in only 348 PetaFLOPs into World Community Grid during this entire period, or 0.348 quintillion FLOPs in total.\nHence, if my donation of computing power to SETI@Home and Einstein@Home happened at similar time as to WCG, then potentially I could have mined at least 6 times more Bitcoins. Well, I couldn’t imagine what my life would be if I’ve mined 100 Bitcoins, which might be $2.5 million.\n\n\n\n\n Back to top"
  },
  {
    "objectID": "posts/adding-another-factor-to-principal-agent-model/index.html",
    "href": "posts/adding-another-factor-to-principal-agent-model/index.html",
    "title": "Adding Another Factor to Principal-Agent Model",
    "section": "",
    "text": "In a traditional principal-agent model, firm output is a function of the agent’s effort and the principal observes only the output not agent’s effort. The principal carefully designs the agent’s compensation package, especially the sensitivity of the agent’s pay to firm output, to maximize the firm value. Now, what if we add another factor to the relationship between firm output and agent’s effort? How would the optimal pay sensitivity change?\n\nMy earlier paper (Gao, Leung, and Qiu 2021) studied this issue by assuming such a factor, organization capital, that substitutes agent’s effort in improving firm output. I find that if firm output is a function of two substituting factors (of which one is agent’s effort), the optimal sensitivity of agent’s pay to firm output can be both higher or lower, depending on the principal’s choice.\nTo yield this two-way prediction, let’s see a simple extension to the standard principal-agent model following Holmstrom and Milgrom (1987), where the principal hires an agent (CEO) to run the firm. We added organization capital (OC) as an additional determinant of firm outcomes, but in fact we can assume any factor, e.g., intellectual property, IT infrastructure, etc., that either strengthens or weakens the relation between firm output and executive effort."
  },
  {
    "objectID": "posts/adding-another-factor-to-principal-agent-model/index.html#background",
    "href": "posts/adding-another-factor-to-principal-agent-model/index.html#background",
    "title": "Adding Another Factor to Principal-Agent Model",
    "section": "",
    "text": "In a traditional principal-agent model, firm output is a function of the agent’s effort and the principal observes only the output not agent’s effort. The principal carefully designs the agent’s compensation package, especially the sensitivity of the agent’s pay to firm output, to maximize the firm value. Now, what if we add another factor to the relationship between firm output and agent’s effort? How would the optimal pay sensitivity change?\n\nMy earlier paper (Gao, Leung, and Qiu 2021) studied this issue by assuming such a factor, organization capital, that substitutes agent’s effort in improving firm output. I find that if firm output is a function of two substituting factors (of which one is agent’s effort), the optimal sensitivity of agent’s pay to firm output can be both higher or lower, depending on the principal’s choice.\nTo yield this two-way prediction, let’s see a simple extension to the standard principal-agent model following Holmstrom and Milgrom (1987), where the principal hires an agent (CEO) to run the firm. We added organization capital (OC) as an additional determinant of firm outcomes, but in fact we can assume any factor, e.g., intellectual property, IT infrastructure, etc., that either strengthens or weakens the relation between firm output and executive effort."
  },
  {
    "objectID": "posts/adding-another-factor-to-principal-agent-model/index.html#model",
    "href": "posts/adding-another-factor-to-principal-agent-model/index.html#model",
    "title": "Adding Another Factor to Principal-Agent Model",
    "section": "Model",
    "text": "Model\nThe production function is given by \\(V(a,o)=f(a,o)+\\varepsilon\\), where \\(a\\) is the effort by the agent, \\(o\\) is the firm’s organization capital, and \\(\\varepsilon\\) is random noise.\n\n\\(f(a,o)\\) is an increasing function in both \\(a\\) and \\(o\\). The substitutability of OC and executive effort implies that \\(\\frac{\\partial^2}{\\partial o \\partial a}f(a,o)&lt;0\\), i.e., OC reduces the marginal effect of any agent action on firm outcomes.\nWithout loss of generality, we assume \\(f(a,o)=a+(1-a)o\\), where both \\(a\\) and \\(o\\) follow a continuous uniform distribution from 0 to 1.\n\nThe agent is paid a wage \\(c(V)\\) and has reservation utility of \\(\\underline U\\). His objective function is given by \\(E\\left[U\\right]=E\\left[u\\left(v\\left(c\\right)-g\\left(a\\right)\\right)\\right]\\).\n\nThe increasing and weakly convex function \\(g\\) represents the cost of effort.\nThe function \\(u\\) represents his utility function and \\(v\\) represents his felicity function (i.e., his utility from cash), both increasing and weakly concave.\nThe functions \\(g\\), \\(u\\) and \\(v\\) are all twice continuously differentiable.\n\nThe risk-neutral principal chooses the effort level \\(a\\) and contract \\(c\\) to maximize the expected firm value minus the wage paid to the agent,\n\\[\n    \\max_{c(\\cdot),a} E\\left[V\\left(a,o\\right)-c\\left(V\\left(a,o\\right)\\right)\\right]\n\\]\nsubject to the individual rationality or participation constraint (IR) and incentive compatibility constraint (IC) as follows:\n\\[\n\\begin{align}\n&E\\left[u\\left(v\\left(c\\left(V\\left(a,o\\right)\\right)\\right)-g\\left(a\\right)\\right)\\right] \\ge \\underline{U} \\\\\n&a \\in \\arg\\max_{\\hat{a}}E\\left[u\\left(v\\left(c\\left(V\\left(\\hat{a},o\\right)\\right)\\right)-g\\left(\\hat{a}\\right)\\right)\\right]\n\\end{align}\n\\]\nWe first consider the case where the optimal effort is determined endogenously. Under the Holmstrom and Milgrom (1987) framework, the following assumptions are made:\n\nan exponential utility function of the agent, \\(u(x)=-e^{-\\eta x}\\), where \\(\\eta\\) is the coefficient of constant absolute risk aversion,\n\\(v(c)=c\\), such that cost of effort is pecuniary and can be viewed as a subtraction to cash pay,\na normal noise, \\(\\varepsilon \\sim N(0,\\sigma^2)\\), and\nthat the agent chooses his effort continuously in a multiperiod model and the optimal contract is linear, i.e., \\(c=\\phi+\\theta V\\), where \\(\\phi\\) is the fixed wage and \\(\\theta\\) represents the proportion of firm outcomes shared with the agent via compensation (i.e., \\(\\theta\\) represents the agent’s pay-for-performance sensitivity).\n\nFurther, Holmstrom and Milgrom (1987) show that the problem is equivalent to a single-period static problem under these assumptions. For simplicity, we also assume a quadratic cost of effort, \\(g(a)=\\frac{1}{2}ga^2\\), so that the principal’s optimization problem becomes:\n\\[\n    \\max_{\\phi,\\theta,a^*} E\\left[V-c\\right]\n\\]\nsubject to\n\\[\n\\begin{align}\n&E\\left[-e^{-\\eta\\left(c-\\frac{1}{2}ga^{*2}\\right)}\\right] \\ge \\underline{U} \\\\\n& a^* \\in \\arg\\max_{\\hat{a}} E\\left[-e^{-\\eta\\left(c-\\frac{1}{2}g\\hat{a}^2\\right)}\\right]\n\\end{align}\n\\]\nSubstituting in \\(c=\\phi+\\theta V\\) and \\(V(a,o)=f(a,o)+\\varepsilon\\), maximizing the agent’s (negative exponential) utility function is equivalent to maximizing \\(\\phi+\\theta f(a,o)-\\frac{1}{2}ga^2-\\frac{1}{2}\\eta \\theta^2 \\sigma^2\\).\nSince \\(f(a,o)=a+(1-a)o\\), the first-order condition of the agent’s objective function with respect to a is given by \\(a^*=\\theta(1-o)⁄g\\), which implies his effort choice is decreasing in the cost of effort \\(g\\), decreasing in the firm’s organization capital \\(o\\), and increasing in the pay-for-performance sensitivity \\(\\theta\\).\nMoreover, his chosen effort is independent of the fixed wage \\(\\phi\\), so that the principal can adjust the fixed pay to satisfy his participation constraint without affecting the incentives. Substituting \\(a^*=\\theta(1-o)⁄g\\) into the principal’s objective function and setting the participation constraint to bind, the optimal level of pay-for-performance sensitivity is given by:\n\\[\n    \\theta = \\frac{1}{1+\\eta g \\frac{\\sigma^2}{(1-o)^2}}\n\\]\n\n\n\n\n\n\nNote\n\n\n\nThis optimal level of pay-for-performance sensitivity is derived as follows. Substituting \\(c=\\phi + \\theta V\\) and \\(V(a,o)=f(a,o)+\\varepsilon\\) into the agent’s objective function of \\(E\\left[U\\right]=E\\left[u\\left(v(c)-g(a)\\right)\\right]\\), where \\(u(x)=-e^{-\\eta x}\\), \\(v(c)=c\\), and \\(\\varepsilon \\sim N(0,\\sigma^2)\\), we obtain:\n\\[\n\\begin{align}\n  E\\left[U\\right] &= E\\left[e^{-\\eta \\left(\\phi+\\theta f(a,o)+\\theta\\varepsilon-\\frac{1}{2}ga^2\\right)}\\right] \\\\\n  &= -E\\left[e^{-\\eta \\left(\\phi+\\theta f(a,o)-\\frac{1}{2}ga^2\\right)}\\right] \\times E\\left[e^{-\\eta \\theta \\varepsilon}\\right]\\\\\n  &= -e^{-\\eta \\left(\\phi+\\theta f(a,o)-\\frac{1}{2}ga^2\\right)} \\times e^{\\frac{\\eta^2 \\theta^2 \\sigma^2}{2}} \\\\\n  &= -e^{-\\eta \\left(\\phi+\\theta f(a,o)-\\frac{1}{2}ga^2-\\frac{1}{2}\\eta \\theta^2 \\sigma^2\\right)}\n\\end{align}\n\\]\nThe first-order condition (FOC) of the agent with respect to \\(a\\) is given by\n\\[\n  \\frac{\\partial}{\\partial a}\\left(\\phi+\\theta f(a^*,o)-\\frac{1}{2}ga^{*2}-\\frac{1}{2}\\eta\\theta^2\\sigma^2\\right)=0\n\\]\nSince we assume \\(f(a,o)=a+(1-a)o\\), this yields the agent’s FOC:\n\\[\n  a^*=\\theta(1-o)/g\n\\]\nSetting the participation constraint to bind, we have\n\\[\n  E\\left[U\\right] = -e^{-\\eta\\left(\\phi+\\theta\\left(a^*+(1-a^*)o\\right)-\\frac{1}{2}ga^{*2}-\\frac{1}{2}\\eta\\theta^2\\sigma^2\\right)} = \\underline{U}\n\\]\nThe above equation implies:\n\\[\n  \\phi + \\theta\\left(a^*+\\left(1-a^*\\right)o\\right)-\\frac{1}{2}ga^{*2}-\\frac{1}{2}\\eta\\theta^2\\sigma^2=w\n\\]\nwhere \\(w\\equiv -\\ln(-\\underline{U})/\\eta\\) is a constant determined by the agent’s reservation utility and his coefficient of constant absolute risk aversion. Substituting in \\(a^*=\\theta(1-o)/g\\), we yield\n\\[\n  E\\left[c\\right] = \\phi + \\theta E\\left[V\\right] \\\\\n  = w+\\frac{\\theta^2(1-o)^2}{2g} +\\frac{1}{2}\\eta\\theta^2\\sigma^2\n\\]\nThus, by substituting \\(a^*=\\theta(1-o)/g\\) into the principal’s objective function \\(E\\left[V-c\\right]\\), we yield\n\\[\n  a^*+(1-a^*)o-\\left[w+\\frac{\\theta^2(1-o)^2}{2g}+\\frac{1}{2}\\eta\\theta^2\\sigma^2\\right] \\\\\n  =\\frac{\\theta}{g}(1-o)^2+o-\\left[w+\\frac{\\theta^2(1-o)^2}{2g}+\\frac{1}{2}\\eta\\theta^2\\sigma^2\\right]\n\\]\nThe principal’s FOC with respect to \\(\\theta\\) yields:\n\\[\n  \\theta = \\frac{1}{1+\\eta g \\frac{\\sigma^2}{(1-o)^2}}\n\\]\n\n\nOther things equal, we can see that the optimal pay-for-performance sensitivity \\(\\theta\\) is decreasing in the firm’s organization capital \\(o\\). Specifically, this substitution effect is from the fact that OC reduces the marginal effect of executive effort on firm outcomes and thus reduces the optimal effort level endogenously.\nOn the other hand, fixing \\(a^*\\), the required pay-for-performance sensitivity is \\(\\theta=(a^* g)/(1-o)\\), which is increasing in organization capital \\(o\\). Thus, to elicit any given level of effort, the incentive compensation must be more high-powered (“fixed target action” as in Edmans and Gabaix (2016)."
  },
  {
    "objectID": "posts/adding-another-factor-to-principal-agent-model/index.html#implications",
    "href": "posts/adding-another-factor-to-principal-agent-model/index.html#implications",
    "title": "Adding Another Factor to Principal-Agent Model",
    "section": "Implications",
    "text": "Implications\nThe relation between OC and executive pay-for-performance sensitivity depends critically on the optimal level of effort the principal wants to implement:\n\nIf the principal wants to implement a fixed target action (e.g., \\(a=1\\) in our case, or to induce full effort in general), the optimal \\(\\theta\\) is increasing in the firm’s organization capital.\nIf the principal trades off the benefits and costs of high effort, the optimal \\(\\theta\\) is decreasing in the firm’s organization capital.\n\nTherefore, the model offers two empirical predictions. On the one hand, high OC firms may offer higher pay-for-performance sensitivity to induce executive effort. On the other hand, pay-for-performance sensitivity may be reduced in high OC firms as a result of efficiency gains from the substitution of OC for executive effort.\nNow, coming back at the question at the beginning, adding another factor to the principal-agent model may cause the optimal pay structure to change in either direction, even if such factor has a directional impact on the relation between firm output and agent’s effort. In our case, such factor reduces the marginal effect of agent’s effort on firm output. But one can easily find many other factors that may increase the marginal effect of agent’s effort and yield similar predictions.\nPerhaps, what’s also interesting is that, if we know the directional effect of a factor while observing both pay-for-performance sensitivity and the level of such factor, we may be able to infer whether the principal elicits full executive effort at all costs. Paired with firm performance, could this be some indicators of governance or board ability? Seems like some future research questions.\n\nThis post is adapted from the online appendix of Gao, Leung, and Qiu (2021)."
  },
  {
    "objectID": "posts/bitcoin-address-generator-in-obfuscated-python/index.html",
    "href": "posts/bitcoin-address-generator-in-obfuscated-python/index.html",
    "title": "Bitcoin Address Generator in Obfuscated Python",
    "section": "",
    "text": "Never underestimate what programmers can do.\n\nThe code below shows a fully-functioning Bitcoin address generator in obfuscated Python (2.5-2.7), which I saw in an interesting article posted in 2013.\n_                   =r\"\"\"A(W/2,*M(3*G\n               *G*V(2*J%P),G,J,G)+((M((J-T\n            )*V((G-S)%P),S,T,G)if(S@(G,J))if(\n         W%2@(S,T)))if(W@(S,T);H=2**256;import&h\n       ashlib&as&h,os,re,bi    nascii&as&k;J$:int(\n     k.b2a_hex(W),16);C$:C    (W/    58)+[W%58]if(W@\n    [];X=h.new(\"rip           em    d160\");Y$:h.sha25\n   6(W).digest();I$                 d=32:I(W/256,d-1)+\n  chr(W%256)if(d&gt;0@\"\";                  U$:J(k.a2b_base\n 64(W));f=J(os.urando       m(64))        %(H-U(\"AUVRIxl\nQt1/EQC2hcy/JvsA=\"))+      1;M$Q,R,G       :((W*W-Q-G)%P,\n(W*(G+2*Q-W*W)-R)%P)       ;P=H-2**       32-977;V$Q=P,L=\n1,O=0:V(Q%W,W,O-Q/W*                      L,L)if(W@O%P;S,\nT=A(f,U(\"eb5mfvncu6                    xVoGKVzocLBwKb/Nst\nzijZWfKBWxb4F5g=\"),      U(\"SDra         dyajxGVdpPv8DhEI\nqP0XtEimhVQZnEfQj/       sQ1Lg=\"),        0,0);F$:\"1\"+F(W\n [1:])if(W[:1           ]==\"\\0\"@\"\"        .join(map(B,C(\n  J(W))));K$:               F(W          +Y(Y(W))[:4]);\n   X.update(Y(\"\\4\"+                     I(S)+I(T)));B$\n    :re.sub(\"[0OIl    _]|            [^\\\\w]\",\"\",\"\".jo\n     in(map(chr,ra    nge    (123))))[W];print\"Addre\n       ss:\",K(\"\\0\"+X.dig    est())+\"\\nPrivkey:\",K(\n         \"\\x80\"+I(f))\"\"\";exec(reduce(lambda W,X:\n            W.replace(*X),zip(\" \\n&$@\",[\"\",\"\",\n               \" \",\"=lambda W,\",\")else \"])\n                    ,\"A$G,J,S,T:\"+_))\nI’ve tested it on Python 2.7 on Ubuntu. Working like a charm.\n\n\n\nScreenshot of running the obfuscated code to generate a Bitcoin address\n\n\n\n\n\n\n\n\nWarning\n\n\n\nDon’t use this address! The private key is not private!\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "posts/call-option-value-from-two-approaches/index.html",
    "href": "posts/call-option-value-from-two-approaches/index.html",
    "title": "Call Option Value from Two Approaches",
    "section": "",
    "text": "Suppose today the stock price is \\(S\\) and in one year time, the stock price could be either \\(S_1\\) or \\(S_2\\). You hold an European call option on this stock with an exercise price of \\(X=S\\), where \\(S_1&lt;X&lt;S_2\\) for simplicity. So you’ll exercise the call when the stock price turns out to be \\(S_2\\) and leave it unexercised if \\(S_1\\)."
  },
  {
    "objectID": "posts/call-option-value-from-two-approaches/index.html#replicating-portfolio-approach",
    "href": "posts/call-option-value-from-two-approaches/index.html#replicating-portfolio-approach",
    "title": "Call Option Value from Two Approaches",
    "section": "1. Replicating Portfolio Approach",
    "text": "1. Replicating Portfolio Approach\n\n\n\n\n\n\n\n\n\nCase 1\nCase 2\n\n\n\n\nStock Price\n\\(S_1\\)\n\\(S_2\\)\n\n\nOption: 1 Call of cost \\(c\\)\n\n\n\n\nExercise?\nNo\nYes\n\n\nPayoff (to replicate)\n0\n\\(S_2-X\\)\n\n\nStock: \\(\\delta\\) shares of cost \\(\\delta S\\)\n\n\n\n\nPayoff\n\\(\\delta S_1\\)\n\\(\\delta S_2\\)\n\n\nBorrowing PV(K)\n\n\n\n\nRepay\nK\nK\n\n\n\nSo we have:\n\\[\n\\begin{equation}\n\\delta S_1-K=0\n\\end{equation}\n\\]\n\\[\n\\begin{equation}\n\\delta S_2 -K = S_2-X\n\\end{equation}\n\\]\nTherefore, the call option value is given by the difference between the cost of \\(\\delta\\) units of shares and the amount of borrowing:\n\\[\n\\begin{align}\nc_{REP} &= \\delta S - PV(K) \\newline\n  &= \\delta S - Ke^{-r_f} \\newline\n  &= \\delta S - \\delta S_1e^{-r_f}\n\\end{align}\n\\]\nWhen \\(\\delta\\) is defined as \\(\\frac{(S_2-X)-0}{S_2-S_1}\\) as in the textbook (at introductory level),\n\\[\n\\begin{equation}\n  c_{REP}= \\frac{S_2-X}{S_2-S_1}(S - S_1e^{-r_f})\n\\end{equation}\n\\]"
  },
  {
    "objectID": "posts/call-option-value-from-two-approaches/index.html#risk-neutral-approach",
    "href": "posts/call-option-value-from-two-approaches/index.html#risk-neutral-approach",
    "title": "Call Option Value from Two Approaches",
    "section": "2. Risk Neutral Approach",
    "text": "2. Risk Neutral Approach\nWithout too much trouble, we can derive the call value using risk neutral approach as\n\\[\n\\begin{align}\nc_{RN} &= \\frac{p(S_2-X)+(1-p)\\times0}{e^{r_f}}\\newline\n&= \\frac{p(S_2-X)+0}{e^{r_f}}\\newline\n&= p(S_2-X) e^{-r_f}\n\\end{align}\n\\]\nWe know that\n\\[\n\\begin{equation}\np\\times \\frac{S_2}{S} + (1-p)\\frac{S_1}{S} = e^{r_f}\n\\end{equation}\n\\]\nso\n\\[\n\\begin{align}\np &= \\frac{e^{r_f}-\\frac{S_1}{S}}{\\frac{S_2}{S}-\\frac{S_1}{S}}\\newline\n&=\\frac{Se^{r_f}-S_1}{S_2-S_1}\n\\end{align}\n\\]\nTherefore,\n\\[\n\\begin{align}\nc_{RN} &= p(S_2-X) e^{r_f}\\newline\n&=\\frac{Se^{r_f}-S_1}{S_2-S_1}(S_2-X) e^{-r_f}\\newline\n&=\\frac{S-S_1e^{-r_f}}{S_2-S_1}(S_2-X)\n\\end{align}\n\\]"
  },
  {
    "objectID": "posts/call-option-value-from-two-approaches/index.html#identical-result-from-the-two-methods",
    "href": "posts/call-option-value-from-two-approaches/index.html#identical-result-from-the-two-methods",
    "title": "Call Option Value from Two Approaches",
    "section": "Identical Result from the Two Methods",
    "text": "Identical Result from the Two Methods\nIt’s easy to find that\n\\[\nc_{RN} = c_{REP}\n\\]\nHence, the call option value from replicating portfolio is the same as from risk neutral approach."
  },
  {
    "objectID": "posts/compute-jackknife-coefficient-estimates-in-sas/index.html",
    "href": "posts/compute-jackknife-coefficient-estimates-in-sas/index.html",
    "title": "Compute Jackknife Coefficient Estimates in SAS",
    "section": "",
    "text": "In certain scenarios, we want to estimate a model’s parameters on the sample for each observation with itself excluded. This can be achieved by estimating the model repeatedly on the leave-one-out samples but is very inefficient. If we estimate the model on the full sample, however, the coefficient estimates will certainly be biased. Thankfully, we have the Jackknife method to correct for the bias, which produces the Jackknifed coefficient estimates for each observation."
  },
  {
    "objectID": "posts/compute-jackknife-coefficient-estimates-in-sas/index.html#variable-definition",
    "href": "posts/compute-jackknife-coefficient-estimates-in-sas/index.html#variable-definition",
    "title": "Compute Jackknife Coefficient Estimates in SAS",
    "section": "Variable Definition",
    "text": "Variable Definition\nLet’s start with some variable definitions to help with the explanation.\n\n\n\n\n\n\n\nVariable\nDefinition\n\n\n\n\n\\(b(i)\\)\nthe parameter estimates after deleting the \\(i\\)th observation\n\n\n\\(s^2(i)\\)\nthe variance estimate after deleting the \\(i\\)th observation\n\n\n\\(X(i)\\)\nthe \\(X\\) matrix without the \\(i\\)th observation\n\n\n\\(\\hat{y}(i)\\)\nthe \\(i\\)th value predicted without using the \\(i\\)th observation\n\n\n\\(r_i = y_i - \\hat{y}_i\\)\nthe \\(i\\)th residual\n\n\n\\(h_i = x_i(X'X)^{-1}x_i'\\)\nthe \\(i\\)th diagonal of the projection matrix for the predictor space, also called the hat matrix\n\n\n\\(RStudent =\\frac{r_i}{s(i) \\sqrt{1-h_i}}\\)\nstudentized residual\n\n\n\\((X'X)_{jj}\\)\nthe \\((j,j)\\)th element of \\((X'X)^{-1}\\)\n\n\n\\(DFBeta_j = \\frac{b_{j} - b_{(i)j}}{s(i)\\sqrt{(X'X)_{jj}}}\\)\nthe scaled measures of the change in the \\(j\\)th parameter estimate calculated by deleting the \\(i\\)th observation"
  },
  {
    "objectID": "posts/compute-jackknife-coefficient-estimates-in-sas/index.html#objective",
    "href": "posts/compute-jackknife-coefficient-estimates-in-sas/index.html#objective",
    "title": "Compute Jackknife Coefficient Estimates in SAS",
    "section": "Objective",
    "text": "Objective\nCompute the coefficient estiamtes with the \\(i\\)th observation excluded from the sample, i.e. \\(b(i)\\), or the Jackknifed coefficient estimate."
  },
  {
    "objectID": "posts/compute-jackknife-coefficient-estimates-in-sas/index.html#formula",
    "href": "posts/compute-jackknife-coefficient-estimates-in-sas/index.html#formula",
    "title": "Compute Jackknife Coefficient Estimates in SAS",
    "section": "Formula",
    "text": "Formula\nFrom the table above, we can get that the \\(j\\)th Jackknifed coefficient estimate \\(b_{(i)j}\\) without using the \\(i\\)th observation is:\n\\[b_{(i)j} = b_j - DFBeta_j \\times s(i) \\sqrt{(X'X)_{jj}} \\]\nHence,\n\\[b_{(i)j} = b_j - DFBeta_j \\times \\frac{r_i}{RStudent\\times \\sqrt{1-h_i}} \\sqrt{(X'X)_{jj}}\\]\nThe good thing is that PROC REG produces the coefficient estimate \\(b_j\\) for \\(j=1,2,...K\\), where \\(K\\) is the number of coefficients, and the INFLUENCE and I options produce the remaining statistics just enough to compute \\(b(i)\\):\n\n\n\n\n\n\n\n\nVariable\nOption in PROC REG or MODEL statement\nName in the output dataset\n\n\n\n\n\\(b_j\\)\nOutest= option in PROC REG\n&lt;jthVariable&gt;\n\n\n\\(r_i\\)\nOutputStatistics= from INFLUENCE option in MODEL statement\nResidual\n\n\n\\(RStudent\\)\nOutputStatistics= from INFLUENCE option in MODEL statement\nRStudent\n\n\n\\(h_i\\)\nOutputStatistics= from INFLUENCE option in MODEL statement\nHatDiagnol\n\n\n\\(DFBeta_j\\)\nOutputStatistics= from INFLUENCE option in MODEL statement\nDFB_&lt;jthVariable&gt;\n\n\n\\((X'X)_{jj}\\)\nInvXPX= from I option in MODEL statement\n&lt;jthVariable&gt;"
  },
  {
    "objectID": "posts/compute-jackknife-coefficient-estimates-in-sas/index.html#discretionary-accruals",
    "href": "posts/compute-jackknife-coefficient-estimates-in-sas/index.html#discretionary-accruals",
    "title": "Compute Jackknife Coefficient Estimates in SAS",
    "section": "Discretionary accruals",
    "text": "Discretionary accruals\nSuppose we want to calculate the firm-level discretionary accruals for each year using the Jones (1991) model and Kothari, Leone, and Wasley (2005) model. For a firm \\(i\\), we need to first estimate the model for the industry-year excluding firm \\(i\\), then use the coefficient estimates to generate predicted accruals for firm \\(i\\). The firm’s discretionary accruals is the actual accruals minus the predicted accruals.\nBelow is an example PROC REG that produces three datasets named work.params, work.outstats and work.xpxinv, which contain sufficient statistics to compute the Jackknifed estimates and thus the predicted accruals.\nods listing close; \nproc reg data=work.funda edf outest=work.params;\n  /* industry-year regression */\n  by fyear sic2;\n  /* id is necessary for later matching Jackknifed coefficients to firm-year */\n  id key;\n  /* Jones Model */\n  Jones: model tac = inv_at_l drev ppe / noint influence i;\n  /* Kothari Model with ROA */\n  Kothari: model tac = inv_at_l drevadj ppe roa / noint influence i;\n  ods output OutputStatistics=work.outstats InvXPX=work.xpxinv;\nrun;\nods listing;\nFull SAS program for estimating 5 different measures of discretionary accruals:"
  },
  {
    "objectID": "posts/convert-between-numeric-and-character-variables/index.html",
    "href": "posts/convert-between-numeric-and-character-variables/index.html",
    "title": "Convert Between Numeric and Character Variables",
    "section": "",
    "text": "Converting between numeric and character variables is one of the most frequently encountered issues when processing datasets. This article explains how to do this conversion correctly and efficiently."
  },
  {
    "objectID": "posts/convert-between-numeric-and-character-variables/index.html#numeric-to-character",
    "href": "posts/convert-between-numeric-and-character-variables/index.html#numeric-to-character",
    "title": "Convert Between Numeric and Character Variables",
    "section": "Numeric to Character",
    "text": "Numeric to Character\nAssume there’s an imported dataset named filings, where cik is stored as a numeric variable as shown below:\n\n\n\ncik\nfile_type\ndate\n\n\n\n\n1000229\n8-K\n2011-09-30\n\n\n100591\n8-K\n2006-05-11\n\n\n100826\n8-K\n2009-06-30\n\n\n93542\n8-K\n2007-01-25\n\n\n\nBecause cik is of different digits, to convert the numeric cik into a character variable, the natural procedure is to pad it with leading zeros. For example, cik (Central Index Key) itself is a 10-digit number used by SEC.\nIn SAS, convert numeric variable to string with leading zeros (assuming 10-digit fixed length) is done via PUT() function:\ndata filings(drop=cik); set filings;\n    cik_char = put(cik, z10.); \nrun;\n\n\n\n\n\n\nTip\n\n\n\nPUT() function also works in PROC SQL.\n\n\nThe generated cik_char variable is of format and informat $10., and the dataset becomes:\n\n\n\ncik_char\nfile_type\ndate\n\n\n\n\n0001000229\n8-K\n2011-09-30\n\n\n0000100591\n8-K\n2006-05-11\n\n\n0000100826\n8-K\n2009-06-30\n\n\n0000093542\n8-K\n2007-01-25\n\n\n\nIn STATA, convert numeric variable to string with leading zeros (assuming 6-digit fixed length) can be achieved via the string() function.\ngen char_var = string(num_var,\"%06.0f\")"
  },
  {
    "objectID": "posts/convert-between-numeric-and-character-variables/index.html#character-to-numeric",
    "href": "posts/convert-between-numeric-and-character-variables/index.html#character-to-numeric",
    "title": "Convert Between Numeric and Character Variables",
    "section": "Character to Numeric",
    "text": "Character to Numeric\nIn SAS, converting a character variable to a numeric one uses the INPUT() function:\nvar_numeric = input(var_char, best12.);\nIn STATA, this conversion be can be done via either real() function or destring command.\ngen num_var = real(char_var);\nThe real() function works on a single variable. destring command can convert all character variables into numeric in one go.\ndestring, repalce\n\n\n\n\n\n\nWarning\n\n\n\nIf a character variable has non-numeric characters in it, then it will not be converted. In such a case, you may choose to use the encode command, although it in fact is generating categories.\n\n\nA more detailed explanation with examples is available at stats.idre.ucla.edu"
  },
  {
    "objectID": "posts/crsp-missing-codes/index.html",
    "href": "posts/crsp-missing-codes/index.html",
    "title": "CRSP Missing Codes",
    "section": "",
    "text": "A note on the missing codes in CRSP.1"
  },
  {
    "objectID": "posts/crsp-missing-codes/index.html#note",
    "href": "posts/crsp-missing-codes/index.html#note",
    "title": "CRSP Missing Codes",
    "section": "Note",
    "text": "Note\n\nPRC: A positive amount is an actual close for the trading date while a negative amount denotes the average between BIDLO and ASKHI.\n\nUnits:\n\nMost prices are represented in U.S. dollar values per share.\nSHROUT in thousands.\nVOL: The sum of the trading volumes during the month, reported in units of 100, and are not adjusted for splits during the month."
  },
  {
    "objectID": "posts/developing-a-bank-simulation-software/index.html",
    "href": "posts/developing-a-bank-simulation-software/index.html",
    "title": "Developing a Bank Simulation Software",
    "section": "",
    "text": "In 2025, I plan to incorporate BRMS (Bank Risk Management Simulation) into my teaching to provide students with a hands-on approach to understanding bank risk and financial intermediation. The project aims to feature\nIn this post, I’ll demonstrate the current capabilities of BRMS. Along the way, I’ll touch on key aspects of bank accounting, provide some example code, and showcase outputs."
  },
  {
    "objectID": "posts/developing-a-bank-simulation-software/index.html#simple-banking-book-accounting",
    "href": "posts/developing-a-bank-simulation-software/index.html#simple-banking-book-accounting",
    "title": "Developing a Bank Simulation Software",
    "section": "Simple banking book accounting",
    "text": "Simple banking book accounting\nTo begin with, a simple bank has just been established with shareholders’ contribution of $10,000. Its balance sheet is shown as below.\n\n\n\n\nA new bank has just been established.\nimport datetime\nfrom brms.accounting.account import AccountBalances\nfrom brms.accounting.report import Report\nfrom brms.accounting.statement_viewer import HTMLStatementViewer\nfrom brms.models.bank import Bank\n\n\nbank = Bank()\nbalances = AccountBalances(\n    {\n        bank.chart_of_accounts.cash_account: 10_000,\n        bank.chart_of_accounts.equity_account: 10_000,\n    },\n)\nbank.initialize(balances)\nviewer = HTMLStatementViewer(jupyter=True, hide_zero_balance_accounts=True)\n\ntoday = datetime.date(2025, 1, 20)\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_balance_sheet()\n\n\n                Balance Sheet                 \n ──────────────────────────────────────────── \n  Assets                                      \n    Cash and Cash Equivalents     $10,000.00  \n  Total assets                    $10,000.00  \n ──────────────────────────────────────────── \n  Liabilities                                 \n  Total liabilities                    $0.00  \n ──────────────────────────────────────────── \n  Net assets                      $10,000.00  \n ──────────────────────────────────────────── \n  Shareholders' equity                        \n    Shareholders' Equity          $10,000.00  \n  Total shareholders' equity      $10,000.00  \n ──────────────────────────────────────────── \n                              Date: 2025-01-20\n\n\n\n\n\n\nCustomer deposit\nNow some customers have made some deposits, for example:\n\nCustomer A deposits $60,000.\nCustomer B deposits $40,000.\nCustomer C deposits $20,000.\n\nNotably, customer deposits are the bank’s liability. We see an increase in both the bank’s total assets and total liabilities, while total shareholders’ equity remains unchanged.\n\n\n\n\nSome customers have made deposits.\nfrom brms.instruments.factory import InstrumentFactory\nfrom brms.models.transaction import TransactionFactory, TransactionType\n\ncustomer_A_deposit = InstrumentFactory.create_deposit(value=60_000)\ncustomer_B_deposit = InstrumentFactory.create_deposit(value=40_000)\ncustomer_C_deposit = InstrumentFactory.create_deposit(value=20_000)\ntx_deposit1 = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.DEPOSIT_RECEIVED,\n    instrument=customer_A_deposit,\n    transaction_date=today,\n    description=\"Customer A's Deposits\",\n)\ntx_deposit2 = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.DEPOSIT_RECEIVED,\n    instrument=customer_B_deposit,\n    transaction_date=today,\n    description=\"Customer B's Deposits\",\n)\ntx_deposit3 = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.DEPOSIT_RECEIVED,\n    instrument=customer_C_deposit,\n    transaction_date=today,\n    description=\"Customer C's Deposits\",\n)\nbank.process_transaction(tx_deposit1)\nbank.process_transaction(tx_deposit2)\nbank.process_transaction(tx_deposit3)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_balance_sheet()\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                $130,000.00  \n  Total assets                               $130,000.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $120,000.00  \n      Deposits                               $120,000.00  \n  Total liabilities                          $120,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $10,000.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n  Total shareholders' equity                  $10,000.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-01-20\n\n\n\n\n\n\n\nDeposit withdraw\nDepositors can also withdraw from the bank. If Customer C has withdrawn all of their deposits, we see a decrease of cash and deposits.\n\n\n\n\nCustomer C has withdrawn their deposits.\nfrom brms.models.transaction import DepositWithdrawTransaction\n\ntx_deposit_withdraw = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.DEPOSIT_WITHDRAWAL,\n    instrument=customer_C_deposit,\n    transaction_date=today,\n    description=\"Customer C withdraw\",\n)\nbank.process_transaction(tx_deposit_withdraw)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_balance_sheet()\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                $110,000.00  \n  Total assets                               $110,000.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $10,000.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n  Total shareholders' equity                  $10,000.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-01-20\n\n\n\n\n\n\n\nLoan disbursement\nOf course, the typical business of a bank is to make loans. Let’s assume the bank has made an (interest-only) loan of $80,000 to some borrowers.\n\n\n\n\nThe bank has made some loans.\nfrom brms.instruments.base import Instrument\nfrom brms.instruments.mock import MockInstrument\nfrom brms.models.transaction import LoanDisbursementTransaction\n\n(loan := MockInstrument(\"A loan\")).value = 80_000\n# fmt: off\ntx_loan = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.LOAN_DISBURSEMENT,\n    instrument=loan,\n    transaction_date=today,\n    description=\"Loan made to a borrower\",\n)\n# fmt: on\nbank.process_transaction(tx_loan)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_balance_sheet()\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                 $30,000.00  \n    Loans and Advances                        $80,000.00  \n  Total assets                               $110,000.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $10,000.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n  Total shareholders' equity                  $10,000.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-01-20\n\n\n\n\n\n\n\nInterest paid on deposits\nAfter some time (e.g., a month), the bank may need to pay interest on customers’ deposits, e.g., $100.\n\n\n\n\n\n\nTip\n\n\n\nIncome Statement is included given that we’d like to know the profit and loss (P&L) of the bank over the period.\n\n\n\n\n\n\nIf the bank has only paid interest on deposits over the month…\nfrom brms.instruments.cash import Cash\nfrom brms.models.transaction import InterestPaidOnDepositTransaction\n\ntoday = today + datetime.timedelta(days=31)\n\ntx_interest_paid = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.INTEREST_PAID_ON_DEPOSIT,\n    instrument=Cash(value=100),\n    transaction_date=today,\n    description=\"Interest paid on deposits\",\n)\nbank.process_transaction(tx_interest_paid)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_income_statement()\nprint(\"-\" * 80)\nreport.print_balance_sheet()\n\n\n          Income Statement          \n ────────────────────────────────── \n  Income                     $0.00  \n ────────────────────────────────── \n  Expense                  $100.00  \n    Interest Expense       $100.00  \n ────────────────────────────────── \n  Profit                 ($100.00)  \n ────────────────────────────────── \n                    Date: 2025-02-20\n\n\n\n--------------------------------------------------------------------------------\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                 $29,900.00  \n    Loans and Advances                        $80,000.00  \n  Total assets                               $109,900.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                   $9,900.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n    Retained Earnings                          ($100.00)  \n  Total shareholders' equity                   $9,900.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-02-20\n\n\n\n\n\nIf the bank has only paid interest on deposits over this period, it surely has a net loss or negative profit as shown above. However, it is more reasonable that the bank also has earned some profits during the same time, especially because it has made some loans.\n\n\nLoan interest income\nSuppose that over the 1-month period, the bank has earned some interest income from the loans made earlier, e.g., for a total of $800.\n\n\n\n\n… if the bank has also earned interest from loans over the month.\ntx_interest_earned = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.LOAN_INTEREST_PAYMENT,\n    instrument=Cash(value=800),\n    transaction_date=today,\n    description=\"Interest earned from loans\",\n)\nbank.process_transaction(tx_interest_earned)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_income_statement()\nprint(\"-\" * 80)\nreport.print_balance_sheet()\n\n\n         Income Statement         \n ──────────────────────────────── \n  Income                 $800.00  \n    Interest Income      $800.00  \n ──────────────────────────────── \n  Expense                $100.00  \n    Interest Expense     $100.00  \n ──────────────────────────────── \n  Profit                 $700.00  \n ──────────────────────────────── \n                  Date: 2025-02-20\n\n\n\n--------------------------------------------------------------------------------\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                 $30,700.00  \n    Loans and Advances                        $80,000.00  \n  Total assets                               $110,700.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $10,700.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n    Retained Earnings                            $700.00  \n  Total shareholders' equity                  $10,700.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-02-20\n\n\n\n\n\nOverall, the bank has a net profit of $700. We can observe that the bank’s Retained Earnings has increased by $700, too."
  },
  {
    "objectID": "posts/developing-a-bank-simulation-software/index.html#intermediate-trading-book-accounting",
    "href": "posts/developing-a-bank-simulation-software/index.html#intermediate-trading-book-accounting",
    "title": "Developing a Bank Simulation Software",
    "section": "Intermediate trading book accounting",
    "text": "Intermediate trading book accounting\nThose transactions and non-transactions above all occur to the bank’s banking book.\nHowever, a bank also has a trading book that holds securities for short-term trading P&L purposes. These instruments are named Fair Value Through Profit and Loss (FVTPL).\nAccounting for trading book securities is relatively easy.\n\nFVTPL security purchase\nAssume that the bank just purchased a FVTPL security for its trading book at its fair value of $10,000.\n\n\n\n\nThe bank has purchased some FVTPL securities.\nfrom brms.models.base import BookType\n\nfvtpl_security = MockInstrument(\"A FVTPL Security\", BookType.TRADING_BOOK)\nfvtpl_security.value = 1_0000\ntx_fvtpl_purchase = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.SECURITY_PURCHASE_TRADING,\n    instrument=fvtpl_security,\n    transaction_date=today,\n    description=\"Purchase a FVTPL security\",\n)\nbank.process_transaction(tx_fvtpl_purchase)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_balance_sheet()\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                 $20,700.00  \n    Loans and Advances                        $80,000.00  \n    Assets at FVTPL                           $10,000.00  \n  Total assets                               $110,700.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $10,700.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n    Retained Earnings                            $700.00  \n  Total shareholders' equity                  $10,700.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-02-20\n\n\n\n\n\nThe fair value of the security is recorded on the balance sheet under the Assets at FVTPL account.\n\n\nFVTPL security marking to market\nThe fair value of FVTPL security is marked to market periodically, e.g., daily. This ensures consistency in that they are held for trading P&N in the first place.\n\nUnrealized trading loss\nIf the market value of the security went down by 5% ($500) the next day, we need to recognize this unrealized trading loss in the Income Statement.\n\n\n\n\nThe FVTPL security is marked to market with an unrealized trading loss.\nfrom brms.instruments.mock import MockValuationVisitor\n\ntoday = today + datetime.timedelta(days=1)\n# Assume that the market value of the FVTPL security went down by 5%\nnew_fvtpl_instrument_value = fvtpl_security.value * 0.95\nvaluation_visitor = MockValuationVisitor(new_value=new_fvtpl_instrument_value)\ntx_fvtpl_marked_down = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.SECURITY_FVTPL_MARK_TO_MARKET,\n    instrument=fvtpl_security,\n    transaction_date=today,\n    valuation_visitor=valuation_visitor,\n    description=\"Mark to market a FVTPL security (down)\",\n)\nbank.process_transaction(tx_fvtpl_marked_down)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_income_statement()\nprint(\"-\" * 80)\nreport.print_balance_sheet()\n\n\n               Income Statement                \n ───────────────────────────────────────────── \n  Income                              $300.00  \n    Interest Income                   $800.00  \n    Trading Income (FVTPL)          ($500.00)  \n      Unrealized Trading Loss         $500.00  \n ───────────────────────────────────────────── \n  Expense                             $100.00  \n    Interest Expense                  $100.00  \n ───────────────────────────────────────────── \n  Profit                              $200.00  \n ───────────────────────────────────────────── \n                               Date: 2025-02-21\n\n\n\n--------------------------------------------------------------------------------\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                 $20,700.00  \n    Loans and Advances                        $80,000.00  \n    Assets at FVTPL                            $9,500.00  \n  Total assets                               $110,200.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $10,200.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n    Retained Earnings                            $200.00  \n  Total shareholders' equity                  $10,200.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-02-21\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nUsually, financial reports are generated at a period’s end, such as quarter’s end or year’s end. What’s shown here should be viewed as what if we close the bank’s accounting ledger at this time and generate the reports?\nIf we were to generate the balance sheet now, such net trading loss would reduce the bank’s retained earnings.\n\n\n\n\nUnrealized trading gain\nThe day after, if the market value of the security went up by 10% ($950), we need to recognize this unrealized trading gain.\n\n\n\n\nThe FVTPL security is marked to market with an unrealized trading gain.\ntoday = today + datetime.timedelta(days=1)\n# Assume that the market value of the FVTPL security went up by 10%\nnew_fvtpl_instrument_value = fvtpl_security.value * 1.1\nvaluation_visitor = MockValuationVisitor(new_value=new_fvtpl_instrument_value)\ntx_fvtpl_marked_up = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.SECURITY_FVTPL_MARK_TO_MARKET,\n    instrument=fvtpl_security,\n    transaction_date=today,\n    valuation_visitor=valuation_visitor,\n    description=\"Mark to market a FVTPL security (up)\",\n)\nbank.process_transaction(tx_fvtpl_marked_up)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_income_statement()\nprint(\"-\" * 80)\nreport.print_balance_sheet()\n\n\n               Income Statement                \n ───────────────────────────────────────────── \n  Income                            $1,250.00  \n    Interest Income                   $800.00  \n    Trading Income (FVTPL)            $450.00  \n      Unrealized Trading Gain         $950.00  \n      Unrealized Trading Loss         $500.00  \n ───────────────────────────────────────────── \n  Expense                             $100.00  \n    Interest Expense                  $100.00  \n ───────────────────────────────────────────── \n  Profit                            $1,150.00  \n ───────────────────────────────────────────── \n                               Date: 2025-02-22\n\n\n\n--------------------------------------------------------------------------------\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                 $20,700.00  \n    Loans and Advances                        $80,000.00  \n    Assets at FVTPL                           $10,450.00  \n  Total assets                               $111,150.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $11,150.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n    Retained Earnings                          $1,150.00  \n  Total shareholders' equity                  $11,150.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-02-22\n\n\n\n\n\nAgain, if we were to close the bank’s accounting ledger now and check its balance sheet, we will see changes of the bank’s retained earnings.\n\n\n\nFVTPL security sale\nThe next day, if the bank sold the security at the prevailing market price (assumed 2% up), we recognize realized trading gain.\nTracking the P&L of this particular FVTPL security,\n\nOn day 1, we had a loss of $500 ($10,000 * 0.95 = $9,500).\nOn day 2, we had a gain of $950 ($9,500 * 1.1 = $10,450).\nOn day 3, we had a gain of $209 ($10,450 * 1.02 = $10,659).\n\nThe total P&L from this security is therefore a net gain of $659, which shows up in the Income Statement.\n\n\n\n\n\n\nNote\n\n\n\nBecause of the sale, the unrealized trading gain/loss associated with this security must be reclassified to realized gain/loss.\n\n\n\n\n\n\nThe FVTPL security is sold.\ntoday = today + datetime.timedelta(days=1)\n# Assume that the market value of the FVTPL security went up by 2%\nnew_fvtpl_instrument_value = fvtpl_security.value * 1.02\nvaluation_visitor = MockValuationVisitor(new_value=new_fvtpl_instrument_value)\ntx_fvtpl_marked_up = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.SECURITY_FVTPL_MARK_TO_MARKET,\n    instrument=fvtpl_security,\n    transaction_date=today,\n    valuation_visitor=valuation_visitor,\n    description=\"Mark to market a FVTPL security (up)\",\n)\nbank.process_transaction(tx_fvtpl_marked_up)\n# Sale transaction should be created after the previous transaction has been processed\ntx_fvtpl_sale = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.SECURITY_SALE_TRADING,\n    instrument=fvtpl_security,\n    transaction_date=today,\n    valuation_visitor=valuation_visitor,\n    description=\"Sale of FVTPL security (net gain)\",\n)\nbank.process_transaction(tx_fvtpl_sale)\n# fmt: on\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_income_statement()\nprint(\"-\" * 80)\nreport.print_balance_sheet()\n\n\n              Income Statement               \n ─────────────────────────────────────────── \n  Income                          $1,459.00  \n    Interest Income                 $800.00  \n    Trading Income (FVTPL)          $659.00  \n      Realized Trading Gain       $1,159.00  \n      Realized Trading Loss         $500.00  \n ─────────────────────────────────────────── \n  Expense                           $100.00  \n    Interest Expense                $100.00  \n ─────────────────────────────────────────── \n  Profit                          $1,359.00  \n ─────────────────────────────────────────── \n                             Date: 2025-02-23\n\n\n\n--------------------------------------------------------------------------------\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                 $31,359.00  \n    Loans and Advances                        $80,000.00  \n  Total assets                               $111,359.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $11,359.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n    Retained Earnings                          $1,359.00  \n  Total shareholders' equity                  $11,359.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-02-23\n\n\n\n\n\nCompare this balance sheet to the one before the bank purchased this FVTPL security, the retained earnings increased by exactly $659."
  },
  {
    "objectID": "posts/developing-a-bank-simulation-software/index.html#intermediate-banking-book-accounting",
    "href": "posts/developing-a-bank-simulation-software/index.html#intermediate-banking-book-accounting",
    "title": "Developing a Bank Simulation Software",
    "section": "Intermediate banking book accounting",
    "text": "Intermediate banking book accounting\nApart from loans, a bank’s banking book contains other assets that are held mostly for interest income. However, depending on whether the bank intends to hold them until maturity, these non-loan banking book assets can be either:\n\nFair Value Through Other Comprehensive Income (FVOCI), or\nAt Amortized Cost or Held to Maturity (HTM).\n\nFor example, Treasury bonds, corporate bonds, MBS, etc., are usually FVOCI or HTM banking book assets.\n\nFVOCI security purchase\nFVOCI assets in the banking book are typically debt securities that:\n\nEarn interest income for the bank.\nCan be sold before maturity but are not actively traded like FVTPL securities.\nExperience fair value changes that are recorded in Accumulated Other Comprehensive Income (AOCI) instead of directly impacting net income.\nUpon sale, unrealized gains/losses from AOCI are transferred to Net Income.\n\nAssume that the bank now purchased a Treasury bond at a fair value of $30,000. The bank may sell the bond before it matures, and hence classify it as a FVOCI asset on the banking book.\n\n\n\n\nThe bank has purchased some FVOCI securities.\nfvoci_security = MockInstrument(\"A Treausy bond (FVOCI)\", BookType.BANKING_BOOK)\nfvoci_security.value = 30_000\ntx_fvoci_purchase = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.SECURITY_PURCHASE_FVOCI,\n    instrument=fvoci_security,\n    transaction_date=today,\n    description=\"Purchase a FVOCI security\",\n)\nbank.process_transaction(tx_fvoci_purchase)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_balance_sheet()\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                  $1,359.00  \n    Loans and Advances                        $80,000.00  \n    Investment Securities                     $30,000.00  \n      Investment Securities at FVOCI          $30,000.00  \n  Total assets                               $111,359.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $11,359.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n    Retained Earnings                          $1,359.00  \n  Total shareholders' equity                  $11,359.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-02-23\n\n\n\n\n\nThe fair value of the security is recorded on the balance sheet under the Investment Securities at FVOCI account.\n\n\nFVOCI security marking to market\n\nUnrealized gain\nSimilarly, the next day, we need to mark to market the FVOCI security to ensure its fair value is correctly accounted for. Suppose that its market value went up by 5% ($600 = $30,000*5%).\nIt is important to note that FVOCI security’s fair value changes affect AOCI, an equity account. It does not affect Income Statement P&L untill it’s eventually sold.\n\n\n\n\nThe FVOCI security is marked to market with an unrealized gain.\ntoday = today + datetime.timedelta(days=1)\n# Assume that the market value of the FVTPL security went up by 2%\nnew_fvoci_instrument_value = fvoci_security.value * 1.02\nvaluation_visitor = MockValuationVisitor(new_value=new_fvoci_instrument_value)\ntx_fvoci_marked_up = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.SECURITY_FVOCI_MARK_TO_MARKET,\n    instrument=fvoci_security,\n    transaction_date=today,\n    valuation_visitor=valuation_visitor,\n    description=\"Mark to market a FVTPL security (up)\",\n)\nbank.process_transaction(tx_fvoci_marked_up)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_income_statement()\nprint(\"-\" * 80)\nreport.print_balance_sheet()\n\n\n              Income Statement               \n ─────────────────────────────────────────── \n  Income                          $1,459.00  \n    Interest Income                 $800.00  \n    Trading Income (FVTPL)          $659.00  \n      Realized Trading Gain       $1,159.00  \n      Realized Trading Loss         $500.00  \n ─────────────────────────────────────────── \n  Expense                           $100.00  \n    Interest Expense                $100.00  \n ─────────────────────────────────────────── \n  Profit                          $1,359.00  \n ─────────────────────────────────────────── \n                             Date: 2025-02-24\n\n\n\n--------------------------------------------------------------------------------\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                  $1,359.00  \n    Loans and Advances                        $80,000.00  \n    Investment Securities                     $30,600.00  \n      Investment Securities at FVOCI          $30,600.00  \n  Total assets                               $111,959.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $11,959.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n    Accumulated OCI                              $600.00  \n      Unrealized OCI Gain                        $600.00  \n    Retained Earnings                          $1,359.00  \n  Total shareholders' equity                  $11,959.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-02-24\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nBecause FVOCI’s (even unrealized) gain increases AOCI, and AOCI is part of a bank’s CET1 capital, FVOCI’s fair value movement can cause volatility in the bank’s regulatory capital ratios.\n\n\n\n\nUnrealized loss\nIf the market value of the security went down by 2% ($612=$30,600*2%) the next day, we recognize this unrealized OCI loss of AOCI.\n\n\n\n\nThe FVOCI security is marked to market with an unrealized trading loss.\ntoday = today + datetime.timedelta(days=1)\n# Assume that the market value of the FVOCI security went down by 2%\nnew_fvoci_instrument_value = fvoci_security.value * 0.98\nvaluation_visitor = MockValuationVisitor(new_value=new_fvoci_instrument_value)\ntx_fvoci_marked_down = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.SECURITY_FVOCI_MARK_TO_MARKET,\n    instrument=fvoci_security,\n    transaction_date=today,\n    valuation_visitor=valuation_visitor,\n    description=\"Mark to market a FVTPL security (down)\",\n)\nbank.process_transaction(tx_fvoci_marked_down)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_income_statement()\nprint(\"-\" * 80)\nreport.print_balance_sheet()\n\n\n              Income Statement               \n ─────────────────────────────────────────── \n  Income                          $1,459.00  \n    Interest Income                 $800.00  \n    Trading Income (FVTPL)          $659.00  \n      Realized Trading Gain       $1,159.00  \n      Realized Trading Loss         $500.00  \n ─────────────────────────────────────────── \n  Expense                           $100.00  \n    Interest Expense                $100.00  \n ─────────────────────────────────────────── \n  Profit                          $1,359.00  \n ─────────────────────────────────────────── \n                             Date: 2025-02-25\n\n\n\n--------------------------------------------------------------------------------\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                  $1,359.00  \n    Loans and Advances                        $80,000.00  \n    Investment Securities                     $29,988.00  \n      Investment Securities at FVOCI          $29,988.00  \n  Total assets                               $111,347.00  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $11,347.00  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n    Accumulated OCI                             ($12.00)  \n      Unrealized OCI Gain                        $600.00  \n      Unrealized OCI Loss                        $612.00  \n    Retained Earnings                          $1,359.00  \n  Total shareholders' equity                  $11,347.00  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-02-25\n\n\n\n\n\n\n\n\nFVOCI security sale\nThe next day, if the bank sold the FVOCI security at the prevailing market price (assumed 2% down), we recognize realized OCI loss.\nTracking the AOCI gain/loss of this particular FVOCI security,\n\nOn day 1, we had a gain of $600.\nOn day 2, we had a loss of $612.\nOn day 3, we had a loss of $599.76.\n\nThe total net loss of this security is therefore $611.76.\nNow that the FVOCI security is sold, its gain/loss is moved from AOCI to Income Statement as Investment Income (FVOCI). When P&L accounts of income statement are closed, the net gain/loss of Investment Income (FVOCI) changes the bank’s retained earnings.\n\n\n\n\nThe FVOCI security is sold.\nfrom brms.models.transaction import SecuritySaleFVOCITransaction\n\ntoday = today + datetime.timedelta(days=1)\n# Assume that the market value of the FVOCI security went down by 2%\nnew_fvoci_instrument_value = fvoci_security.value * 0.98\nvaluation_visitor = MockValuationVisitor(new_value=new_fvoci_instrument_value)\ntx_fvoci_marked_down = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.SECURITY_FVOCI_MARK_TO_MARKET,\n    instrument=fvoci_security,\n    transaction_date=today,\n    valuation_visitor=valuation_visitor,\n    description=\"Mark to market a FVTPL security (down)\",\n)\nbank.process_transaction(tx_fvoci_marked_down)\n# Sale transaction should be created after the previous transaction has been processed\ntx_fvoci_sale = TransactionFactory.create_transaction(\n    bank=bank,\n    transaction_type=TransactionType.SECURITY_SALE_FVOCI,\n    instrument=fvoci_security,\n    transaction_date=today,\n    description=\"Sale of FVOCI security (net loss)\",\n)\nbank.process_transaction(tx_fvoci_sale)\n\nreport = Report(ledger=bank.ledger, viewer=viewer, date=today)\nreport.print_income_statement()\nprint(\"-\" * 80)\nreport.print_balance_sheet()\n\n\n              Income Statement               \n ─────────────────────────────────────────── \n  Income                            $847.24  \n    Interest Income                 $800.00  \n    Trading Income (FVTPL)          $659.00  \n      Realized Trading Gain       $1,159.00  \n      Realized Trading Loss         $500.00  \n    Investment Income (FVOCI)     ($611.76)  \n      Realized OCI Gain             $600.00  \n      Realized OCI Loss           $1,211.76  \n ─────────────────────────────────────────── \n  Expense                           $100.00  \n    Interest Expense                $100.00  \n ─────────────────────────────────────────── \n  Profit                            $747.24  \n ─────────────────────────────────────────── \n                             Date: 2025-02-26\n\n\n\n--------------------------------------------------------------------------------\n\n\n                      Balance Sheet                       \n ──────────────────────────────────────────────────────── \n  Assets                                                  \n    Cash and Cash Equivalents                 $30,747.24  \n    Loans and Advances                        $80,000.00  \n  Total assets                               $110,747.24  \n ──────────────────────────────────────────────────────── \n  Liabilities                                             \n    Deposits and Other Public Borrowings     $100,000.00  \n      Deposits                               $100,000.00  \n  Total liabilities                          $100,000.00  \n ──────────────────────────────────────────────────────── \n  Net assets                                  $10,747.24  \n ──────────────────────────────────────────────────────── \n  Shareholders' equity                                    \n    Shareholders' Equity                      $10,000.00  \n    Retained Earnings                            $747.24  \n  Total shareholders' equity                  $10,747.24  \n ──────────────────────────────────────────────────────── \n                                          Date: 2025-02-26"
  },
  {
    "objectID": "posts/developing-a-bank-simulation-software/index.html#short-summary",
    "href": "posts/developing-a-bank-simulation-software/index.html#short-summary",
    "title": "Developing a Bank Simulation Software",
    "section": "Short summary",
    "text": "Short summary\nAs shown above, at the moment BRMS can provide a flexible accounting framework to address basic banking transactions and non-transactions. This provides the foundation for scaling up. Next, I will implement various instruments and pricing mechanisms. With the implementation of scenario simulation, it will then be capable of automated accounting and financial performance monitoring."
  },
  {
    "objectID": "posts/docker-nginx-letsencrypt/index.html",
    "href": "posts/docker-nginx-letsencrypt/index.html",
    "title": "Setup Docker/Ngnix and Let’s Encrypt on Ubuntu",
    "section": "",
    "text": "This is a note for setting up a Docker, Nginx and Let’s Encrypt environment on Ubuntu 20.04 LTS."
  },
  {
    "objectID": "posts/docker-nginx-letsencrypt/index.html#create-a-ubuntu-20.04-lts-instance",
    "href": "posts/docker-nginx-letsencrypt/index.html#create-a-ubuntu-20.04-lts-instance",
    "title": "Setup Docker/Ngnix and Let’s Encrypt on Ubuntu",
    "section": "Create a Ubuntu 20.04 LTS instance",
    "text": "Create a Ubuntu 20.04 LTS instance"
  },
  {
    "objectID": "posts/docker-nginx-letsencrypt/index.html#install-docker-using-the-convenience-script",
    "href": "posts/docker-nginx-letsencrypt/index.html#install-docker-using-the-convenience-script",
    "title": "Setup Docker/Ngnix and Let’s Encrypt on Ubuntu",
    "section": "Install Docker using the convenience script",
    "text": "Install Docker using the convenience script\n$ curl -fsSL https://get.docker.com -o get-docker.sh\n$ sudo sh get-docker.sh"
  },
  {
    "objectID": "posts/docker-nginx-letsencrypt/index.html#manage-docker-as-a-non-root-user",
    "href": "posts/docker-nginx-letsencrypt/index.html#manage-docker-as-a-non-root-user",
    "title": "Setup Docker/Ngnix and Let’s Encrypt on Ubuntu",
    "section": "Manage Docker as a non-root user",
    "text": "Manage Docker as a non-root user\nIf you don’t want to preface the docker command with sudo, create a Unix group called docker and add users to it. When the Docker daemon starts, it creates a Unix socket accessible by members of the docker group.\nTo create the docker group and add your user:\n\nCreate the docker group.\n\n$ sudo groupadd docker\n\nAdd your user to the docker group.\n\n$ sudo usermod -aG docker $USER\n\nLog out and log back in so that your group membership is re-evaluated.\nOn Linux, you can also run the following command to activate the changes to groups:\n\n$ newgrp docker"
  },
  {
    "objectID": "posts/docker-nginx-letsencrypt/index.html#configure-docker-to-start-on-boot",
    "href": "posts/docker-nginx-letsencrypt/index.html#configure-docker-to-start-on-boot",
    "title": "Setup Docker/Ngnix and Let’s Encrypt on Ubuntu",
    "section": "Configure Docker to start on boot",
    "text": "Configure Docker to start on boot\n$ sudo systemctl enable docker\nTo disable this behavior, use disable instead.\n$ sudo systemctl disable docker"
  },
  {
    "objectID": "posts/docker-nginx-letsencrypt/index.html#install-docker-compose",
    "href": "posts/docker-nginx-letsencrypt/index.html#install-docker-compose",
    "title": "Setup Docker/Ngnix and Let’s Encrypt on Ubuntu",
    "section": "Install Docker Compose",
    "text": "Install Docker Compose\nOn Linux, you can download the Docker Compose binary from the Compose repository release page on GitHub. Follow the instructions from the link, which involve running the curl command in your terminal to download the binaries. These step-by-step instructions are also included below.\n\nRun this command to download the current stable release of Docker Compose:\n\n$ sudo curl -L \"https://github.com/docker/compose/releases/download/1.25.5/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n\n\n\n\n\n\nNote\n\n\n\nTo install a different version of Compose, substitute 1.25.5 with the version of Compose you want to use.\n\n\n\nApply executable permissions to the binary:\n\n$ sudo chmod +x /usr/local/bin/docker-compose\n\n\n\n\n\n\nNote\n\n\n\nIf the command docker-compose fails after installation, check your path. You can also create a symbolic link to /usr/bin or any other directory in your path. For example:\n$ sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose"
  },
  {
    "objectID": "posts/docker-nginx-letsencrypt/index.html#set-up-nginx-proxy",
    "href": "posts/docker-nginx-letsencrypt/index.html#set-up-nginx-proxy",
    "title": "Setup Docker/Ngnix and Let’s Encrypt on Ubuntu",
    "section": "Set up Nginx-Proxy",
    "text": "Set up Nginx-Proxy\nCreate a unique network for nginx-proxy and other Docker containers to communicate through.\n$ docker network create nginx-proxy\nCreate a directory nginx-proxy for the compose file.\n$ mkdir nginx-proxy && cd nginx-proxy\nIn the nginx-proxy directory, create a new file named docker-compose.yml and paste in the following text:\n\n\n\n\n\n\nexample docker-compose.yml for nginx-proxy\n\n\n\n\n\nversion: '3'\n\nservices:\n  nginx:\n    image: nginx\n    restart: always\n    container_name: nginx-proxy\n    ports:\n      - \"80:80\"\n      - \"443:443\"\n    volumes:\n      - conf:/etc/nginx/conf.d\n      - vhost:/etc/nginx/vhost.d\n      - html:/usr/share/nginx/html\n      - certs:/etc/nginx/certs\n    labels:\n      - \"com.github.jrcs.letsencrypt_nginx_proxy_companion.nginx_proxy=true\"\n\n  dockergen:\n    image: jwilder/docker-gen\n    restart: always\n    container_name: nginx-proxy-gen\n    depends_on:\n      - nginx\n    command: -notify-sighup nginx-proxy -watch -wait 5s:30s /etc/docker-gen/templates/nginx.tmpl /etc/nginx/conf.d/default.conf\n    volumes:\n      - conf:/etc/nginx/conf.d\n      - vhost:/etc/nginx/vhost.d\n      - html:/usr/share/nginx/html\n      - certs:/etc/nginx/certs\n      - /var/run/docker.sock:/tmp/docker.sock:ro\n      - ./nginx.tmpl:/etc/docker-gen/templates/nginx.tmpl:ro\n\n  letsencrypt:\n    image: jrcs/letsencrypt-nginx-proxy-companion\n    restart: always\n    container_name: nginx-proxy-le\n    depends_on:\n      - nginx\n      - dockergen\n    environment:\n      NGINX_PROXY_CONTAINER: nginx-proxy\n      NGINX_DOCKER_GEN_CONTAINER: nginx-proxy-gen\n    volumes:\n      - conf:/etc/nginx/conf.d\n      - vhost:/etc/nginx/vhost.d\n      - html:/usr/share/nginx/html\n      - certs:/etc/nginx/certs\n      - /var/run/docker.sock:/var/run/docker.sock:ro\n\nvolumes:\n  conf:\n  vhost:\n  html:\n  certs:\n\nnetworks:\n  default:\n    external:\n      name: nginx-proxy\nInside of the nginx-proxy directory, use the following curl command to copy the developer’s sample nginx.tmpl file to your VPS.\n$ curl https://raw.githubusercontent.com/jwilder/nginx-proxy/master/nginx.tmpl &gt; nginx.tmpl\n\nIncrease upload file size\nTo increase the maximum upload size, for example, add client_max_body_size 100M; to the server{} section in the nginx.tmpl template file. For WordPress,\n\nRunning nginx-proxy.\n$ docker-compose up -d\n\nAdd a WordPress container\nCreate a directory for the docker-compose.yml with:\n??? example “example docker-compose.yml for WordPress container”\nversion: \"3\"\n\nservices:\n  db_node_domain:\n    image: mysql:5.7\n    volumes:\n        - db_data:/var/lib/mysql\n    restart: always\n    environment:\n        MYSQL_ROOT_PASSWORD: somewordpress\n        MYSQL_DATABASE: wordpress\n        MYSQL_USER: wordpress\n        MYSQL_PASSWORD: wordpress\n    container_name: wp_test_db\n\n  wordpress:\n    depends_on:\n        - db_node_domain\n    image: wordpress:latest\n    expose:\n        - 80\n    restart: always\n    environment:\n        VIRTUAL_HOST: blog.example.com\n        LETSENCRYPT_HOST: blog.example.com\n        LETSENCRYPT_EMAIL: foo@example.com\n        WORDPRESS_DB_HOST: db_node_domain:3306\n        WORDPRESS_DB_USER: wordpress\n        WORDPRESS_DB_PASSWORD: wordpress\n    container_name: wp_test\nvolumes:\n  db_data:\n\nnetworks:\n  default:\n    external:\n      name: nginx-proxy\n\n\n\n\nTo create a second WordPress container, add MYSQL_TCP_PORT environment variable and set it to a different port.\n\nIncrease maximum WordPress upload file size\nEnter the bash of the WordPress container.\n$ docker exec -t wordpress_container_name bash\nMove inside your /var/www/html directory (already there if you’re using the standard Docker Compose image). Run the following command to insert the values.\n$ sed -i '/^# END WordPress.*/i php_value upload_max_filesize 256M\\nphp_value post_max_size 256M' .htaccess\n\n\n\n\n\n\nNote\n\n\n\nTo restore the values, run $ sed -i \"11,12d\" .htaccess"
  },
  {
    "objectID": "posts/docker-nginx-letsencrypt/index.html#add-a-wordpress-container",
    "href": "posts/docker-nginx-letsencrypt/index.html#add-a-wordpress-container",
    "title": "Setup Docker/Ngnix and Let’s Encrypt on Ubuntu",
    "section": "Add a WordPress container",
    "text": "Add a WordPress container\nCreate a directory for the docker-compose.yml with:\n??? example “example docker-compose.yml for WordPress container”\nversion: \"3\"\n\nservices:\n  db_node_domain:\n    image: mysql:5.7\n    volumes:\n        - db_data:/var/lib/mysql\n    restart: always\n    environment:\n        MYSQL_ROOT_PASSWORD: somewordpress\n        MYSQL_DATABASE: wordpress\n        MYSQL_USER: wordpress\n        MYSQL_PASSWORD: wordpress\n    container_name: wp_test_db\n\n  wordpress:\n    depends_on:\n        - db_node_domain\n    image: wordpress:latest\n    expose:\n        - 80\n    restart: always\n    environment:\n        VIRTUAL_HOST: blog.example.com\n        LETSENCRYPT_HOST: blog.example.com\n        LETSENCRYPT_EMAIL: foo@example.com\n        WORDPRESS_DB_HOST: db_node_domain:3306\n        WORDPRESS_DB_USER: wordpress\n        WORDPRESS_DB_PASSWORD: wordpress\n    container_name: wp_test\nvolumes:\n  db_data:\n\nnetworks:\n  default:\n    external:\n      name: nginx-proxy"
  },
  {
    "objectID": "posts/encode-password-for-sas-remote-submission/index.html",
    "href": "posts/encode-password-for-sas-remote-submission/index.html",
    "title": "Encode Password for SAS Remote Submission",
    "section": "",
    "text": "The Wharton Research Data Services (WRDS) allows one to submit and execute SAS programs to the cloud. WRDS has an instruction on accessing WRDS data from SAS on our own PCs. Generally, you should use:\nHowever, if you want to save the effort of entering username and password every time, you’ll need to encode your password. Concluding the two articles, basically you just need to follow the steps below."
  },
  {
    "objectID": "posts/encode-password-for-sas-remote-submission/index.html#simple-steps",
    "href": "posts/encode-password-for-sas-remote-submission/index.html#simple-steps",
    "title": "Encode Password for SAS Remote Submission",
    "section": "Simple Steps",
    "text": "Simple Steps\nFirst, open your SAS program locally on your PC, run the following command and replace 1234567890 with your WRDS password:\nproc pwencode in=\"1234567890\"; run;\nThe output {SAS002}23AA9C2811439227077603C8365060A44800CA1F is the encoded password (which is 1234567890 in this example).\n\n\n\n\n\n\nDo NOT share your SAS program with encoded password!\n\n\n\nEncoded password functions the same as your plain-text password. You should never make public your password in any way.\n\n\nNext, put the following statements at the beginning of your SAS program and replace my_username with your WRDS username:\n%let wrds=wrds-cloud.wharton.upenn.edu 4016;\noptions comamid=TCP remote=WRDS;\nsignon username=my_username password=\"{SAS002}23AA9C2811439227077603C8365060A44800CA1F\";\nAfter these statements, you’ll be able to submit your SAS program remotely to and execute on the WRDS server by enclosing your statements with rsubmit and endrsubmit. An example would be:\nrsubmit;\nproc download data=comp.funda out=funda; run;\nendrsubmit;\nAs you can guess, this statement actually downloads the whole Compustat Fundamentals Annual to the local work directory, with the downloaded dataset also named funda.\nLastly, after everything, you should run signoff to close the connection with WRDS.\nFull code is as below.\n%let wrds=wrds-cloud.wharton.upenn.edu 4016;\noptions comamid=TCP remote=WRDS;\nsignon username=my_username password=\"{SAS002}23AA9C2811439227077603C8365060A44800CA1F\";\n\nrsubmit;\nproc download data=comp.funda out=funda; run;\nendrsubmit;\nsignoff;\nReplace my_username and the encoded password with your actual WRDS username and encoded password, paste it in the SAS program editor and press F3. You’ll be downloading comp.funda in a few seconds!"
  },
  {
    "objectID": "posts/encode-password-for-sas-remote-submission/index.html#video-instruction",
    "href": "posts/encode-password-for-sas-remote-submission/index.html#video-instruction",
    "title": "Encode Password for SAS Remote Submission",
    "section": "Video Instruction",
    "text": "Video Instruction\nI made a short video introduction as well, available on my YouTube channel."
  },
  {
    "objectID": "posts/firm-historical-headquarter-state-from-10k/index.html",
    "href": "posts/firm-historical-headquarter-state-from-10k/index.html",
    "title": "Firm Historical Headquarter State from SEC 10K/Q Filings",
    "section": "",
    "text": "In the Compustat database, a firm’s headquarter state (and other identification) is in fact the current record stored in comp.company. This means once a firm relocates (or updates its incorporate state, address, etc.), all historical observations will be updated and not recording historical state information anymore.\nTo resolve this issue, an effective way is to use the firm’s historical SEC filings. You can follow my previous post Textual Analysis on SEC filings to extract the header information, which includes a wide range of meta data. Alternatively, the University of Notre Dame’s Software Repository for Accounting and Finance provides an augmented 10-X header dataset.\n\n\n\n\n\n\n2023 March Update\n\n\n\nIn this update, I use 1,491,368 8-K filings of U.S. firms from 2004 to Dec 2022 and extract their HQ state and zipcode. hist_state_zipcode_from_8k_2004_2022.csv.zip"
  },
  {
    "objectID": "posts/firm-historical-headquarter-state-from-10k/index.html#why-the-need-to-use-sec-filings",
    "href": "posts/firm-historical-headquarter-state-from-10k/index.html#why-the-need-to-use-sec-filings",
    "title": "Firm Historical Headquarter State from SEC 10K/Q Filings",
    "section": "",
    "text": "In the Compustat database, a firm’s headquarter state (and other identification) is in fact the current record stored in comp.company. This means once a firm relocates (or updates its incorporate state, address, etc.), all historical observations will be updated and not recording historical state information anymore.\nTo resolve this issue, an effective way is to use the firm’s historical SEC filings. You can follow my previous post Textual Analysis on SEC filings to extract the header information, which includes a wide range of meta data. Alternatively, the University of Notre Dame’s Software Repository for Accounting and Finance provides an augmented 10-X header dataset.\n\n\n\n\n\n\n2023 March Update\n\n\n\nIn this update, I use 1,491,368 8-K filings of U.S. firms from 2004 to Dec 2022 and extract their HQ state and zipcode. hist_state_zipcode_from_8k_2004_2022.csv.zip"
  },
  {
    "objectID": "posts/firm-historical-headquarter-state-from-10k/index.html#do-i-have-to-use-sec-filings",
    "href": "posts/firm-historical-headquarter-state-from-10k/index.html#do-i-have-to-use-sec-filings",
    "title": "Firm Historical Headquarter State from SEC 10K/Q Filings",
    "section": "Do I have to use SEC filings?",
    "text": "Do I have to use SEC filings?\nI’ll skip the parsing procedure for now. The most important point is that using the historical SEC filings, you can ensure that you truly are using the historical headquarter state in your empirical estimation. Based on the augmented 10-X header dataset, I find that around 2-3% of Compustat firms changed their headquarter state (as indicated by their business address) each year.\n\n\n\nYear\nFirms Changed State\nTotal Firms\n% Firms Changed State\n\n\n\n\n1995\n22\n4205\n0.52\n\n\n1996\n69\n7939\n0.87\n\n\n1997\n199\n8101\n2.46\n\n\n1998\n206\n8126\n2.54\n\n\n1999\n202\n8199\n2.46\n\n\n2000\n202\n8252\n2.45\n\n\n2001\n204\n7802\n2.61\n\n\n2002\n167\n7421\n2.25\n\n\n2003\n214\n6930\n3.09\n\n\n2004\n175\n6742\n2.6\n\n\n2005\n154\n6478\n2.38\n\n\n2006\n156\n6267\n2.49\n\n\n2007\n144\n6091\n2.36\n\n\n2008\n125\n5797\n2.16\n\n\n2009\n127\n5523\n2.3\n\n\n2010\n128\n5479\n2.34\n\n\n2011\n152\n5445\n2.79\n\n\n2012\n160\n5494\n2.91\n\n\n2013\n171\n5491\n3.11\n\n\n2014\n195\n5455\n3.57\n\n\n2015\n147\n5322\n2.76\n\n\n2016\n117\n5092\n2.3\n\n\n2017\n129\n4914\n2.63\n\n\n2018\n107\n4847\n2.21\n\n\n\nMoreover, 2,947 out of the 17,221 firms, or about 17% firms changed their headquarter state in the merged sample. This is by no means a small number that can be ignored. So, whenever possible, you should try to use the historical information from past SEC filings’ metadata."
  },
  {
    "objectID": "posts/firm-historical-headquarter-state-from-10k/index.html#how-to-get-the-actual-historical-firm-hq-state-using-sec-filings",
    "href": "posts/firm-historical-headquarter-state-from-10k/index.html#how-to-get-the-actual-historical-firm-hq-state-using-sec-filings",
    "title": "Firm Historical Headquarter State from SEC 10K/Q Filings",
    "section": "How to get the actual historical firm HQ state using SEC filings?",
    "text": "How to get the actual historical firm HQ state using SEC filings?\n\n1969 - 2003\nI start with the firm historical HQ state provided by Bai, Fairhurst, and Serfling (2020). This dataset contains the historical HQ locations from 1969 to 2003, which is based on the SEC filings post 1994 and hand-collected by the authors from the Moody’s Manuals (later Mergent Manuals) and Dun & Bradstreet’s Million Dollar Directory (later bought by Mergent).1\n1 The authors note that “for our final sample of 115,432 firm-year observations, we find that over the 1969 to 2003 period, 9,847 (87.50%) never relocate, 1,211 (10.76%) relocate once, 178 (1.58%) relocate twice, and 18 (0.16%) relocate three times.”\n\n1994 - 2018\nTo extend the dataset, I download the augmented 10-X header dataset and use the following Python script to extract the business address (state) filed.\nimport pandas as pd\n\nfilepath = \"~/Downloads/LM_EDGAR_10X_Header_1994_2018.csv\"\n\nif __name__ == \"__main__\":\n\n    df = pd.read_csv(\n        filepath,\n        usecols=[\"cik\", \"file_date\", \"ba_state\"],\n        dtype={\"cik\": str},\n        parse_dates=[\"file_date\"],\n    )\n    # Some `ba_stata` codes are lowercase\n    df[\"ba_state\"] = df[\"ba_state\"].str.upper()\n    # Some  `ba_state` codes are not valid US states\n    df = df[df[\"ba_state\"].str.isalpha() & ~pd.isnull(df[\"ba_state\"])]\n    df.drop_duplicates().to_stata(\n        \"~/Downloads/historical_state_1994_2018.dta\",\n        write_index=False,\n        convert_dates={\"file_date\": \"td\"},\n    )\nThe result is a historical_state.dta Stata file like this:\n\n\n\nScreenshot of historical_state.dta in Stata\n\n\n\n\n1969 - 2018 merged\nFinally, to merge the two datasets together, I imported them into WRDS Cloud and run the following SAS script:\n\nPre-2003, use Bai, Fairhurst, and Serfling (2020).\nPost-2003, use the business address as in the header of 10K/Q filings, and the Compustat records if the business address is missing and invalid from parsing the headers.\n\nlibname hs \"~/historical_state\";\n\n/* Historical HQ state (1994 to 2018) from augmented 10-X header dataset */\nproc import datafile=\"~/historical_state/historical_state_1994_2018.dta\"\n    out=historical_state_1994_2018 dbms=stata replace;\n/* Historical HQ state (1969 to 2003) from Bai, Fairhurst and Serfling (2020 RFS) */\nproc import datafile=\"~/historical_state/hist_headquarters_Bai_et_al.dta\"\n    out=hist_headquarters_Bai_et_al dbms=stata replace;\n\n/* Build the post-1994 dataset using SEC filings */\nproc sql;\ncreate table funda as \nselect gvkey, cik, datadate, fyear from comp.funda\nwhere indfmt= 'INDL' and datafmt='STD' and popsrc='D' and consol='C'\nand year(datadate) between 1994 and 2018\n/* \"For firms that change fiscal year within a calendar year, \n    we take the last reported date when extracting financial data. \n    This leaves us with one set of observations for each firm (gvkey) in each year.\" \n    -- Pelueger, Siriwardane and Sunderam (2020 QJE) */\ngroup by gvkey, fyear having datadate=max(datadate);\n\ncreate table firm_historical_state as \nselect a.*, b.ba_state as state_sec label=\"State from SEC filings\"\nfrom funda as a left join historical_state as b \non a.cik=b.cik and year(a.datadate)=year(b.file_date) and b.file_date&lt;=a.datadate\ngroup by a.gvkey, a.datadate\n/* use the SEC filing closet to and before the Compustat datadate */\nhaving b.file_date=max(b.file_date);\n\ncreate table historical_state_1994_2018 as\nselect a.*, b.state as state_comp label=\"State from Compustat\"\nfrom firm_historical_state as a left join comp.company as b \non a.gvkey=b.gvkey\norder by a.gvkey, a.datadate;\nquit;\n\n/* Sanity check: no duplicated gvkey-fyear */\nproc sort data=historical_state_1994_2018 nodupkey; by gvkey datadate; run;\n\n\nproc sql;\ncreate table hist_headquarters_Bai_et_al as \nselect put(gvkeyn, z6.) as gvkey, fyear, state \nfrom hist_headquarters_Bai_et_al;\nquit;\n\n/* Stack together the two datasets */\ndata states; \nset hist_headquarters_Bai_et_al \n    historical_state_1994_2018(where=(fyear&gt;2003) keep=gvkey fyear state:);\nrun;\n\nproc sql;\ncreate table hs.corrected_hist_state_1969_2018 as \nselect *, coalesce(state, state_sec, state_comp) as corrected_state\nfrom states where not missing(calculated corrected_state)\norder by gvkey, fyear;\nquit;\n\n/* Sanity check: no duplicated gvkey-fyear */\nproc sort data=hs.corrected_hist_state_1969_2018 nodupkey; by gvkey fyear; run;"
  },
  {
    "objectID": "posts/firm-historical-headquarter-state-from-10k/index.html#data-available-for-download",
    "href": "posts/firm-historical-headquarter-state-from-10k/index.html#data-available-for-download",
    "title": "Firm Historical Headquarter State from SEC 10K/Q Filings",
    "section": "Data available for download",
    "text": "Data available for download\nYou can download the data I compiled here: corrected_hist_state_1969_2018.dta.zip (1MB).\n\n2023 Update\nIn this update, I use 1,491,368 8-K filings of U.S. firms from 2004 to Dec 2022 and extract their HQ state and zipcode. Data: hist_state_zipcode_from_8k_2004_2022.csv.zip\nSpecifically, I download all 8-K filings from EDGAR and run a script to extract business address from filing header into a database. If a firm reported different states in its filings in a given year, I keep the last one. The code is here at GitHub."
  },
  {
    "objectID": "posts/firm-historical-headquarter-state-from-10k/index.html#suggested-citation",
    "href": "posts/firm-historical-headquarter-state-from-10k/index.html#suggested-citation",
    "title": "Firm Historical Headquarter State from SEC 10K/Q Filings",
    "section": "Suggested citation",
    "text": "Suggested citation\nLastly, if you use the code/data above, please consider citing the following article for which it was written/constructed.\n\nGao, M. Leung, H. and Qiu, B. (2021). Organization Capital and Executive Performance Incentives, Journal of Banking & Finance, 123, 106017."
  },
  {
    "objectID": "posts/fixed-income/bond-prices-and-yields/index.html",
    "href": "posts/fixed-income/bond-prices-and-yields/index.html",
    "title": "Bond Prices and Yields",
    "section": "",
    "text": "In the last post we introduce features of a bond. Now, let’s look at how to price a plain vanilla bond and examine the relation between bond price and yield.",
    "crumbs": [
      "Fixed Income",
      "Bond Prices and Yields"
    ]
  },
  {
    "objectID": "posts/fixed-income/bond-prices-and-yields/index.html#price-of-a-bond",
    "href": "posts/fixed-income/bond-prices-and-yields/index.html#price-of-a-bond",
    "title": "Bond Prices and Yields",
    "section": "Price of a bond",
    "text": "Price of a bond\nFirst, what’s the fair price of a bond?\nFor the investor, a bond represents a series of cashflows to receive in the future. So its price is naturally the total present value of all cashflows from the bond, including coupon payments (if any) and the repayment of principal (bond face value).\nTherefore, the following equation holds true universally at all time \\(t\\):\n\\[\n\\text{Bond Price}_{t} = \\text{PV}_t(\\text{future coupons}) + \\text{PV}_t(\\text{face value})\n\\]\n\nA bond’s price at time \\(t\\) is the present value as at time \\(t\\) of all coupons to receive in the future, plus the present value as at time \\(t\\) of the bond face value. Personally, I’d call this fundamental.\n\n\n\n\n\n\n\nBefore we move on\n\n\n\nRemember that all the complications we will see later are just results of uncertainties about the PVs, which ultimately are determined by cashflows and discount rates. Whenever you’re lost, pause and think about how they are affected, and then reason about how bond price may be affected.\n\n\nI like examples. Suppose we are to issue a 10-year bond with a $10,000 face value that pays 5% annual coupon in arrears1, with 8% discount rate2, what would be the price today \\(t=0\\) at which we can sell the bond to investors?\n1 “in arrears” means that the payment is made at the end of the period. So in this case, the bond pays coupon annually at the end of the year, not any time sooner.2 We assume that this is an effective annual rate, and is the same for all 10 years in the future.The chart below shows the result. Specifically, the blue bars indicate the bond’s cashflows, the overlaying red bars indicate their present values as at time \\(t=0\\).\n\nviewof maturity = Inputs.range(\n  [1, 30], \n  {value: 15, step: 1, label: \"Maturity (years):\"}\n)\nviewof discountRate = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.1, step: 0.01, label:\"Discount rate:\"}\n)\nviewof couponRate = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.1, step: 0.01, label:\"Coupon rate:\"}\n)\nviewof couponFreq = Inputs.radio(\n    [\"Annual\", \"Semiannual\"],\n    {value: \"Annual\", label:\"Coupon frequency:\"}\n)\na = {\n  const f = 100;\n  let c, m, r;\n  if (couponFreq == \"Semiannual\") {\n    c = couponRate / 2;\n    m = 2 * maturity;\n    r = discountRate / 2;\n  } else {\n    c = couponRate;\n    m = maturity;\n    r = discountRate;\n  }\n  const cashflows = {\"Time\": [], \"Cashflow\": [], \"PV\": []};\n  let cf = f * c;\n  for (let i = 1; i &lt; m+1; ++i) {\n    cashflows[\"Time\"].push(i);\n    if (i == m) cf = f * (1+c);\n    cashflows[\"Cashflow\"].push(cf);\n    cashflows[\"PV\"].push(cf / (1+r)**i);\n  }\n  return cashflows;\n}\n\ndata = transpose(a)\nPlot.plot({\n  x: {padding: 0.4},\n  grid: true,\n  marks: [\n    Plot.ruleY([0]),\n    Plot.barY(data, {x: \"Time\", y: \"Cashflow\", fill: \"blue\", dx: -2, dy: -2}),\n    Plot.barY(data, {x: \"Time\", y: \"PV\", fill: \"red\", dx: 2, dy: 2}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTry it out\n\n\n\nChange the parameters, see what happens to the bond price!\n\n\n\nThe formula\nThe initial price \\(P_{t=0}\\) of a plain vanilla \\(N\\)-year bond with face value \\(F\\), annual coupon \\(C\\), at a constant discount rate \\(r\\)3, is given by\n3 This discount rate \\(r\\) is assumed to be an effective rate for a period of time between two coupons, i.e., effective annual rate in this case.\\[\nP_{t=0} = \\underbrace{\\sum_{\\tau=1}^{N} \\frac{C}{(1+r)^{\\tau}}}_{\\text{sum of coupons' PVs}} + \\underbrace{\\frac{F}{(1+r)^N}}_{\\text{face value's PV}}\n\\]\nNote that this is only the initial price when the bond is issued at time \\(t=0\\).",
    "crumbs": [
      "Fixed Income",
      "Bond Prices and Yields"
    ]
  },
  {
    "objectID": "posts/fixed-income/bond-prices-and-yields/index.html#price-over-time",
    "href": "posts/fixed-income/bond-prices-and-yields/index.html#price-over-time",
    "title": "Bond Prices and Yields",
    "section": "Price over time",
    "text": "Price over time\n\n\n\n\n\n\nQuestion\n\n\n\nSo, other things equal, how does bond price changes over time as we approaches the maturity date?\n\n\nWe need a better formula that can let \\(t\\) take values other than 0. Recall the rationale that the price is nothing but sum of all PVs of future payments.\n\nA slightly improved formula\nAt time \\(t\\), which is exactly \\(n\\) years till maturity, the price, \\(P_{t}\\), of a plain vanilla bond with face value \\(F\\), annual coupon \\(C\\), at a constant discount rate \\(r\\), is given by\n\\[\nP_{t} = \\underbrace{\\sum_{\\tau=1}^{n} \\frac{C}{(1+r)^{\\tau}}}_{\\text{sum of coupons' PVs}} + \\underbrace{\\frac{F}{(1+r)^n}}_{\\text{face value's PV}}\n\\]\nFrom only \\(P_{t=0}\\) to \\(\\{P_{t}\\}\\) is a major improvement!4\n4 However, here \\(t\\) can only be positive integers as we assume \\(t\\) is exactly \\(n\\) years before the bond’s maturity. See the next question.5 Note that at maturity, \\(n=0\\) such that the price \\(P_t=F\\).Let me show you another graph. Note that in this graph, each bar represents the bond price as at a point in time.5\n\nviewof maturity2 = Inputs.range(\n  [1, 30], \n  {value: 15, step: 1, label: \"Maturity (years):\"}\n)\nviewof discountRate2 = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.10, step: 0.01, label:\"Discount rate:\"}\n)\nviewof couponRate2 = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.05, step: 0.01, label:\"Coupon rate:\"}\n)\nviewof couponFreq2 = Inputs.radio(\n    [\"Annual\", \"Semiannual\"],\n    {value: \"Annual\", label:\"Coupon frequency:\"}\n)\nb = {\n  const f = 100;\n  let c, m, r;\n  if (couponFreq2 == \"Semiannual\") {\n    c = couponRate2 / 2;\n    m = 2 * maturity2;\n    r = discountRate2 / 2;\n  } else {\n    c = couponRate2;\n    m = maturity2;\n    r = discountRate2;\n  }\n  function pv(c, f, t, r) {\n    return c * (1 - (1+r)**(-(m-t))) / r + f / (1+r)**(m-t)\n  }\n  const cashflows = {\"Time\": [], \"PV\": []};\n  let coupon = f * c;\n  for (let i = 0; i &lt; m+1; ++i) {\n    cashflows[\"Time\"].push(i);\n    cashflows[\"PV\"].push(pv(coupon, f, i, r));\n  }\n  return cashflows;\n}\n\ndata2 = transpose(b)\nPlot.plot({\n  caption: \"Assume $100 bond, coupons paid in arrears and effective annual discount rate.\",\n  x: {padding: 0.4},\n  grid: true,\n  marks: [\n    Plot.ruleY([0]),\n    Plot.ruleY([100]),\n    Plot.barY(data2, {x: \"Time\", y: \"PV\", fill: \"blue\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nChange the discount rate to be lower than coupon rate, what do you find?\n\nIt’s not difficult to find that, as it approaches the maturity, the bond price approaches the face value, regardless of whether the bond is traded at a premium or discount.6\n6 A bond is traded at a premium (discount) if its price is above (below) face value.\n\n\n\n\n\nConfused?\n\n\n\nRecall earlier we said that the longer the maturity, the lower the bond price. This is true because we are talking about the initial price at issue. For example, other things equal, the price of a 30-year bond is lower than the price of a 10-year bond.\nHere, time is changing. There is a bond of a given maturity (e.g., 30 years), and we study how its price changes over time as we get close to the 30-year mark.\n\n\n\n\nA more improved formula\nBut we can still do better!\n\n\n\n\n\n\nQuestion\n\n\n\nSo far we have been assuming the next coupon is exactly one period (e.g., year) in the future, or in other words, the last coupon has just been paid. What if this is not the case? What if the next annual coupon is in 2 months, not in 12 months, from now?\n\n\nWhen the coupon payment date does not align with the time at which we compute the bond price, only a simple adjustment is required.\nThe basic idea is, since next coupon and all future payments are closer than what’s assumed in computation, we have over-discounted the bond value. So, we can correct it by “growing” the undervalued price for the time since last coupon payment.\n\\[\nP_{t} = \\underbrace{\\left[\\sum_{\\tau=1}^{n} \\frac{C}{(1+r)^{\\tau}} + \\frac{F}{(1+r)^n}\\right]}_{\\text{bond price right after last coupon}} \\times (1+r)^{\\frac{\\text{days since last coupon}}{\\text{days between coupons}}}\n\\]\nAs such, we can now derive a continuous path for the bond price since issue to maturity, assuming other things equal. This is shown in the next chart as a blue line.7\n7 In the last one, I deliberately use bar chart to indicate discreteness.",
    "crumbs": [
      "Fixed Income",
      "Bond Prices and Yields"
    ]
  },
  {
    "objectID": "posts/fixed-income/bond-prices-and-yields/index.html#price-dirty-and-clean",
    "href": "posts/fixed-income/bond-prices-and-yields/index.html#price-dirty-and-clean",
    "title": "Bond Prices and Yields",
    "section": "Price: dirty and clean",
    "text": "Price: dirty and clean\n\n\n\n\n\n\nAttention!\n\n\n\nNow imagine you are to buy a bond immediately before it matures. What would be the price according to the formula and the chart above?\nNo matter how much coupon the bond pays, the price (indicated by the the last bar) is the face value of the bond $10,000. After the purchase, however, you will immediately receive a total payment of bond face value and the last coupon payment, which surely is greater than $10,000.\nApparently, you need to pay more than the price described by the formula to the seller.\n\n\nIn fact, a bondholder starts to accumulate accrued interest8 the moment their own the bond. Even though they may sell the bond right before a coupon payment, but given that they have been holding the bond for almost entire the time until selling just before the next coupon payment, they should be given compensation for not receiving the next coupon, which will be paid to the buyer.\n8 Accrued interest: payoffs entitled to the investor but not yet paid.Further, we generalize this idea to bond transactions any time between coupon payments – the buyer should compensate the seller additionally a coupon payment proportional to the time that the seller has been holding since last coupon payment relative to the time between two coupon payments.\n\nviewof maturity3 = Inputs.range(\n  [1, 30], \n  {value: 15, step: 1, label: \"Maturity (years):\"}\n)\nviewof discountRate3 = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.10, step: 0.01, label:\"Discount rate:\"}\n)\nviewof couponRate3 = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.05, step: 0.01, label:\"Coupon rate:\"}\n)\nviewof couponFreq3 = Inputs.radio(\n    [\"Annual\", \"Semiannual\"],\n    {value: \"Annual\", label:\"Coupon frequency:\"}\n)\nc = {\n  const f = 100;\n  let c, m, r;\n  if (couponFreq3 == \"Semiannual\") {\n    c = couponRate3 / 2;\n    m = 2 * maturity3;\n    r = discountRate3 / 2;\n  } else {\n    c = couponRate3;\n    m = maturity3;\n    r = discountRate3;\n  }\n  let scale = 300 / m;\n  function pv(c, f, t, r) {\n    return c * (1 - (1+r)**(-(m-t))) / r + f / (1+r)**(m-t)\n  }\n  const cashflows = {\"Time\": [], \"Clean\": [], \"Dirty\": []};\n  let coupon = f * c;\n  for (let i = 0; i &lt; m * scale + 1; ++i) {\n    let t = parseInt(i / scale, 10);\n    cashflows[\"Time\"].push(i);\n    let clean = pv(coupon, f, i/scale, r);\n    let dirty = clean + coupon * (i-t*scale)/scale;\n    cashflows[\"Clean\"].push(clean);\n    cashflows[\"Dirty\"].push(dirty);\n  }\n  return cashflows;\n}\n\ndata3 = transpose(c)\nPlot.plot({\n  caption: \"Assume $100 bond, coupons paid in arrears and effective annual discount rate.\",\n  x: {padding: 0.4, \n        transform: (x) =&gt; (x/(300/maturity3)),\n        domain: [0, maturity3],\n        label: \"Year\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0, 100]),\n    Plot.ruleX([0]),\n    Plot.lineY(data3, {x: \"Time\", y: \"Clean\", stroke: \"blue\"}),\n    Plot.lineY(data3, {x: \"Time\", y: \"Dirty\", stroke: \"red\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe chart above shows the continuous path of bond price described by the formula in blue and the price including the additional compensation, i.e., the accrued interest. We names these two prices “clean price” and “dirty price”, respectively.\n\nThe clean price is the price suggested by the formula. In reality, this is the price that market participants deal with more often, e.g., in financial reporting, portfolio management, etc.\nThe dirty price is the clean price plus accrued interest. This is the actual settlement price for bond transactions.\n\nAnd the accrued interest is given by\n\\[\n\\text{coupon} \\times \\frac{\\text{time since last coupon}}{\\text{time between coupons}}\n\\]\nwhich periodically increases and resets.\n\n\n\n\n\n\nDay count convention\n\n\n\n\nFor Treasury bonds, we use “actual/actual” convention.\nFor others, typically “30/360” convention.",
    "crumbs": [
      "Fixed Income",
      "Bond Prices and Yields"
    ]
  },
  {
    "objectID": "posts/fixed-income/bond-prices-and-yields/index.html#price-and-yield-to-maturity",
    "href": "posts/fixed-income/bond-prices-and-yields/index.html#price-and-yield-to-maturity",
    "title": "Bond Prices and Yields",
    "section": "Price and yield (to maturity)",
    "text": "Price and yield (to maturity)\nSo far, we have not yet spent a single word on a bond’s “yield”, but instead been using “discount rate”. What’s the difference?\nThe answer is straightforward. A bond consists of a series of cashflows in the future, each of which may be discounted at different rates. For example, the coupon in 1 year may be discounted at a 5% discount rate, the coupon in 2 years may be discounted at 6%, and so on.\nIt turns out that, at any time \\(t\\), while a bond can have multiple future payments each discounted at different rates \\(\\{r_{\\tau}\\}\\), we can always find a single discount rate \\(\\color{red}y\\) which, when applied to all future payments, leads to the same bond price at the time:\n\\[\nP_{t} = \\underbrace{\\sum_{\\tau=1}^{n} \\frac{C}{(1+r_\\tau)^{\\tau}} + \\frac{F}{(1+r_n)^n}}_{\\text{each discounted at varying rates}} = \\underbrace{\\sum_{\\tau=1}^{n} \\frac{C}{(1+{\\color{red}y})^{\\tau}} + \\frac{F}{(1+{\\color{red}y})^n}}_{\\text{all discounted at the same rate}}\n\\]\nThis single discount rate \\(\\color{red}y\\) is called the yield to maturity, or yield, of the bond at time \\(t\\).\nIf we plot bond prices against yields, at a given time, it’s easy to see that they have a one-to-one mapping and a inverse non-linear relationship.\n\nviewof maturity4 = Inputs.range(\n  [1, 30], \n  {value: 15, step: 1, label: \"Maturity (years):\"}\n)\nviewof couponRate4 = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.05, step: 0.01, label:\"Coupon rate:\"}\n)\nd = {\n  const f = 100;\n  let c, m;\n  c = couponRate4;\n  m = maturity4;\n  function pv(c, f, t, r) {\n    return c * (1 - (1+r)**(-t)) / r + f / (1+r)**(t)\n  }\n  const prices = {\"YTM\": [], \"Price\": []};\n  let coupon = f * c;\n  for (let ytm = 0.01; ytm &lt; 20; ytm++) {\n    let price = pv(coupon, f, m, ytm/100);\n    prices[\"YTM\"].push(ytm);\n    prices[\"Price\"].push(price);\n  }\n  return prices;\n}\n\ndata4 = transpose(d)\nPlot.plot({\n  caption: \"Assume $100 bond, annual coupons paid in arrears and effective annual discount rate.\",\n  x: {padding: 0.4, label: \"YTM (%)\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0, 100]),\n    Plot.ruleX([0]),\n    Plot.lineY(data4, {x: \"YTM\", y: \"Price\", stroke: \"blue\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThere are many interesting features about the bond price-yield relationship.\nThe one-to-one mapping between bond price and yield implies that we can always compute the other when given either of them. So, knowing either price or yield is sufficient when dealing with bonds.9\n9 Assuming other bond features are known, such as coupon rate, frequency, etc., which are public information.The inverse relationship suggests that the higher the yield, the lower the bond price.\nThe non-linearity suggests that the sensitivity of bond price to yield is not static. In fact, we can tell from the graph that the curve is convex. This convexity will be of great importance in later studies of bond risk.",
    "crumbs": [
      "Fixed Income",
      "Bond Prices and Yields"
    ]
  },
  {
    "objectID": "posts/fixed-income/bond-prices-and-yields/index.html#other-yields",
    "href": "posts/fixed-income/bond-prices-and-yields/index.html#other-yields",
    "title": "Bond Prices and Yields",
    "section": "Other yields",
    "text": "Other yields\nWhen we talk about a bond’s yield, we usually refer to the yield to maturity. But there can be some other yield measures:\n\nCurrent yield.\nBond equivalent yield.\nYield to call.\nYield to put.\nYield to worse.\n…\n\n\n\n\n\n\n\nPortfolio of bonds\n\n\n\nThe yield of a portfolio of bonds is NOT a weighted average of individual bonds’ yields because the bonds are not homogeneous.",
    "crumbs": [
      "Fixed Income",
      "Bond Prices and Yields"
    ]
  },
  {
    "objectID": "posts/fixed-income/bond-prices-and-yields/index.html#trouble-maker-floating-rate-bonds",
    "href": "posts/fixed-income/bond-prices-and-yields/index.html#trouble-maker-floating-rate-bonds",
    "title": "Bond Prices and Yields",
    "section": "Trouble maker: floating-rate bonds",
    "text": "Trouble maker: floating-rate bonds\nWe cannot easily compute the yield of a floater, simply because the values of reference rate in the future are unknown. Instead, we can use some spread measures that describe the yield in excess of the reference rate. The most popular measure of yield spread for a floating-rate bond is discount margin.\nAs its name suggests, discount margin basically captures the “discount rate in excess of reference rate”.\nSuppose the bond market price is \\(P_t\\), reference rate is assumed constant at \\(R\\), the discount margin \\(DM\\) is the one that solves the equation below:\n\\[\nP_{t} = \\sum_{\\tau=1}^{n} \\frac{C}{(1+R+{\\color{red}DM})^{\\tau}} + \\frac{F}{(1+R+{\\color{red}DM})^n}\n\\]\nNote that here the coupon payment \\(C\\) is determined by the reference rate \\(R\\) and the quoted margin.10\n\n\n10 Quoted margin: a floating-rate bond’s coupon rate is determined by a reference rate plus its quoted margin.",
    "crumbs": [
      "Fixed Income",
      "Bond Prices and Yields"
    ]
  },
  {
    "objectID": "posts/fixed-income/yield-curve/index.html",
    "href": "posts/fixed-income/yield-curve/index.html",
    "title": "Yield Curve and Term Structure of Interest Rates",
    "section": "",
    "text": "Note\n\n\n\nWe focus on risk-free government bonds for now as their yields serve as the backbone of pricing other bonds.",
    "crumbs": [
      "Fixed Income",
      "Yield Curve and Term Structure of Interest Rates"
    ]
  },
  {
    "objectID": "posts/fixed-income/yield-curve/index.html#background",
    "href": "posts/fixed-income/yield-curve/index.html#background",
    "title": "Yield Curve and Term Structure of Interest Rates",
    "section": "Background",
    "text": "Background\nAs discussed earlier, a bond represents a series of cashflows in the future and its price equals the sum of present values of all cashflows, each of which may be discounted at different rates.\nWhatever these different discount rates are, we can always find a single discount rate (named yield to maturity or YTM) which, when applied to all future payments, gives the market price at the time. Therefore, the yield to maturity is just the same thing as the bond’s market price.\n!!! question “But how should a bond’s price (hence yield to maturity) be determined?” Of course, price is shaped by transactions in the market. Yet how exactly do market participants value a bond so that they agree on the transaction price? Alternatively, if a new bond is to be issued, how should it be priced?\nIf we look at the bond pricing formula,\n\\[\nP_{t} = \\underbrace{\\sum_{\\tau=1}^{n} \\frac{C}{(1+r_\\tau)^{\\tau}} + \\frac{F}{(1+r_n)^n}}_{\\text{each discounted at corresponding spot rate}} = \\underbrace{\\sum_{\\tau=1}^{n} \\frac{C}{(1+{y})^{\\tau}} + \\frac{F}{(1+{y})^n}}_{\\text{all discounted at YTM}}\n\\]\nclearly the ultimate factor at play is the series of discount rates \\(\\{r_\\tau\\}\\), which are the spot rates as at time \\(t\\). On the other hand, each spot rate is applied to discount a single cashflow promised in the future, which resembles the payment of a zero-coupon bond, therefore, the spot rate is also sometimes called the “zero rate”.\n\n\n\n\n\n\nExample\n\n\n\nA two-year 5% coupon $100 bond with annual payments can be viewed as a portfolio of two separate assets:\n\nAsset 1 pays a single cashflow of $5 in one year, nothing else in any other time.\nAsset 2 pays a single cashflow of $105 in two years, nothing else in any other time.\n\nTo value Asset 1, we need the one-year spot rate. To value Asset 2, we need the two-year spot rate.\nSo, to value the bond, we need both the one-year spot rate and the two-year spot rate.\n\n\nIdeally, we would like to have a table of spot rates that tells us all the spot rates for all maturities, e.g., the 6-month rate, the 1-year rate, 1.5-year rate, 2-year rate, 2.5-year rate, 3-year rate, …, etc. This table mapping the term to maturity1 to the corresponding spot rate describes the term structure of interest rates, whose graphical representations are yield curves.\n1 Term to maturity: the remaining time to maturity.\nd = {\n  const data = {\"YTM\": [], \"Year\": []};\n  for (let year= 0.05; year &lt; 10; year+=0.5) {\n    data.YTM.push(Math.pow(1.1, year)-1)\n    data.Year.push(year)\n  }\n  return data;\n}\nPlot.plot({\n  caption: \"An illustrative yield curve\",\n  x: {padding: 0.4, label: \"Maturity (years)\"},\n  y: {padding: 0.4, label: \"Spot Rate (%)\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0]),\n    Plot.ruleX([0]),\n    Plot.dot(transpose(d), {x: \"Year\", y: \"YTM\", stroke: \"blue\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMoreover, we want this curve to be continuous without gaps, so that at any point of time we would know the spot rate to use for a cashflow, say 3.14 years in the future.\nHowever, do we have all spot rates readily available? Unfortunately, no. At least not directly.",
    "crumbs": [
      "Fixed Income",
      "Yield Curve and Term Structure of Interest Rates"
    ]
  },
  {
    "objectID": "posts/fixed-income/yield-curve/index.html#what-do-we-have-in-reality",
    "href": "posts/fixed-income/yield-curve/index.html#what-do-we-have-in-reality",
    "title": "Yield Curve and Term Structure of Interest Rates",
    "section": "What do we have in reality?",
    "text": "What do we have in reality?\nWhy do we not have a table of all spot rates? This is firstly because there are no government bonds for some maturities. For example, the U.S. government issues only Treasury securities of a selected range of maturities:2\n2 See TreasuryDirect for a list of available Treasury securities. This is the official website to buy U.S. Treasury securities.\nTreasury Bills (no coupon): 4, 8, 13, 17, 26, and 52 weeks.\nTreasury Notes (semi-annual coupon): 2, 3, 5, 7, or 10 years.\nTreasury Bonds (semi-annual coupon): 20 or 30 years.\n\nFurther, the YTM of a bond is a complicated weighted average of spot rates \\(\\{r_\\tau\\}\\) conditional on other bond-specific characteristics. For example, the YTM \\(y_n\\) of a \\(n\\)-year coupon bond with annual payments \\(C\\) and face value \\(F\\) is function \\(g\\) of \\(\\{r_{\\tau}\\}, C, F, n\\):\n\\[\ny_{n} = g(\\{r_\\tau\\}| C, F, n)\n\\]\nWe can observe from the market the YTMs \\(\\{y_n\\}\\) of Treasury securities of all maturities. If we plot them, we may end up with a “yield (to maturity) curve” like below:\n\nd2 = {\n  const data = {\"YTM\": [], \"Year\": []};\n  const m = [0.5, 1, 2, 3, 5, 7, 10, 20, 30];\n  for (let year= 0; year &lt; 31; year++) {\n    data.Year.push(year)\n    if (m.includes(year)) {\n      data.YTM.push(Math.pow(1.05, year)-1);\n    } else {\n      data.YTM.push(null);\n    }\n  }\n  return data;\n}\nPlot.plot({\n  caption: \"An illustrative graph of Treasury Securities' YTMs\",\n  x: {padding: 0.4, label: \"Maturity (years)\"},\n  y: {padding: 0.4, label: \"YTM (%)\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0]),\n    Plot.ruleX([0]),\n    Plot.dot(transpose(d2), {x: \"Year\", y: \"YTM\", stroke: \"blue\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCaution\n\n\n\nNotice that here we plot the YTMs \\(\\{y_n\\}\\), not the spot rates \\(\\{r_\\tau\\}\\).\n\n\nImmediately, we can feel the need for some further work:\n\nFirst, we need some reasonable interpolation methods to fill the gaps and connect the dots.\nSecond, we need a method to extract spot rate \\(r\\) from yield \\(y\\).\n\nFor the first point, unfortunately, finding such a reasonable interpolation method is not easy and requires advanced finance and mathematical knowledge. It is beyond the scope of discussion here.\nFurther, for those coupon-paying Treasury securities (TNotes and TBonds), their observed market yields are subject to the “coupon effect”, i.e., the bond yield is affected by coupon rate holding everything else constant.\nBut luckily, once we have removed the “coupon effect” from the yields, the second point is relatively straightforward as we will see soon.",
    "crumbs": [
      "Fixed Income",
      "Yield Curve and Term Structure of Interest Rates"
    ]
  },
  {
    "objectID": "posts/fixed-income/yield-curve/index.html#the-coupon-effect-and-par-yield",
    "href": "posts/fixed-income/yield-curve/index.html#the-coupon-effect-and-par-yield",
    "title": "Yield Curve and Term Structure of Interest Rates",
    "section": "The “coupon effect” and “par yield”",
    "text": "The “coupon effect” and “par yield”\nRecall that a bond’s YTM is a function of spot rates conditional on its coupon rate and other characteristics. This means that, other things equal, coupon rates affect YTM. This effect is unwanted - we are only interested in the relationship between yields and maturities without the distortion in yield comparisons caused by differences in coupon rates among bonds of different maturities.\n\n\n\n\n\n\nQuick notes on the coupon effect\n\n\n\n\nIf the yield curve (of spot rates) is not flat, then bonds with the same maturity but different coupons will have different yields.\n\nIf the yield curve is upward-sloping, then for any given maturity, higher coupon bonds will have lower yields.\nIf the yield curve is downward-sloping, then for any given maturity, higher coupon bonds will have higher yields.\n\n\nSee for example this NYU Stern course note on the coupon effect.\n\n\nThere is, fortunately, a situation where the “coupon effect” is not a concern, that is when the bonds are trading at par. When bonds are trading at par, their coupon rates and yields are aligned, and this “coupon effect” is mitigated.\nTherefore, when we initially select the Treasury securities in our analysis, we would like to choose those that are trading at par. We’d also like to choose those on-the-run3 Treasury securities because their yields are the most recent reflection of market expectation, and they are more likely to be trading at par or close to par.\n3 “on-the-run” refers to the most recently issued and actively traded securities in a particular category, usually referring to government bonds. These are the latest bonds or securities issued by a government or other issuing entity, and they are typically the ones that are most actively traded in the market.\nIn the context of government bonds, such as U.S. Treasury bonds, the term “on-the-run” is used to describe the most recently auctioned bonds of a particular maturity. These bonds are considered the benchmark or reference securities for that maturity because they represent the most current market conditions.The YTMs of these Treasury securities trading at par are called the “par yields”. Notice that while they’re named “yield”, but they are also the coupon rate of bonds such that these bonds are traded at par.\n\nIn other words, par yield is like a market consensus of what the coupon rate (hence yield) of a newly issued Treasury bond should be, so that it is fairly issued at par.\n\nOf course, not all on-the-run Treasury securities will necessarily be trading at par. Some adjustments may be applied by the Treasury. Though the Treasury does not disclose the exact method, but they do report the daily par yields for all maturities.",
    "crumbs": [
      "Fixed Income",
      "Yield Curve and Term Structure of Interest Rates"
    ]
  },
  {
    "objectID": "posts/fixed-income/yield-curve/index.html#the-yield-curve",
    "href": "posts/fixed-income/yield-curve/index.html#the-yield-curve",
    "title": "Yield Curve and Term Structure of Interest Rates",
    "section": "The yield curve",
    "text": "The yield curve\nNow that par yields remove the coupon effect, we may proceed to computing spot rates (zero rates), which will then be used in bond pricing.4\n4 We didn’t talk about how to “fill the gaps” between consecutive par yields because the methods used by central banks are pretty complicated. Let’s assume that we are provided with such par yield curve without gaps to facilitate our discussions.It should be noted, though, given a series of par yields, there should be a corresponding series zero rates. Hence, a yield curve can either be represented in terms of par yields or zero rates - they carry the same information.\n\nPar yields to zero rates\nSuppose at the end of the day, we observe the following par yields:\n\n\n\n\n\n\n\n\n\nMaturity\nType\nPar Yield\nZero Rate\n\n\n\n\n6 months\nTBill (no coupon)\n\\(y_{0.5yr}=1.05\\%\\)\n1.05%\n\n\n1 year\nTBill (no coupon)\n\\(y_{1yr}=1.2\\%\\)\n1.2%\n\n\n1.5 years\nHypothetical TNote\n\\(y_{1.5yr}=1.5\\%\\)\n\n\n\n2 year\nTNote\n\\(y_{2yr}=2.2\\%\\)\n\n\n\n2.5 year\nHypothetical TNote\n\\(y_{2.5yr}=2.4\\%\\)\n\n\n\n3 year\nTNote\n\\(y_{3yr}=2.8\\%\\)\n\n\n\n3.5 year\nHypothetical TNote\n\\(y_{3.5yr}=3\\%\\)\n\n\n\n4 year\nHypothetical TNote\n\\(y_{4yr}=3.4\\%\\)\n\n\n\n…\n\n\n\n\n\n\nWe can compute the zero rates from the given par yields using a method called bootstrapping.5\n5 Bootstrapping is an iterative process. In each iteration, we compute a single output based known information plus all the previously computed outputs, so that the “information set” grows gradually as we move forward.Iteration 1\nLet’s consider the pricing of the (hypothetical) 1.5-year TNote. Its par yield and hence coupon rate is \\(y_{1.5}=1.5\\%\\). Notice that the only unknown variable is the 1.5-year spot rate (zero rate) \\({\\color{red}r_{1.5}}\\):\n\\[\nP(\\text{1.5yr } y_{1.5}\\% \\text{ TNote}) = \\frac{0.5\\times y_{1.5}}{1+\\frac{r_{0.5}}{2}} + \\frac{0.5\\times y_{1.5}}{(1+\\frac{r_{1}}{2})^2} + \\frac{0.5\\times y_{1.5}+100}{(1+\\frac{\\color{red}r_{1.5}}{2})^3} = 100\n\\]\nSince there is only one unknown, we can solve for the 1.5-year spot rate (zero rate) \\({\\color{red}r_{1.5}}\\). In this example, the value of \\(\\color{green}r_{1.5}=1.5026\\%\\)\n\n\n\n\n\n\n\n\n\nMaturity\nType\nPar Yield\nZero Rate\n\n\n\n\n6 months\nTBill (no coupon)\n\\(y_{0.5yr}=1.05\\%\\)\n1.05%\n\n\n1 year\nTBill (no coupon)\n\\(y_{1yr}=1.2\\%\\)\n1.2%\n\n\n1.5 years\nHypothetical TNote\n\\(y_{1.5yr}=1.5\\%\\)\n\\(\\color{green}r_{1.5}=1.5026\\%\\)\n\n\n2 year\nTNote\n\\(y_{2yr}=2.2\\%\\)\n\n\n\n2.5 year\nHypothetical TNote\n\\(y_{2.5yr}=2.4\\%\\)\n\n\n\n3 year\nTNote\n\\(y_{3yr}=2.8\\%\\)\n\n\n\n3.5 year\nHypothetical TNote\n\\(y_{3.5yr}=3\\%\\)\n\n\n\n4 year\nHypothetical TNote\n\\(y_{4yr}=3.4\\%\\)\n\n\n\n…\n\n\n\n\n\n\nIteration 2\nNow consider the pricing of the 2-year TNote. Its par yield hence coupon rate is \\(y_{2}=2.2\\%\\). Notice that we now have the 1.5-year spot rate \\(\\color{green}r_{1.5}\\) available from last iteration, and the only unknown variable is now the 2-year spot rate (zero rate) \\({\\color{red}r_{2}}\\):\n\\[\nP(\\text{2yr } y_2\\% \\text{ TNote}) = \\frac{0.5\\times y_2}{1+\\frac{r_{0.5}}{2}} + \\frac{0.5\\times y_2}{(1+\\frac{r_{1}}{2})^2} + \\frac{0.5\\times y_2}{(1+\\frac{\\color{green}r_{1.5}}{2})^3} +\\frac{0.5\\times y_2+100}{(1+\\frac{\\color{red}r_{2}}{2})^4}=100\n\\]\nWe can solve for the 2-year spot rate (zero rate) \\({\\color{red}r_{2}}\\). It turns out that in this example, \\({\\color{green}r_{2}=2.2146\\%}\\).\n\n\n\n\n\n\n\n\n\nMaturity\nType\nPar Yield\nZero Rate\n\n\n\n\n6 months\nTBill (no coupon)\n\\(y_{0.5yr}=1.05\\%\\)\n1.05%\n\n\n1 year\nTBill (no coupon)\n\\(y_{1yr}=1.2\\%\\)\n1.2%\n\n\n1.5 years\nHypothetical TNote\n\\(y_{1.5yr}=1.5\\%\\)\n\\(\\color{green}r_{1.5}=1.5026\\%\\)\n\n\n2 year\nTNote\n\\(y_{2yr}=2.2\\%\\)\n\\({\\color{green}r_{2}=2.2146\\%}\\)\n\n\n2.5 year\nHypothetical TNote\n\\(y_{2.5yr}=2.4\\%\\)\n\n\n\n3 year\nTNote\n\\(y_{3yr}=2.8\\%\\)\n\n\n\n3.5 year\nHypothetical TNote\n\\(y_{3.5yr}=3\\%\\)\n\n\n\n4 year\nHypothetical TNote\n\\(y_{4yr}=3.4\\%\\)\n\n\n\n…\n\n\n\n\n\n\nIteration 3\nNow consider the pricing of the 2.5-year TNote. Its par yield hence coupon rate is \\(y_{2.5}=2.4\\%\\). Notice that we now have \\(\\color{green}r_{1.5}\\) and \\(\\color{green}r_{2}\\) available from last iterations, and the only unknown variable is now the 2.5-year spot rate (zero rate) \\({\\color{red}r_{2.5}}\\):\n\\[\nP(\\text{2.5yr } y_{2.5}\\% \\text{ TNote}) = \\frac{0.5\\times y_{2.5}}{1+\\frac{r_{0.5}}{2}} + \\frac{0.5\\times y_{2.5}}{(1+\\frac{r_{1}}{2})^2} + \\frac{0.5\\times y_{2.5}}{(1+\\frac{\\color{green}r_{1.5}}{2})^3} +\\frac{0.5\\times y_{2.5}}{(1+\\frac{\\color{green}r_{2}}{2})^4} + \\frac{0.5\\times y_{2.5}+100}{(1+\\frac{\\color{red}r_{2.5}}{2})^4}=100\n\\]\nWe can solve for the 2.5-year spot rate (zero rate) \\({\\color{red}r_{2.5}}\\). It turns out that in this example, \\({\\color{green}r_{2.5}=2.4176\\%}\\).\n\n\n\n\n\n\n\n\n\nMaturity\nType\nPar Yield\nZero Rate\n\n\n\n\n6 months\nTBill (no coupon)\n\\(y_{0.5yr}=1.05\\%\\)\n1.05%\n\n\n1 year\nTBill (no coupon)\n\\(y_{1yr}=1.2\\%\\)\n1.2%\n\n\n1.5 years\nHypothetical TNote\n\\(y_{1.5yr}=1.5\\%\\)\n\\(\\color{green}r_{1.5}=1.5026\\%\\)\n\n\n2 year\nTNote\n\\(y_{2yr}=2.2\\%\\)\n\\({\\color{green}r_{2}=2.2146\\%}\\)\n\n\n2.5 year\nHypothetical TNote\n\\(y_{2.5yr}=2.4\\%\\)\n\\({\\color{green}r_{2.5}=2.4176\\%}\\)\n\n\n3 year\nTNote\n\\(y_{3yr}=2.8\\%\\)\n\n\n\n3.5 year\nHypothetical TNote\n\\(y_{3.5yr}=3\\%\\)\n\n\n\n4 year\nHypothetical TNote\n\\(y_{4yr}=3.4\\%\\)\n\n\n\n…\n\n\n\n\n\n\nIterations continue…\nEventually, we will be able to fill all the blanks in the table by working out the zero rates for all maturities.\n\n\nPlotting yield curves\nIn terms of the example above, we can plot the par yields (blue) and bootstrapped zero rates (red) as below.\n\nd3 = [{ \"year\": 0.5, \"par_yield\": 1.05, \"spot_rate\": 1.05 },\n        { \"year\": 1, \"par_yield\": 1.2, \"spot_rate\": 1.2 },\n        { \"year\": 1.5, \"par_yield\": 1.5, \"spot_rate\": 1.5026393890380874 },\n        { \"year\": 2.0, \"par_yield\": 2.2, \"spot_rate\": 2.2146487236022976 },\n        { \"year\": 2.5, \"par_yield\": 2.4, \"spot_rate\": 2.417717552185062 },\n        { \"year\": 3.0, \"par_yield\": 2.8, \"spot_rate\": 2.8317731857299844 },\n        { \"year\": 3.5, \"par_yield\": 3, \"spot_rate\": 3.0386474132537877 },\n        { \"year\": 4.0, \"par_yield\": 3.4, \"spot_rate\": 3.4637652397155807 },\n        { \"year\": 4.5, \"par_yield\": 3.5, \"spot_rate\": 3.565935420989996 },\n        { \"year\": 5.0, \"par_yield\": 3.6, \"spot_rate\": 3.669886875152593 },\n        { \"year\": 5.5, \"par_yield\": 3.8, \"spot_rate\": 3.8880950450897283 },\n        { \"year\": 6.0, \"par_yield\": 4, \"spot_rate\": 4.1098044395446856 },\n        { \"year\": 6.5, \"par_yield\": 4.3, \"spot_rate\": 4.453684520721444 },\n        { \"year\": 7.0, \"par_yield\": 4.8, \"spot_rate\": 5.053358459472664 },\n        { \"year\": 7.5, \"par_yield\": 5, \"spot_rate\": 5.290201091766365 },\n        { \"year\": 8.0, \"par_yield\": 5.2, \"spot_rate\": 5.533113956451425 },\n        { \"year\": 8.5, \"par_yield\": 5.35, \"spot_rate\": 5.714883279800425 },\n        { \"year\": 9.0, \"par_yield\": 5.4, \"spot_rate\": 5.763193321228037 },\n        { \"year\": 9.5, \"par_yield\": 5.45, \"spot_rate\": 5.8138489723205655 },\n        { \"year\": 10.0, \"par_yield\": 5.5, \"spot_rate\": 5.866698265075694 }]\nPlot.plot({\n  caption: \"An illustrative graph of par yields and zero rates\",\n  x: {padding: 0.4, label: \"Maturity (years)\"},\n  y: {padding: 0.4, label: \"YTM (%)\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0]),\n    Plot.ruleX([0]),\n    Plot.dot(d3, {x: \"year\", y: \"par_yield\", stroke: \"blue\"}),\n    Plot.dot(d3, {x: \"year\", y: \"spot_rate\", stroke: \"red\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWhat does a yield curve look like in real world?\n\n\n\nSee an animation of the daily yield curves since January 2021 to August 20236. This is the par yield curve without interpolation. I simply connect consecutive par yields straightly.\n\n\n6 Yes, yield curve is not constant. As time changes, the par yields (hence spot rates) change!\n\n\n\n\n\n\nStata code for the animation\n\n\n\n\n\n/* Yield Curve Animation Frames */\n\n/* Import data from FRED */\nimport fred DGS1MO DGS3MO DGS6MO DGS1 DGS2 DGS3 DGS5 DGS7 DGS10 DGS20 DGS30, ///\ndaterange(2021-01-01 2023-08-25) aggregate(daily,eop) clear\ndrop datestr \n\n/* Rename vars to reshape */\nforeach yr in 1 2 3 5 7 10 20 30 {\nloc months = `yr'*12\nrename DGS`yr' DGS`months'\n}\nforeach m in 1 3 6 {\nrename DSG`m'MO DGS`m'\n}\nreshape long DGS, i(daten) j(maturityInMonths)\nrename DGS yield\n\n/* Vars */\ngen maturity = maturityInMonths/12\nlabel var maturity \"Maturity (years)\"\nlabel var yield \"Yield (%)\"\n\n/* Remove no-yield dates */\ndrop if yield == .\n\nloc i = 0\nforvalues year = 2021/2023 {\nforvalues month = 1/12 {\n  forvalues day = 1/31 {\n    /* Skip dates without data */\n    loc date = mdy(`month', `day', `year')\n    if `date' == . {\n      continue\n    }\n    local formatted_date : display %tdY-m-d `date'\n    di \"`formatted_date'\"\n    su if daten== mdy(`month',`day',`year'), meanonly\n    if r(N)==0 {\n      continue\n    }\n    /* Plot and index each date as a frame */\n    loc i = `i' + 1\n    twoway (spike yield maturity, sort lcolor(%30) lpattern(dash)) ///\n    (connected yield maturity, sort) if daten== mdy(`month',`day',`year'), ///\n    ylabel(0(1)10) xtitle(Maturity) ///\n    xlabel(0.5 \"6M\" 1 \"1Y\" 2 \"2Y\" 3 \"3Y\" 5 \"5Y\" 7 \"7Y\" ///\n      10 \"10Y\" 20 \"20Y\" 30 \"30Y\", labsize(vsmall) ///\n    angle(forty_five)) title(Yield Curve of U.S. Treasury Securities) ///\n    subtitle(\"Date: `formatted_date'\") ///\n    caption(Made by Dr. Mingze Gao, size(vsmall) position(5)) ///\n    note(Source: FRED) legend(off)\n    graph export \"yiled_curve_`i'.png\", replace\n  }\n}\n}\n\n\n\n\n\nShapes of yield curve\nWe can see from the animation above that the yield curve has been overall shifted upwardly in the past few years. Moreover, the shape of the yield curve has changed.\n\nIn 2021, the yield curve’s shape was normal, meaning that it’s upward-sloping with short-term yields lower than long-term yields.\nIn 2022, the yield curve’s shape became flat, meaning that the short-term yields are similar to those long-term yields.\nSince late 2022 and in 2023, the yield curve’s shape is inverted, meaning that it’s downward-sloping the short-term yields higher than long-term yields.\n\nThese shapes of yield curves are informative.\n\nAn upward-sloping yield curve generally indicates that investors expect the economy to grow in the future, leading to higher inflation and interest rates. It reflects the market’s anticipation of increasing borrowing costs and potentially rising demand for credit.\nA flat yield curve could suggest uncertainty about the economic outlook. It might also indicate that the central bank is maintaining a neutral stance or that market participants believe that current interest rates are close to their peak.\nAn inverted yield curve is often seen as a signal of potential economic slowdown or recession. It suggests that investors expect future interest rates to decline due to weaker economic conditions. An inverted curve can indicate that market participants expect the central bank to cut interest rates to stimulate economic growth.",
    "crumbs": [
      "Fixed Income",
      "Yield Curve and Term Structure of Interest Rates"
    ]
  },
  {
    "objectID": "posts/garch-ccc/index.html",
    "href": "posts/garch-ccc/index.html",
    "title": "GARCH-Constant Conditional Correlation (CCC)",
    "section": "",
    "text": "This post details a multivariate GARCH Constant Conditional Correlation (CCC) model (Engle 1982). It was somewhat surprising that I didn’t find a good Python implementation of GARCH-CCC, so I wrote my own, see documentation on frds.io. It performs very well, often generates (marginally) better estimates than in Stata based on log-likelihood."
  },
  {
    "objectID": "posts/garch-ccc/index.html#multivariate-garch-ccc",
    "href": "posts/garch-ccc/index.html#multivariate-garch-ccc",
    "title": "GARCH-Constant Conditional Correlation (CCC)",
    "section": "Multivariate GARCH-CCC",
    "text": "Multivariate GARCH-CCC\nThe Multivariate GARCH model generalizes the univariate GARCH framework to multiple time series, capturing not only the conditional variances but also the conditional covariances between the series. One common form is the Constant Conditional Correlation (CCC) model proposed by Bollerslev (1990).\n\nReturn equation\nThe return equation for a \\(N\\)-dimensional time series is:\n\\[\n\\mathbf{r}_t = \\boldsymbol{\\mu} + \\boldsymbol{\\epsilon}_t\n\\]\nHere, \\(\\mathbf{r}_t\\) is a \\(N \\times 1\\) vector of returns, and \\(\\boldsymbol{\\mu}\\) is a \\(N \\times 1\\) vector of mean returns. \\(\\boldsymbol{\\epsilon}_t\\) is the \\(N \\times 1\\) vector of shock terms.\n\n\n\n\n\n\nBivariate example\n\n\n\n\\[\n\\begin{align*}\nr_{1t} &= \\mu_1 + \\epsilon_{1,t-1} \\\\\\\\\nr_{2t} &= \\mu_2 + \\epsilon_{2,t-1}\n\\end{align*}\n\\]\n\n\n\n\nShock equation\nThe shock term is modelled as:\n\\[\n\\boldsymbol{\\epsilon}_t = \\mathbf{H}_t^{1/2} \\mathbf{z}_t\n\\]\nHere, \\(\\mathbf{H}_t\\) is a \\(N \\times N\\) conditional covariance matrix, \\(\\mathbf{H}_t^{1/2}\\) is a \\(N \\times N\\) positive definite matrix, and \\(\\mathbf{z}_t\\) is a \\(N \\times 1\\) vector of standard normal innovations.\n\n\n\n\n\n\nBivariate example\n\n\n\n\\[\n\\begin{align*}\n\\epsilon_{1t} &= \\sqrt{h_{1t}} \\cdot z_{1t} \\\\\\\\\n\\epsilon_{2t} &= \\sqrt{h_{2t}} \\cdot z_{2t}\n\\end{align*}\n\\]\n\n\n\n\nConditional covariance matrix\nIn the CCC-GARCH(1,1) model, the conditional covariance matrix \\(\\mathbf{H}_t\\) is constructed as:\n\\[\n\\mathbf{H}_t = \\mathbf{D}_t\\mathbf{R}\\mathbf{D}_t\n\\]\nwhere \\(\\mathbf{D}_t = \\text{diag}(\\mathbf{h}_t)^{1/2}\\), and \\(\\mathbf{h}_t\\) is a \\(N \\times 1\\) vector whose elements are univariate GARCH(1,1) variances for each time series. \\(\\mathbf{R}\\) is a positive definite constant conditional correlation matrix.\n\n\n\n\n\n\nBivariate example\n\n\n\nIn a bivariate GARCH(1,1) setting, we have two univariate GARCH(1,1) processes, one for each return series. Specifically, the GARCH(1,1) equations for the conditional variances \\(h_{1t}\\) and \\(h_{2t}\\) can be written as:\n\\[\n\\begin{align*}\nh_{1t} &= \\omega_1 + \\alpha_1 \\epsilon_{1,t-1}^2 + \\beta_1 h_{1,t-1} \\\\\\\\\nh_{2t} &= \\omega_2 + \\alpha_2 \\epsilon_{2,t-1}^2 + \\beta_2 h_{2,t-1}\n\\end{align*}\n\\]\nwhere\n\n\\(\\epsilon_{1,t-1}\\) and \\(\\epsilon_{2,t-1}\\) are past shock terms from their respective time series.\nThe parameters \\(\\omega_1, \\alpha_1, \\beta_1, \\omega_2, \\alpha_2, \\beta_2\\) are to be estimated.\n\nWith these individual variances, the conditional covariance matrix \\(\\mathbf{H}_t\\) is:\n\\[\n\\mathbf{H}_t = \\begin{pmatrix}\nh_{1t} & \\rho\\sqrt{h_{1t} h_{2t}} \\\\\n\\rho\\sqrt{h_{1t} h_{2t}} & h_{2t}\n\\end{pmatrix}\n\\]\nHere, \\(\\rho\\) is the correlation between the two time series. It is assumed to be constant over time in the CCC-GARCH framework.\n\n\n\n\nLog-likelihood function\nThe log-likelihood function for the \\(N\\)-dimensional multivariate GARCH CCC model is:\n\\[\n   \\begin{align*}\n   \\ell &= -\\frac{1}{2} \\sum_{t=1}^T \\left[ N\\ln(2\\pi) + \\ln(|\\mathbf{H}_t|) + \\mathbf{\\epsilon}_t' \\mathbf{H}_t^{-1} \\mathbf{\\epsilon}_t \\right] \\\\\\\\\n        &= -\\frac{1}{2} \\sum_{t=1}^T \\left[ N\\ln(2\\pi) + \\ln(|\\mathbf{D}_t\\mathbf{R}\\mathbf{D}_t|) + \\mathbf{\\epsilon}_t' \\mathbf{D}_t^{-1}\\mathbf{R}^{-1}\\mathbf{D}_t^{-1} \\mathbf{\\epsilon}_t \\right] \\\\\\\\\n        &= -\\frac{1}{2} \\sum_{t=1}^T \\left[ N\\ln(2\\pi) + 2 \\ln(|\\mathbf{D}_t|) + \\ln(|\\mathbf{R}|)+ \\mathbf{z}_t' \\mathbf{R}^{-1} \\mathbf{z}_t \\right]\n   \\end{align*}\n\\]\nwhere \\(\\mathbf{z}_t=\\mathbf{D}_t^{-1}\\mathbf{\\epsilon}_t\\) is the vector of standardized residuals.\n\n\n\n\n\n\nBivariate example\n\n\n\nIn the bivariate case, the log-likelihood function can be specifically written as a function of all parameters.\nThe log-likelihood function \\(\\ell(\\Theta)\\) for the bivariate case with all parameters \\(\\Theta = (\\mu_1, \\omega_1, \\alpha_1, \\beta_1, \\mu_2, \\omega_2, \\alpha_2, \\beta_2, \\rho)\\) is:\n\\[\n\\ell(\\Theta) = -\\frac{1}{2} \\sum_{t=1}^T \\left[ 2\\ln(2\\pi) + 2 \\ln(|\\mathbf{D}_t|) + \\ln(|\\mathbf{R}|) + \\mathbf{z}_t' \\mathbf{R}^{-1} \\mathbf{z}_t \\right]\n\\tag{1}\\]\nHere, \\(\\mathbf{z}_t'\\) is the transpose of the vector of standardized residuals \\(\\mathbf{z}_t\\):\n\\[\n\\mathbf{z}_t = \\begin{pmatrix}\nz_{1,t} \\\\\nz_{2,t}\n\\end{pmatrix}\n\\]\nFurther, \\(\\mathbf{D}_t\\) is:\n\\[\n\\mathbf{D}_t = \\begin{pmatrix}\n\\sqrt{h_{1t}} & 0 \\\\\n0 & \\sqrt{h_{2t}}\n\\end{pmatrix}\n\\]\nSo the log-determinant of \\(\\mathbf{D}_t\\) is:\n\\[\n\\ln(|\\mathbf{D}_t|) = \\frac{1}{2} \\ln(h_{1t} h_{2t})\n\\]\nThe log-determinant of \\(\\mathbf{R}\\) is:\n\\[\n\\ln(|\\mathbf{R}|) = \\ln(1 - \\rho^2)\n\\]\nThe inverse of \\(\\mathbf{R}\\) is:\n\\[\n\\mathbf{R}^{-1} = \\frac{1}{1 - \\rho^2} \\begin{pmatrix}\n1 & -\\rho \\\\\n-\\rho & 1\n\\end{pmatrix}\n\\]\nLastly, \\(\\mathbf{z}_t' \\mathbf{R}^{-1} \\mathbf{z}_t\\) is:\n\\[\n\\mathbf{z}_t' \\mathbf{R}^{-1} \\mathbf{z}_t = \\frac{1}{1 - \\rho^2} \\left[ z_{1t}^2 - 2\\rho z_{1t} z_{2t} + z_{2t}^2 \\right]\n\\]\nInserting all of these into \\(\\ell(\\Theta)\\) in Equation 1 leads to:\n\\[\n\\ell(\\Theta) = -\\frac{1}{2} \\sum_{t=1}^T \\left[ 2\\ln(2\\pi) + \\ln(h_{1t} h_{2t} (1 - \\rho^2)) + \\frac{1}{1 - \\rho^2} \\left( z_{1t}^2 - 2\\rho z_{1t} z_{2t} + z_{2t}^2 \\right) \\right]\n\\]"
  },
  {
    "objectID": "posts/garch-ccc/index.html#estimation-techniques",
    "href": "posts/garch-ccc/index.html#estimation-techniques",
    "title": "GARCH-Constant Conditional Correlation (CCC)",
    "section": "Estimation techniques",
    "text": "Estimation techniques\nfrds.algorithms.GARCHModel_CCC is my implementation. Specifically, I estimate all the GARCH-DCC parameters simultaneously via maximizing the log-likelihood.\nGeneral steps are:\n\nUse frds.algorithms.GARCHModel to estimate the GARCH model for each of the returns.\nUse the standardized residuals from the estimated GARCH models to compute the correlation coefficient.\nUse as starting values the estimated parameters from above in optimizing the log-likelihood function."
  },
  {
    "objectID": "posts/garch-ccc/index.html#example-code",
    "href": "posts/garch-ccc/index.html#example-code",
    "title": "GARCH-Constant Conditional Correlation (CCC)",
    "section": "Example code",
    "text": "Example code\nLet’s import the dataset.\n&gt;&gt;&gt; import pandas as pd\n&gt;&gt;&gt; data_url = \"https://www.stata-press.com/data/r18/stocks.dta\"\n&gt;&gt;&gt; df = pd.read_stata(data_url, convert_dates=[\"date\"])\nScale returns to percentage returns for better optimization results\n&gt;&gt;&gt; returns1 = df[\"toyota\"].to_numpy() * 100\n&gt;&gt;&gt; returns2 = df[\"nissan\"].to_numpy() * 100\nUse frds.algorithms.GARCHModel_CCC to estimate a GARCH(1,1)-CCC.\n&gt;&gt;&gt; from frds.algorithms import GARCHModel_CCC\n&gt;&gt;&gt; model_ccc = GARCHModel_CCC(returns1, returns2)\n&gt;&gt;&gt; res = model_ccc.fit()\n&gt;&gt;&gt; from pprint import pprint\n&gt;&gt;&gt; pprint(res)\nParameters(mu1=0.02745814255283541,\n           omega1=0.03401400758840226,\n           alpha1=0.06593379740524756,\n           beta1=0.9219575443861723,\n           mu2=0.009390068254041505,\n           omega2=0.058694325049554734,\n           alpha2=0.0830561828957614,\n           beta2=0.9040961791372522,\n           rho=0.6506770477876749,\n           loglikelihood=-7281.321453218112)\nThese results are comparable to the ones obtained in Stata, and even marginally better based on log-likelihood. In Stata, we can estimate the same model as below:\nwebuse stocks, clear\nreplace toyota = toyota * 100\nreplace nissan = nissan * 100\nmgarch ccc (toyota nissan = ), arch(1) garch(1)\nThe Stata results are:\n     Constant conditional correlation MGARCH model\n\n     Sample: 1 thru 2015                                      Number of obs = 2,015\n     Distribution: Gaussian                                   Wald chi2(.)  =     .\n     Log likelihood = -7282.961                               Prob &gt; chi2   =     .\n\n     -------------------------------------------------------------------------------------\n                         | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]\n     --------------------+----------------------------------------------------------------\n     toyota              |\n                 _cons   |   .0277462   .0302805     0.92   0.360    -.0316024    .0870948\n     --------------------+----------------------------------------------------------------\n     ARCH_toyota         |\n                    arch |\n                    L1.  |   .0666384   .0101597     6.56   0.000     .0467257    .0865511\n                         |\n                  garch  |\n                    L1.  |   .9210688   .0119214    77.26   0.000     .8977032    .9444343\n                         |\n                  _cons  |   .0344153   .0109208     3.15   0.002      .013011    .0558197\n     --------------------+----------------------------------------------------------------\n     nissan              |\n                  _cons  |   .0079682   .0349351     0.23   0.820    -.0605034    .0764398\n     --------------------+----------------------------------------------------------------\n     ARCH_nissan         |\n                    arch |\n                    L1.  |   .0851778   .0132656     6.42   0.000     .0591778    .1111779\n                         |\n                  garch  |\n                    L1.  |   .9016613   .0150494    59.91   0.000     .8721649    .9311577\n                         |\n                  _cons  |   .0603765   .0178318     3.39   0.001     .0254269    .0953262\n     --------------------+----------------------------------------------------------------\n     corr(toyota,nissan) |   .6512249   .0128548    50.66   0.000       .62603    .6764199\n     -------------------------------------------------------------------------------------"
  },
  {
    "objectID": "posts/generate-fama-french-industry-classification-from-sic/index.html",
    "href": "posts/generate-fama-french-industry-classification-from-sic/index.html",
    "title": "Generate Fama-French Industry Classification From SIC",
    "section": "",
    "text": "This Stata program creates the Fama-French industry classification from SIC code."
  },
  {
    "objectID": "posts/generate-fama-french-industry-classification-from-sic/index.html#basic-usage",
    "href": "posts/generate-fama-french-industry-classification-from-sic/index.html#basic-usage",
    "title": "Generate Fama-French Industry Classification From SIC",
    "section": "Basic usage",
    "text": "Basic usage\nffind sic, generate(“FF48”) type(48)\nwhere sic is SIC code, FF48 is the generated industry variable name, and we are using 48-industry classification. Alternatively, one can choose 5, 10, 12, 17, 30, 38 or 49 industries."
  },
  {
    "objectID": "posts/generate-fama-french-industry-classification-from-sic/index.html#full-stata-code",
    "href": "posts/generate-fama-french-industry-classification-from-sic/index.html#full-stata-code",
    "title": "Generate Fama-French Industry Classification From SIC",
    "section": "Full Stata code",
    "text": "Full Stata code\n/****************************************\n* ffind.ado\n* Creates variable containing Fama-French\n* industry classification.\n*\n* Author:  Judson Caskey, UCLA\n*          December 9, 2007\n*\n* Revised by Malcolm Wardlaw, Uiversity of Texas at Dallas (November 1, 2011)\n****************************************/\n\ncapture program drop ffind\n\nprogram define ffind\n    version 9.2\n    syntax varlist(min=1 max=1 numeric) [if] [in], Generate(string) Type(numlist max=1 min=1)\n\n    tempvar ftyp\n    tokenize \"`type'\"\n    local `ftyp'=`1'\n    \n    * Check if generate is valid variable name\n    capture confirm new variable `generate'\n    if _rc != 0 {\n        di as error \"Variable `generate' is invalid\"\n        exit 111\n        }\n\n    * Check type\n    if ~inlist(``ftyp'',5,10,12,17,30,38,48,49) {\n        di as error \"Type must be 5, 10, 12, 17, 30, 38, 48 or 49\"\n        exit 111\n        }\n\n    * Set industries\n\n    tempvar ffind\n    tokenize \"`varlist'\"\n    local `ffind' \"`1'\"\n\n\n    qui gen `generate'=.\n    label variable `generate' \"Fama-French industry code (``ftyp'' industries)\"\n\n    capture label drop `generate'\n    if ``ftyp''==5 {\n        label define `generate' 1 \"Consumer Durables, NonDurables, Wholesale, Retail, and Some Services (Laundries, Repair Shops)\" 2 \"Manufacturing, Energy, and Utilities\" 3 \"Business Equipment, Telephone and Television Transmission\" 4 \"Healthcare, Medical Equipment, and Drugs\" 5 \"Other -- Mines, Constr, BldMt, Trans, Hotels, Bus Serv, Entertainment, Finance\"\n        label values `generate' `generate'\n\n        qui replace `generate'=1 if inrange(``ffind'',100,999) | inrange(``ffind'',2000,2399) | inrange(``ffind'',2700,2749) | inrange(``ffind'',2770,2799) | inrange(``ffind'',3100,3199) | inrange(``ffind'',3940,3989) | inrange(``ffind'',2500,2519) | inrange(``ffind'',2590,2599) | inrange(``ffind'',3630,3659) | inrange(``ffind'',3710,3711) | inrange(``ffind'',3714,3714) | inrange(``ffind'',3716,3716) | inrange(``ffind'',3750,3751) | inrange(``ffind'',3792,3792) | inrange(``ffind'',3900,3939) | inrange(``ffind'',3990,3999) | inrange(``ffind'',5000,5999) | inrange(``ffind'',7200,7299) | inrange(``ffind'',7600,7699)\n        qui replace `generate'=2 if inrange(``ffind'',2520,2589) | inrange(``ffind'',2600,2699) | inrange(``ffind'',2750,2769) | inrange(``ffind'',2800,2829) | inrange(``ffind'',2840,2899) | inrange(``ffind'',3000,3099) | inrange(``ffind'',3200,3569) | inrange(``ffind'',3580,3629) | inrange(``ffind'',3700,3709) | inrange(``ffind'',3712,3713) | inrange(``ffind'',3715,3715) | inrange(``ffind'',3717,3749) | inrange(``ffind'',3752,3791) | inrange(``ffind'',3793,3799) | inrange(``ffind'',3830,3839) | inrange(``ffind'',3860,3899) | inrange(``ffind'',1200,1399) | inrange(``ffind'',2900,2999) | inrange(``ffind'',4900,4949)\n        qui replace `generate'=3 if inrange(``ffind'',3570,3579) | inrange(``ffind'',3622,3622) | inrange(``ffind'',3660,3692) | inrange(``ffind'',3694,3699) | inrange(``ffind'',3810,3839) | inrange(``ffind'',7370,7372) | inrange(``ffind'',7373,7373) | inrange(``ffind'',7374,7374) | inrange(``ffind'',7375,7375) | inrange(``ffind'',7376,7376) | inrange(``ffind'',7377,7377) | inrange(``ffind'',7378,7378) | inrange(``ffind'',7379,7379) | inrange(``ffind'',7391,7391) | inrange(``ffind'',8730,8734) | inrange(``ffind'',4800,4899)\n        qui replace `generate'=4 if inrange(``ffind'',2830,2839) | inrange(``ffind'',3693,3693) | inrange(``ffind'',3840,3859) | inrange(``ffind'',8000,8099)\n        qui replace `generate'=5 if missing(`generate') & ~missing(``ffind'')\n        }\n    else if ``ftyp''==10 {\n        label define `generate' 1 \"Consumer NonDurables -- Food, Tobacco, Textiles, Apparel, Leather, Toys\" 2 \"Consumer Durables -- Cars, TV's, Furniture, Household Appliances\" 3 \"Manufacturing -- Machinery, Trucks, Planes, Chemicals, Off Furn, Paper, Com Printing\" 4 \"Oil, Gas, and Coal Extraction and Products\" 5 \"Business Equipment -- Computers, Software, and Electronic Equipment\" 6 \"Telephone and Television Transmission\" 7 \"Wholesale, Retail, and Some Services (Laundries, Repair Shops)\" 8 \"Healthcare, Medical Equipment, and Drugs\" 9 \"Utilities\" 10 \"Other -- Mines, Constr, BldMt, Trans, Hotels, Bus Serv, Entertainment, Finance\"\n        label values `generate' `generate'\n\n        qui replace `generate'=1 if inrange(``ffind'',100,999) | inrange(``ffind'',2000,2399) | inrange(``ffind'',2700,2749) | inrange(``ffind'',2770,2799) | inrange(``ffind'',3100,3199) | inrange(``ffind'',3940,3989)\n        qui replace `generate'=2 if inrange(``ffind'',2500,2519) | inrange(``ffind'',2590,2599) | inrange(``ffind'',3630,3659) | inrange(``ffind'',3710,3711) | inrange(``ffind'',3714,3714) | inrange(``ffind'',3716,3716) | inrange(``ffind'',3750,3751) | inrange(``ffind'',3792,3792) | inrange(``ffind'',3900,3939) | inrange(``ffind'',3990,3999)\n        qui replace `generate'=3 if inrange(``ffind'',2520,2589) | inrange(``ffind'',2600,2699) | inrange(``ffind'',2750,2769) | inrange(``ffind'',2800,2829) | inrange(``ffind'',2840,2899) | inrange(``ffind'',3000,3099) | inrange(``ffind'',3200,3569) | inrange(``ffind'',3580,3629) | inrange(``ffind'',3700,3709) | inrange(``ffind'',3712,3713) | inrange(``ffind'',3715,3715) | inrange(``ffind'',3717,3749) | inrange(``ffind'',3752,3791) | inrange(``ffind'',3793,3799) | inrange(``ffind'',3830,3839) | inrange(``ffind'',3860,3899)\n        qui replace `generate'=4 if inrange(``ffind'',1200,1399) | inrange(``ffind'',2900,2999)\n        qui replace `generate'=5 if inrange(``ffind'',3570,3579) | inrange(``ffind'',3622,3622) | inrange(``ffind'',3660,3692) | inrange(``ffind'',3694,3699) | inrange(``ffind'',3810,3839) | inrange(``ffind'',7370,7372) | inrange(``ffind'',7373,7373) | inrange(``ffind'',7374,7374) | inrange(``ffind'',7375,7375) | inrange(``ffind'',7376,7376) | inrange(``ffind'',7377,7377) | inrange(``ffind'',7378,7378) | inrange(``ffind'',7379,7379) | inrange(``ffind'',7391,7391) | inrange(``ffind'',8730,8734)\n        qui replace `generate'=6 if inrange(``ffind'',4800,4899)\n        qui replace `generate'=7 if inrange(``ffind'',5000,5999) | inrange(``ffind'',7200,7299) | inrange(``ffind'',7600,7699)\n        qui replace `generate'=8 if inrange(``ffind'',2830,2839) | inrange(``ffind'',3693,3693) | inrange(``ffind'',3840,3859) | inrange(``ffind'',8000,8099)\n        qui replace `generate'=9 if inrange(``ffind'',4900,4949)\n        qui replace `generate'=10 if missing(`generate') & ~missing(``ffind'')\n        }\n    else if ``ftyp''==12 {\n        label define `generate' 1 \"Consumer NonDurables -- Food, Tobacco, Textiles, Apparel, Leather, Toys\" 2 \"Consumer Durables -- Cars, TV's, Furniture, Household Appliances\" 3 \"Manufacturing -- Machinery, Trucks, Planes, Off Furn, Paper, Com Printing\" 4 \"Oil, Gas, and Coal Extraction and Products\" 5 \"Chemicals and Allied Products\" 6 \"Business Equipment -- Computers, Software, and Electronic Equipment\" 7 \"Telephone and Television Transmission\" 8 \"Utilities\" 9 \"Wholesale, Retail, and Some Services (Laundries, Repair Shops)\" 10 \"Healthcare, Medical Equipment, and Drugs\" 11 \"Finance\" 12 \"Other -- Mines, Constr, BldMt, Trans, Hotels, Bus Serv, Entertainment\"\n        label values `generate' `generate'\n\n        qui replace `generate'=1 if inrange(``ffind'',100,999) | inrange(``ffind'',2000,2399) | inrange(``ffind'',2700,2749) | inrange(``ffind'',2770,2799) | inrange(``ffind'',3100,3199) | inrange(``ffind'',3940,3989)\n        qui replace `generate'=2 if inrange(``ffind'',2500,2519) | inrange(``ffind'',2590,2599) | inrange(``ffind'',3630,3659) | inrange(``ffind'',3710,3711) | inrange(``ffind'',3714,3714) | inrange(``ffind'',3716,3716) | inrange(``ffind'',3750,3751) | inrange(``ffind'',3792,3792) | inrange(``ffind'',3900,3939) | inrange(``ffind'',3990,3999)\n        qui replace `generate'=3 if inrange(``ffind'',2520,2589) | inrange(``ffind'',2600,2699) | inrange(``ffind'',2750,2769) | inrange(``ffind'',3000,3099) | inrange(``ffind'',3200,3569) | inrange(``ffind'',3580,3629) | inrange(``ffind'',3700,3709) | inrange(``ffind'',3712,3713) | inrange(``ffind'',3715,3715) | inrange(``ffind'',3717,3749) | inrange(``ffind'',3752,3791) | inrange(``ffind'',3793,3799) | inrange(``ffind'',3830,3839) | inrange(``ffind'',3860,3899)\n        qui replace `generate'=4 if inrange(``ffind'',1200,1399) | inrange(``ffind'',2900,2999)\n        qui replace `generate'=5 if inrange(``ffind'',2800,2829) | inrange(``ffind'',2840,2899)\n        qui replace `generate'=6 if inrange(``ffind'',3570,3579) | inrange(``ffind'',3660,3692) | inrange(``ffind'',3694,3699) | inrange(``ffind'',3810,3829) | inrange(``ffind'',7370,7379)\n        qui replace `generate'=7 if inrange(``ffind'',4800,4899)\n        qui replace `generate'=8 if inrange(``ffind'',4900,4949)\n        qui replace `generate'=9 if inrange(``ffind'',5000,5999) | inrange(``ffind'',7200,7299) | inrange(``ffind'',7600,7699)\n        qui replace `generate'=10 if inrange(``ffind'',2830,2839) | inrange(``ffind'',3693,3693) | inrange(``ffind'',3840,3859) | inrange(``ffind'',8000,8099)\n        qui replace `generate'=11 if inrange(``ffind'',6000,6999)\n        qui replace `generate'=12 if missing(`generate') & ~missing(``ffind'')\n        }\n\n    else if ``ftyp''==17 {\n        label define `generate' 1 \"Food\" 2 \"Mining and Minerals\" 3 \"Oil and Petroleum Products\" 4 \"Textiles, Apparel & Footware\" 5 \"Consumer Durables\" 6 \"Chemicals\" 7 \"Drugs, Soap, Prfums, Tobacco\" 8 \"Construction and Construction Materials\" 9 \"Steel Works Etc\" 10 \"Fabricated Products\" 11 \"Machinery and Business Equipment\" 12 \"Automobiles\" 13 \"Transportation\" 14 \"Utilities\" 15 \"Retail Stores\" 16 \"Banks, Insurance Companies, and Other Financials\" 17 \"Other\"\n        label values `generate' `generate'\n\n        qui replace `generate'=1 if inrange(``ffind'',100,199) | inrange(``ffind'',200,299) | inrange(``ffind'',700,799) | inrange(``ffind'',900,999) | inrange(``ffind'',2000,2009) | inrange(``ffind'',2010,2019) | inrange(``ffind'',2020,2029) | inrange(``ffind'',2030,2039) | inrange(``ffind'',2040,2046) | inrange(``ffind'',2047,2047) | inrange(``ffind'',2048,2048) | inrange(``ffind'',2050,2059) | inrange(``ffind'',2060,2063) | inrange(``ffind'',2064,2068) | inrange(``ffind'',2070,2079) | inrange(``ffind'',2080,2080) | inrange(``ffind'',2082,2082) | inrange(``ffind'',2083,2083) | inrange(``ffind'',2084,2084) | inrange(``ffind'',2085,2085) | inrange(``ffind'',2086,2086) | inrange(``ffind'',2087,2087) | inrange(``ffind'',2090,2092) | inrange(``ffind'',2095,2095) | inrange(``ffind'',2096,2096) | inrange(``ffind'',2097,2097) | inrange(``ffind'',2098,2099) | inrange(``ffind'',5140,5149) | inrange(``ffind'',5150,5159) | inrange(``ffind'',5180,5182) | inrange(``ffind'',5191,5191)\n        qui replace `generate'=2 if inrange(``ffind'',1000,1009) | inrange(``ffind'',1010,1019) | inrange(``ffind'',1020,1029) | inrange(``ffind'',1030,1039) | inrange(``ffind'',1040,1049) | inrange(``ffind'',1060,1069) | inrange(``ffind'',1080,1089) | inrange(``ffind'',1090,1099) | inrange(``ffind'',1200,1299) | inrange(``ffind'',1400,1499) | inrange(``ffind'',5050,5052)\n        qui replace `generate'=3 if inrange(``ffind'',1300,1300) | inrange(``ffind'',1310,1319) | inrange(``ffind'',1320,1329) | inrange(``ffind'',1380,1380) | inrange(``ffind'',1381,1381) | inrange(``ffind'',1382,1382) | inrange(``ffind'',1389,1389) | inrange(``ffind'',2900,2912) | inrange(``ffind'',5170,5172)\n        qui replace `generate'=4 if inrange(``ffind'',2200,2269) | inrange(``ffind'',2270,2279) | inrange(``ffind'',2280,2284) | inrange(``ffind'',2290,2295) | inrange(``ffind'',2296,2296) | inrange(``ffind'',2297,2297) | inrange(``ffind'',2298,2298) | inrange(``ffind'',2299,2299) | inrange(``ffind'',2300,2390) | inrange(``ffind'',2391,2392) | inrange(``ffind'',2393,2395) | inrange(``ffind'',2396,2396) | inrange(``ffind'',2397,2399) | inrange(``ffind'',3020,3021) | inrange(``ffind'',3100,3111) | inrange(``ffind'',3130,3131) | inrange(``ffind'',3140,3149) | inrange(``ffind'',3150,3151) | inrange(``ffind'',3963,3965) | inrange(``ffind'',5130,5139)\n        qui replace `generate'=5 if inrange(``ffind'',2510,2519) | inrange(``ffind'',2590,2599) | inrange(``ffind'',3060,3069) | inrange(``ffind'',3070,3079) | inrange(``ffind'',3080,3089) | inrange(``ffind'',3090,3099) | inrange(``ffind'',3630,3639) | inrange(``ffind'',3650,3651) | inrange(``ffind'',3652,3652) | inrange(``ffind'',3860,3861) | inrange(``ffind'',3870,3873) | inrange(``ffind'',3910,3911) | inrange(``ffind'',3914,3914) | inrange(``ffind'',3915,3915) | inrange(``ffind'',3930,3931) | inrange(``ffind'',3940,3949) | inrange(``ffind'',3960,3962) | inrange(``ffind'',5020,5023) | inrange(``ffind'',5064,5064) | inrange(``ffind'',5094,5094) | inrange(``ffind'',5099,5099)\n        qui replace `generate'=6 if inrange(``ffind'',2800,2809) | inrange(``ffind'',2810,2819) | inrange(``ffind'',2820,2829) | inrange(``ffind'',2860,2869) | inrange(``ffind'',2870,2879) | inrange(``ffind'',2890,2899) | inrange(``ffind'',5160,5169)\n        qui replace `generate'=7 if inrange(``ffind'',2100,2199) | inrange(``ffind'',2830,2830) | inrange(``ffind'',2831,2831) | inrange(``ffind'',2833,2833) | inrange(``ffind'',2834,2834) | inrange(``ffind'',2840,2843) | inrange(``ffind'',2844,2844) | inrange(``ffind'',5120,5122) | inrange(``ffind'',5194,5194)\n        qui replace `generate'=8 if inrange(``ffind'',800,899) | inrange(``ffind'',1500,1511) | inrange(``ffind'',1520,1529) | inrange(``ffind'',1530,1539) | inrange(``ffind'',1540,1549) | inrange(``ffind'',1600,1699) | inrange(``ffind'',1700,1799) | inrange(``ffind'',2400,2439) | inrange(``ffind'',2440,2449) | inrange(``ffind'',2450,2459) | inrange(``ffind'',2490,2499) | inrange(``ffind'',2850,2859) | inrange(``ffind'',2950,2952) | inrange(``ffind'',3200,3200) | inrange(``ffind'',3210,3211) | inrange(``ffind'',3240,3241) | inrange(``ffind'',3250,3259) | inrange(``ffind'',3261,3261) | inrange(``ffind'',3264,3264) | inrange(``ffind'',3270,3275) | inrange(``ffind'',3280,3281) | inrange(``ffind'',3290,3293) | inrange(``ffind'',3420,3429) | inrange(``ffind'',3430,3433) | inrange(``ffind'',3440,3441) | inrange(``ffind'',3442,3442) | inrange(``ffind'',3446,3446) | inrange(``ffind'',3448,3448) | inrange(``ffind'',3449,3449) | inrange(``ffind'',3450,3451) | inrange(``ffind'',3452,3452) | inrange(``ffind'',5030,5039) | inrange(``ffind'',5070,5078) | inrange(``ffind'',5198,5198) | inrange(``ffind'',5210,5211) | inrange(``ffind'',5230,5231) | inrange(``ffind'',5250,5251)\n        qui replace `generate'=9 if inrange(``ffind'',3300,3300) | inrange(``ffind'',3310,3317) | inrange(``ffind'',3320,3325) | inrange(``ffind'',3330,3339) | inrange(``ffind'',3340,3341) | inrange(``ffind'',3350,3357) | inrange(``ffind'',3360,3369) | inrange(``ffind'',3390,3399)\n        qui replace `generate'=10 if inrange(``ffind'',3410,3412) | inrange(``ffind'',3443,3443) | inrange(``ffind'',3444,3444) | inrange(``ffind'',3460,3469) | inrange(``ffind'',3470,3479) | inrange(``ffind'',3480,3489) | inrange(``ffind'',3490,3499)\n        qui replace `generate'=11 if inrange(``ffind'',3510,3519) | inrange(``ffind'',3520,3529) | inrange(``ffind'',3530,3530) | inrange(``ffind'',3531,3531) | inrange(``ffind'',3532,3532) | inrange(``ffind'',3533,3533) | inrange(``ffind'',3534,3534) | inrange(``ffind'',3535,3535) | inrange(``ffind'',3536,3536) | inrange(``ffind'',3540,3549) | inrange(``ffind'',3550,3559) | inrange(``ffind'',3560,3569) | inrange(``ffind'',3570,3579) | inrange(``ffind'',3580,3580) | inrange(``ffind'',3581,3581) | inrange(``ffind'',3582,3582) | inrange(``ffind'',3585,3585) | inrange(``ffind'',3586,3586) | inrange(``ffind'',3589,3589) | inrange(``ffind'',3590,3599) | inrange(``ffind'',3600,3600) | inrange(``ffind'',3610,3613) | inrange(``ffind'',3620,3621) | inrange(``ffind'',3622,3622) | inrange(``ffind'',3623,3629) | inrange(``ffind'',3670,3679) | inrange(``ffind'',3680,3680) | inrange(``ffind'',3681,3681) | inrange(``ffind'',3682,3682) | inrange(``ffind'',3683,3683) | inrange(``ffind'',3684,3684) | inrange(``ffind'',3685,3685) | inrange(``ffind'',3686,3686) | inrange(``ffind'',3687,3687) | inrange(``ffind'',3688,3688) | inrange(``ffind'',3689,3689) | inrange(``ffind'',3690,3690) | inrange(``ffind'',3691,3692) | inrange(``ffind'',3693,3693) | inrange(``ffind'',3694,3694) | inrange(``ffind'',3695,3695) | inrange(``ffind'',3699,3699) | inrange(``ffind'',3810,3810) | inrange(``ffind'',3811,3811) | inrange(``ffind'',3812,3812) | inrange(``ffind'',3820,3820) | inrange(``ffind'',3821,3821) | inrange(``ffind'',3822,3822) | inrange(``ffind'',3823,3823) | inrange(``ffind'',3824,3824) | inrange(``ffind'',3825,3825) | inrange(``ffind'',3826,3826) | inrange(``ffind'',3827,3827) | inrange(``ffind'',3829,3829) | inrange(``ffind'',3830,3839) | inrange(``ffind'',3950,3955) | inrange(``ffind'',5060,5060) | inrange(``ffind'',5063,5063) | inrange(``ffind'',5065,5065) | inrange(``ffind'',5080,5080) | inrange(``ffind'',5081,5081)\n        qui replace `generate'=12 if inrange(``ffind'',3710,3710) | inrange(``ffind'',3711,3711) | inrange(``ffind'',3714,3714) | inrange(``ffind'',3716,3716) | inrange(``ffind'',3750,3751) | inrange(``ffind'',3792,3792) | inrange(``ffind'',5010,5015) | inrange(``ffind'',5510,5521) | inrange(``ffind'',5530,5531) | inrange(``ffind'',5560,5561) | inrange(``ffind'',5570,5571) | inrange(``ffind'',5590,5599)\n        qui replace `generate'=13 if inrange(``ffind'',3713,3713) | inrange(``ffind'',3715,3715) | inrange(``ffind'',3720,3720) | inrange(``ffind'',3721,3721) | inrange(``ffind'',3724,3724) | inrange(``ffind'',3725,3725) | inrange(``ffind'',3728,3728) | inrange(``ffind'',3730,3731) | inrange(``ffind'',3732,3732) | inrange(``ffind'',3740,3743) | inrange(``ffind'',3760,3769) | inrange(``ffind'',3790,3790) | inrange(``ffind'',3795,3795) | inrange(``ffind'',3799,3799) | inrange(``ffind'',4000,4013) | inrange(``ffind'',4100,4100) | inrange(``ffind'',4110,4119) | inrange(``ffind'',4120,4121) | inrange(``ffind'',4130,4131) | inrange(``ffind'',4140,4142) | inrange(``ffind'',4150,4151) | inrange(``ffind'',4170,4173) | inrange(``ffind'',4190,4199) | inrange(``ffind'',4200,4200) | inrange(``ffind'',4210,4219) | inrange(``ffind'',4220,4229) | inrange(``ffind'',4230,4231) | inrange(``ffind'',4400,4499) | inrange(``ffind'',4500,4599) | inrange(``ffind'',4600,4699) | inrange(``ffind'',4700,4700) | inrange(``ffind'',4710,4712) | inrange(``ffind'',4720,4729) | inrange(``ffind'',4730,4739) | inrange(``ffind'',4740,4742) | inrange(``ffind'',4780,4780) | inrange(``ffind'',4783,4783) | inrange(``ffind'',4785,4785) | inrange(``ffind'',4789,4789)\n        qui replace `generate'=14 if inrange(``ffind'',4900,4900) | inrange(``ffind'',4910,4911) | inrange(``ffind'',4920,4922) | inrange(``ffind'',4923,4923) | inrange(``ffind'',4924,4925) | inrange(``ffind'',4930,4931) | inrange(``ffind'',4932,4932) | inrange(``ffind'',4939,4939) | inrange(``ffind'',4940,4942)\n        qui replace `generate'=15 if inrange(``ffind'',5260,5261) | inrange(``ffind'',5270,5271) | inrange(``ffind'',5300,5300) | inrange(``ffind'',5310,5311) | inrange(``ffind'',5320,5320) | inrange(``ffind'',5330,5331) | inrange(``ffind'',5334,5334) | inrange(``ffind'',5390,5399) | inrange(``ffind'',5400,5400) | inrange(``ffind'',5410,5411) | inrange(``ffind'',5412,5412) | inrange(``ffind'',5420,5421) | inrange(``ffind'',5430,5431) | inrange(``ffind'',5440,5441) | inrange(``ffind'',5450,5451) | inrange(``ffind'',5460,5461) | inrange(``ffind'',5490,5499) | inrange(``ffind'',5540,5541) | inrange(``ffind'',5550,5551) | inrange(``ffind'',5600,5699) | inrange(``ffind'',5700,5700) | inrange(``ffind'',5710,5719) | inrange(``ffind'',5720,5722) | inrange(``ffind'',5730,5733) | inrange(``ffind'',5734,5734) | inrange(``ffind'',5735,5735) | inrange(``ffind'',5736,5736) | inrange(``ffind'',5750,5750) | inrange(``ffind'',5800,5813) | inrange(``ffind'',5890,5890) | inrange(``ffind'',5900,5900) | inrange(``ffind'',5910,5912) | inrange(``ffind'',5920,5921) | inrange(``ffind'',5930,5932) | inrange(``ffind'',5940,5940) | inrange(``ffind'',5941,5941) | inrange(``ffind'',5942,5942) | inrange(``ffind'',5943,5943) | inrange(``ffind'',5944,5944) | inrange(``ffind'',5945,5945) | inrange(``ffind'',5946,5946) | inrange(``ffind'',5947,5947) | inrange(``ffind'',5948,5948) | inrange(``ffind'',5949,5949) | inrange(``ffind'',5960,5963) | inrange(``ffind'',5980,5989) | inrange(``ffind'',5990,5990) | inrange(``ffind'',5992,5992) | inrange(``ffind'',5993,5993) | inrange(``ffind'',5994,5994) | inrange(``ffind'',5995,5995) | inrange(``ffind'',5999,5999)\n        qui replace `generate'=16 if inrange(``ffind'',6010,6019) | inrange(``ffind'',6020,6020) | inrange(``ffind'',6021,6021) | inrange(``ffind'',6022,6022) | inrange(``ffind'',6023,6023) | inrange(``ffind'',6025,6025) | inrange(``ffind'',6026,6026) | inrange(``ffind'',6028,6029) | inrange(``ffind'',6030,6036) | inrange(``ffind'',6040,6049) | inrange(``ffind'',6050,6059) | inrange(``ffind'',6060,6062) | inrange(``ffind'',6080,6082) | inrange(``ffind'',6090,6099) | inrange(``ffind'',6100,6100) | inrange(``ffind'',6110,6111) | inrange(``ffind'',6112,6112) | inrange(``ffind'',6120,6129) | inrange(``ffind'',6140,6149) | inrange(``ffind'',6150,6159) | inrange(``ffind'',6160,6163) | inrange(``ffind'',6172,6172) | inrange(``ffind'',6199,6199) | inrange(``ffind'',6200,6299) | inrange(``ffind'',6300,6300) | inrange(``ffind'',6310,6312) | inrange(``ffind'',6320,6324) | inrange(``ffind'',6330,6331) | inrange(``ffind'',6350,6351) | inrange(``ffind'',6360,6361) | inrange(``ffind'',6370,6371) | inrange(``ffind'',6390,6399) | inrange(``ffind'',6400,6411) | inrange(``ffind'',6500,6500) | inrange(``ffind'',6510,6510) | inrange(``ffind'',6512,6512) | inrange(``ffind'',6513,6513) | inrange(``ffind'',6514,6514) | inrange(``ffind'',6515,6515) | inrange(``ffind'',6517,6519) | inrange(``ffind'',6530,6531) | inrange(``ffind'',6532,6532) | inrange(``ffind'',6540,6541) | inrange(``ffind'',6550,6553) | inrange(``ffind'',6611,6611) | inrange(``ffind'',6700,6700) | inrange(``ffind'',6710,6719) | inrange(``ffind'',6720,6722) | inrange(``ffind'',6723,6723) | inrange(``ffind'',6724,6724) | inrange(``ffind'',6725,6725) | inrange(``ffind'',6726,6726) | inrange(``ffind'',6730,6733) | inrange(``ffind'',6790,6790) | inrange(``ffind'',6792,6792) | inrange(``ffind'',6794,6794) | inrange(``ffind'',6795,6795) | inrange(``ffind'',6798,6798) | inrange(``ffind'',6799,6799)\n        qui replace `generate'=17 if missing(`generate') & ~missing(``ffind'')\n\n        }\n\n    else if ``ftyp''==30 {\n        label define `generate' 1 \"Food Products\" 2 \"Beer & Liquor\" 3 \"Tobacco Products\" 4 \"Recreation\" 5 \"Printing and Publishing\" 6 \"Consumer Goods\" 7 \"Apparel\" 8 \"Healthcare, Medical Equipment, Pharmaceutical Products\" 9 \"Chemicals\" 10 \"Textiles\" 11 \"Construction and Construction Materials\" 12 \"Steel Works Etc\" 13 \"Fabricated Products and Machinery\" 14 \"Electrical Equipment\" 15 \"Automobiles and Trucks\" 16 \"Aircraft, ships, and railroad equipment\" 17 \"Precious Metals, Non-Metallic, and Industrial Metal Mining\" 18 \"Coal\" 19 \"Petroleum and Natural Gas\" 20 \"Utilities\" 21 \"Communication\" 22 \"Personal and Business Services\" 23 \"Business Equipment\" 24 \"Business Supplies and Shipping Containers\" 25 \"Transportation\" 26 \"Wholesale\" 27 \"Retail\" 28 \"Restaraunts, Hotels, Motels\" 29 \"Banking, Insurance, Real Estate, Trading\" 30 \"Everything Else\"\n        label values `generate' `generate'\n\n        qui replace `generate'=1 if inrange(``ffind'',100,199) | inrange(``ffind'',200,299) | inrange(``ffind'',700,799) | inrange(``ffind'',910,919) | inrange(``ffind'',2000,2009) | inrange(``ffind'',2010,2019) | inrange(``ffind'',2020,2029) | inrange(``ffind'',2030,2039) | inrange(``ffind'',2040,2046) | inrange(``ffind'',2048,2048) | inrange(``ffind'',2050,2059) | inrange(``ffind'',2060,2063) | inrange(``ffind'',2064,2068) | inrange(``ffind'',2070,2079) | inrange(``ffind'',2086,2086) | inrange(``ffind'',2087,2087) | inrange(``ffind'',2090,2092) | inrange(``ffind'',2095,2095) | inrange(``ffind'',2096,2096) | inrange(``ffind'',2097,2097) | inrange(``ffind'',2098,2099)\n        qui replace `generate'=2 if inrange(``ffind'',2080,2080) | inrange(``ffind'',2082,2082) | inrange(``ffind'',2083,2083) | inrange(``ffind'',2084,2084) | inrange(``ffind'',2085,2085)\n        qui replace `generate'=3 if inrange(``ffind'',2100,2199)\n        qui replace `generate'=4 if inrange(``ffind'',920,999) | inrange(``ffind'',3650,3651) | inrange(``ffind'',3652,3652) | inrange(``ffind'',3732,3732) | inrange(``ffind'',3930,3931) | inrange(``ffind'',3940,3949) | inrange(``ffind'',7800,7829) | inrange(``ffind'',7830,7833) | inrange(``ffind'',7840,7841) | inrange(``ffind'',7900,7900) | inrange(``ffind'',7910,7911) | inrange(``ffind'',7920,7929) | inrange(``ffind'',7930,7933) | inrange(``ffind'',7940,7949) | inrange(``ffind'',7980,7980) | inrange(``ffind'',7990,7999)\n        qui replace `generate'=5 if inrange(``ffind'',2700,2709) | inrange(``ffind'',2710,2719) | inrange(``ffind'',2720,2729) | inrange(``ffind'',2730,2739) | inrange(``ffind'',2740,2749) | inrange(``ffind'',2750,2759) | inrange(``ffind'',2770,2771) | inrange(``ffind'',2780,2789) | inrange(``ffind'',2790,2799) | inrange(``ffind'',3993,3993)\n        qui replace `generate'=6 if inrange(``ffind'',2047,2047) | inrange(``ffind'',2391,2392) | inrange(``ffind'',2510,2519) | inrange(``ffind'',2590,2599) | inrange(``ffind'',2840,2843) | inrange(``ffind'',2844,2844) | inrange(``ffind'',3160,3161) | inrange(``ffind'',3170,3171) | inrange(``ffind'',3172,3172) | inrange(``ffind'',3190,3199) | inrange(``ffind'',3229,3229) | inrange(``ffind'',3260,3260) | inrange(``ffind'',3262,3263) | inrange(``ffind'',3269,3269) | inrange(``ffind'',3230,3231) | inrange(``ffind'',3630,3639) | inrange(``ffind'',3750,3751) | inrange(``ffind'',3800,3800) | inrange(``ffind'',3860,3861) | inrange(``ffind'',3870,3873) | inrange(``ffind'',3910,3911) | inrange(``ffind'',3914,3914) | inrange(``ffind'',3915,3915) | inrange(``ffind'',3960,3962) | inrange(``ffind'',3991,3991) | inrange(``ffind'',3995,3995)\n        qui replace `generate'=7 if inrange(``ffind'',2300,2390) | inrange(``ffind'',3020,3021) | inrange(``ffind'',3100,3111) | inrange(``ffind'',3130,3131) | inrange(``ffind'',3140,3149) | inrange(``ffind'',3150,3151) | inrange(``ffind'',3963,3965)\n        qui replace `generate'=8 if inrange(``ffind'',2830,2830) | inrange(``ffind'',2831,2831) | inrange(``ffind'',2833,2833) | inrange(``ffind'',2834,2834) | inrange(``ffind'',2835,2835) | inrange(``ffind'',2836,2836) | inrange(``ffind'',3693,3693) | inrange(``ffind'',3840,3849) | inrange(``ffind'',3850,3851) | inrange(``ffind'',8000,8099)\n        qui replace `generate'=9 if inrange(``ffind'',2800,2809) | inrange(``ffind'',2810,2819) | inrange(``ffind'',2820,2829) | inrange(``ffind'',2850,2859) | inrange(``ffind'',2860,2869) | inrange(``ffind'',2870,2879) | inrange(``ffind'',2890,2899)\n        qui replace `generate'=10 if inrange(``ffind'',2200,2269) | inrange(``ffind'',2270,2279) | inrange(``ffind'',2280,2284) | inrange(``ffind'',2290,2295) | inrange(``ffind'',2297,2297) | inrange(``ffind'',2298,2298) | inrange(``ffind'',2299,2299) | inrange(``ffind'',2393,2395) | inrange(``ffind'',2397,2399)\n        qui replace `generate'=11 if inrange(``ffind'',800,899) | inrange(``ffind'',1500,1511) | inrange(``ffind'',1520,1529) | inrange(``ffind'',1530,1539) | inrange(``ffind'',1540,1549) | inrange(``ffind'',1600,1699) | inrange(``ffind'',1700,1799) | inrange(``ffind'',2400,2439) | inrange(``ffind'',2450,2459) | inrange(``ffind'',2490,2499) | inrange(``ffind'',2660,2661) | inrange(``ffind'',2950,2952) | inrange(``ffind'',3200,3200) | inrange(``ffind'',3210,3211) | inrange(``ffind'',3240,3241) | inrange(``ffind'',3250,3259) | inrange(``ffind'',3261,3261) | inrange(``ffind'',3264,3264) | inrange(``ffind'',3270,3275) | inrange(``ffind'',3280,3281) | inrange(``ffind'',3290,3293) | inrange(``ffind'',3295,3299) | inrange(``ffind'',3420,3429) | inrange(``ffind'',3430,3433) | inrange(``ffind'',3440,3441) | inrange(``ffind'',3442,3442) | inrange(``ffind'',3446,3446) | inrange(``ffind'',3448,3448) | inrange(``ffind'',3449,3449) | inrange(``ffind'',3450,3451) | inrange(``ffind'',3452,3452) | inrange(``ffind'',3490,3499) | inrange(``ffind'',3996,3996)\n        qui replace `generate'=12 if inrange(``ffind'',3300,3300) | inrange(``ffind'',3310,3317) | inrange(``ffind'',3320,3325) | inrange(``ffind'',3330,3339) | inrange(``ffind'',3340,3341) | inrange(``ffind'',3350,3357) | inrange(``ffind'',3360,3369) | inrange(``ffind'',3370,3379) | inrange(``ffind'',3390,3399)\n        qui replace `generate'=13 if inrange(``ffind'',3400,3400) | inrange(``ffind'',3443,3443) | inrange(``ffind'',3444,3444) | inrange(``ffind'',3460,3469) | inrange(``ffind'',3470,3479) | inrange(``ffind'',3510,3519) | inrange(``ffind'',3520,3529) | inrange(``ffind'',3530,3530) | inrange(``ffind'',3531,3531) | inrange(``ffind'',3532,3532) | inrange(``ffind'',3533,3533) | inrange(``ffind'',3534,3534) | inrange(``ffind'',3535,3535) | inrange(``ffind'',3536,3536) | inrange(``ffind'',3538,3538) | inrange(``ffind'',3540,3549) | inrange(``ffind'',3550,3559) | inrange(``ffind'',3560,3569) | inrange(``ffind'',3580,3580) | inrange(``ffind'',3581,3581) | inrange(``ffind'',3582,3582) | inrange(``ffind'',3585,3585) | inrange(``ffind'',3586,3586) | inrange(``ffind'',3589,3589) | inrange(``ffind'',3590,3599)\n        qui replace `generate'=14 if inrange(``ffind'',3600,3600) | inrange(``ffind'',3610,3613) | inrange(``ffind'',3620,3621) | inrange(``ffind'',3623,3629) | inrange(``ffind'',3640,3644) | inrange(``ffind'',3645,3645) | inrange(``ffind'',3646,3646) | inrange(``ffind'',3648,3649) | inrange(``ffind'',3660,3660) | inrange(``ffind'',3690,3690) | inrange(``ffind'',3691,3692) | inrange(``ffind'',3699,3699)\n        qui replace `generate'=15 if inrange(``ffind'',2296,2296) | inrange(``ffind'',2396,2396) | inrange(``ffind'',3010,3011) | inrange(``ffind'',3537,3537) | inrange(``ffind'',3647,3647) | inrange(``ffind'',3694,3694) | inrange(``ffind'',3700,3700) | inrange(``ffind'',3710,3710) | inrange(``ffind'',3711,3711) | inrange(``ffind'',3713,3713) | inrange(``ffind'',3714,3714) | inrange(``ffind'',3715,3715) | inrange(``ffind'',3716,3716) | inrange(``ffind'',3792,3792) | inrange(``ffind'',3790,3791) | inrange(``ffind'',3799,3799)\n        qui replace `generate'=16 if inrange(``ffind'',3720,3720) | inrange(``ffind'',3721,3721) | inrange(``ffind'',3723,3724) | inrange(``ffind'',3725,3725) | inrange(``ffind'',3728,3729) | inrange(``ffind'',3730,3731) | inrange(``ffind'',3740,3743)\n        qui replace `generate'=17 if inrange(``ffind'',1000,1009) | inrange(``ffind'',1010,1019) | inrange(``ffind'',1020,1029) | inrange(``ffind'',1030,1039) | inrange(``ffind'',1040,1049) | inrange(``ffind'',1050,1059) | inrange(``ffind'',1060,1069) | inrange(``ffind'',1070,1079) | inrange(``ffind'',1080,1089) | inrange(``ffind'',1090,1099) | inrange(``ffind'',1100,1119) | inrange(``ffind'',1400,1499)\n        qui replace `generate'=18 if inrange(``ffind'',1200,1299)\n        qui replace `generate'=19 if inrange(``ffind'',1300,1300) | inrange(``ffind'',1310,1319) | inrange(``ffind'',1320,1329) | inrange(``ffind'',1330,1339) | inrange(``ffind'',1370,1379) | inrange(``ffind'',1380,1380) | inrange(``ffind'',1381,1381) | inrange(``ffind'',1382,1382) | inrange(``ffind'',1389,1389) | inrange(``ffind'',2900,2912) | inrange(``ffind'',2990,2999)\n        qui replace `generate'=20 if inrange(``ffind'',4900,4900) | inrange(``ffind'',4910,4911) | inrange(``ffind'',4920,4922) | inrange(``ffind'',4923,4923) | inrange(``ffind'',4924,4925) | inrange(``ffind'',4930,4931) | inrange(``ffind'',4932,4932) | inrange(``ffind'',4939,4939) | inrange(``ffind'',4940,4942)\n        qui replace `generate'=21 if inrange(``ffind'',4800,4800) | inrange(``ffind'',4810,4813) | inrange(``ffind'',4820,4822) | inrange(``ffind'',4830,4839) | inrange(``ffind'',4840,4841) | inrange(``ffind'',4880,4889) | inrange(``ffind'',4890,4890) | inrange(``ffind'',4891,4891) | inrange(``ffind'',4892,4892) | inrange(``ffind'',4899,4899)\n        qui replace `generate'=22 if inrange(``ffind'',7020,7021) | inrange(``ffind'',7030,7033) | inrange(``ffind'',7200,7200) | inrange(``ffind'',7210,7212) | inrange(``ffind'',7214,7214) | inrange(``ffind'',7215,7216) | inrange(``ffind'',7217,7217) | inrange(``ffind'',7218,7218) | inrange(``ffind'',7219,7219) | inrange(``ffind'',7220,7221) | inrange(``ffind'',7230,7231) | inrange(``ffind'',7240,7241) | inrange(``ffind'',7250,7251) | inrange(``ffind'',7260,7269) | inrange(``ffind'',7270,7290) | inrange(``ffind'',7291,7291) | inrange(``ffind'',7292,7299) | inrange(``ffind'',7300,7300) | inrange(``ffind'',7310,7319) | inrange(``ffind'',7320,7329) | inrange(``ffind'',7330,7339) | inrange(``ffind'',7340,7342) | inrange(``ffind'',7349,7349) | inrange(``ffind'',7350,7351) | inrange(``ffind'',7352,7352) | inrange(``ffind'',7353,7353) | inrange(``ffind'',7359,7359) | inrange(``ffind'',7360,7369) | inrange(``ffind'',7370,7372) | inrange(``ffind'',7374,7374) | inrange(``ffind'',7375,7375) | inrange(``ffind'',7376,7376) | inrange(``ffind'',7377,7377) | inrange(``ffind'',7378,7378) | inrange(``ffind'',7379,7379) | inrange(``ffind'',7380,7380) | inrange(``ffind'',7381,7382) | inrange(``ffind'',7383,7383) | inrange(``ffind'',7384,7384) | inrange(``ffind'',7385,7385) | inrange(``ffind'',7389,7390) | inrange(``ffind'',7391,7391) | inrange(``ffind'',7392,7392) | inrange(``ffind'',7393,7393) | inrange(``ffind'',7394,7394) | inrange(``ffind'',7395,7395) | inrange(``ffind'',7396,7396) | inrange(``ffind'',7397,7397) | inrange(``ffind'',7399,7399) | inrange(``ffind'',7500,7500) | inrange(``ffind'',7510,7519) | inrange(``ffind'',7520,7529) | inrange(``ffind'',7530,7539) | inrange(``ffind'',7540,7549) | inrange(``ffind'',7600,7600) | inrange(``ffind'',7620,7620) | inrange(``ffind'',7622,7622) | inrange(``ffind'',7623,7623) | inrange(``ffind'',7629,7629) | inrange(``ffind'',7630,7631) | inrange(``ffind'',7640,7641) | inrange(``ffind'',7690,7699) | inrange(``ffind'',8100,8199) | inrange(``ffind'',8200,8299) | inrange(``ffind'',8300,8399) | inrange(``ffind'',8400,8499) | inrange(``ffind'',8600,8699) | inrange(``ffind'',8700,8700) | inrange(``ffind'',8710,8713) | inrange(``ffind'',8720,8721) | inrange(``ffind'',8730,8734) | inrange(``ffind'',8740,8748) | inrange(``ffind'',8800,8899) | inrange(``ffind'',8900,8910) | inrange(``ffind'',8911,8911) | inrange(``ffind'',8920,8999)\n        qui replace `generate'=23 if inrange(``ffind'',3570,3579) | inrange(``ffind'',3622,3622) | inrange(``ffind'',3661,3661) | inrange(``ffind'',3662,3662) | inrange(``ffind'',3663,3663) | inrange(``ffind'',3664,3664) | inrange(``ffind'',3665,3665) | inrange(``ffind'',3666,3666) | inrange(``ffind'',3669,3669) | inrange(``ffind'',3670,3679) | inrange(``ffind'',3680,3680) | inrange(``ffind'',3681,3681) | inrange(``ffind'',3682,3682) | inrange(``ffind'',3683,3683) | inrange(``ffind'',3684,3684) | inrange(``ffind'',3685,3685) | inrange(``ffind'',3686,3686) | inrange(``ffind'',3687,3687) | inrange(``ffind'',3688,3688) | inrange(``ffind'',3689,3689) | inrange(``ffind'',3695,3695) | inrange(``ffind'',3810,3810) | inrange(``ffind'',3811,3811) | inrange(``ffind'',3812,3812) | inrange(``ffind'',3820,3820) | inrange(``ffind'',3821,3821) | inrange(``ffind'',3822,3822) | inrange(``ffind'',3823,3823) | inrange(``ffind'',3824,3824) | inrange(``ffind'',3825,3825) | inrange(``ffind'',3826,3826) | inrange(``ffind'',3827,3827) | inrange(``ffind'',3829,3829) | inrange(``ffind'',3830,3839) | inrange(``ffind'',7373,7373)\n        qui replace `generate'=24 if inrange(``ffind'',2440,2449) | inrange(``ffind'',2520,2549) | inrange(``ffind'',2600,2639) | inrange(``ffind'',2640,2659) | inrange(``ffind'',2670,2699) | inrange(``ffind'',2760,2761) | inrange(``ffind'',3220,3221) | inrange(``ffind'',3410,3412) | inrange(``ffind'',3950,3955)\n        qui replace `generate'=25 if inrange(``ffind'',4000,4013) | inrange(``ffind'',4040,4049) | inrange(``ffind'',4100,4100) | inrange(``ffind'',4110,4119) | inrange(``ffind'',4120,4121) | inrange(``ffind'',4130,4131) | inrange(``ffind'',4140,4142) | inrange(``ffind'',4150,4151) | inrange(``ffind'',4170,4173) | inrange(``ffind'',4190,4199) | inrange(``ffind'',4200,4200) | inrange(``ffind'',4210,4219) | inrange(``ffind'',4220,4229) | inrange(``ffind'',4230,4231) | inrange(``ffind'',4240,4249) | inrange(``ffind'',4400,4499) | inrange(``ffind'',4500,4599) | inrange(``ffind'',4600,4699) | inrange(``ffind'',4700,4700) | inrange(``ffind'',4710,4712) | inrange(``ffind'',4720,4729) | inrange(``ffind'',4730,4739) | inrange(``ffind'',4740,4749) | inrange(``ffind'',4780,4780) | inrange(``ffind'',4782,4782) | inrange(``ffind'',4783,4783) | inrange(``ffind'',4784,4784) | inrange(``ffind'',4785,4785) | inrange(``ffind'',4789,4789)\n        qui replace `generate'=26 if inrange(``ffind'',5000,5000) | inrange(``ffind'',5010,5015) | inrange(``ffind'',5020,5023) | inrange(``ffind'',5030,5039) | inrange(``ffind'',5040,5042) | inrange(``ffind'',5043,5043) | inrange(``ffind'',5044,5044) | inrange(``ffind'',5045,5045) | inrange(``ffind'',5046,5046) | inrange(``ffind'',5047,5047) | inrange(``ffind'',5048,5048) | inrange(``ffind'',5049,5049) | inrange(``ffind'',5050,5059) | inrange(``ffind'',5060,5060) | inrange(``ffind'',5063,5063) | inrange(``ffind'',5064,5064) | inrange(``ffind'',5065,5065) | inrange(``ffind'',5070,5078) | inrange(``ffind'',5080,5080) | inrange(``ffind'',5081,5081) | inrange(``ffind'',5082,5082) | inrange(``ffind'',5083,5083) | inrange(``ffind'',5084,5084) | inrange(``ffind'',5085,5085) | inrange(``ffind'',5086,5087) | inrange(``ffind'',5088,5088) | inrange(``ffind'',5090,5090) | inrange(``ffind'',5091,5092) | inrange(``ffind'',5093,5093) | inrange(``ffind'',5094,5094) | inrange(``ffind'',5099,5099) | inrange(``ffind'',5100,5100) | inrange(``ffind'',5110,5113) | inrange(``ffind'',5120,5122) | inrange(``ffind'',5130,5139) | inrange(``ffind'',5140,5149) | inrange(``ffind'',5150,5159) | inrange(``ffind'',5160,5169) | inrange(``ffind'',5170,5172) | inrange(``ffind'',5180,5182) | inrange(``ffind'',5190,5199)\n        qui replace `generate'=27 if inrange(``ffind'',5200,5200) | inrange(``ffind'',5210,5219) | inrange(``ffind'',5220,5229) | inrange(``ffind'',5230,5231) | inrange(``ffind'',5250,5251) | inrange(``ffind'',5260,5261) | inrange(``ffind'',5270,5271) | inrange(``ffind'',5300,5300) | inrange(``ffind'',5310,5311) | inrange(``ffind'',5320,5320) | inrange(``ffind'',5330,5331) | inrange(``ffind'',5334,5334) | inrange(``ffind'',5340,5349) | inrange(``ffind'',5390,5399) | inrange(``ffind'',5400,5400) | inrange(``ffind'',5410,5411) | inrange(``ffind'',5412,5412) | inrange(``ffind'',5420,5429) | inrange(``ffind'',5430,5439) | inrange(``ffind'',5440,5449) | inrange(``ffind'',5450,5459) | inrange(``ffind'',5460,5469) | inrange(``ffind'',5490,5499) | inrange(``ffind'',5500,5500) | inrange(``ffind'',5510,5529) | inrange(``ffind'',5530,5539) | inrange(``ffind'',5540,5549) | inrange(``ffind'',5550,5559) | inrange(``ffind'',5560,5569) | inrange(``ffind'',5570,5579) | inrange(``ffind'',5590,5599) | inrange(``ffind'',5600,5699) | inrange(``ffind'',5700,5700) | inrange(``ffind'',5710,5719) | inrange(``ffind'',5720,5722) | inrange(``ffind'',5730,5733) | inrange(``ffind'',5734,5734) | inrange(``ffind'',5735,5735) | inrange(``ffind'',5736,5736) | inrange(``ffind'',5750,5799) | inrange(``ffind'',5900,5900) | inrange(``ffind'',5910,5912) | inrange(``ffind'',5920,5929) | inrange(``ffind'',5930,5932) | inrange(``ffind'',5940,5940) | inrange(``ffind'',5941,5941) | inrange(``ffind'',5942,5942) | inrange(``ffind'',5943,5943) | inrange(``ffind'',5944,5944) | inrange(``ffind'',5945,5945) | inrange(``ffind'',5946,5946) | inrange(``ffind'',5947,5947) | inrange(``ffind'',5948,5948) | inrange(``ffind'',5949,5949) | inrange(``ffind'',5950,5959) | inrange(``ffind'',5960,5969) | inrange(``ffind'',5970,5979) | inrange(``ffind'',5980,5989) | inrange(``ffind'',5990,5990) | inrange(``ffind'',5992,5992) | inrange(``ffind'',5993,5993) | inrange(``ffind'',5994,5994) | inrange(``ffind'',5995,5995) | inrange(``ffind'',5999,5999)\n        qui replace `generate'=28 if inrange(``ffind'',5800,5819) | inrange(``ffind'',5820,5829) | inrange(``ffind'',5890,5899) | inrange(``ffind'',7000,7000) | inrange(``ffind'',7010,7019) | inrange(``ffind'',7040,7049) | inrange(``ffind'',7213,7213)\n        qui replace `generate'=29 if inrange(``ffind'',6000,6000) | inrange(``ffind'',6010,6019) | inrange(``ffind'',6020,6020) | inrange(``ffind'',6021,6021) | inrange(``ffind'',6022,6022) | inrange(``ffind'',6023,6024) | inrange(``ffind'',6025,6025) | inrange(``ffind'',6026,6026) | inrange(``ffind'',6027,6027) | inrange(``ffind'',6028,6029) | inrange(``ffind'',6030,6036) | inrange(``ffind'',6040,6059) | inrange(``ffind'',6060,6062) | inrange(``ffind'',6080,6082) | inrange(``ffind'',6090,6099) | inrange(``ffind'',6100,6100) | inrange(``ffind'',6110,6111) | inrange(``ffind'',6112,6113) | inrange(``ffind'',6120,6129) | inrange(``ffind'',6130,6139) | inrange(``ffind'',6140,6149) | inrange(``ffind'',6150,6159) | inrange(``ffind'',6160,6169) | inrange(``ffind'',6170,6179) | inrange(``ffind'',6190,6199) | inrange(``ffind'',6200,6299) | inrange(``ffind'',6300,6300) | inrange(``ffind'',6310,6319) | inrange(``ffind'',6320,6329) | inrange(``ffind'',6330,6331) | inrange(``ffind'',6350,6351) | inrange(``ffind'',6360,6361) | inrange(``ffind'',6370,6379) | inrange(``ffind'',6390,6399) | inrange(``ffind'',6400,6411) | inrange(``ffind'',6500,6500) | inrange(``ffind'',6510,6510) | inrange(``ffind'',6512,6512) | inrange(``ffind'',6513,6513) | inrange(``ffind'',6514,6514) | inrange(``ffind'',6515,6515) | inrange(``ffind'',6517,6519) | inrange(``ffind'',6520,6529) | inrange(``ffind'',6530,6531) | inrange(``ffind'',6532,6532) | inrange(``ffind'',6540,6541) | inrange(``ffind'',6550,6553) | inrange(``ffind'',6590,6599) | inrange(``ffind'',6610,6611) | inrange(``ffind'',6700,6700) | inrange(``ffind'',6710,6719) | inrange(``ffind'',6720,6722) | inrange(``ffind'',6723,6723) | inrange(``ffind'',6724,6724) | inrange(``ffind'',6725,6725) | inrange(``ffind'',6726,6726) | inrange(``ffind'',6730,6733) | inrange(``ffind'',6740,6779) | inrange(``ffind'',6790,6791) | inrange(``ffind'',6792,6792) | inrange(``ffind'',6793,6793) | inrange(``ffind'',6794,6794) | inrange(``ffind'',6795,6795) | inrange(``ffind'',6798,6798) | inrange(``ffind'',6799,6799)\n        qui replace `generate'=30 if missing(`generate') & ~missing(``ffind'')\n        }\n\n    else if ``ftyp''==38 {\n        label define `generate' 1 \"Agriculture, forestry, and fishing\" 2 \"Mining\" 3 \"Oil and Gas Extraction\" 4 \"Nonmetalic Minerals Except Fuels\" 5 \"Construction\" 6 \"Food and Kindred Products\" 7 \"Tobacco Products\" 8 \"Textile Mill Products\" 9 \"Apparel and other Textile Products\" 10 \"Lumber and Wood Products\" 11 \"Furniture and Fixtures\" 12 \"Paper and Allied Products\" 13 \"Printing and Publishing\" 14 \"Chemicals and Allied Products\" 15 \"Petroleum and Coal Products\" 16 \"Rubber and Miscellaneous Plastics Products\" 17 \"Leather and Leather Products\" 18 \"Stone, Clay and Glass Products\" 19 \"Primary Metal Industries\" 20 \"Fabricated Metal Products\" 21 \"Machinery, Except Electrical\" 22 \"Electrical and Electronic Equipment\" 23 \"Transportation Equipment\" 24 \"Instruments and Related Products\" 25 \"Miscellaneous Manufacturing Industries\" 26 \"Transportation\" 27 \"Telephone and Telegraph Communication\" 28 \"Radio and Television Broadcasting\" 29 \"Electric, Gas, and Water Supply\" 30 \"Sanitary Services\" 31 \"Steam Supply\" 32 \"Irrigation Systems\" 33 \"Wholesale\" 34 \"Retail Stores\" 35 \"Finance, Insurance, and Real Estate\" 36 \"Services\" 37 \"Public Administration\" 38 \"Almost Nothing\"\n        label values `generate' `generate'\n\n        qui replace `generate'=1 if inrange(``ffind'',100,999)\n        qui replace `generate'=2 if inrange(``ffind'',1000,1299)\n        qui replace `generate'=3 if inrange(``ffind'',1300,1399)\n        qui replace `generate'=4 if inrange(``ffind'',1400,1499)\n        qui replace `generate'=5 if inrange(``ffind'',1500,1799)\n        qui replace `generate'=6 if inrange(``ffind'',2000,2099)\n        qui replace `generate'=7 if inrange(``ffind'',2100,2199)\n        qui replace `generate'=8 if inrange(``ffind'',2200,2299)\n        qui replace `generate'=9 if inrange(``ffind'',2300,2399)\n        qui replace `generate'=10 if inrange(``ffind'',2400,2499)\n        qui replace `generate'=11 if inrange(``ffind'',2500,2599)\n        qui replace `generate'=12 if inrange(``ffind'',2600,2661)\n        qui replace `generate'=13 if inrange(``ffind'',2700,2799)\n        qui replace `generate'=14 if inrange(``ffind'',2800,2899)\n        qui replace `generate'=15 if inrange(``ffind'',2900,2999)\n        qui replace `generate'=16 if inrange(``ffind'',3000,3099)\n        qui replace `generate'=17 if inrange(``ffind'',3100,3199)\n        qui replace `generate'=18 if inrange(``ffind'',3200,3299)\n        qui replace `generate'=19 if inrange(``ffind'',3300,3399)\n        qui replace `generate'=20 if inrange(``ffind'',3400,3499)\n        qui replace `generate'=21 if inrange(``ffind'',3500,3599)\n        qui replace `generate'=22 if inrange(``ffind'',3600,3699)\n        qui replace `generate'=23 if inrange(``ffind'',3700,3799)\n        qui replace `generate'=24 if inrange(``ffind'',3800,3879)\n        qui replace `generate'=25 if inrange(``ffind'',3900,3999)\n        qui replace `generate'=26 if inrange(``ffind'',4000,4799)\n        qui replace `generate'=27 if inrange(``ffind'',4800,4829)\n        qui replace `generate'=28 if inrange(``ffind'',4830,4899)\n        qui replace `generate'=29 if inrange(``ffind'',4900,4949)\n        qui replace `generate'=30 if inrange(``ffind'',4950,4959)\n        qui replace `generate'=31 if inrange(``ffind'',4960,4969)\n        qui replace `generate'=32 if inrange(``ffind'',4970,4979)\n        qui replace `generate'=33 if inrange(``ffind'',5000,5199)\n        qui replace `generate'=34 if inrange(``ffind'',5200,5999)\n        qui replace `generate'=35 if inrange(``ffind'',6000,6999)\n        qui replace `generate'=36 if inrange(``ffind'',7000,8999)\n        qui replace `generate'=37 if inrange(``ffind'',9000,9999)\n        qui replace `generate'=38 if missing(`generate') & ~missing(``ffind'')\n\n        }\n    else if ``ftyp''==48 {\n        label define `generate' 1 \"Agriculture\" 2 \"Food Products\" 3 \"Candy & Soda\" 4 \"Beer & Liquor\" 5 \"Tobacco Products\" 6 \"Recreation\" 7 \"Entertainment\" 8 \"Printing and Publishing\" 9 \"Consumer Goods\" 10 \"Apparel\" 11 \"Healthcare\" 12 \"Medical Equipment\" 13 \"Pharmaceutical Products\" 14 \"Chemicals\" 15 \"Rubber and Plastic Products\" 16 \"Textiles\" 17 \"Construction Materials\" 18 \"Construction\" 19 \"Steel Works Etc\" 20 \"Fabricated Products\" 21 \"Machinery\" 22 \"Electrical Equipment\" 23 \"Automobiles and Trucks\" 24 \"Aircraft\" 25 \"Shipbuilding, Railroad Equipment\" 26 \"Defense\" 27 \"Precious Metals\" 28 \"Non-Metallic and Industrial Metal Mining\" 29 \"Coal\" 30 \"Petroleum and Natural Gas\" 31 \"Utilities\" 32 \"Communication\" 33 \"Personal Services\" 34 \"Business Services\" 35 \"Computers\" 36 \"Electronic Equipment\" 37 \"Measuring and Control Equipment\" 38 \"Business Supplies\" 39 \"Shipping Containers\" 40 \"Transportation\" 41 \"Wholesale\" 42 \"Retail\" 43 \"Restaraunts, Hotels, Motels\" 44 \"Banking\" 45 \"Insurance\" 46 \"Real Estate\" 47 \"Trading\" 48 \"Almost Nothing\"\n        label values `generate' `generate'\n\n        qui replace `generate'=1 if inrange(``ffind'',100,199) | inrange(``ffind'',200,299) | inrange(``ffind'',700,799) | inrange(``ffind'',910,919) | inrange(``ffind'',2048,2048)\n        qui replace `generate'=2 if inrange(``ffind'',2000,2009) | inrange(``ffind'',2010,2019) | inrange(``ffind'',2020,2029) | inrange(``ffind'',2030,2039) | inrange(``ffind'',2040,2046) | inrange(``ffind'',2050,2059) | inrange(``ffind'',2060,2063) | inrange(``ffind'',2070,2079) | inrange(``ffind'',2090,2092) | inrange(``ffind'',2095,2095) | inrange(``ffind'',2098,2099)\n        qui replace `generate'=3 if inrange(``ffind'',2064,2068) | inrange(``ffind'',2086,2086) | inrange(``ffind'',2087,2087) | inrange(``ffind'',2096,2096) | inrange(``ffind'',2097,2097)\n        qui replace `generate'=4 if inrange(``ffind'',2080,2080) | inrange(``ffind'',2082,2082) | inrange(``ffind'',2083,2083) | inrange(``ffind'',2084,2084) | inrange(``ffind'',2085,2085)\n        qui replace `generate'=5 if inrange(``ffind'',2100,2199)\n        qui replace `generate'=6 if inrange(``ffind'',920,999) | inrange(``ffind'',3650,3651) | inrange(``ffind'',3652,3652) | inrange(``ffind'',3732,3732) | inrange(``ffind'',3930,3931) | inrange(``ffind'',3940,3949)\n        qui replace `generate'=7 if inrange(``ffind'',7800,7829) | inrange(``ffind'',7830,7833) | inrange(``ffind'',7840,7841) | inrange(``ffind'',7900,7900) | inrange(``ffind'',7910,7911) | inrange(``ffind'',7920,7929) | inrange(``ffind'',7930,7933) | inrange(``ffind'',7940,7949) | inrange(``ffind'',7980,7980) | inrange(``ffind'',7990,7999)\n        qui replace `generate'=8 if inrange(``ffind'',2700,2709) | inrange(``ffind'',2710,2719) | inrange(``ffind'',2720,2729) | inrange(``ffind'',2730,2739) | inrange(``ffind'',2740,2749) | inrange(``ffind'',2770,2771) | inrange(``ffind'',2780,2789) | inrange(``ffind'',2790,2799)\n        qui replace `generate'=9 if inrange(``ffind'',2047,2047) | inrange(``ffind'',2391,2392) | inrange(``ffind'',2510,2519) | inrange(``ffind'',2590,2599) | inrange(``ffind'',2840,2843) | inrange(``ffind'',2844,2844) | inrange(``ffind'',3160,3161) | inrange(``ffind'',3170,3171) | inrange(``ffind'',3172,3172) | inrange(``ffind'',3190,3199) | inrange(``ffind'',3229,3229) | inrange(``ffind'',3260,3260) | inrange(``ffind'',3262,3263) | inrange(``ffind'',3269,3269) | inrange(``ffind'',3230,3231) | inrange(``ffind'',3630,3639) | inrange(``ffind'',3750,3751) | inrange(``ffind'',3800,3800) | inrange(``ffind'',3860,3861) | inrange(``ffind'',3870,3873) | inrange(``ffind'',3910,3911) | inrange(``ffind'',3914,3914) | inrange(``ffind'',3915,3915) | inrange(``ffind'',3960,3962) | inrange(``ffind'',3991,3991) | inrange(``ffind'',3995,3995)\n        qui replace `generate'=10 if inrange(``ffind'',2300,2390) | inrange(``ffind'',3020,3021) | inrange(``ffind'',3100,3111) | inrange(``ffind'',3130,3131) | inrange(``ffind'',3140,3149) | inrange(``ffind'',3150,3151) | inrange(``ffind'',3963,3965)\n        qui replace `generate'=11 if inrange(``ffind'',8000,8099)\n        qui replace `generate'=12 if inrange(``ffind'',3693,3693) | inrange(``ffind'',3840,3849) | inrange(``ffind'',3850,3851)\n        qui replace `generate'=13 if inrange(``ffind'',2830,2830) | inrange(``ffind'',2831,2831) | inrange(``ffind'',2833,2833) | inrange(``ffind'',2834,2834) | inrange(``ffind'',2835,2835) | inrange(``ffind'',2836,2836)\n        qui replace `generate'=14 if inrange(``ffind'',2800,2809) | inrange(``ffind'',2810,2819) | inrange(``ffind'',2820,2829) | inrange(``ffind'',2850,2859) | inrange(``ffind'',2860,2869) | inrange(``ffind'',2870,2879) | inrange(``ffind'',2890,2899)\n        qui replace `generate'=15 if inrange(``ffind'',3031,3031) | inrange(``ffind'',3041,3041) | inrange(``ffind'',3050,3053) | inrange(``ffind'',3060,3069) | inrange(``ffind'',3070,3079) | inrange(``ffind'',3080,3089) | inrange(``ffind'',3090,3099)\n        qui replace `generate'=16 if inrange(``ffind'',2200,2269) | inrange(``ffind'',2270,2279) | inrange(``ffind'',2280,2284) | inrange(``ffind'',2290,2295) | inrange(``ffind'',2297,2297) | inrange(``ffind'',2298,2298) | inrange(``ffind'',2299,2299) | inrange(``ffind'',2393,2395) | inrange(``ffind'',2397,2399)\n        qui replace `generate'=17 if inrange(``ffind'',800,899) | inrange(``ffind'',2400,2439) | inrange(``ffind'',2450,2459) | inrange(``ffind'',2490,2499) | inrange(``ffind'',2660,2661) | inrange(``ffind'',2950,2952) | inrange(``ffind'',3200,3200) | inrange(``ffind'',3210,3211) | inrange(``ffind'',3240,3241) | inrange(``ffind'',3250,3259) | inrange(``ffind'',3261,3261) | inrange(``ffind'',3264,3264) | inrange(``ffind'',3270,3275) | inrange(``ffind'',3280,3281) | inrange(``ffind'',3290,3293) | inrange(``ffind'',3295,3299) | inrange(``ffind'',3420,3429) | inrange(``ffind'',3430,3433) | inrange(``ffind'',3440,3441) | inrange(``ffind'',3442,3442) | inrange(``ffind'',3446,3446) | inrange(``ffind'',3448,3448) | inrange(``ffind'',3449,3449) | inrange(``ffind'',3450,3451) | inrange(``ffind'',3452,3452) | inrange(``ffind'',3490,3499) | inrange(``ffind'',3996,3996)\n        qui replace `generate'=18 if inrange(``ffind'',1500,1511) | inrange(``ffind'',1520,1529) | inrange(``ffind'',1530,1539) | inrange(``ffind'',1540,1549) | inrange(``ffind'',1600,1699) | inrange(``ffind'',1700,1799)\n        qui replace `generate'=19 if inrange(``ffind'',3300,3300) | inrange(``ffind'',3310,3317) | inrange(``ffind'',3320,3325) | inrange(``ffind'',3330,3339) | inrange(``ffind'',3340,3341) | inrange(``ffind'',3350,3357) | inrange(``ffind'',3360,3369) | inrange(``ffind'',3370,3379) | inrange(``ffind'',3390,3399)\n        qui replace `generate'=20 if inrange(``ffind'',3400,3400) | inrange(``ffind'',3443,3443) | inrange(``ffind'',3444,3444) | inrange(``ffind'',3460,3469) | inrange(``ffind'',3470,3479)\n        qui replace `generate'=21 if inrange(``ffind'',3510,3519) | inrange(``ffind'',3520,3529) | inrange(``ffind'',3530,3530) | inrange(``ffind'',3531,3531) | inrange(``ffind'',3532,3532) | inrange(``ffind'',3533,3533) | inrange(``ffind'',3534,3534) | inrange(``ffind'',3535,3535) | inrange(``ffind'',3536,3536) | inrange(``ffind'',3538,3538) | inrange(``ffind'',3540,3549) | inrange(``ffind'',3550,3559) | inrange(``ffind'',3560,3569) | inrange(``ffind'',3580,3580) | inrange(``ffind'',3581,3581) | inrange(``ffind'',3582,3582) | inrange(``ffind'',3585,3585) | inrange(``ffind'',3586,3586) | inrange(``ffind'',3589,3589) | inrange(``ffind'',3590,3599)\n        qui replace `generate'=22 if inrange(``ffind'',3600,3600) | inrange(``ffind'',3610,3613) | inrange(``ffind'',3620,3621) | inrange(``ffind'',3623,3629) | inrange(``ffind'',3640,3644) | inrange(``ffind'',3645,3645) | inrange(``ffind'',3646,3646) | inrange(``ffind'',3648,3649) | inrange(``ffind'',3660,3660) | inrange(``ffind'',3690,3690) | inrange(``ffind'',3691,3692) | inrange(``ffind'',3699,3699)\n        qui replace `generate'=23 if inrange(``ffind'',2296,2296) | inrange(``ffind'',2396,2396) | inrange(``ffind'',3010,3011) | inrange(``ffind'',3537,3537) | inrange(``ffind'',3647,3647) | inrange(``ffind'',3694,3694) | inrange(``ffind'',3700,3700) | inrange(``ffind'',3710,3710) | inrange(``ffind'',3711,3711) | inrange(``ffind'',3713,3713) | inrange(``ffind'',3714,3714) | inrange(``ffind'',3715,3715) | inrange(``ffind'',3716,3716) | inrange(``ffind'',3792,3792) | inrange(``ffind'',3790,3791) | inrange(``ffind'',3799,3799)\n        qui replace `generate'=24 if inrange(``ffind'',3720,3720) | inrange(``ffind'',3721,3721) | inrange(``ffind'',3723,3724) | inrange(``ffind'',3725,3725) | inrange(``ffind'',3728,3729)\n        qui replace `generate'=25 if inrange(``ffind'',3730,3731) | inrange(``ffind'',3740,3743)\n        qui replace `generate'=26 if inrange(``ffind'',3760,3769) | inrange(``ffind'',3795,3795) | inrange(``ffind'',3480,3489)\n        qui replace `generate'=27 if inrange(``ffind'',1040,1049)\n        qui replace `generate'=28 if inrange(``ffind'',1000,1009) | inrange(``ffind'',1010,1019) | inrange(``ffind'',1020,1029) | inrange(``ffind'',1030,1039) | inrange(``ffind'',1050,1059) | inrange(``ffind'',1060,1069) | inrange(``ffind'',1070,1079) | inrange(``ffind'',1080,1089) | inrange(``ffind'',1090,1099) | inrange(``ffind'',1100,1119) | inrange(``ffind'',1400,1499)\n        qui replace `generate'=29 if inrange(``ffind'',1200,1299)\n        qui replace `generate'=30 if inrange(``ffind'',1300,1300) | inrange(``ffind'',1310,1319) | inrange(``ffind'',1320,1329) | inrange(``ffind'',1330,1339) | inrange(``ffind'',1370,1379) | inrange(``ffind'',1380,1380) | inrange(``ffind'',1381,1381) | inrange(``ffind'',1382,1382) | inrange(``ffind'',1389,1389) | inrange(``ffind'',2900,2912) | inrange(``ffind'',2990,2999)\n        qui replace `generate'=31 if inrange(``ffind'',4900,4900) | inrange(``ffind'',4910,4911) | inrange(``ffind'',4920,4922) | inrange(``ffind'',4923,4923) | inrange(``ffind'',4924,4925) | inrange(``ffind'',4930,4931) | inrange(``ffind'',4932,4932) | inrange(``ffind'',4939,4939) | inrange(``ffind'',4940,4942)\n        qui replace `generate'=32 if inrange(``ffind'',4800,4800) | inrange(``ffind'',4810,4813) | inrange(``ffind'',4820,4822) | inrange(``ffind'',4830,4839) | inrange(``ffind'',4840,4841) | inrange(``ffind'',4880,4889) | inrange(``ffind'',4890,4890) | inrange(``ffind'',4891,4891) | inrange(``ffind'',4892,4892) | inrange(``ffind'',4899,4899)\n        qui replace `generate'=33 if inrange(``ffind'',7020,7021) | inrange(``ffind'',7030,7033) | inrange(``ffind'',7200,7200) | inrange(``ffind'',7210,7212) | inrange(``ffind'',7214,7214) | inrange(``ffind'',7215,7216) | inrange(``ffind'',7217,7217) | inrange(``ffind'',7219,7219) | inrange(``ffind'',7220,7221) | inrange(``ffind'',7230,7231) | inrange(``ffind'',7240,7241) | inrange(``ffind'',7250,7251) | inrange(``ffind'',7260,7269) | inrange(``ffind'',7270,7290) | inrange(``ffind'',7291,7291) | inrange(``ffind'',7292,7299) | inrange(``ffind'',7395,7395) | inrange(``ffind'',7500,7500) | inrange(``ffind'',7520,7529) | inrange(``ffind'',7530,7539) | inrange(``ffind'',7540,7549) | inrange(``ffind'',7600,7600) | inrange(``ffind'',7620,7620) | inrange(``ffind'',7622,7622) | inrange(``ffind'',7623,7623) | inrange(``ffind'',7629,7629) | inrange(``ffind'',7630,7631) | inrange(``ffind'',7640,7641) | inrange(``ffind'',7690,7699) | inrange(``ffind'',8100,8199) | inrange(``ffind'',8200,8299) | inrange(``ffind'',8300,8399) | inrange(``ffind'',8400,8499) | inrange(``ffind'',8600,8699) | inrange(``ffind'',8800,8899) | inrange(``ffind'',7510,7515)\n        qui replace `generate'=34 if inrange(``ffind'',2750,2759) | inrange(``ffind'',3993,3993) | inrange(``ffind'',7218,7218) | inrange(``ffind'',7300,7300) | inrange(``ffind'',7310,7319) | inrange(``ffind'',7320,7329) | inrange(``ffind'',7330,7339) | inrange(``ffind'',7340,7342) | inrange(``ffind'',7349,7349) | inrange(``ffind'',7350,7351) | inrange(``ffind'',7352,7352) | inrange(``ffind'',7353,7353) | inrange(``ffind'',7359,7359) | inrange(``ffind'',7360,7369) | inrange(``ffind'',7370,7372) | inrange(``ffind'',7374,7374) | inrange(``ffind'',7375,7375) | inrange(``ffind'',7376,7376) | inrange(``ffind'',7377,7377) | inrange(``ffind'',7378,7378) | inrange(``ffind'',7379,7379) | inrange(``ffind'',7380,7380) | inrange(``ffind'',7381,7382) | inrange(``ffind'',7383,7383) | inrange(``ffind'',7384,7384) | inrange(``ffind'',7385,7385) | inrange(``ffind'',7389,7390) | inrange(``ffind'',7391,7391) | inrange(``ffind'',7392,7392) | inrange(``ffind'',7393,7393) | inrange(``ffind'',7394,7394) | inrange(``ffind'',7396,7396) | inrange(``ffind'',7397,7397) | inrange(``ffind'',7399,7399) | inrange(``ffind'',7519,7519) | inrange(``ffind'',8700,8700) | inrange(``ffind'',8710,8713) | inrange(``ffind'',8720,8721) | inrange(``ffind'',8730,8734) | inrange(``ffind'',8740,8748) | inrange(``ffind'',8900,8910) | inrange(``ffind'',8911,8911) | inrange(``ffind'',8920,8999) | inrange(``ffind'',4220,4229)\n        qui replace `generate'=35 if inrange(``ffind'',3570,3579) | inrange(``ffind'',3680,3680) | inrange(``ffind'',3681,3681) | inrange(``ffind'',3682,3682) | inrange(``ffind'',3683,3683) | inrange(``ffind'',3684,3684) | inrange(``ffind'',3685,3685) | inrange(``ffind'',3686,3686) | inrange(``ffind'',3687,3687) | inrange(``ffind'',3688,3688) | inrange(``ffind'',3689,3689) | inrange(``ffind'',3695,3695) | inrange(``ffind'',7373,7373)\n        qui replace `generate'=36 if inrange(``ffind'',3622,3622) | inrange(``ffind'',3661,3661) | inrange(``ffind'',3662,3662) | inrange(``ffind'',3663,3663) | inrange(``ffind'',3664,3664) | inrange(``ffind'',3665,3665) | inrange(``ffind'',3666,3666) | inrange(``ffind'',3669,3669) | inrange(``ffind'',3670,3679) | inrange(``ffind'',3810,3810) | inrange(``ffind'',3812,3812)\n        qui replace `generate'=37 if inrange(``ffind'',3811,3811) | inrange(``ffind'',3820,3820) | inrange(``ffind'',3821,3821) | inrange(``ffind'',3822,3822) | inrange(``ffind'',3823,3823) | inrange(``ffind'',3824,3824) | inrange(``ffind'',3825,3825) | inrange(``ffind'',3826,3826) | inrange(``ffind'',3827,3827) | inrange(``ffind'',3829,3829) | inrange(``ffind'',3830,3839)\n        qui replace `generate'=38 if inrange(``ffind'',2520,2549) | inrange(``ffind'',2600,2639) | inrange(``ffind'',2670,2699) | inrange(``ffind'',2760,2761) | inrange(``ffind'',3950,3955)\n        qui replace `generate'=39 if inrange(``ffind'',2440,2449) | inrange(``ffind'',2640,2659) | inrange(``ffind'',3220,3221) | inrange(``ffind'',3410,3412)\n        qui replace `generate'=40 if inrange(``ffind'',4000,4013) | inrange(``ffind'',4040,4049) | inrange(``ffind'',4100,4100) | inrange(``ffind'',4110,4119) | inrange(``ffind'',4120,4121) | inrange(``ffind'',4130,4131) | inrange(``ffind'',4140,4142) | inrange(``ffind'',4150,4151) | inrange(``ffind'',4170,4173) | inrange(``ffind'',4190,4199) | inrange(``ffind'',4200,4200) | inrange(``ffind'',4210,4219) | inrange(``ffind'',4230,4231) | inrange(``ffind'',4240,4249) | inrange(``ffind'',4400,4499) | inrange(``ffind'',4500,4599) | inrange(``ffind'',4600,4699) | inrange(``ffind'',4700,4700) | inrange(``ffind'',4710,4712) | inrange(``ffind'',4720,4729) | inrange(``ffind'',4730,4739) | inrange(``ffind'',4740,4749) | inrange(``ffind'',4780,4780) | inrange(``ffind'',4782,4782) | inrange(``ffind'',4783,4783) | inrange(``ffind'',4784,4784) | inrange(``ffind'',4785,4785) | inrange(``ffind'',4789,4789)\n        qui replace `generate'=41 if inrange(``ffind'',5000,5000) | inrange(``ffind'',5010,5015) | inrange(``ffind'',5020,5023) | inrange(``ffind'',5030,5039) | inrange(``ffind'',5040,5042) | inrange(``ffind'',5043,5043) | inrange(``ffind'',5044,5044) | inrange(``ffind'',5045,5045) | inrange(``ffind'',5046,5046) | inrange(``ffind'',5047,5047) | inrange(``ffind'',5048,5048) | inrange(``ffind'',5049,5049) | inrange(``ffind'',5050,5059) | inrange(``ffind'',5060,5060) | inrange(``ffind'',5063,5063) | inrange(``ffind'',5064,5064) | inrange(``ffind'',5065,5065) | inrange(``ffind'',5070,5078) | inrange(``ffind'',5080,5080) | inrange(``ffind'',5081,5081) | inrange(``ffind'',5082,5082) | inrange(``ffind'',5083,5083) | inrange(``ffind'',5084,5084) | inrange(``ffind'',5085,5085) | inrange(``ffind'',5086,5087) | inrange(``ffind'',5088,5088) | inrange(``ffind'',5090,5090) | inrange(``ffind'',5091,5092) | inrange(``ffind'',5093,5093) | inrange(``ffind'',5094,5094) | inrange(``ffind'',5099,5099) | inrange(``ffind'',5100,5100) | inrange(``ffind'',5110,5113) | inrange(``ffind'',5120,5122) | inrange(``ffind'',5130,5139) | inrange(``ffind'',5140,5149) | inrange(``ffind'',5150,5159) | inrange(``ffind'',5160,5169) | inrange(``ffind'',5170,5172) | inrange(``ffind'',5180,5182) | inrange(``ffind'',5190,5199)\n        qui replace `generate'=42 if inrange(``ffind'',5200,5200) | inrange(``ffind'',5210,5219) | inrange(``ffind'',5220,5229) | inrange(``ffind'',5230,5231) | inrange(``ffind'',5250,5251) | inrange(``ffind'',5260,5261) | inrange(``ffind'',5270,5271) | inrange(``ffind'',5300,5300) | inrange(``ffind'',5310,5311) | inrange(``ffind'',5320,5320) | inrange(``ffind'',5330,5331) | inrange(``ffind'',5334,5334) | inrange(``ffind'',5340,5349) | inrange(``ffind'',5390,5399) | inrange(``ffind'',5400,5400) | inrange(``ffind'',5410,5411) | inrange(``ffind'',5412,5412) | inrange(``ffind'',5420,5429) | inrange(``ffind'',5430,5439) | inrange(``ffind'',5440,5449) | inrange(``ffind'',5450,5459) | inrange(``ffind'',5460,5469) | inrange(``ffind'',5490,5499) | inrange(``ffind'',5500,5500) | inrange(``ffind'',5510,5529) | inrange(``ffind'',5530,5539) | inrange(``ffind'',5540,5549) | inrange(``ffind'',5550,5559) | inrange(``ffind'',5560,5569) | inrange(``ffind'',5570,5579) | inrange(``ffind'',5590,5599) | inrange(``ffind'',5600,5699) | inrange(``ffind'',5700,5700) | inrange(``ffind'',5710,5719) | inrange(``ffind'',5720,5722) | inrange(``ffind'',5730,5733) | inrange(``ffind'',5734,5734) | inrange(``ffind'',5735,5735) | inrange(``ffind'',5736,5736) | inrange(``ffind'',5750,5799) | inrange(``ffind'',5900,5900) | inrange(``ffind'',5910,5912) | inrange(``ffind'',5920,5929) | inrange(``ffind'',5930,5932) | inrange(``ffind'',5940,5940) | inrange(``ffind'',5941,5941) | inrange(``ffind'',5942,5942) | inrange(``ffind'',5943,5943) | inrange(``ffind'',5944,5944) | inrange(``ffind'',5945,5945) | inrange(``ffind'',5946,5946) | inrange(``ffind'',5947,5947) | inrange(``ffind'',5948,5948) | inrange(``ffind'',5949,5949) | inrange(``ffind'',5950,5959) | inrange(``ffind'',5960,5969) | inrange(``ffind'',5970,5979) | inrange(``ffind'',5980,5989) | inrange(``ffind'',5990,5990) | inrange(``ffind'',5992,5992) | inrange(``ffind'',5993,5993) | inrange(``ffind'',5994,5994) | inrange(``ffind'',5995,5995) | inrange(``ffind'',5999,5999)\n        qui replace `generate'=43 if inrange(``ffind'',5800,5819) | inrange(``ffind'',5820,5829) | inrange(``ffind'',5890,5899) | inrange(``ffind'',7000,7000) | inrange(``ffind'',7010,7019) | inrange(``ffind'',7040,7049) | inrange(``ffind'',7213,7213)\n        qui replace `generate'=44 if inrange(``ffind'',6000,6000) | inrange(``ffind'',6010,6019) | inrange(``ffind'',6020,6020) | inrange(``ffind'',6021,6021) | inrange(``ffind'',6022,6022) | inrange(``ffind'',6023,6024) | inrange(``ffind'',6025,6025) | inrange(``ffind'',6026,6026) | inrange(``ffind'',6027,6027) | inrange(``ffind'',6028,6029) | inrange(``ffind'',6030,6036) | inrange(``ffind'',6040,6059) | inrange(``ffind'',6060,6062) | inrange(``ffind'',6080,6082) | inrange(``ffind'',6090,6099) | inrange(``ffind'',6100,6100) | inrange(``ffind'',6110,6111) | inrange(``ffind'',6112,6113) | inrange(``ffind'',6120,6129) | inrange(``ffind'',6130,6139) | inrange(``ffind'',6140,6149) | inrange(``ffind'',6150,6159) | inrange(``ffind'',6160,6169) | inrange(``ffind'',6170,6179) | inrange(``ffind'',6190,6199)\n        qui replace `generate'=45 if inrange(``ffind'',6300,6300) | inrange(``ffind'',6310,6319) | inrange(``ffind'',6320,6329) | inrange(``ffind'',6330,6331) | inrange(``ffind'',6350,6351) | inrange(``ffind'',6360,6361) | inrange(``ffind'',6370,6379) | inrange(``ffind'',6390,6399) | inrange(``ffind'',6400,6411)\n        qui replace `generate'=46 if inrange(``ffind'',6500,6500) | inrange(``ffind'',6510,6510) | inrange(``ffind'',6512,6512) | inrange(``ffind'',6513,6513) | inrange(``ffind'',6514,6514) | inrange(``ffind'',6515,6515) | inrange(``ffind'',6517,6519) | inrange(``ffind'',6520,6529) | inrange(``ffind'',6530,6531) | inrange(``ffind'',6532,6532) | inrange(``ffind'',6540,6541) | inrange(``ffind'',6550,6553) | inrange(``ffind'',6590,6599) | inrange(``ffind'',6610,6611)\n        qui replace `generate'=47 if inrange(``ffind'',6200,6299) | inrange(``ffind'',6700,6700) | inrange(``ffind'',6710,6719) | inrange(``ffind'',6720,6722) | inrange(``ffind'',6723,6723) | inrange(``ffind'',6724,6724) | inrange(``ffind'',6725,6725) | inrange(``ffind'',6726,6726) | inrange(``ffind'',6730,6733) | inrange(``ffind'',6740,6779) | inrange(``ffind'',6790,6791) | inrange(``ffind'',6792,6792) | inrange(``ffind'',6793,6793) | inrange(``ffind'',6794,6794) | inrange(``ffind'',6795,6795) | inrange(``ffind'',6798,6798) | inrange(``ffind'',6799,6799)\n        qui replace `generate'=48 if missing(`generate') & ~missing(``ffind'')\n\n        }\n    else if ``ftyp''==49 {\n        label define `generate' 1 \"Agriculture\" 2 \"Food Products\" 3 \"Candy & Soda\" 4 \"Beer & Liquor\" 5 \"Tobacco Products\" 6 \"Recreation\" 7 \"Entertainment\" 8 \"Printing and Publishing\" 9 \"Consumer Goods\" 10 \"Apparel\" 11 \"Healthcare\" 12 \"Medical Equipment\" 13 \"Pharmaceutical Products\" 14 \"Chemicals\" 15 \"Rubber and Plastic Products\" 16 \"Textiles\" 17 \"Construction Materials\" 18 \"Construction\" 19 \"Steel Works Etc\" 20 \"Fabricated Products\" 21 \"Machinery\" 22 \"Electrical Equipment\" 23 \"Automobiles and Trucks\" 24 \"Aircraft\" 25 \"Shipbuilding, Railroad Equipment\" 26 \"Defense\" 27 \"Precious Metals\" 28 \"Non-Metallic and Industrial Metal Mining\" 29 \"Coal\" 30 \"Petroleum and Natural Gas\" 31 \"Utilities\" 32 \"Communication\" 33 \"Personal Services\" 34 \"Business Services\" 35 \"Computer Hardware\" 36 \"Computer Software\" 37 \"Electronic Equipment\" 38 \"Measuring and Control Equipment\" 39 \"Business Supplies\" 40 \"Shipping Containers\" 41 \"Transportation\" 42 \"Wholesale\" 43 \"Retail\" 44 \"Restaraunts, Hotels, Motels\" 45 \"Banking\" 46 \"Insurance\" 47 \"Real Estate\" 48 \"Trading\" 49 \"Almost Nothing\"\n        label values `generate' `generate'\n\n        qui replace `generate'=1 if inrange(``ffind'',100,199) | inrange(``ffind'',200,299) | inrange(``ffind'',700,799) | inrange(``ffind'',910,919) | inrange(``ffind'',2048,2048)\n        qui replace `generate'=2 if inrange(``ffind'',2000,2009) | inrange(``ffind'',2010,2019) | inrange(``ffind'',2020,2029) | inrange(``ffind'',2030,2039) | inrange(``ffind'',2040,2046) | inrange(``ffind'',2050,2059) | inrange(``ffind'',2060,2063) | inrange(``ffind'',2070,2079) | inrange(``ffind'',2090,2092) | inrange(``ffind'',2095,2095) | inrange(``ffind'',2098,2099)\n        qui replace `generate'=3 if inrange(``ffind'',2064,2068) | inrange(``ffind'',2086,2086) | inrange(``ffind'',2087,2087) | inrange(``ffind'',2096,2096) | inrange(``ffind'',2097,2097)\n        qui replace `generate'=4 if inrange(``ffind'',2080,2080) | inrange(``ffind'',2082,2082) | inrange(``ffind'',2083,2083) | inrange(``ffind'',2084,2084) | inrange(``ffind'',2085,2085)\n        qui replace `generate'=5 if inrange(``ffind'',2100,2199)\n        qui replace `generate'=6 if inrange(``ffind'',920,999) | inrange(``ffind'',3650,3651) | inrange(``ffind'',3652,3652) | inrange(``ffind'',3732,3732) | inrange(``ffind'',3930,3931) | inrange(``ffind'',3940,3949)\n        qui replace `generate'=7 if inrange(``ffind'',7800,7829) | inrange(``ffind'',7830,7833) | inrange(``ffind'',7840,7841) | inrange(``ffind'',7900,7900) | inrange(``ffind'',7910,7911) | inrange(``ffind'',7920,7929) | inrange(``ffind'',7930,7933) | inrange(``ffind'',7940,7949) | inrange(``ffind'',7980,7980) | inrange(``ffind'',7990,7999)\n        qui replace `generate'=8 if inrange(``ffind'',2700,2709) | inrange(``ffind'',2710,2719) | inrange(``ffind'',2720,2729) | inrange(``ffind'',2730,2739) | inrange(``ffind'',2740,2749) | inrange(``ffind'',2770,2771) | inrange(``ffind'',2780,2789) | inrange(``ffind'',2790,2799)\n        qui replace `generate'=9 if inrange(``ffind'',2047,2047) | inrange(``ffind'',2391,2392) | inrange(``ffind'',2510,2519) | inrange(``ffind'',2590,2599) | inrange(``ffind'',2840,2843) | inrange(``ffind'',2844,2844) | inrange(``ffind'',3160,3161) | inrange(``ffind'',3170,3171) | inrange(``ffind'',3172,3172) | inrange(``ffind'',3190,3199) | inrange(``ffind'',3229,3229) | inrange(``ffind'',3260,3260) | inrange(``ffind'',3262,3263) | inrange(``ffind'',3269,3269) | inrange(``ffind'',3230,3231) | inrange(``ffind'',3630,3639) | inrange(``ffind'',3750,3751) | inrange(``ffind'',3800,3800) | inrange(``ffind'',3860,3861) | inrange(``ffind'',3870,3873) | inrange(``ffind'',3910,3911) | inrange(``ffind'',3914,3914) | inrange(``ffind'',3915,3915) | inrange(``ffind'',3960,3962) | inrange(``ffind'',3991,3991) | inrange(``ffind'',3995,3995)\n        qui replace `generate'=10 if inrange(``ffind'',2300,2390) | inrange(``ffind'',3020,3021) | inrange(``ffind'',3100,3111) | inrange(``ffind'',3130,3131) | inrange(``ffind'',3140,3149) | inrange(``ffind'',3150,3151) | inrange(``ffind'',3963,3965)\n        qui replace `generate'=11 if inrange(``ffind'',8000,8099)\n        qui replace `generate'=12 if inrange(``ffind'',3693,3693) | inrange(``ffind'',3840,3849) | inrange(``ffind'',3850,3851)\n        qui replace `generate'=13 if inrange(``ffind'',2830,2830) | inrange(``ffind'',2831,2831) | inrange(``ffind'',2833,2833) | inrange(``ffind'',2834,2834) | inrange(``ffind'',2835,2835) | inrange(``ffind'',2836,2836)\n        qui replace `generate'=14 if inrange(``ffind'',2800,2809) | inrange(``ffind'',2810,2819) | inrange(``ffind'',2820,2829) | inrange(``ffind'',2850,2859) | inrange(``ffind'',2860,2869) | inrange(``ffind'',2870,2879) | inrange(``ffind'',2890,2899)\n        qui replace `generate'=15 if inrange(``ffind'',3031,3031) | inrange(``ffind'',3041,3041) | inrange(``ffind'',3050,3053) | inrange(``ffind'',3060,3069) | inrange(``ffind'',3070,3079) | inrange(``ffind'',3080,3089) | inrange(``ffind'',3090,3099)\n        qui replace `generate'=16 if inrange(``ffind'',2200,2269) | inrange(``ffind'',2270,2279) | inrange(``ffind'',2280,2284) | inrange(``ffind'',2290,2295) | inrange(``ffind'',2297,2297) | inrange(``ffind'',2298,2298) | inrange(``ffind'',2299,2299) | inrange(``ffind'',2393,2395) | inrange(``ffind'',2397,2399)\n        qui replace `generate'=17 if inrange(``ffind'',800,899) | inrange(``ffind'',2400,2439) | inrange(``ffind'',2450,2459) | inrange(``ffind'',2490,2499) | inrange(``ffind'',2660,2661) | inrange(``ffind'',2950,2952) | inrange(``ffind'',3200,3200) | inrange(``ffind'',3210,3211) | inrange(``ffind'',3240,3241) | inrange(``ffind'',3250,3259) | inrange(``ffind'',3261,3261) | inrange(``ffind'',3264,3264) | inrange(``ffind'',3270,3275) | inrange(``ffind'',3280,3281) | inrange(``ffind'',3290,3293) | inrange(``ffind'',3295,3299) | inrange(``ffind'',3420,3429) | inrange(``ffind'',3430,3433) | inrange(``ffind'',3440,3441) | inrange(``ffind'',3442,3442) | inrange(``ffind'',3446,3446) | inrange(``ffind'',3448,3448) | inrange(``ffind'',3449,3449) | inrange(``ffind'',3450,3451) | inrange(``ffind'',3452,3452) | inrange(``ffind'',3490,3499) | inrange(``ffind'',3996,3996)\n        qui replace `generate'=18 if inrange(``ffind'',1500,1511) | inrange(``ffind'',1520,1529) | inrange(``ffind'',1530,1539) | inrange(``ffind'',1540,1549) | inrange(``ffind'',1600,1699) | inrange(``ffind'',1700,1799)\n        qui replace `generate'=19 if inrange(``ffind'',3300,3300) | inrange(``ffind'',3310,3317) | inrange(``ffind'',3320,3325) | inrange(``ffind'',3330,3339) | inrange(``ffind'',3340,3341) | inrange(``ffind'',3350,3357) | inrange(``ffind'',3360,3369) | inrange(``ffind'',3370,3379) | inrange(``ffind'',3390,3399)\n        qui replace `generate'=20 if inrange(``ffind'',3400,3400) | inrange(``ffind'',3443,3443) | inrange(``ffind'',3444,3444) | inrange(``ffind'',3460,3469) | inrange(``ffind'',3470,3479)\n        qui replace `generate'=21 if inrange(``ffind'',3510,3519) | inrange(``ffind'',3520,3529) | inrange(``ffind'',3530,3530) | inrange(``ffind'',3531,3531) | inrange(``ffind'',3532,3532) | inrange(``ffind'',3533,3533) | inrange(``ffind'',3534,3534) | inrange(``ffind'',3535,3535) | inrange(``ffind'',3536,3536) | inrange(``ffind'',3538,3538) | inrange(``ffind'',3540,3549) | inrange(``ffind'',3550,3559) | inrange(``ffind'',3560,3569) | inrange(``ffind'',3580,3580) | inrange(``ffind'',3581,3581) | inrange(``ffind'',3582,3582) | inrange(``ffind'',3585,3585) | inrange(``ffind'',3586,3586) | inrange(``ffind'',3589,3589) | inrange(``ffind'',3590,3599)\n        qui replace `generate'=22 if inrange(``ffind'',3600,3600) | inrange(``ffind'',3610,3613) | inrange(``ffind'',3620,3621) | inrange(``ffind'',3623,3629) | inrange(``ffind'',3640,3644) | inrange(``ffind'',3645,3645) | inrange(``ffind'',3646,3646) | inrange(``ffind'',3648,3649) | inrange(``ffind'',3660,3660) | inrange(``ffind'',3690,3690) | inrange(``ffind'',3691,3692) | inrange(``ffind'',3699,3699)\n        qui replace `generate'=23 if inrange(``ffind'',2296,2296) | inrange(``ffind'',2396,2396) | inrange(``ffind'',3010,3011) | inrange(``ffind'',3537,3537) | inrange(``ffind'',3647,3647) | inrange(``ffind'',3694,3694) | inrange(``ffind'',3700,3700) | inrange(``ffind'',3710,3710) | inrange(``ffind'',3711,3711) | inrange(``ffind'',3713,3713) | inrange(``ffind'',3714,3714) | inrange(``ffind'',3715,3715) | inrange(``ffind'',3716,3716) | inrange(``ffind'',3792,3792) | inrange(``ffind'',3790,3791) | inrange(``ffind'',3799,3799)\n        qui replace `generate'=24 if inrange(``ffind'',3720,3720) | inrange(``ffind'',3721,3721) | inrange(``ffind'',3723,3724) | inrange(``ffind'',3725,3725) | inrange(``ffind'',3728,3729)\n        qui replace `generate'=25 if inrange(``ffind'',3730,3731) | inrange(``ffind'',3740,3743)\n        qui replace `generate'=26 if inrange(``ffind'',3760,3769) | inrange(``ffind'',3795,3795) | inrange(``ffind'',3480,3489)\n        qui replace `generate'=27 if inrange(``ffind'',1040,1049)\n        qui replace `generate'=28 if inrange(``ffind'',1000,1009) | inrange(``ffind'',1010,1019) | inrange(``ffind'',1020,1029) | inrange(``ffind'',1030,1039) | inrange(``ffind'',1050,1059) | inrange(``ffind'',1060,1069) | inrange(``ffind'',1070,1079) | inrange(``ffind'',1080,1089) | inrange(``ffind'',1090,1099) | inrange(``ffind'',1100,1119) | inrange(``ffind'',1400,1499)\n        qui replace `generate'=29 if inrange(``ffind'',1200,1299)\n        qui replace `generate'=30 if inrange(``ffind'',1300,1300) | inrange(``ffind'',1310,1319) | inrange(``ffind'',1320,1329) | inrange(``ffind'',1330,1339) | inrange(``ffind'',1370,1379) | inrange(``ffind'',1380,1380) | inrange(``ffind'',1381,1381) | inrange(``ffind'',1382,1382) | inrange(``ffind'',1389,1389) | inrange(``ffind'',2900,2912) | inrange(``ffind'',2990,2999)\n        qui replace `generate'=31 if inrange(``ffind'',4900,4900) | inrange(``ffind'',4910,4911) | inrange(``ffind'',4920,4922) | inrange(``ffind'',4923,4923) | inrange(``ffind'',4924,4925) | inrange(``ffind'',4930,4931) | inrange(``ffind'',4932,4932) | inrange(``ffind'',4939,4939) | inrange(``ffind'',4940,4942)\n        qui replace `generate'=32 if inrange(``ffind'',4800,4800) | inrange(``ffind'',4810,4813) | inrange(``ffind'',4820,4822) | inrange(``ffind'',4830,4839) | inrange(``ffind'',4840,4841) | inrange(``ffind'',4880,4889) | inrange(``ffind'',4890,4890) | inrange(``ffind'',4891,4891) | inrange(``ffind'',4892,4892) | inrange(``ffind'',4899,4899)\n        qui replace `generate'=33 if inrange(``ffind'',7020,7021) | inrange(``ffind'',7030,7033) | inrange(``ffind'',7200,7200) | inrange(``ffind'',7210,7212) | inrange(``ffind'',7214,7214) | inrange(``ffind'',7215,7216) | inrange(``ffind'',7217,7217) | inrange(``ffind'',7219,7219) | inrange(``ffind'',7220,7221) | inrange(``ffind'',7230,7231) | inrange(``ffind'',7240,7241) | inrange(``ffind'',7250,7251) | inrange(``ffind'',7260,7269) | inrange(``ffind'',7270,7290) | inrange(``ffind'',7291,7291) | inrange(``ffind'',7292,7299) | inrange(``ffind'',7395,7395) | inrange(``ffind'',7500,7500) | inrange(``ffind'',7520,7529) | inrange(``ffind'',7530,7539) | inrange(``ffind'',7540,7549) | inrange(``ffind'',7600,7600) | inrange(``ffind'',7620,7620) | inrange(``ffind'',7622,7622) | inrange(``ffind'',7623,7623) | inrange(``ffind'',7629,7629) | inrange(``ffind'',7630,7631) | inrange(``ffind'',7640,7641) | inrange(``ffind'',7690,7699) | inrange(``ffind'',8100,8199) | inrange(``ffind'',8200,8299) | inrange(``ffind'',8300,8399) | inrange(``ffind'',8400,8499) | inrange(``ffind'',8600,8699) | inrange(``ffind'',8800,8899) | inrange(``ffind'',7510,7515)\n        qui replace `generate'=34 if inrange(``ffind'',2750,2759) | inrange(``ffind'',3993,3993) | inrange(``ffind'',7218,7218) | inrange(``ffind'',7300,7300) | inrange(``ffind'',7310,7319) | inrange(``ffind'',7320,7329) | inrange(``ffind'',7330,7339) | inrange(``ffind'',7340,7342) | inrange(``ffind'',7349,7349) | inrange(``ffind'',7350,7351) | inrange(``ffind'',7352,7352) | inrange(``ffind'',7353,7353) | inrange(``ffind'',7359,7359) | inrange(``ffind'',7360,7369) | inrange(``ffind'',7374,7374) | inrange(``ffind'',7376,7376) | inrange(``ffind'',7377,7377) | inrange(``ffind'',7378,7378) | inrange(``ffind'',7379,7379) | inrange(``ffind'',7380,7380) | inrange(``ffind'',7381,7382) | inrange(``ffind'',7383,7383) | inrange(``ffind'',7384,7384) | inrange(``ffind'',7385,7385) | inrange(``ffind'',7389,7390) | inrange(``ffind'',7391,7391) | inrange(``ffind'',7392,7392) | inrange(``ffind'',7393,7393) | inrange(``ffind'',7394,7394) | inrange(``ffind'',7396,7396) | inrange(``ffind'',7397,7397) | inrange(``ffind'',7399,7399) | inrange(``ffind'',7519,7519) | inrange(``ffind'',8700,8700) | inrange(``ffind'',8710,8713) | inrange(``ffind'',8720,8721) | inrange(``ffind'',8730,8734) | inrange(``ffind'',8740,8748) | inrange(``ffind'',8900,8910) | inrange(``ffind'',8911,8911) | inrange(``ffind'',8920,8999) | inrange(``ffind'',4220,4229)\n        qui replace `generate'=35 if inrange(``ffind'',3570,3579) | inrange(``ffind'',3680,3680) | inrange(``ffind'',3681,3681) | inrange(``ffind'',3682,3682) | inrange(``ffind'',3683,3683) | inrange(``ffind'',3684,3684) | inrange(``ffind'',3685,3685) | inrange(``ffind'',3686,3686) | inrange(``ffind'',3687,3687) | inrange(``ffind'',3688,3688) | inrange(``ffind'',3689,3689) | inrange(``ffind'',3695,3695)\n        qui replace `generate'=36 if inrange(``ffind'',7370,7372) | inrange(``ffind'',7375,7375) | inrange(``ffind'',7373,7373)\n        qui replace `generate'=37 if inrange(``ffind'',3622,3622) | inrange(``ffind'',3661,3661) | inrange(``ffind'',3662,3662) | inrange(``ffind'',3663,3663) | inrange(``ffind'',3664,3664) | inrange(``ffind'',3665,3665) | inrange(``ffind'',3666,3666) | inrange(``ffind'',3669,3669) | inrange(``ffind'',3670,3679) | inrange(``ffind'',3810,3810) | inrange(``ffind'',3812,3812)\n        qui replace `generate'=38 if inrange(``ffind'',3811,3811) | inrange(``ffind'',3820,3820) | inrange(``ffind'',3821,3821) | inrange(``ffind'',3822,3822) | inrange(``ffind'',3823,3823) | inrange(``ffind'',3824,3824) | inrange(``ffind'',3825,3825) | inrange(``ffind'',3826,3826) | inrange(``ffind'',3827,3827) | inrange(``ffind'',3829,3829) | inrange(``ffind'',3830,3839)\n        qui replace `generate'=39 if inrange(``ffind'',2520,2549) | inrange(``ffind'',2600,2639) | inrange(``ffind'',2670,2699) | inrange(``ffind'',2760,2761) | inrange(``ffind'',3950,3955)\n        qui replace `generate'=40 if inrange(``ffind'',2440,2449) | inrange(``ffind'',2640,2659) | inrange(``ffind'',3220,3221) | inrange(``ffind'',3410,3412)\n        qui replace `generate'=41 if inrange(``ffind'',4000,4013) | inrange(``ffind'',4040,4049) | inrange(``ffind'',4100,4100) | inrange(``ffind'',4110,4119) | inrange(``ffind'',4120,4121) | inrange(``ffind'',4130,4131) | inrange(``ffind'',4140,4142) | inrange(``ffind'',4150,4151) | inrange(``ffind'',4170,4173) | inrange(``ffind'',4190,4199) | inrange(``ffind'',4200,4200) | inrange(``ffind'',4210,4219) | inrange(``ffind'',4230,4231) | inrange(``ffind'',4240,4249) | inrange(``ffind'',4400,4499) | inrange(``ffind'',4500,4599) | inrange(``ffind'',4600,4699) | inrange(``ffind'',4700,4700) | inrange(``ffind'',4710,4712) | inrange(``ffind'',4720,4729) | inrange(``ffind'',4730,4739) | inrange(``ffind'',4740,4749) | inrange(``ffind'',4780,4780) | inrange(``ffind'',4782,4782) | inrange(``ffind'',4783,4783) | inrange(``ffind'',4784,4784) | inrange(``ffind'',4785,4785) | inrange(``ffind'',4789,4789)\n        qui replace `generate'=42 if inrange(``ffind'',5000,5000) | inrange(``ffind'',5010,5015) | inrange(``ffind'',5020,5023) | inrange(``ffind'',5030,5039) | inrange(``ffind'',5040,5042) | inrange(``ffind'',5043,5043) | inrange(``ffind'',5044,5044) | inrange(``ffind'',5045,5045) | inrange(``ffind'',5046,5046) | inrange(``ffind'',5047,5047) | inrange(``ffind'',5048,5048) | inrange(``ffind'',5049,5049) | inrange(``ffind'',5050,5059) | inrange(``ffind'',5060,5060) | inrange(``ffind'',5063,5063) | inrange(``ffind'',5064,5064) | inrange(``ffind'',5065,5065) | inrange(``ffind'',5070,5078) | inrange(``ffind'',5080,5080) | inrange(``ffind'',5081,5081) | inrange(``ffind'',5082,5082) | inrange(``ffind'',5083,5083) | inrange(``ffind'',5084,5084) | inrange(``ffind'',5085,5085) | inrange(``ffind'',5086,5087) | inrange(``ffind'',5088,5088) | inrange(``ffind'',5090,5090) | inrange(``ffind'',5091,5092) | inrange(``ffind'',5093,5093) | inrange(``ffind'',5094,5094) | inrange(``ffind'',5099,5099) | inrange(``ffind'',5100,5100) | inrange(``ffind'',5110,5113) | inrange(``ffind'',5120,5122) | inrange(``ffind'',5130,5139) | inrange(``ffind'',5140,5149) | inrange(``ffind'',5150,5159) | inrange(``ffind'',5160,5169) | inrange(``ffind'',5170,5172) | inrange(``ffind'',5180,5182) | inrange(``ffind'',5190,5199)\n        qui replace `generate'=43 if inrange(``ffind'',5200,5200) | inrange(``ffind'',5210,5219) | inrange(``ffind'',5220,5229) | inrange(``ffind'',5230,5231) | inrange(``ffind'',5250,5251) | inrange(``ffind'',5260,5261) | inrange(``ffind'',5270,5271) | inrange(``ffind'',5300,5300) | inrange(``ffind'',5310,5311) | inrange(``ffind'',5320,5320) | inrange(``ffind'',5330,5331) | inrange(``ffind'',5334,5334) | inrange(``ffind'',5340,5349) | inrange(``ffind'',5390,5399) | inrange(``ffind'',5400,5400) | inrange(``ffind'',5410,5411) | inrange(``ffind'',5412,5412) | inrange(``ffind'',5420,5429) | inrange(``ffind'',5430,5439) | inrange(``ffind'',5440,5449) | inrange(``ffind'',5450,5459) | inrange(``ffind'',5460,5469) | inrange(``ffind'',5490,5499) | inrange(``ffind'',5500,5500) | inrange(``ffind'',5510,5529) | inrange(``ffind'',5530,5539) | inrange(``ffind'',5540,5549) | inrange(``ffind'',5550,5559) | inrange(``ffind'',5560,5569) | inrange(``ffind'',5570,5579) | inrange(``ffind'',5590,5599) | inrange(``ffind'',5600,5699) | inrange(``ffind'',5700,5700) | inrange(``ffind'',5710,5719) | inrange(``ffind'',5720,5722) | inrange(``ffind'',5730,5733) | inrange(``ffind'',5734,5734) | inrange(``ffind'',5735,5735) | inrange(``ffind'',5736,5736) | inrange(``ffind'',5750,5799) | inrange(``ffind'',5900,5900) | inrange(``ffind'',5910,5912) | inrange(``ffind'',5920,5929) | inrange(``ffind'',5930,5932) | inrange(``ffind'',5940,5940) | inrange(``ffind'',5941,5941) | inrange(``ffind'',5942,5942) | inrange(``ffind'',5943,5943) | inrange(``ffind'',5944,5944) | inrange(``ffind'',5945,5945) | inrange(``ffind'',5946,5946) | inrange(``ffind'',5947,5947) | inrange(``ffind'',5948,5948) | inrange(``ffind'',5949,5949) | inrange(``ffind'',5950,5959) | inrange(``ffind'',5960,5969) | inrange(``ffind'',5970,5979) | inrange(``ffind'',5980,5989) | inrange(``ffind'',5990,5990) | inrange(``ffind'',5992,5992) | inrange(``ffind'',5993,5993) | inrange(``ffind'',5994,5994) | inrange(``ffind'',5995,5995) | inrange(``ffind'',5999,5999)\n        qui replace `generate'=44 if inrange(``ffind'',5800,5819) | inrange(``ffind'',5820,5829) | inrange(``ffind'',5890,5899) | inrange(``ffind'',7000,7000) | inrange(``ffind'',7010,7019) | inrange(``ffind'',7040,7049) | inrange(``ffind'',7213,7213)\n        qui replace `generate'=45 if inrange(``ffind'',6000,6000) | inrange(``ffind'',6010,6019) | inrange(``ffind'',6020,6020) | inrange(``ffind'',6021,6021) | inrange(``ffind'',6022,6022) | inrange(``ffind'',6023,6024) | inrange(``ffind'',6025,6025) | inrange(``ffind'',6026,6026) | inrange(``ffind'',6027,6027) | inrange(``ffind'',6028,6029) | inrange(``ffind'',6030,6036) | inrange(``ffind'',6040,6059) | inrange(``ffind'',6060,6062) | inrange(``ffind'',6080,6082) | inrange(``ffind'',6090,6099) | inrange(``ffind'',6100,6100) | inrange(``ffind'',6110,6111) | inrange(``ffind'',6112,6113) | inrange(``ffind'',6120,6129) | inrange(``ffind'',6130,6139) | inrange(``ffind'',6140,6149) | inrange(``ffind'',6150,6159) | inrange(``ffind'',6160,6169) | inrange(``ffind'',6170,6179) | inrange(``ffind'',6190,6199)\n        qui replace `generate'=46 if inrange(``ffind'',6300,6300) | inrange(``ffind'',6310,6319) | inrange(``ffind'',6320,6329) | inrange(``ffind'',6330,6331) | inrange(``ffind'',6350,6351) | inrange(``ffind'',6360,6361) | inrange(``ffind'',6370,6379) | inrange(``ffind'',6390,6399) | inrange(``ffind'',6400,6411)\n        qui replace `generate'=47 if inrange(``ffind'',6500,6500) | inrange(``ffind'',6510,6510) | inrange(``ffind'',6512,6512) | inrange(``ffind'',6513,6513) | inrange(``ffind'',6514,6514) | inrange(``ffind'',6515,6515) | inrange(``ffind'',6517,6519) | inrange(``ffind'',6520,6529) | inrange(``ffind'',6530,6531) | inrange(``ffind'',6532,6532) | inrange(``ffind'',6540,6541) | inrange(``ffind'',6550,6553) | inrange(``ffind'',6590,6599) | inrange(``ffind'',6610,6611)\n        qui replace `generate'=48 if inrange(``ffind'',6200,6299) | inrange(``ffind'',6700,6700) | inrange(``ffind'',6710,6719) | inrange(``ffind'',6720,6722) | inrange(``ffind'',6723,6723) | inrange(``ffind'',6724,6724) | inrange(``ffind'',6725,6725) | inrange(``ffind'',6726,6726) | inrange(``ffind'',6730,6733) | inrange(``ffind'',6740,6779) | inrange(``ffind'',6790,6791) | inrange(``ffind'',6792,6792) | inrange(``ffind'',6793,6793) | inrange(``ffind'',6794,6794) | inrange(``ffind'',6795,6795) | inrange(``ffind'',6798,6798) | inrange(``ffind'',6799,6799)\n        qui replace `generate'=49 if missing(`generate') & ~missing(``ffind'')\n\n        }\n    else {\n        di as error \"Type must be 5, 10, 12, 17, 30, 38, 48 or 49\"\n        exit 111\n        }\n\nend"
  },
  {
    "objectID": "posts/identify-chinese-state-owned-enterprise-using-csmar/index.html",
    "href": "posts/identify-chinese-state-owned-enterprise-using-csmar/index.html",
    "title": "Identify Chinese State-Owned Enterprise using CSMAR",
    "section": "",
    "text": "Many research papers on Chinese firms include a control variable that indicates if the firm is a state-owned enterprise (SOE). This is important as SOEs and non-SOEs differ in many aspects and may have structural differences. This post documents the way to construct this indicator variable from the CSMAR databases.\n\nSpecifically, we need the CSMAR China Listed Firms Shareholders - Controlling Shareholders dataset. On WRDS, this dataset is named hld_contrshr, located at /wrds/csmar/sasdata/hld.\nInside this dataset there’re a few variables identifying the ultimate controlling shareholder.\n\ns0701b: ultimate controlling shareholder.\ns0702b: nature of ultimate controlling shareholder.\n\nAccording to the CSMAR documentation, s0702b can be one of the following. Apparently, s0702b=1100 means the firm is a SOE.\n\n\n\nCode\nType\n\n\n\n\n1000\nEnterprise business unit\n\n\n1100\nState-owned Enterprise\n\n\n1210\nCollective-owned enterprises\n\n\n1200\nPrivate Enterprises\n\n\n1220\nEnterprises with funds from Hong Kong, Macau and Taiwan\n\n\n1230\nForeign-funded enterprises\n\n\n2000\nAdministrative departments or institutions\n\n\n2100\nCentral institution\n\n\n2120\nLocal institution\n\n\n2500\nSocial Organization\n\n\n3000\nNatural Persons\n\n\n3110\nDomestic natural persons\n\n\n3120\nNatural person from Hong Kong, Macao and Taiwan\n\n\n3200\nForeign natural person\n\n\n9999\nOther\n\n\n\nPrinceton University Library has another guide on other ways to identify Chinese SOE.\n\n\n\n Back to top"
  },
  {
    "objectID": "posts/index.html",
    "href": "posts/index.html",
    "title": "Blog",
    "section": "",
    "text": "Order By\n       Default\n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n         \n          Title\n        \n     \n  \n\n\n\n\n\nDate\n\n\nTitle\n\n\n\n\n\n\nJan 20, 2025\n\n\nDeveloping a Bank Simulation Software\n\n\n\n\nNov 28, 2024\n\n\nKalman Filter\n\n\n\n\nSep 9, 2024\n\n\nPhDs.io\n\n\n\n\nJul 20, 2024\n\n\nTechnology Diversity\n\n\n\n\nJun 30, 2024\n\n\nQuantLib - Yield Curve\n\n\n\n\nDec 21, 2023\n\n\nIdentify Retail Investors\n\n\n\n\nDec 15, 2023\n\n\nBond Price Volatility (Sensitivity)\n\n\n\n\nOct 15, 2023\n\n\nTranslog Cost Function Estimation\n\n\n\n\nOct 13, 2023\n\n\nTranslog Production and Cost Functions\n\n\n\n\nOct 2, 2023\n\n\nGARCH-Constant Conditional Correlation (CCC)\n\n\n\n\nSep 26, 2023\n\n\nGARCH Estimation\n\n\n\n\nSep 8, 2023\n\n\nDownload SEC Filings from EDGAR\n\n\n\n\nAug 31, 2023\n\n\nYield Curve and Term Structure of Interest Rates\n\n\n\n\nAug 21, 2023\n\n\nBond Prices and Yields\n\n\n\n\nAug 17, 2023\n\n\nDifference-in-Differences Estimation\n\n\n\n\nAug 15, 2023\n\n\nCRSP Missing Codes\n\n\n\n\nAug 8, 2023\n\n\nFRED - Federal Reserve Economic Data\n\n\n\n\nJul 31, 2023\n\n\nStata - Working with datasets\n\n\n\n\nJul 26, 2023\n\n\nIntroduction to Fixed Income Securities\n\n\n\n\nApr 9, 2023\n\n\nCorrelated Random Effects\n\n\n\n\nApr 5, 2023\n\n\nProbability of Informed Trading (PIN)\n\n\n\n\nFeb 16, 2023\n\n\nStata - Packages\n\n\n\n\nFeb 3, 2023\n\n\nStata - Introduction\n\n\n\n\nNov 30, 2022\n\n\nEstimate Merton Distance-to-Default\n\n\n\n\nJun 18, 2022\n\n\nUninitialized Variable in C\n\n\n\n\nApr 16, 2022\n\n\nCentrifuge Problem\n\n\n\n\nMar 6, 2022\n\n\nAdding Another Factor to Principal-Agent Model\n\n\n\n\nJan 9, 2022\n\n\nEstimate Organization Capital\n\n\n\n\nMay 15, 2021\n\n\nDownload M&A Deals from SDC Platinum\n\n\n\n\nFeb 11, 2021\n\n\nSpecification Curve Analysis\n\n\n\n\nJul 30, 2020\n\n\nBitcoin Address Generator in Obfuscated Python\n\n\n\n\nJul 28, 2020\n\n\nFirm Historical Headquarter State from SEC 10K/Q Filings\n\n\n\n\nJun 10, 2020\n\n\nCompute Jackknife Coefficient Estimates in SAS\n\n\n\n\nJun 8, 2020\n\n\nPython Shared Memory in Multiprocessing\n\n\n\n\nMay 27, 2020\n\n\nTextual Analysis on SEC Filings\n\n\n\n\nMay 26, 2020\n\n\nVariance Ratio Test - Lo and MacKinlay (1988)\n\n\n\n\nMay 26, 2020\n\n\nMinimum Variance Hedge Ratio\n\n\n\n\nMay 26, 2020\n\n\nWinsorization in SAS\n\n\n\n\nMay 25, 2020\n\n\nCall Option Value from Two Approaches\n\n\n\n\nMay 25, 2020\n\n\nBank Holing Company Financials from FR Y-9C\n\n\n\n\nMay 25, 2020\n\n\nMerge Compustat and CRSP\n\n\n\n\nMay 25, 2020\n\n\nReconciliation of Black-Scholes Variants\n\n\n\n\nMay 24, 2020\n\n\nDecomposing Herfindahl–Hirschman (HHI) Index\n\n\n\n\nMay 22, 2020\n\n\nBloomberg BQuant (BQNT)\n\n\n\n\nMay 22, 2020\n\n\nCompute Weekly Return from Daily CRSP Data\n\n\n\n\nMay 22, 2020\n\n\nConvert Between Numeric and Character Variables\n\n\n\n\nMay 22, 2020\n\n\nSetup Docker/Ngnix and Let’s Encrypt on Ubuntu\n\n\n\n\nMay 22, 2020\n\n\nGenerate Fama-French Industry Classification From SIC\n\n\n\n\nMay 22, 2020\n\n\nIdentify Chinese State-Owned Enterprise using CSMAR\n\n\n\n\nMay 22, 2020\n\n\nLeGao to Make Your Own LEGO Mosaics\n\n\n\n\nMay 22, 2020\n\n\nUse SAS Macros on WRDS\n\n\n\n\nMay 22, 2020\n\n\nWhat it takes to be a CEO? A fun survey of literature\n\n\n\n\nMay 22, 2020\n\n\nWorking Remotely on a Windows Machine from VSCode on a Mac\n\n\n\n\nMar 24, 2020\n\n\nBeta - Unlevered and Levered\n\n\n\n\nJul 25, 2019\n\n\nEncode Password for SAS Remote Submission\n\n\n\n\nMay 29, 2019\n\n\nAccumulator Option Pricing\n\n\n\n\nMay 29, 2019\n\n\nNever Use a Brain Wallet\n\n\n\n\nFeb 25, 2019\n\n\n100 Bitcoins Forgone for Science\n\n\n\n\n\nNo matching items\n\n\n  \n\n Back to top"
  },
  {
    "objectID": "posts/lomackinlay1988/index.html",
    "href": "posts/lomackinlay1988/index.html",
    "title": "Variance Ratio Test - Lo and MacKinlay (1988)",
    "section": "",
    "text": "A simple test for the random walk hypothesis of prices and efficient market."
  },
  {
    "objectID": "posts/lomackinlay1988/index.html#definition",
    "href": "posts/lomackinlay1988/index.html#definition",
    "title": "Variance Ratio Test - Lo and MacKinlay (1988)",
    "section": "Definition",
    "text": "Definition\nLet’s assume:\n\na price series \\(\\{p_t\\}=\\{p_0,p_1,p_2,...,p_T\\}\\) and\na log return series \\(\\{x_t\\}=\\{x_1, x_2, ..., x_T\\}\\) where \\(x_t=\\ln \\frac{p_t}{p_{t-1}}\\)\n\n\nVariance Ratio (VR)\nThe variance ratio of \\(k\\)-period return is defined as:\n\\[\n\\begin{equation}\n\\textit{V}(k)=\\frac{\\textit{Var}(x_t+x_{t-1}+...+x_{t-k+1})/k}{\\textit{Var}(x_t)}\n\\end{equation}\n\\]\nThe estimator of \\(\\textit{V}(k)\\) proposed in Lo and MacKinlay (1988) is\n\\[\n\\begin{equation}\n\\textit{VR}(k)=\\frac{\\hat\\sigma^2(k)}{\\hat\\sigma^2(1)}\n\\end{equation}\n\\]\nwhere \\(\\hat\\sigma^2(1)\\) is the unbiased estimator of the one-period return variance, using the one-period returns \\(\\{x_t\\}\\), and is defined as\n\\[\n\\begin{equation}\n\\hat\\sigma^2(1)=\\frac{1}{T-1} \\sum_{t-1}^T (x_t - \\hat\\mu)^2\n\\end{equation}\n\\]\nand \\(\\hat\\sigma^2(k)\\) is the estimator of \\(k\\)-period return variance using \\(k\\)-period returns. Lo and MacKinlay (1988) defined it, due to limited sample size and the desire to improve the power of the test, as\n\\[\n\\begin{equation}\n\\hat\\sigma^2(k)=\\frac{1}{m} \\sum_{t-1}^T \\left(\\ln\\frac{P_t}{P_{t-k}} - k\\hat\\mu \\right)^2\n\\end{equation}\n\\]\nwhere \\(m=k(T-k+1)(1-k/T)\\) is chosen such that \\(\\hat\\sigma^2(k)\\) is an unbiased estimator of the \\(k\\)-period return variance when \\(\\sigma^2_t\\) is constant over time.\n\n\nVariance Ratio Test Statistics\nLo and MacKinlay (1988) proposed that under the null hypothesis of \\(V(k)=1\\), the test statistic is given by\n\\[\n\\begin{equation}\nZ(k)=\\frac{\\textit{VR}(k)-1}{\\sqrt{\\phi(k)}}\n\\end{equation}\n\\]\nwhich follows the standard normal distribution asymptotically.\n\nHomoscedasticity\nUnder the assumption of homoscedasticity, the asymptotic variance \\(\\phi\\) is given by\n\\[\n\\begin{equation}\n\\phi(k)=\\frac{2(2k-1)(k-1)}{3kT}\n\\end{equation}\n\\]\n\n\nHeteroscedasticity\nUnder the assumption of heteroscedasticity, the asymptotic variance \\(\\phi\\) is given by\n\\[\n\\begin{equation}\n\\phi(k)=\\sum_{j=1}^{k-1} \\left[\\frac{2(k-j)}{k} \\right]^2\\delta(j)\n\\end{equation}\n\\]\n\\[\n\\begin{equation}\n\\delta(j)=\\frac{\\sum_{t=j+1}^T (x_t - \\hat\\mu)^2(x_{t-j} - \\hat\\mu)^2}{\\left[\\sum_{t=1}^T (x_t - \\hat\\mu)^2\\right]^2}\n\\end{equation}\n\\]\n\n\n\n\n\n\nErratum\n\n\n\nNote that there’s a missing \\(T\\) in the numerator of \\(\\delta(j)\\) of Equation (8). It is actually missing the 1988 RFS paper and the 1998 JE’mtric paper, but has been corrected in the 1990 RFS Issue 1: https://doi.org/10.1093/rfs/3.1.ii. The corrected version reads:\n\\[\n\\begin{equation}\n\\delta(j)=\\frac{T\\sum_{t=j+1}^T (x_t - \\hat\\mu)^2(x_{t-j} - \\hat\\mu)^2}{\\left[\\sum_{t=1}^T (x_t - \\hat\\mu)^2\\right]^2}\n\\end{equation}\n\\]\nTo correct it in the example code below, change the line 51 below to:\ndelta_arr = T * b_arr / np.square(np.sum(sqr_demeaned_x))\nI thank Simon Jurkatis for letting me know about the erratum."
  },
  {
    "objectID": "posts/lomackinlay1988/index.html#source-code",
    "href": "posts/lomackinlay1988/index.html#source-code",
    "title": "Variance Ratio Test - Lo and MacKinlay (1988)",
    "section": "Source Code",
    "text": "Source Code\n\nThis example Python code has been optimized for speed but serves only demonstration purpose. It may contain errors.\n# LoMacKinlay.py\nimport numpy as np\nfrom numba import jit\n\nname = 'LoMacKinlay1988'\ndescription = 'Variance ratio and test statistics as in Lo and MacKinlay (1988)'\nvars_needed = ['Price']\n\n\n@jit(nopython=True, nogil=True, cache=True)\ndef _estimate(log_prices, k, const_arr):\n    # Log returns = [x2, x3, x4, ..., xT], where x(i)=ln[p(i)/p(i-1)]\n    rets = np.diff(log_prices)\n    # T is the length of return series\n    T = len(rets)\n    # mu is the mean log return\n    mu = np.mean(rets)\n    # sqr_demeaned_x is the array of squared demeaned log returns\n    sqr_demeaned_x = np.square(rets - mu)\n    # Var_1\n    # Didn't use np.var(rets, ddof=1) because\n    # sqr_demeaned_x is calculated already and will be used many times.\n    var_1 = np.sum(sqr_demeaned_x) / (T-1)\n    # Var_k\n    # Variance of log returns where x(i) = ln[p(i)/p(i-k)]\n    # Before np.roll() - array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])\n    # After np.roll(,shift=2) - array([8, 9, 0, 1, 2, 3, 4, 5, 6, 7])\n    # Discard the first k elements.\n    rets_k = (log_prices - np.roll(log_prices, k))[k:]\n    m = k * (T - k + 1) * (1 - k / T)\n    var_k = 1/m * np.sum(np.square(rets_k - k * mu))\n\n    # Variance Ratio\n    vr = var_k / var_1\n\n    # a_arr is an array of { (2*(k-j)/k)^2 } for j=1,2,...,k-1, fixed for a given k:\n    #   When k=5, a_arr = array([2.56, 1.44, 0.64, 0.16]).\n    #   When k=8, a_arr = array([3.0625, 2.25, 1.5625, 1., 0.5625, 0.25, 0.0625])\n    # Without JIT it's defined as:\n    #   a_arr = np.square(np.arange(k-1, 0, step=-1, dtype=np.int) * 2 / k)\n    # But np.array creation is not allowed in nopython mode.\n    # So const_arr=np.arange(k-1, 0, step=-1, dtype=np.int) is created outside.\n    a_arr = np.square(const_arr * 2 / k)\n\n    # b_arr is part of the delta_arr.\n    b_arr = np.empty(k-1, dtype=np.float64)\n    for j in range(1, k):\n        b_arr[j-1] = np.sum((sqr_demeaned_x *\n1                             np.roll(sqr_demeaned_x, j))[j:])\n\n2    delta_arr = b_arr / np.square(np.sum(sqr_demeaned_x))\n\n    # Both arrarys are of length (k-1)\n    assert len(delta_arr) == len(a_arr) == k-1\n\n    phi1 = 2 * (2*k - 1) * (k-1) / (3*k*T)\n    phi2 = np.sum(a_arr * delta_arr)\n\n    # VR test statistics under two assumptions\n    vr_stat_homoscedasticity = (vr - 1) / np.sqrt(phi1)\n    vr_stat_heteroscedasticity = (vr - 1) / np.sqrt(phi2)\n\n    return vr, vr_stat_homoscedasticity, vr_stat_heteroscedasticity\n\n\ndef estimate(data):\n    \"A fast estimation of Variance Ratio test statistics as in Lo and MacKinlay (1988)\"\n    # Prices array = [p1, p2, p3, p4, ..., pT]\n    prices = data['Price'].to_numpy(dtype=np.float64)\n    result = []\n    # Estimate many lags.\n    for k in [2, 4, 6, 8, 10, 15, 20, 30, 40, 50, 100, 200, 500, 1000]:\n        # Compute a constant array as np.array creation is not allowed in nopython mode.\n3        const_arr = np.arange(k-1, 0, step=-1, dtype=np.int64)\n        vr, stat1, stat2 = _estimate(np.log(prices), k, const_arr)\n        result.append({\n            f'Variance Ratio (k={k})': vr,\n            f'Variance Ratio Test Statistic (k={k}) Homoscedasticity Assumption': stat1,\n            f'Variance Ratio Test Statistic (k={k}) Heteroscedasticity Assumption': stat2\n        })\n    return result\n\n1\n\nNote that a correction has been made here in August 2023. The summed vector should have a length of T-j not T-j-1. The incorrect code before was np.roll(sqr_demeaned_x, j))[j+1:]). I thank Jakub Bujnowicz for spotting this error.\n\n2\n\nCheck the Erratum for correction.\n\n3\n\nnp.int is deprecated in NumPy 1.2. Changed to np.int64 in August 2023.\n\n\nAs an example, let’s create 1 million prices from random walk and estimate the variance ratio and two test statistics at various lags.\nif __name__ == \"__main__\":\n\n    import pandas as pd\n    from pprint import pprint\n    np.random.seed(1)\n    # Generate random steps with mean=0 and standard deviation=1\n    steps = np.random.normal(0, 1, size=1000000)\n    # Set first element to 0 so that the first price will be the starting stock price\n    steps[0] = 0\n    # Simulate stock prices, P with a large starting price\n    P = 10000 + np.cumsum(steps)\n    # Test\n    data = pd.DataFrame(P, columns=['Price'])\n    result = estimate(data)\n    pprint(result)\nIn just a few seconds, the output is:\n[{'Variance Ratio (k=2)': 1.0003293867428107,\n  'Variance Ratio Test Statistic (k=2) Heteroscedasticity Assumption': 0.32904631796994205,\n  'Variance Ratio Test Statistic (k=2) Homoscedasticity Assumption': 0.3293865781172764},\n {'Variance Ratio (k=4)': 1.0007984480057008,\n  'Variance Ratio Test Statistic (k=4) Heteroscedasticity Assumption': 0.42595328310183966,\n  'Variance Ratio Test Statistic (k=4) Homoscedasticity Assumption': 0.4267881978179488},\n {'Variance Ratio (k=6)': 0.9999130202975436,\n  'Variance Ratio Test Statistic (k=6) Heteroscedasticity Assumption': -0.03511755955165345,\n  'Variance Ratio Test Statistic (k=6) Homoscedasticity Assumption': -0.03518500446740915},\n {'Variance Ratio (k=8)': 1.0001094011344323,\n  'Variance Ratio Test Statistic (k=8) Heteroscedasticity Assumption': 0.036922676034485354,\n  'Variance Ratio Test Statistic (k=8) Homoscedasticity Assumption': 0.03698431520284624},\n {'Variance Ratio (k=10)': 1.0007024101299271,\n  'Variance Ratio Test Statistic (k=10) Heteroscedasticity Assumption': 0.2077273579781436,\n  'Variance Ratio Test Statistic (k=10) Homoscedasticity Assumption': 0.20803582207648225},\n {'Variance Ratio (k=15)': 1.0022173139633859,\n  'Variance Ratio Test Statistic (k=15) Heteroscedasticity Assumption': 0.521306589715623,\n  'Variance Ratio Test Statistic (k=15) Homoscedasticity Assumption': 0.5219816274022102},\n {'Variance Ratio (k=20)': 1.003804866170505,\n  'Variance Ratio Test Statistic (k=20) Heteroscedasticity Assumption': 0.7646392343979235,\n  'Variance Ratio Test Statistic (k=20) Homoscedasticity Assumption': 0.7655801985572465},\n {'Variance Ratio (k=30)': 1.0054447472916037,\n  'Variance Ratio Test Statistic (k=30) Heteroscedasticity Assumption': 0.8819247138934212,\n  'Variance Ratio Test Statistic (k=30) Homoscedasticity Assumption': 0.8829960534693014},\n {'Variance Ratio (k=40)': 1.007383025302277,\n  'Variance Ratio Test Statistic (k=40) Heteroscedasticity Assumption': 1.0290210221871228,\n  'Variance Ratio Test Statistic (k=40) Homoscedasticity Assumption': 1.0303005120741011},\n {'Variance Ratio (k=50)': 1.0086502431826903,\n  'Variance Ratio Test Statistic (k=50) Heteroscedasticity Assumption': 1.0741834484206978,\n  'Variance Ratio Test Statistic (k=50) Homoscedasticity Assumption': 1.0755809312730416},\n {'Variance Ratio (k=100)': 1.0153961901671607,\n  'Variance Ratio Test Statistic (k=100) Heteroscedasticity Assumption': 1.341511635554299,\n  'Variance Ratio Test Statistic (k=100) Homoscedasticity Assumption': 1.3434284573260966},\n {'Variance Ratio (k=200)': 1.015704654116103,\n  'Variance Ratio Test Statistic (k=200) Heteroscedasticity Assumption': 0.9639231633966341,\n  'Variance Ratio Test Statistic (k=200) Homoscedasticity Assumption': 0.9653299929053236},\n {'Variance Ratio (k=500)': 1.018216620766853,\n  'Variance Ratio Test Statistic (k=500) Heteroscedasticity Assumption': 0.7055679685728111,\n  'Variance Ratio Test Statistic (k=500) Homoscedasticity Assumption': 0.7065863036900603},\n {'Variance Ratio (k=1000)': 1.0187822241562867,\n  'Variance Ratio Test Statistic (k=1000) Heteroscedasticity Assumption': 0.5140697633208364,\n  'Variance Ratio Test Statistic (k=1000) Homoscedasticity Assumption': 0.5147582201029187}]\nIt’s easy to see that at all lags tested, we cannot reject the null hypothesis that this price series follows a random walk.\nFor comparison purpose, below is an implementation in pure Python. It is more readable but is significantly slower.\ndef estimate_python(data, k=5):\n    \"A slow pure python implementation\"\n    prices = data['Price'].to_numpy(dtype=np.float64)\n    log_prices = np.log(prices)\n    rets = np.diff(log_prices)\n    T = len(rets)\n    mu = np.mean(rets)\n    var_1 = np.var(rets, ddof=1, dtype=np.float64)\n    rets_k = (log_prices - np.roll(log_prices, k))[k:]\n    m = k * (T - k + 1) * (1 - k / T)\n    var_k = 1/m * np.sum(np.square(rets_k - k * mu))\n\n    # Variance Ratio\n    vr = var_k / var_1\n    # Phi1\n    phi1 = 2 * (2*k - 1) * (k-1) / (3*k*T)\n    # Phi2\n\n    def delta(j):\n        res = 0\n        for t in range(j+1, T+1):\n            t -= 1  # array index is t-1 for t-th element\n            res += np.square((rets[t]-mu)*(rets[t-j]-mu))\n        return res / ((T-1) * var_1)**2\n\n    phi2 = 0\n    for j in range(1, k):\n        phi2 += (2*(k-j)/k)**2 * delta(j)\n\n    return vr, (vr - 1) / np.sqrt(phi1), (vr - 1) / np.sqrt(phi2)"
  },
  {
    "objectID": "posts/merger-acquisition-deals-from-sdc-platinum/index.html",
    "href": "posts/merger-acquisition-deals-from-sdc-platinum/index.html",
    "title": "Download M&A Deals from SDC Platinum",
    "section": "",
    "text": "Warning\n\n\n\nThe standalone SDC Platinum PC executable has been replaced by LSEG (Refinitiv) Workspace. This post is no longer relevant. The new Workspace is much more efficient.\nThomson One Banker SDC Platinum database provides comprehensive M&A transaction data from early 1980s, and is perhaps the most widely used M&A database in the world.\nThis post documents the steps of downloading M&A deals from the SDC Platinum database. Specifically, I show how to download the complete M&A data where:"
  },
  {
    "objectID": "posts/merger-acquisition-deals-from-sdc-platinum/index.html#interface-of-sdc-platinum",
    "href": "posts/merger-acquisition-deals-from-sdc-platinum/index.html#interface-of-sdc-platinum",
    "title": "Download M&A Deals from SDC Platinum",
    "section": "Interface of SDC Platinum",
    "text": "Interface of SDC Platinum\nThe screenshot below is the interface we’ll see on launch of SDC Platinum. Click on Login and we’ll be asked to enter our initials and a project name for billing purpose.\n\n\n\nSDC interface\n\n\nClick on Login and you’ll be asked to enter your initials and a project name for billing purpose."
  },
  {
    "objectID": "posts/merger-acquisition-deals-from-sdc-platinum/index.html#database-selection",
    "href": "posts/merger-acquisition-deals-from-sdc-platinum/index.html#database-selection",
    "title": "Download M&A Deals from SDC Platinum",
    "section": "Database Selection",
    "text": "Database Selection\nSince we’re interested in M&A deals, select the Mergers & Acquisitions tab and check US Targets, so that we’ll be searching in the domestic mergers database.\n\n\n\nSDC database selection\n\n\nThen select the sample period, e.g. for the entire 2020 calendar year.\n\n\n\nSDC deal date"
  },
  {
    "objectID": "posts/merger-acquisition-deals-from-sdc-platinum/index.html#apply-filters-on-ma-deals",
    "href": "posts/merger-acquisition-deals-from-sdc-platinum/index.html#apply-filters-on-ma-deals",
    "title": "Download M&A Deals from SDC Platinum",
    "section": "Apply Filters on M&A Deals",
    "text": "Apply Filters on M&A Deals\nNow we can apply various filters on the M&A deals we want to download.\n\n\n\nSDC search items\n\n\nWe can quickly add some filters on the target’s and acquiror’s nation, and make sure we check the Action to be Select not Exclude. Under the Deal tab, we set the deal value to be at least $1m.\n\n\n\nSDC deal value\n\n\nIn case we couldn’t find the desired filtering variable, we can head to All Items tab and search manually. We add restrictions on acquiror and target public status here.\n\n\n\nSDC search all\n\n\nLastly, for the Form of the Deal, we restrict to A Acquisition (Stock), M Merger (Stock or Assets) and AM Acquisition of Majority Interest (Stock). We do not want to include deals that are acquisition of partial interest, recapitalization or repurchases in this case.\nOur search requests should now look like below. Strongly recommended saving this session for later reuse.\n\n\n\nSDC all filters"
  },
  {
    "objectID": "posts/merger-acquisition-deals-from-sdc-platinum/index.html#specify-deal-variables-to-download",
    "href": "posts/merger-acquisition-deals-from-sdc-platinum/index.html#specify-deal-variables-to-download",
    "title": "Download M&A Deals from SDC Platinum",
    "section": "Specify Deal Variables to Download",
    "text": "Specify Deal Variables to Download\nOur effort so far is only shortlisting the M&A deals that we’re interested in. We now need to specify the relevant deal variables to download by creating a new custom report.\n\n\n\nSDC custom report\n\n\nAs before, we can check those variables in the Basics tab or search under All Items tab. Once done, we format the report like below by arranging the order of the variables. This order is preserved when exported to spreadsheet. One note here is that each page has a maximum width of 160, so we need to insert page at proper places. It does not affect the layout of output spreadsheet. It also recommended to save the custom report for later reuse.\n\n\n\nSDC custom report items\n\n\nFinally, it’s time to execute the requests and download the M&A deal data.\n\n\n\nSDC deals download"
  },
  {
    "objectID": "posts/merger-acquisition-deals-from-sdc-platinum/index.html#final-note",
    "href": "posts/merger-acquisition-deals-from-sdc-platinum/index.html#final-note",
    "title": "Download M&A Deals from SDC Platinum",
    "section": "Final Note",
    "text": "Final Note\nAs a final remark, the downloaded spreadsheet can be imported into SAS and matched with CRSP/Compustat using CUSIP and Ticker (SDC doesn’t have permno or gvkey). First, merge the SDC CUSIP with the first 6-digit CUSIP in CRSP or Compustat; if no match, then use SDC Primary Ticker Symbol to match with the ticker symbol in CRSP or Compustat."
  },
  {
    "objectID": "posts/minimum-variance-hedge-ratio/index.html",
    "href": "posts/minimum-variance-hedge-ratio/index.html",
    "title": "Minimum Variance Hedge Ratio",
    "section": "",
    "text": "This note briefly explains what’s the minimum variance hedge ratio and how to derive it in a cross hedge, where the asset to be hedged is not the same as underlying asset."
  },
  {
    "objectID": "posts/minimum-variance-hedge-ratio/index.html#the-hedge-ratio-h",
    "href": "posts/minimum-variance-hedge-ratio/index.html#the-hedge-ratio-h",
    "title": "Minimum Variance Hedge Ratio",
    "section": "The Hedge Ratio \\(h\\)",
    "text": "The Hedge Ratio \\(h\\)\nThe hedge ratio \\(h\\) is the ratio of the size of the hedging position to the exposure of the asset to be hedged:\n\n\\(N_A\\): the units of asset held to be hedged (\\(A\\)), i.e. the risk exposure.\n\\(N_F\\): the units of the underlying asset hedged with futures (\\(A'\\)).\n\nNote that the underlying asset \\(A'\\) may not be the same as the asset to be hedged \\(A\\).\nIn a cross hedge, the underlying of the futures is different from the asset to be hedge.\n\n\n\\[\nh=\\frac{N_F}{N_A}=\\frac{\\text{size of hedging position}}{\\text{size of exposure}}\n\\]\nApparently, if we vary \\(h\\), the variance (risk) of the combined hedged position will also change."
  },
  {
    "objectID": "posts/minimum-variance-hedge-ratio/index.html#the-optimal-minimum-variance-hedge-ratio-h",
    "href": "posts/minimum-variance-hedge-ratio/index.html#the-optimal-minimum-variance-hedge-ratio-h",
    "title": "Minimum Variance Hedge Ratio",
    "section": "The (Optimal) Minimum-Variance Hedge Ratio \\(h^*\\)",
    "text": "The (Optimal) Minimum-Variance Hedge Ratio \\(h^*\\)\nOur objective in hedging is to manage the variance (risk) of our position, making it as low as possible by setting the hedge ratio \\(h\\) to be the optimal hedge ratio \\(h^*\\) that minimises the variance of the combined hedged position.\n\nHedge where \\(A'=A\\)\nIt’s relatively easy when the underlying asset of the futures (\\(A'\\)) is the same as the asset to be hedged (\\(A\\)), as they have a perfect correlation and the same variance. Thus, as long as the hedge ratio \\(h=1\\), where the size of hedging position equals the exposure of the asset held, the perfect correlation and same variance ensure the value changes in the hedging position offset the changes in the value of asset to be hedged, so that the variance of the hedged position is minimum at zero (ignoring other basis risks). This means, the optimal minimum-variance hedge ratio \\(h^*=1\\).\n\n\nCross Hedge where \\(A' \\neq A\\)\nWhen the underlying asset of the futures (\\(A'\\)) differ from asset to be hedged (\\(A\\)), the optimal hedge ratio \\(h^*\\) that minimises the portfolio variance is not necessarily 1 anymore.\nLet’s now derive \\(h^*\\).\n\n\\(S_t\\): the spot price of the asset to be hedged at time \\(t=1,2\\).\n\\(F_t\\): the price of the futures at time \\(t=1,2\\).\n\\(\\sigma_S\\): the standard deviation of \\(\\Delta S=S_2 - S_1\\).\n\\(\\sigma_F\\): the standard deviation of \\(\\Delta F=F_2 - F_1\\).\n\\(\\rho\\): the correlation coefficient between \\(\\Delta S\\) and \\(\\Delta F\\).\n\nLet’s consider a short hedge, where we long \\(S_t\\) and short \\(h\\times\nF_t\\), hence：\n\nCombined position \\(C=S_t-h\\times F_t\\)\n\\(\\Delta C=\\Delta S_t-h\\times \\Delta F_t\\)\n\nThe optimal hedge ratio \\(h^*\\) is the hedge ratio that minimises the variance of \\(\\Delta C\\).\n\\[\nh^* =\\underset{h}{\\operatorname{argmin}} \\text{Var}(\\Delta C)\n=\\underset{h}{\\operatorname{argmin}} \\text{Var}(\\Delta S_t-h\\times \\Delta F_t)\n\\]\nWe also know that\n\\[\n\\text{Var}(\\Delta S_t-h\\times \\Delta F_t) = \\sigma^2_S + h^2\\sigma^2_F -\n2h(\\rho \\sigma_S \\sigma_F)\n\\]\nTo minimise the variance, the first-order condition (FOC) is that\n\\[\n\\frac{\\partial \\text{Var}(\\Delta C)}{\\partial h}=2h\\sigma^2_F-2(\\rho \\sigma_S\n\\sigma_F)=0\n\\]\nThe optimal hedge ratio \\(h^*\\) is the \\(h\\) that solves the FOC above. Therefore,\n\\[\nh^* = \\rho \\frac{\\sigma_S}{\\sigma_F}\n\\]"
  },
  {
    "objectID": "posts/minimum-variance-hedge-ratio/index.html#intuition",
    "href": "posts/minimum-variance-hedge-ratio/index.html#intuition",
    "title": "Minimum Variance Hedge Ratio",
    "section": "Intuition",
    "text": "Intuition\nThe optimal hedge ratio \\(h^*\\) describes the optimal \\(N_F/N_A\\), so that the optimal size of the hedging position:\n\\[\nN_F^* = h^* \\times N_A\n\\]\n\nIf \\(F\\) changes by 1%, \\(S\\) is expected to change by \\(h^*\\)%.\nIf \\(S\\) changes by 1%, \\(F\\) is expected to change by \\((1/h^*)\\)%.\n\nIf \\(\\rho=1\\) and \\(\\sigma_F=\\sigma_S\\), then \\(h^*=1\\):\n\n\\(F\\) and \\(S\\) always change in the same way by the same size.\nHolding the same amount of \\(F\\) as \\(S\\) gives the perfect hedge.\n\nIf \\(\\rho=1\\) and \\(\\sigma_F=2\\sigma_S\\), then \\(h^*=0.5\\):\n\n\\(F\\) always changes twice as much as \\(S\\).\nHolding half as much of \\(F\\) as \\(S\\) gives the perfect hedge.\n\nIf \\(\\rho&lt;1\\), then \\(h^*\\) depends on \\(\\rho\\) and \\({\\sigma_S}/{\\sigma_F}\\):\n\n\\(F\\) is expected to change by \\((1/h^*)\\)% when \\(S\\) changes by 1%.\nHolding \\(h^*\\) as much of \\(F\\) as \\(S\\) gives an imperfect hedge where the value of the hedging position is expected to offset the change in \\(S\\)."
  },
  {
    "objectID": "posts/phds.io/index.html",
    "href": "posts/phds.io/index.html",
    "title": "PhDs.io",
    "section": "",
    "text": "A fast literature search engine.\n\n\n\nGive it a try: PhDs.io."
  },
  {
    "objectID": "posts/phds.io/index.html#why-i-created-phds.io",
    "href": "posts/phds.io/index.html#why-i-created-phds.io",
    "title": "PhDs.io",
    "section": "Why I created PhDs.io",
    "text": "Why I created PhDs.io\nWhen I first started my PhD study, one of the biggest challenges I faced was navigating the sheer volume of research papers in finance and related fields. It’s easy to feel overwhelmed when there are thousands of papers published every year. The time spent searching for quality references, vetting sources, and organizing findings can feel like a second job on top of research and teaching.\nThat’s where the idea for PhDs.io came from. I wanted to create a platform where finance researchers—whether they’re PhD students just starting out or seasoned academics—can find and access high-quality research without the headache. I envisioned a tool that makes it easy to discover research papers across finance, economics, accounting, and related fields.\nBut this project isn’t just for me or my peers. I also want to support the next generation of researchers who may not have the same level of experience. PhDs.io is my way of giving back to the community—creating something that can help those navigating the often confusing world of academic research.\nAs for the future, my vision for PhDs.io goes beyond a mere repository of papers. I see it growing into a platform that offers personalized recommendations, connects researchers with similar interests, and even provides collaborative tools for teams working on interdisciplinary projects. It’s an ambitious goal, but one that I believe can make a meaningful impact in our field.\nThis journey isn’t something I can do alone. The platform is currently supported by my own contributions, but as it expands, I hope others will see the value in what we’re building here and join the effort. Whether through financial support, collaborations, or just spreading the word, every little bit helps us move toward a better research experience for everyone."
  },
  {
    "objectID": "posts/phds.io/index.html#this-post",
    "href": "posts/phds.io/index.html#this-post",
    "title": "PhDs.io",
    "section": "This post",
    "text": "This post\nIn what follows, I explain a little bit of the development of PhDs.io, in case someone would like to build a similar or even better project.\n\nThis project is built with KerkoApp, a web application that uses Kerko to provide a user-friendly search and browsing interface for sharing a bibliography managed with the Zotero reference manager.\nKerkoApp is built in Python with the Flask framework. It is just a thin container around Kerko and, as such, inherits most of its features directly from Kerko. However, it adds support for TOML configuration files, allowing a good separation of configuration from code.\n\nIn summary, I and my awesome contributors collectively maintain a Zotero group library. We collect and organize high-quality research papers from within Zotero, which is then synced to my server that runs Kerko to serve the website to the public."
  },
  {
    "objectID": "posts/phds.io/index.html#deployment",
    "href": "posts/phds.io/index.html#deployment",
    "title": "PhDs.io",
    "section": "Deployment",
    "text": "Deployment\n\nWebsite\nStart with a fresh AWS EC2 instance. I’m using an ARM-based t4g.small running Ubuntu 24.04 LTS.\nsudo apt update\nInstall pip and venv.\nsudo apt install python3-pip python3-venv\nFollow the deployment guide of kerko.\n\n\n\n\n\n\nNote\n\n\n\nI use a modified version of kerkoapp. So I install my fork not the original one. Use the following instead.\ngit clone https://github.com/mgao6767/phds.io.git ~/kerkoapp\n\n\n\n\nEnable SSL\nUse Let’s Encrypt to obtain a free SSL certificate and configure Nginx to use it.\nInstall Certbot and its Nginx plugin to automate SSL certificate generation.\nsudo apt update\nsudo apt install certbot python3-certbot-nginx\nRun Certbot to get a certificate for the domain.\nsudo certbot --nginx -d phds.io\nCertbot will automatically configure Nginx to use SSL. Once Certbot has finished, verify Nginx configuration to ensure there are no errors.\nsudo nginx -t\nIf everything is correct, reload Nginx:\nsudo systemctl reload nginx\nLet’s Encrypt certificates expire after 90 days, but Certbot takes care of the renewal automatically. Check the Certbot renewal process with:\nsudo certbot renew --dry-run\nThis tests the automatic renewal without actually renewing the certificate."
  },
  {
    "objectID": "posts/phds.io/index.html#rate-limit-and-ip-blocking",
    "href": "posts/phds.io/index.html#rate-limit-and-ip-blocking",
    "title": "PhDs.io",
    "section": "Rate limit and IP blocking",
    "text": "Rate limit and IP blocking\n\nEnable rate limiting in Nginx\nNginx has built-in support for rate limiting based on IP addresses. This can help prevent individual users from overwhelming the server with too many requests in a short period.\nsudo vim /etc/nginx/sites-available/kerkoapp.conf\nAdd the following in the http block:\nhttp {\n    # Rate limiting: limit each IP to 5 requests per second with a burst of 12 requests.\n    limit_req_zone $binary_remote_addr zone=ip:10m rate=5r/s;\n    \n    server {\n        listen 80;\n        server_name phds.io;\n\n        location / {\n            # Apply rate limiting to all requests under this location\n            limit_req zone=ip burst=12 delay=8;\n\n            # Other configurations, such as proxy_pass, root, etc.\n            ...\n        }\n    }\n}\n\n\nFail2Ban for IP blocking\nWhile Nginx’s rate limiting helps to slow down abusive clients, use Fail2Ban to ban IPs that continuously exceed rate limits by monitoring Nginx logs.\nsudo apt install fail2ban\nNext, create a configuration file for Nginx rate limit monitoring. Open /etc/fail2ban/jail.local:\nsudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local\nsudo vim /etc/fail2ban/jail.local\nEnable nginx-limit-req.\n[nginx-limit-req]\nenabled = true\nport    = http,https\nlogpath = %(nginx_error_log)s\nEdit the filter file for Fail2Ban if necessary:\nsudo vim /etc/fail2ban/filter.d/nginx-limit-req.conf\nRestart Fail2Ban to apply the changes:\nsudo service fail2ban restart\nCheck Fail2ban logs:\ntail -f /var/log/fail2ban.log\nManual jail (ban forever). In filer.d/manual.conf:\n[Definition]\nfailregex = \nignoreregex = \nIn jail.d/custom.conf:\n[manual]\nbanaction = %(banaction_allports)s\nbantime = -1\nenabled = true\nTo ban an ip:\nfail2ban-client set manual banip 11.22.33.44"
  },
  {
    "objectID": "posts/python-shared-memory-in-multiprocessing/index.html",
    "href": "posts/python-shared-memory-in-multiprocessing/index.html",
    "title": "Python Shared Memory in Multiprocessing",
    "section": "",
    "text": "Python 3.8 introduced a new module multiprocessing.shared_memory that provides shared memory for direct access across processes. My test shows that it significantly reduces the memory usage, which also speeds up the program by reducing the costs of copying and moving things around.1"
  },
  {
    "objectID": "posts/python-shared-memory-in-multiprocessing/index.html#test",
    "href": "posts/python-shared-memory-in-multiprocessing/index.html#test",
    "title": "Python Shared Memory in Multiprocessing",
    "section": "Test",
    "text": "Test\nIn this test, I generated a 240MB numpy.recarray from a pandas.DataFrame with datetime, int and str typed columns. I used numpy.recarray because it can preserve the dtype of each column, so that later I can reconstruct the same array from the buffer of shared memory.\nI performed a simple numpy.nansum on the numeric column of the data using two methods. The first method uses multiprocessing.shared_memory where the 4 spawned processes directly access the data in the shared memory. The second method passes the data to the spawned processes, which effectively means each process will have a separate copy of the data.\n\nTest Result\n\n\n\nTest result\n\n\nA quick run of the test code below shows that the first method based on shared_memory uses minimal memory (peak usage is 0.33MB) and is much faster (2.09s) than the second one where the entire data is copied and passed into each process (peak memory usage of 1.8G and takes 216s). More importantly, the memory usage under the second method is consistently high.\n\n\nTest Code\nfrom multiprocessing.shared_memory import SharedMemory\nfrom multiprocessing.managers import SharedMemoryManager\nfrom concurrent.futures import ProcessPoolExecutor, as_completed\nfrom multiprocessing import current_process, cpu_count, Process\nfrom datetime import datetime\nimport numpy as np\nimport pandas as pd\nimport tracemalloc\nimport time\n\n\ndef work_with_shared_memory(shm_name, shape, dtype):\n    print(f'With SharedMemory: {current_process()=}')\n    # Locate the shared memory by its name\n    shm = SharedMemory(shm_name)\n    # Create the np.recarray from the buffer of the shared memory\n    np_array = np.recarray(shape=shape, dtype=dtype, buf=shm.buf)\n    return np.nansum(np_array.val)\n\n\ndef work_no_shared_memory(np_array: np.recarray):\n    print(f'No SharedMemory: {current_process()=}')\n    # Without shared memory, the np_array is copied into the child process\n    return np.nansum(np_array.val)\n\n\nif __name__ == \"__main__\":\n    # Make a large data frame with date, float and character columns\n    a = [\n        (datetime.today(), 1, 'string'),\n        (datetime.today(), np.nan, 'abc'),\n    ] * 5000000\n    df = pd.DataFrame(a, columns=['date', 'val', 'character_col'])\n    # Convert into numpy recarray to preserve the dtypes \n1    np_array = df.to_records(index=False, column_dtypes={'character_col': 'S6'})\n    del df\n    shape, dtype = np_array.shape, np_array.dtype\n    print(f\"np_array's size={np_array.nbytes/1e6}MB\")\n\n    # With shared memory\n    # Start tracking memory usage\n    tracemalloc.start()\n    start_time = time.time()\n    with SharedMemoryManager() as smm:\n        # Create a shared memory of size np_arry.nbytes\n        shm = smm.SharedMemory(np_array.nbytes)\n        # Create a np.recarray using the buffer of shm\n        shm_np_array = np.recarray(shape=shape, dtype=dtype, buf=shm.buf)\n        # Copy the data into the shared memory\n        np.copyto(shm_np_array, np_array)\n        # Spawn some processes to do some work\n        with ProcessPoolExecutor(cpu_count()) as exe:\n            fs = [exe.submit(work_with_shared_memory, shm.name, shape, dtype)\n                  for _ in range(cpu_count())]\n            for _ in as_completed(fs):\n                pass\n    # Check memory usage\n    current, peak = tracemalloc.get_traced_memory()\n    print(f\"Current memory usage {current/1e6}MB; Peak: {peak/1e6}MB\")\n    print(f'Time elapsed: {time.time()-start_time:.2f}s')\n    tracemalloc.stop()\n\n    # Without shared memory\n    tracemalloc.start()\n    start_time = time.time()\n    with ProcessPoolExecutor(cpu_count()) as exe:\n        fs = [exe.submit(work_no_shared_memory, np_array)\n              for _ in range(cpu_count())]\n        for _ in as_completed(fs):\n            pass\n    # Check memory usage\n    current, peak = tracemalloc.get_traced_memory()\n    print(f\"Current memory usage {current/1e6}MB; Peak: {peak/1e6}MB\")\n    print(f'Time elapsed: {time.time()-start_time:.2f}s')\n    tracemalloc.stop()\n\n1\n\nCheck the note below for preventing segfault."
  },
  {
    "objectID": "posts/python-shared-memory-in-multiprocessing/index.html#note-on-segfault",
    "href": "posts/python-shared-memory-in-multiprocessing/index.html#note-on-segfault",
    "title": "Python Shared Memory in Multiprocessing",
    "section": "Note on Segfault",
    "text": "Note on Segfault\n\n\n\n\n\n\nWarning\n\n\n\nA very important note about using multiprocessing.shared_memory, as at June 2020, is that the numpy.ndarray cannot have a dtype=dtype('O'). That is, the dtype cannot be dtype(object). If it is, there will be a segmentation fault when child processes try to access the shared memory and dereference it. It happens when the column contains strings.\n\n\nTo solve this problem, you need to specify the dtype in df.to_records(). For example:\nnp_array = df.to_records(index=False，column_dtypes={'character_col': 'S6'})\nHere, we specify that character_col contains strings of length 6. If it contains Unicode, we can use 'U6' instead. Longer strings will then be truncated at the specified length. As such, there won’t be anymore segfault."
  },
  {
    "objectID": "posts/reconciliation-of-black-scholes-variants/index.html",
    "href": "posts/reconciliation-of-black-scholes-variants/index.html",
    "title": "Reconciliation of Black-Scholes Variants",
    "section": "",
    "text": "This note is just to show that the different variants of Black-Scholes formula in textbook and tutorial solutions are in fact the same."
  },
  {
    "objectID": "posts/reconciliation-of-black-scholes-variants/index.html#variant-1",
    "href": "posts/reconciliation-of-black-scholes-variants/index.html#variant-1",
    "title": "Reconciliation of Black-Scholes Variants",
    "section": "Variant 1",
    "text": "Variant 1\nThis is the one shown in our formula sheet, and is also the traditional presentation of Black-Scholes model.\n\\[\n\\begin{equation}\nC=SN(d_1)-N(d_2)Ke^{-r_f t}\n\\end{equation}\n\\tag{1}\\]\n\\[\n\\begin{equation}\nd_1=\\frac{ln(\\frac{S}{K})+(r_f+\\frac{\\sigma^2}{2})t}{\\sigma \\sqrt{t}}\n\\end{equation}\n\\tag{2}\\]\n\\[\n\\begin{equation}\nd_2=d_1 - \\sigma \\sqrt{t}\n\\end{equation}\n\\tag{3}\\]"
  },
  {
    "objectID": "posts/reconciliation-of-black-scholes-variants/index.html#variant-2",
    "href": "posts/reconciliation-of-black-scholes-variants/index.html#variant-2",
    "title": "Reconciliation of Black-Scholes Variants",
    "section": "Variant 2",
    "text": "Variant 2\nThis one comes from textbook, and looks slightly different in that \\(PV(K)\\) replaces \\(K\\) in the natural logarithm.\n\\[\n\\begin{equation}\nC=SN(d_1)-N(d_2)PV(K)\n\\end{equation}\n\\tag{4}\\]\n\\[\n\\begin{equation}\nd_1=\\frac{ln(\\frac{S}{PV(K)})}{\\sigma \\sqrt{t}}+\\frac{\\sigma \\sqrt{t}}{2}\n\\end{equation}\n\\tag{5}\\]\n\\[\n\\begin{equation}\nd_2=d_1 - \\sigma \\sqrt{t}\n\\end{equation}\n\\tag{6}\\]\nHowever, it’s in fact easy to show that \\(d_1\\) in Equation 5 is the same as in Equation 2: Under continuous compounding, \\(PV(K)=Ke^{-r_f t}\\):\n\\[\n\\begin{align}\nd_1 &=\\frac{ln(\\frac{S}{PV(K)})}{\\sigma \\sqrt{t}}+\\frac{\\sigma \\sqrt{t}}{2}\\newline\n&=\\frac{ln(\\frac{S}{Ke^{-r_f t}})}{\\sigma \\sqrt{t}} +\\frac{\\frac{\\sigma^2}{2}t}{\\sigma \\sqrt{t}}\\newline\n&=\\frac{ln(\\frac{S}{Ke^{-r_f t}})+\\frac{\\sigma^2}{2}t}{\\sigma \\sqrt{t}}\\newline\n&=\\frac{ln(\\frac{S}{K})+r_f t+\\frac{\\sigma^2}{2}t}{\\sigma \\sqrt{t}}\\newline\n&=\\frac{ln(\\frac{S}{K})+(r_f+\\frac{\\sigma^2}{2})t}{\\sigma \\sqrt{t}}\n\\end{align}\n\\]\nTherefore, the two variants are effectively the same under continuous compounding."
  },
  {
    "objectID": "posts/stata/introduction/index.html",
    "href": "posts/stata/introduction/index.html",
    "title": "Stata - Introduction",
    "section": "",
    "text": "Stata is a powerful statistical analysis software that we often use in empirical researches. This series of posts aims to provide some basic knowledge for junior researchers to get started with Stata, as well as some personal tips on more efficiently using Stata in research projects.1",
    "crumbs": [
      "Stata Workshop",
      "Stata - Introduction"
    ]
  },
  {
    "objectID": "posts/stata/introduction/index.html#stata-gui",
    "href": "posts/stata/introduction/index.html#stata-gui",
    "title": "Stata - Introduction",
    "section": "Stata GUI",
    "text": "Stata GUI\nThe Graphical User Interface (GUI) of Stata looks like this:\n\n\n\nGUI of Stata\n\n\nThis is the default layout of Stata 16. Some preset preferences can be found via menu option Edit&gt;Preferences&gt;Load preference set. You can also save your personal preferences (color theme, layout, etc.) in the Edit&gt;Preference menu.\nOf the many windows of the GUI, we are mostly interested in the Results window (Ctrl+2) where outputs are displayed. While all other windows can be hidden or closed, the Results window always remains center of the GUI.\nThe Command window (Ctrl+1) is where we mostly interact with Stata by entering Stata commands. Since usually we need a group of commands to complete a task, it is a good idea to place them together in a do file (with the extension .do), which is the file type native to Stata, just like .py file to Python. Later, we will introduce the Stata’s Do Editor (Ctrl+9) as a nice editor for .do files.\n\n\n\n\n\n\nTip\n\n\n\nAs a researcher, keeping good record of the programs and codes used is a merit. For oneself, it boosts productivity as more codes are accumulated. Beyond that, it ensures all results can be replicated even years later. Nowadays, more and more top journals also require submission of the codes used in the paper.",
    "crumbs": [
      "Stata Workshop",
      "Stata - Introduction"
    ]
  },
  {
    "objectID": "posts/stata/introduction/index.html#basic-demonstration",
    "href": "posts/stata/introduction/index.html#basic-demonstration",
    "title": "Stata - Introduction",
    "section": "Basic demonstration",
    "text": "Basic demonstration\nNow let’s start tying our first Stata command in the Command window.\n\nWorking directory\nFirst, let’s type pwd (and hit Eneter), which is a command to display the current working directory. Knowing the current working directory, for example, allows you to use relative path correctly.\nThroughout this series, I’ll follow the tradition and prefix all Stata commands with ., hence . pwd meaning “enter the pwd command in the Command window”:\n. pwd\nFrom the Results window, we can see a line of text like “C:”, which is the output of executing the pwd command, i.e., the current working directory of Stata on my PC.\nWe can change the current working directory to another directory on the computer via the command cd, for example:\n. cd \"C:\\Users\\mgao\\Dropbox (Sydney Uni)\\BUSS7902 Stata\"\nThen we can verify that it’s indeed changed by pwd again.\n\n\nStructure of a Stata command\nThe above two examples (pwd and cd) already showcase the basic syntax structure of Stata commands. With a few exceptions, a Stata command is like:\n. _commmand_ _parameter1_ _parameter2_ ... , _options_\nor technically,\n\ncmd [varlist | namelist | anything] [if] [in] [using filename] [= exp] [weight] [, options]\n\nwhere cmd is the name of a command and everything in [ ] is optional.\n\n\n\n\n\n\nTip\n\n\n\nYou can use . help syntax to see more detailed explanation.\nIn fact, Stata’s help files are so comprehensive that 99.99% of the time you should simply refer to the help files instead of Googling around…\n\n\n\n\nSome other quick examples\ndisplay prints a message to the Results window:\n. display \"hello world!\"\ncls clears the Results window:\n. cls\nclear clears memory, removing the dataset loaded, if any:\n. clear\nlog echos a copy of the session to file:\nCreate a log file name stata101.log in the current working directory. The replace option asks Stata to replace the log file if it already exists. Until . log close, everything displayed in Results will be saved in the log file.\n. log using \"stata101.log\", replace\n. display \"hello from Mingze\"\n. log close\ncmdlog is similar to log but records only the commands but no results.",
    "crumbs": [
      "Stata Workshop",
      "Stata - Introduction"
    ]
  },
  {
    "objectID": "posts/stata/introduction/index.html#what-about-regression",
    "href": "posts/stata/introduction/index.html#what-about-regression",
    "title": "Stata - Introduction",
    "section": "What about regression?",
    "text": "What about regression?\nOf course, Stata is famous for its superior statistical analysis. Let’s see how regressions can be easily done in Stata.\n\nLoad dataset\nWe start by loading an example dataset that comes with Stata installation. This can be done via sysuse command. We use the dataset named “auto”:\n. sysuse auto\n\n\n\n\n\n\nTip\n\n\n\nStata comes with several builtin datasets. Use . sysuse dir to have a look.\nMore generally, we can use our own datasets. We’ll see more on this later.\n\n\nWe can now ask Stata to describe the meta information of the dataset and summarize the variables in terms of number of observations, mean, standard deviation, etc.\nThe screenshot below shows the output:\n\n\n\nsysuse_auto\n\n\nEnlarge the output of describe:\n. describe\n\nContains data from C:\\Program Files\\Stata16\\ado\\base/a/auto.dta\n  obs:            74                          1978 Automobile Data\n vars:            12                          13 Apr 2018 17:45\n                                              (_dta has notes)\n--------------------------------------------------------------------------------\n              storage   display    value\nvariable name   type    format     label      variable label\n--------------------------------------------------------------------------------\nmake            str18   %-18s                 Make and Model\nprice           int     %8.0gc                Price\nmpg             int     %8.0g                 Mileage (mpg)\nrep78           int     %8.0g                 Repair Record 1978\nheadroom        float   %6.1f                 Headroom (in.)\ntrunk           int     %8.0g                 Trunk space (cu. ft.)\nweight          int     %8.0gc                Weight (lbs.)\nlength          int     %8.0g                 Length (in.)\nturn            int     %8.0g                 Turn Circle (ft.)\ndisplacement    int     %8.0g                 Displacement (cu. in.)\ngear_ratio      float   %6.2f                 Gear Ratio\nforeign         byte    %8.0g      origin     Car type\n--------------------------------------------------------------------------------\nSorted by: foreign\n\n\nRun regression\nSuppose we’d like to estimate a simple liner regression to study the relation between car price and mileage, headroom and weight:\n\\[\nprice = \\alpha + \\beta_1 mpg + \\beta_2 headroom + \\beta_3 weight + \\varepsilon\n\\]\nAll we need to do is a simple line of code,\n. regress price mpg headroom weight\nwhich would generate the following estimation results:\n\n\n\nreg_price\n\n\n\n\nSave results\nOne of the coolest things Stata can do is to export the tabulated regression results to Microsoft Word, PDF, LaTeX and more.\n\nSave to Word\nFor example, we can save the previous results (as shown in the screenshot above) to a Word document named “table1” (table1.docx) easily with the following three lines of codes.\n. putdocx begin\n. putdocx table mytable = etable\n. putdocx save table1.docx, replace\nBehind the scene, Stata creates a .docx to work with. putdocx table command creates a new table (mytable) in the .docx file containing estimation results (etable tells it to tabulates the coefficients from previous estimation). Lastly, Stata saves the .docx file as “table1.docx” in the current working directory.\n\n\n\nputdocx\n\n\n\n\nSave to LaTeX\nIf working with LaTeX, you can export results as TeX files conveniently too.\nFor this purpose, though, an additional Stata package estout is required. Personally I’d say this is gold. You can install estout package via a single command in Stata:\n. ssc install estout, replace\nNow, you can use the following two lines of codes:\n. eststo: regress price mpg headroom weight\n. esttab using \"table1.tex\", tex replace label star(* 0.10 ** 0.05 *** 0.01) nogaps compress\nto produce a TeX file (“table1.tex”) with the following content:\n{\n\\def\\sym#1{\\ifmmode^{#1}\\else\\(^{#1}\\)\\fi}\n\\begin{tabular}{l*{1}{c}}\n\\hline\\hline\n                &\\multicolumn{1}{c}{(1)}\\\\\n                &\\multicolumn{1}{c}{Price}\\\\\n\\hline\nMileage (mpg)   &   -56.19         \\\\\n                &  (-0.66)         \\\\\nHeadroom (in.)  &   -675.6\\sym{*}  \\\\\n                &  (-1.72)         \\\\\nWeight (lbs.)   &    2.062\\sym{***}\\\\\n                &   (3.13)         \\\\\nConstant        &   3158.3         \\\\\n                &   (0.87)         \\\\\n\\hline\nObservations    &       74         \\\\\n\\hline\\hline\n\\multicolumn{2}{l}{\\footnotesize \\textit{t} statistics in parentheses}\\\\\n\\multicolumn{2}{l}{\\footnotesize \\sym{*} \\(p&lt;0.10\\), \\sym{**} \\(p&lt;0.05\\), \\sym{***} \\(p&lt;0.01\\)}\\\\\n\\end{tabular}\n}\nYou can check the PDF compiled from the above TeX code at this Overleaf link.\n\n\n\n\n\n\nNote\n\n\n\nWe will revisit and elaborate on these topics later. I deliberately make them oversimplified only to show you what Stata can do in making our lives much easier.",
    "crumbs": [
      "Stata Workshop",
      "Stata - Introduction"
    ]
  },
  {
    "objectID": "posts/stata/working-with-datasets/index.html",
    "href": "posts/stata/working-with-datasets/index.html",
    "title": "Stata - Working with datasets",
    "section": "",
    "text": "Recap\n\n\n\nWe can use the command sysuse to use builtin datasets, and use to load other external datasets.\nIn the introduction, we briefly mentioned how to load Stata datasets to use. Now, let’s take a more in-depth look at how we work with datasets in Stata.",
    "crumbs": [
      "Stata Workshop",
      "Stata - Working with datasets"
    ]
  },
  {
    "objectID": "posts/stata/working-with-datasets/index.html#datasets-here-and-there",
    "href": "posts/stata/working-with-datasets/index.html#datasets-here-and-there",
    "title": "Stata - Working with datasets",
    "section": "Datasets, here and there",
    "text": "Datasets, here and there\nDatasets are stored at different places, locally on our computer’s hard disk or remotely on a server. For Stata to use them, we need to load them into Stata, or putting them into memory.\nBecause Stata commands (e.g., summarize, describe, count, etc.) operate on the current dataset in memory, working simultaneously on multiple datasets was painful – one needs to save current, load the other dataset, perform tasks and save/load again. But since Stata 16, a feature called frame is introduced, where different datasets can be loaded into memory at the same time, but in different “frames”. The chart below gives a simple illustration.\n\n\n\n\n\nflowchart LR\n  subgraph Stata\n    direction TB\n    Engine\n    Engine --&gt;|frame change| default & frame2 & frame3 & ...\n    subgraph default\n    end\n    subgraph frame2\n    end\n    subgraph ...\n    end\n    subgraph frame3\n    end\n  end\n\n\n  \n  default --&gt;|sysuse| auto.dta\n  frame2 --&gt;|use| /User/mgao/Desktop/anotherDataset.dta\n  frame3 --&gt;|use| http://www.stata-press.com/data/r13/nlswork.dta\n\n  subgraph network\n    http://www.stata-press.com/data/r13/nlswork.dta\n  end\n    subgraph local\n    /User/mgao/Desktop/anotherDataset.dta\n  end\n    subgraph builtin\n    auto.dta\n  end\n\n\n\n\n\n\nAlthough we still can only operate Stata commands on a single frame/dataset at a given time, we no longer need to save/load datasets as they all reside in memory frames.\n\n\n\n\n\n\nTip\n\n\n\nWe as beginners can be agnostic about frame, especially when dealing with only one dataset throughout. Technically, we are loading data into the default frame1, and work in the default frame.\n\n\n1 default frame is just a frame named “default”.",
    "crumbs": [
      "Stata Workshop",
      "Stata - Working with datasets"
    ]
  },
  {
    "objectID": "posts/stata/working-with-datasets/index.html#but-we-start-with-loading-and-saving",
    "href": "posts/stata/working-with-datasets/index.html#but-we-start-with-loading-and-saving",
    "title": "Stata - Working with datasets",
    "section": "But we start with loading and saving",
    "text": "But we start with loading and saving\n\nStata’s dta\nThe dta is Stata’s proprietary binary data file format, and is the default file format used by Stata.\nWhat I like very much about the dta data format include:\n\nVariable Types: dta files can store different types of variables, including numeric variables (e.g., integers, floats) and string variables (text). It can represent missing values too.\nMetadata: dta files can store metadata, such as variable labels (descriptive names for variables), value labels (labels for specific variable values), and variable formats (e.g., date formats).\nCross-Platform Compatibility: dta files created in one version of Stata can generally be read by other versions of Stata, ensuring cross-platform compatibility.\n\nAlso, dta files are typically compressed to reduce file size and optimize storage.\nMore importantly, Stata provides commands (use, save, etc.) to read data from dta files into memory and save data from memory to dta files. This makes it extremely easy to work with.\nFor example, you can easily load a Stata dataset online to your Stata via use:\nuse \"http://www.stata-press.com/data/r13/nlswork.dta\", clear\nNote that , clear option tells Stata to clear the memory (1) in case there is already some other dataset in it. { .annotate }\n\nNote that it does not clear the entire memory - datasets in other frames are not cleared. Only the dataset, if any, in the current frame is cleared when the new dataset is loaded.\n\nAlternatively, you can download the nlswork.dta dataset to your computer, and load it from your local computer:\n\nMac / LinuxWindows\n\n\nuse \"/Users/mgao/Downloads/nlswork.dta\", clear\n\n\nuse \"C:\\Users\\mgao\\Downloads\\nlswork.dta\", clear\n\n\n\nAfter some work on the dataset, say, keeping only observations where year is 88,\nkeep if year==88\nwe can save the modified dataset either to its original place, overwriting the original dataset, or to a different place, creating a new dataset:\n\nMac / LinuxWindows\n\n\nsave \"/Users/mgao/Downloads/nlswork.dta\", replace\n\n\nsave \"C:\\Users\\mgao\\Downloads\\nlswork.dta\", replace\n\n\n\n\n\nMighty csv\nWe all love csv or “comma-separated-values” files. They are simple and readable without requiring any special software.2 Many datasets are also published online in csv format.\n2 You don’t need Excel or Numbers to open csv files, in case you didn’t know…What if we want to save a csv version of the dataset? Easy, we use export command:\n\nMac / LinuxWindows\n\n\nexport delimited using \"/Users/mgao/Downloads/nlswork.csv\", replace\n\n\nexport delimited using \"C:\\Users\\mgao\\Downloads\\nlswork.csv\", replace\n\n\n\nOf course, we can import the csv file back to Stata using import command:\n\nMac / LinuxWindows\n\n\nimport delimited using \"/Users/mgao/Downloads/nlswork.csv\", clear \n\n\nimport delimited using \"C:\\Users\\mgao\\Downloads\\nlswork.csv\", clear\n\n\n\nIn some rare cases where the text file is not delimited/separated by comma, we can manually specify the delimiter. For example, some datasets use “tab-separated-values” or tsv format:\nimport delimited \"path/to/datafile.tsv\", delimiter(tab)\n\n\nDid someone say “Excel”?\nStata gets you covered. import excel is all you need.\nFor example, we next are to use an Excel spreadsheet named :octicons-download-24: “BUSS7902 Chapter 4A Lecture (Data).xlsx”.\nBefore everything, we can ask Stata to describe the file:\n. import excel \"~/Downloads/BUSS7902 Chapter 4A Lecture (Data).xlsx\", describe\n\n             Sheet | Range\n  -----------------+-----------------\n         Magic Box | A1:C101\n          Assembly | A1:H76\n          Distance | A1:L42\n  Insurance+Survey | A1:H1501\nAs shown, the spreadsheet contains four sheets of different names, “Magic Box” and so on. Let’s say we are interested in the data in the “Magic Box” sheet,3 we can instruct Stata to load data from the sheet and optionally specify the data range in the sheet.4\n3 The “Magic Box” sheet, as with other sheets, contains more than just data, but also some text. We want only data in the first column A.4 We also use the firstrow option to tell Stata to treat the first row as variable name, not value of an observation.. import excel \"~/Downloads/BUSS7902 Chapter 4A Lecture (Data).xlsx\", firstrow sheet(\"Magic Box\") cellrange(A1:A101) clear\n(1 var, 100 obs)\nAnd that’s it! Stata will take care of the variable type and etc., and is pretty good at it most of the time.",
    "crumbs": [
      "Stata Workshop",
      "Stata - Working with datasets"
    ]
  },
  {
    "objectID": "posts/stata/working-with-datasets/index.html#so-you-want-more-frames",
    "href": "posts/stata/working-with-datasets/index.html#so-you-want-more-frames",
    "title": "Stata - Working with datasets",
    "section": "So you want more frames?",
    "text": "So you want more frames?\n\n\n\n\n\n\nTip\n\n\n\nThis is for the tech-savvy. You don’t need frame almost surely.\n\n\nOkay. So you noticed that every time we import/use a new dataset, we set the clear option to clear the memory, discarding whatever dataset we currently work on to make room for new new dataset. This is troublesome. What if we don’t want to give up the intermediate results while taking a peak at the different dataset?\nWe make a new frame and load the new dataset into the new frame.5\n5 Remember that the frame we work on so far is named “default”.Let’s have a look first at what frames are currently there:\n. frame list\n* default  100 x 1\n\nNote: Frames marked with * contain unsaved data.\n\nCreate a new frame\nWe create a new frame to which a new dataset can be loaded without clearing the existing dataset in the default frame. We can name it whichever we like, say, “assembly”:\nframe create \"assembly\"\nNow check again the frames, we can see it is indeed there.\n. frame list\n  assembly  0 x 0\n* default   100 x 1\n\nNote: Frames marked with * contain unsaved data.\n\n\nChange to the new frame\nLet’s now switch to the newly created “assembly” frame, leaving the “Magic Box” data untouched in the default frame.\nframe change assembly\n\n\n\n\n\n\nTip\n\n\n\nForgot which frame you are in?\n. frame\n(current frame is assembly)\n\n\nYou may notice that the Variables window is now blank, showing that there is no variable in this frame. Rest assured that the x variable we imported earlier from “Magic Box” sheet stays in memory and in the default frame.\nWe can now load data into this empty frame using the same methods as discussed above.\nFor example, I can now load the data in the “Assembly” sheet into the frame.\n. import excel \"~/Downloads/BUSS7902 Chapter 4A Lecture (Data).xlsx\", firstrow sheet(\"Assembly\") cellrange(A1:A76) clear case(lower)\n(1 var, 75 obs)\nIf we check the frames, we can see that now both datasets exist in memory, albeit in two frames.\n. frame list\n* assembly  75 x 1\n* default   100 x 1\n\nNote: Frames marked with * contain unsaved data.\nTo go back to the original frame (named “default”), use frame change default.",
    "crumbs": [
      "Stata Workshop",
      "Stata - Working with datasets"
    ]
  },
  {
    "objectID": "posts/textual-analysis-on-sec-filings/index.html",
    "href": "posts/textual-analysis-on-sec-filings/index.html",
    "title": "Textual Analysis on SEC Filings",
    "section": "",
    "text": "Nowadays top journals favour more granular studies. Sometimes it’s useful to dig into the raw SEC filings and perform textual analysis. This note documents how I download all historical SEC filings via EDGAR and conduct some textual analyses."
  },
  {
    "objectID": "posts/textual-analysis-on-sec-filings/index.html#build-a-master-index-of-sec-filings",
    "href": "posts/textual-analysis-on-sec-filings/index.html#build-a-master-index-of-sec-filings",
    "title": "Textual Analysis on SEC Filings",
    "section": "1. Build a master index of SEC filings",
    "text": "1. Build a master index of SEC filings\nI use the python-edgar to download quarterly zipped index files to ./edgar-idx.\n$ mkdir ~/edgar && cd ~/edgar\n$ git clone https://github.com/edouardswiac/python-edgar.git\n$ python ./python-edgar/run.py -d ./edgar-idx\nThen merge the downloaded tsv files into a master file using cat.\n$ cat ./edgar-idx/*.tsv &gt; ./edgar-idx/master.tsv\n$ du -h ./edgar-idx/master.tsv\nThe resulting master.tsv is about 2.6G as at Feb 2020. I then use the following python script to build a SQLite database for more efficient query.\n# Load index files in `edgar-idx` to a sqlite database.\n\nimport sqlite3\n\nEDGAR_BASE = \"https://www.sec.gov/Archives/\"\n\ndef parse(line):\n    # each line: \"cik|firm_name|file_type|date|url_txt|url_html\"\n    # an example:\n    # \"99780|TRINITY INDUSTRIES INC|8-K|2020-01-15|edgar/data/99780/0000099780-\\\n    # 20-000008.txt|edgar/data/99780/0000099780-20-000008-index.html\"\n    line = tuple(line.split('|')[:5])\n    l = list(line)\n    l[-1] = EDGAR_BASE + l[-1]\n    return tuple(l)\n\nif __name__ == '__main__':\n    conn = sqlite3.connect(r\"edgar-idx.sqlite3\")\n    c = conn.cursor()\n    c.execute('''CREATE TABLE IF NOT EXISTS edgar_idx \n        (cik TEXT, firm_name TEXT, file_type TEXT, date DATE, url TEXT,\n        PRIMARY KEY(cik, file_type, date));''')\n\n    filename = './edgar-idx/master.tsv'\n    with open(filename, 'r') as f:\n        lines = f.readlines()\n\n    data = [parse(line) for line in lines]\n    c.executemany('INSERT OR IGNORE INTO edgar_idx \\\n        (cik, firm_name, file_type, date, url) VALUES (?,?,?,?,?)', data)\n\n    conn.commit()\n    conn.close()"
  },
  {
    "objectID": "posts/textual-analysis-on-sec-filings/index.html#download-filings-from-edgar",
    "href": "posts/textual-analysis-on-sec-filings/index.html#download-filings-from-edgar",
    "title": "Textual Analysis on SEC Filings",
    "section": "2. Download filings from EDGAR",
    "text": "2. Download filings from EDGAR\nI write the following script to download filings from EDGAR. Note that this script is only a skeleton. The full implementation has proper logging, speed control and detailed error handling. For example, you’ll need to keep track of failures and re-download them later.\nThis example script download all 8-K files to ./data/{cik}/{file_type}/{date}.txt.gz.\nCompression is highly recommended unless you’ve TBs of free disk space!\n# Download all 8-K filings.\n\nimport os\nimport sqlite3\nimport requests\nimport concurrent.futures\nimport gzip\nimport tqdm\n\ndef download(job):\n    cik, _, file_type, date, url = job\n    try:\n        res = requests.get(url)\n        filename = f'./data/{cik}/{file_type}/{date}.txt.gz'\n        if res.status_code == 200:\n            with gzip.open(filename, 'wb') as f:\n                f.write(res.content)\n    except Exception:\n        pass\n\nif __name__ == \"__main__\":\n    # select what to download\n    conn = sqlite3.connect(r\"edgar-idx.sqlite3\")\n    c = conn.cursor()\n    c.execute('SELECT * FROM edgar_idx WHERE file_type=\"8-K\";')\n    jobs = c.fetchall()\n    conn.close()\n    # start downloading\n    progress = tqdm.tqdm(total=len(jobs))\n    futures = []\n    with concurrent.futures.ThreadPoolExecutor(max_workers=16) as exe:\n        for job in jobs:\n            cik, _, file_type, date, url = job\n            filename = f'./data/{cik}/{file_type}/{date}.txt.gz'\n            os.makedirs(os.path.dirname(filename), exist_ok=True)\n            if os.path.exists(filename):\n                progress.update()\n            else:\n                f = exe.submit(download, job)\n                f.add_done_callback(progress.update)\n                futures.append(f)\n    for f in concurrent.futures.as_completed(futures):\n        pass"
  },
  {
    "objectID": "posts/textual-analysis-on-sec-filings/index.html#example-textual-analyses",
    "href": "posts/textual-analysis-on-sec-filings/index.html#example-textual-analyses",
    "title": "Textual Analysis on SEC Filings",
    "section": "3. Example textual analyses",
    "text": "3. Example textual analyses\nThe downloaded txt files are the text version of filings htmls, which generally are well structured. Specifically, each filing is structured as:\n&lt;SEC-DOCUMENT&gt;\n  &lt;SEC-HEADER&gt;&lt;/SEC-HEADER&gt;\n  &lt;DOCUMENT&gt;\n    &lt;TYPE&gt;\n      &lt;SEQUENCE&gt;\n        &lt;FILENAME&gt;\n          &lt;DESCRIPTION&gt;\n            &lt;TEXT&gt;\n            &lt;/TEXT&gt;\n          &lt;/DESCRIPTION&gt;\n        &lt;/FILENAME&gt;\n      &lt;/SEQUENCE&gt;\n    &lt;/TYPE&gt;\n  &lt;/DOCUMENT&gt;\n  &lt;DOCUMENT&gt;&lt;/DOCUMENT&gt;\n  &lt;DOCUMENT&gt;&lt;/DOCUMENT&gt;\n  ...\n&lt;/SEC-DOCUMENT&gt;\n\n\n\n\n\n\nExample\n\n\n\n\n\n&lt;SEC-DOCUMENT&gt;\n    &lt;SEC-HEADER&gt;&lt;/SEC-HEADER&gt;\n    &lt;DOCUMENT&gt;\n        &lt;TYPE&gt;8-K\n            &lt;SEQUENCE&gt;1\n                &lt;FILENAME&gt;f13478e8vk.htm\n                    &lt;DESCRIPTION&gt;FORM 8-K\n                        &lt;TEXT&gt;\n                        ...\n                        &lt;/TEXT&gt;\n                    &lt;/DESCRIPTION&gt;\n                &lt;/FILENAME&gt;\n            &lt;/SEQUENCE&gt;\n        &lt;/TYPE&gt;\n    &lt;/DOCUMENT&gt;\n    &lt;DOCUMENT&gt;\n        &lt;TYPE&gt;EX-99.1\n            &lt;SEQUENCE&gt;2\n                &lt;FILENAME&gt;f13478exv99w1.htm\n                    &lt;DESCRIPTION&gt;EXHIBIT 99.1\n                        &lt;TEXT&gt;\n                        ...\n                        &lt;/TEXT&gt;\n                    &lt;/DESCRIPTION&gt;\n                &lt;/FILENAME&gt;\n            &lt;/SEQUENCE&gt;\n        &lt;/TYPE&gt;\n    &lt;/DOCUMENT&gt;\n    &lt;DOCUMENT&gt;&lt;/DOCUMENT&gt;\n    ...\n&lt;/SEC-DOCUMENT&gt;\n\n\n\n\n3.1 Extract all items reported in 8-K filings since 2004\nSince 2004, SEC requires companies to file 8-K within 4 business days of many types of events. For a short description, see SEC’s fast answer to Form 8-K. The detailed instruction (PDF) is available at here.\nTo extract all items reported in each filing since 2004, there are several ways. First, I can use a regular expression to extract all \"Item X.XX\" from the 8-K &lt;DOCUMENT&gt;. Or, I can take advantage of the information in &lt;SEC-HEADER&gt;. Below is an example &lt;SEC-HEADER&gt;1, of which the lines of ITEM INFORMATION actually describe the items reported in the filing.\n1 The original file is at https://www.sec.gov/Archives/edgar/data/0000008192/0000079732-02-000036.txt&lt;SEC-HEADER&gt;0000079732-02-000036.hdr.sgml : 20020802\n&lt;ACCEPTANCE-DATETIME&gt;20020802082752\nACCESSION NUMBER:       0000079732-02-000036\nCONFORMED SUBMISSION TYPE:  8-K\nPUBLIC DOCUMENT COUNT:      4\nCONFORMED PERIOD OF REPORT: 20020801\nITEM INFORMATION:       Changes in control of registrant\nITEM INFORMATION:       Financial statements and exhibits\nFILED AS OF DATE:       20020802\n\nFILER:\n\n    COMPANY DATA:   \n        COMPANY CONFORMED NAME:         ATLANTIC CITY ELECTRIC CO\n        CENTRAL INDEX KEY:          0000008192\n        STANDARD INDUSTRIAL CLASSIFICATION: ELECTRIC SERVICES [4911]\n        IRS NUMBER:             210398280\n        STATE OF INCORPORATION:         NJ\n        FISCAL YEAR END:            1231\n\n    FILING VALUES:\n        FORM TYPE:      8-K\n        SEC ACT:        1934 Act\n        SEC FILE NUMBER:    001-03559\n        FILM NUMBER:        02717802\n\n    BUSINESS ADDRESS:   \n        STREET 1:       800 KING STREET\n        STREET 2:       PO BOX 231\n        CITY:           WILMINGTON\n        STATE:          DE\n        ZIP:            19899\n        BUSINESS PHONE:     6096454100\n\n    MAIL ADDRESS:   \n        STREET 1:       800 KING STREET\n        STREET 2:       PO BOX 231\n        CITY:           WILMINGTON\n        STATE:          DE\n        ZIP:            19899\n&lt;/SEC-HEADER&gt;\nFollowing this strategy, I write the code below to extract all items reported in 8-K filings since 2004. I didn’t use regex for this task because the text portion of the filing is actually dirty. For instance, you’ll need to remove all html tags, and be careful about the “non-breaking space”, &nbsp;, etc. My experience is that using &lt;SEC-HEADER&gt; for this task is the best.\n# Extract all items reported in 8-K filings since 2004.\nimport os\nimport gzip\nimport tqdm\nimport sqlite3\nimport concurrent.futures\n\n\nBASE_DIR = './data'\nFILE_TYPE = '8-K'\nDB = \"result.sqlite3\"\n\n\ndef walk_dirpath(cik, file_type):\n    \"\"\" Yield paths of all files for a given cik and file type \"\"\"\n    for root, _, files in os.walk(os.path.join(BASE_DIR, cik, file_type)):\n        for filename in files:\n            yield os.path.join(root, filename)\n\n\ndef regsearch(cik):\n    matches = []\n    for filepath in walk_dirpath(cik, FILE_TYPE):\n        date = os.path.split(filepath)[1].strip('.txt.gz')\n        if int(date.split('-')[0]) &lt; 2004:\n            continue\n        with gzip.open(filepath, 'rb') as f:\n            data = f.readlines()\n        ls = [l for l in data if l.startswith(b'ITEM INFORMATION')]\n        for l in ls:\n            item = l.decode().replace('\\t','').replace('ITEM INFORMATION:', '')\n            if len(item.strip()):\n                matches.append((cik, FILE_TYPE, date, item.strip()))\n    return matches\n\n\nif __name__ == \"__main__\":\n    conn = sqlite3.connect(DB)\n    c = conn.cursor()\n    c.execute('''CREATE TABLE IF NOT EXISTS files_all_items\n        (cik TEXT, file_type TEXT, date DATE, item TEXT,\n        PRIMARY KEY(cik, file_type, date, item));''')\n    conn.commit()\n\n    _, ciks, _ = next(os.walk(BASE_DIR))\n    progress = tqdm.tqdm(total=len(ciks))\n    with concurrent.futures.ProcessPoolExecutor(max_workers=16) as exe:\n        futures = [exe.submit(regsearch, cik) for cik in ciks]\n        for f in concurrent.futures.as_completed(futures):\n            res = f.result()\n            c.executemany(\n                \"INSERT OR IGNORE INTO files_all_items \\\n                    (cik, file_type, date, item) VALUES (?,?,?,?)\", res)\n            conn.commit()\n            progress.update()\n\n    conn.close()\n\n\n3.2 Find all 8-K filings with Item 1.01 and/or Item 2.03\nTo get those filings that have either:\n\nItem 1.01 Entry into a Material Definitive Agreement, or\nItem 2.03 Creation of a Direct Financial Obligation or an Obligation under an Off-Balance Sheet Arrangement of a Registrant\n\nI run the following SQL query:\n-- SQLite\nCREATE TABLE `files_with_items_101_or_203` AS\nSELECT DISTINCT cik, file_type, date\nFROM `files_all_items`\nWHERE\n    instr(lower(item), \"creation of a direct financial obligation\") &gt; 0 OR\n    instr(lower(item), \"entry into a material definitive agreement\") &gt; 0\nORDER BY cik, file_type, date;\nTo get those with both items, use the following query:\n-- SQLite\nCREATE TABLE `files_with_items_101_and_203` AS\nSELECT cik, file_type, date\nFROM `files_all_items`\nWHERE\n    instr(lower(item), \"creation of a direct financial obligation\") &gt; 0 OR\n    instr(lower(item), \"entry into a material definitive agreement\") &gt; 0\nGROUP BY cik, file_type, date\nHAVING count(*) &gt; 1\nORDER BY cik, file_type, date;\n\n\n3.3 Nini, Smith, and Sufi (2009)\nThis example code finds the appearance of any of the 10 search words used in “Creditor control rights and firm investment policy” by Nini, Smith, and Sufi (2009), which is used to identify the loan contracts as attached in the SEC filing.\nimport re\nimport os\nimport sys\nimport gzip\nimport tqdm\nimport sqlite3\nimport logging\nimport concurrent.futures\n\nlogging.basicConfig(stream=sys.stdout, level=logging.WARN)\n\nBASE_DIR = './data'\nFILE_TYPE = '10-Q'\nDB = \"result.sqlite3\"\n\n# Regex pattern used to remove html tags\ncleanr = re.compile(b'&lt;.*?&gt;|&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-f]{1,6});')\n\n# Regex pattern used to find the appearance of any of the 10 search words used\n# in \"Creditor control rights and firm investment policy\"\n# by Nini, Smith and Sufi (JFE 2009)\n# pat_10_words = r\"CREDIT FACILITY|REVOLVING CREDIT|(CREDIT|LOAN|(LOAN (AND|&) \\\n#    SECURITY)|(FINANCING (AND|&) SECURITY)|CREDIT (AND|&) GUARANTEE) AGREEMENT\"\nNSS_10_words = ['credit facility',\n                'revolving credit',\n                'credit agreement',\n                'loan agreement',\n                'loan and security agreement',\n                'loan & security agreement',\n                'credit and guarantee agreement',\n                'credit & guarantee agreement',\n                'financing and security agreement',\n                'financing & security agreement']\nNSS_10_words_str = '|'.join([word.upper() for word in NSS_10_words])\npat_10_words = re.compile(NSS_10_words_str.encode())\n\n# Regex pattern used in this search\npattern = pat_10_words\n\n\ndef walk_dirpath(cik, file_type):\n    \"\"\" Yield paths of all files for a given cik and file type \"\"\"\n    for root, _, files in os.walk(os.path.join(BASE_DIR, cik, file_type)):\n        for filename in files:\n            yield os.path.join(root, filename)\n\n\ndef regsearch(cik):\n    matches = []\n    for filepath in walk_dirpath(cik, FILE_TYPE):\n        date = os.path.split(filepath)[1].strip('.txt.gz')\n        try:\n            with gzip.open(filepath, 'rb') as f:\n                data = b' '.join(f.read().splitlines())\n                data = re.sub(cleanr, b'', data)\n            match = pattern.search(data)\n            if match:\n                matches.append((cik, FILE_TYPE, date))\n                logging.info(f'{filepath}, {match.group()}')\n        except Exception as e:\n            logging.error(f'failed at {filepath}, {e}')\n    return matches\n\n\nif __name__ == \"__main__\":\n\n    conn = sqlite3.connect(DB)\n    c = conn.cursor()\n    # create a table to store the indices\n    c.execute('''CREATE TABLE IF NOT EXISTS files_with_10_words\n        (cik TEXT, file_type TEXT, date DATE,\n        PRIMARY KEY(cik, file_type, date));''')\n    conn.commit()\n    _, ciks, _ = next(os.walk(BASE_DIR))\n    progress = tqdm.tqdm(total=len(ciks))\n    with concurrent.futures.ProcessPoolExecutor(max_workers=16) as exe:\n        futures = [exe.submit(regsearch, cik) for cik in ciks]\n        for f in concurrent.futures.as_completed(futures):\n            matches = f.result()\n            c.executemany(\n                \"INSERT OR IGNORE INTO files_with_10_words \\\n                    (cik, file_type, date) VALUES (?,?,?)\", matches)\n            conn.commit()\n            progress.update()\n    conn.close()\n    logging.info('complete')"
  },
  {
    "objectID": "posts/translog-production-and-cost-functions/index.html",
    "href": "posts/translog-production-and-cost-functions/index.html",
    "title": "Translog Production and Cost Functions",
    "section": "",
    "text": "In this post, I’ll carefully explain the derivation of cost function from a CES production function, as well as the derivation of translog (transcendental logarithmic) production and cost functions.\nflowchart TB\n    subgraph Production\n    A[Production Function] -. approximation .-&gt; D(Translog Production Function)\n    end\n    subgraph Cost\n    B[Cost Function] -. approximation .-&gt; C(Translog Cost Function)\n    end\n    A == Conversion via Duality ==&gt; B\n\n\n\n\nFigure 1: A diagram of the relationship between production functions and cost functions.\nBefore I start, the graph above illustrate the relations. Specifically, we can derive the cost function from a CES production function via the duality theorem. Translog production and translog cost functions are approximations to the production and corresponding cost function, respectively, via Taylor expansion."
  },
  {
    "objectID": "posts/translog-production-and-cost-functions/index.html#ces-production-function",
    "href": "posts/translog-production-and-cost-functions/index.html#ces-production-function",
    "title": "Translog Production and Cost Functions",
    "section": "CES Production Function",
    "text": "CES Production Function\nLet’s start from the a general production function, CES (Constant Elasticity of Substitution).\nThe standard CES production function with two factors \\(X_1\\) and \\(X_2\\) is given by:\n\\[\n\\begin{equation}\n\\label{eq:ces-production}\nQ = A \\left( \\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho} \\right)^{\\frac{1}{\\rho}}\n\\end{equation}\n\\tag{1}\\]\nwhere \\(\\alpha_1+\\alpha_2=1\\), \\(A\\) is a scale parameter, \\(\\alpha\\) is the distribution parameter, and \\(\\rho\\) is the substitution parameter.\n\n\n\n\n\n\nNote\n\n\n\nThe Cobb-Douglas production function is a special case of the CES function when \\(\\rho \\to 0\\):\n\\[\nQ = A X_1^{\\alpha} X_2^{1-\\alpha}\n\\]"
  },
  {
    "objectID": "posts/translog-production-and-cost-functions/index.html#translog-production-function",
    "href": "posts/translog-production-and-cost-functions/index.html#translog-production-function",
    "title": "Translog Production and Cost Functions",
    "section": "Translog Production Function",
    "text": "Translog Production Function\nTaking the natural logarithm of both sides of Equation Equation 1, we get:\n\\[\n\\begin{equation}\n\\label{eq:log-form-ces-production}\n\\ln Q = \\ln A + \\frac{1}{\\rho} \\ln \\left[ \\alpha X_1^{\\rho} + (1-\\alpha) X_2^{\\rho} \\right]\n\\end{equation}\n\\tag{2}\\]\nThe Taylor expansion of \\(\\frac{1}{\\rho} \\ln \\left[ \\alpha X_1^{\\rho} + (1-\\alpha) X_2^{\\rho} \\right]\\) around \\(\\rho=0\\) is 1\n1 This is computed in Mathematica:\nexpr = Series[1/rho * Log[alpha*X1^rho + (1 - alpha)*X2^rho], {rho, 0, 1}];\nsimplifiedExpr = FullSimplify[expr];\nTeXForm[simplifiedExpr]\n\\[\n\\begin{equation}\n\\label{eq:taylor-expansion-of-ces}\n\\alpha  \\ln X_1 + (1-\\alpha)  \\ln X_2-\\frac{1}{2} \\rho\n    \\left[(\\alpha -1) \\alpha  (\\ln X_1-\\ln X_2)^2\\right]+O\\left(\\rho ^2\\right)\n\\end{equation}\n\\tag{3}\\]\nOmitting \\(O\\left(\\rho ^2\\right)\\) and substituting the Taylor expansion into Equation Equation 2, we have\n\\[\n\\begin{align}\n\\label{eq:log-production-with-taylor}\n\\ln Q &= \\ln A \\\\\n&+ \\alpha  \\ln X_1 + (1-\\alpha)  \\ln X_2-\\frac{1}{2} \\rho \\left[(\\alpha -1) \\alpha  (\\ln X_1-\\ln X_2)^2\\right] \\nonumber\n\\end{align}\n\\tag{4}\\]\nwhich clearly is a function of \\(\\ln X_1\\), \\(\\ln X_2\\) and their interaction terms.\nWe can therefore reparameterize Equation Equation 4 and get the Translog production function:\n\\[\n\\begin{align}\n\\ln Q &= a_0 + a_1 \\ln X_1 + a_2 \\ln X_2 \\\\\n&+ b_{11} (\\ln X_1)^2 + b_{22} (\\ln X_2)^2 + b_{12} \\ln X_1 \\ln X_2 \\nonumber\n\\end{align}\n\\]\nHere, \\(a_1\\) and \\(a_2\\) are coefficients that capture the first-order effects, and \\(b_{11}\\), \\(b_{22}\\), and \\(b_{12}\\) are coefficients that capture the second-order effects.\n\n\n\n\n\n\nNote\n\n\n\nIf we use fist-order Taylor expansion in Equation Equation 3 instead, we will end up with a log-linear production function."
  },
  {
    "objectID": "posts/translog-production-and-cost-functions/index.html#derive-cost-function-from-production-function",
    "href": "posts/translog-production-and-cost-functions/index.html#derive-cost-function-from-production-function",
    "title": "Translog Production and Cost Functions",
    "section": "Derive Cost Function From Production Function",
    "text": "Derive Cost Function From Production Function\nGiven the CES production function Equation 1, we can derive the cost function via the duality theorem.\n\n\n\n\n\n\nDuality in a nutshell\n\n\n\n\nThe production function describes the maximum output \\(Q\\) that can be produced given the input factors.\nGiven a production function and input prices, the firm aims to minimize its costs subject to the constraint of producing a given output level \\(Q\\). This leads to a cost minimization problem.\n\nCost minimization and the production maximization are essentially “dual” to each other. The conditions that solve one problem can be used to solve the other. This is a manifestation of the more general concept of duality in optimization theory.\n\n\nRecall that the CES production function is\n\\[\nQ = A \\left( \\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho} \\right)^{\\frac{1}{\\rho}}\n\\]\nThe firm’s cost function is\n\\[\n\\begin{equation}\n\\label{eq:cost-function}\nC = w_1 X_1 + w_2 X_2\n\\end{equation}\n\\tag{5}\\]\nwhere \\(w_1\\) and \\(w_2\\) are the factor prices.\n\nCost minimization problem\nTo derive the cost function from the given CES production function, we need to find the minimum cost of producing a given level of output \\(Q\\) given input prices \\(w_1\\) and \\(w_2\\).\nThe cost minimization problem is:\n\\[\n\\begin{equation}\n\\min_{X_1, X_2} \\quad C=w_1 X_1 + w_2 X_2\n\\end{equation}\n\\]\nsubject to:\n\\[\n\\begin{equation}\nA \\left( \\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho} \\right)^{\\frac{1}{\\rho}} = Q\n\\end{equation}\n\\]\n\n\nSolving the problem\n\nThis part is math-heavy. The derived cost function is given by Equation Equation 11.\n\nThe Lagrangian for this problem is:\n\\[\n\\begin{equation}\n\\mathcal{L} = w_1 X_1 + w_2 X_2 + \\lambda \\left[ Q - A \\left( \\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho} \\right)^{\\frac{1}{\\rho}} \\right]\n\\end{equation}\n\\]\nTake the first-order conditions:\n\\[\n\\begin{align}\n\\frac{\\partial \\mathcal{L}}{\\partial X_1} &= w_1 - \\lambda A \\alpha_1 \\rho X_1^{\\rho-1} \\left( \\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho} \\right)^{\\frac{1}{\\rho}-1} = 0 \\\\\n\\frac{\\partial \\mathcal{L}}{\\partial X_2} &= w_2 - \\lambda A \\alpha_2 \\rho X_2^{\\rho-1} \\left( \\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho} \\right)^{\\frac{1}{\\rho}-1} = 0 \\\\\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} &= Q - A \\left( \\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho} \\right)^{\\frac{1}{\\rho}} = 0\n\\end{align}\n\\]\nSolve the first two equations for \\(\\lambda\\):\n\\[\n\\begin{equation}\n\\label{eq:lambda}\n\\lambda = \\frac{w_1}{A \\alpha_1 \\rho X_1^{\\rho-1} \\left( \\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho} \\right)^{\\frac{1}{\\rho}-1}} = \\frac{w_2}{A \\alpha_2 \\rho X_2^{\\rho-1} \\left( \\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho} \\right)^{\\frac{1}{\\rho}-1}}\n\\end{equation}\n\\tag{6}\\]\nSimplifying Equation 6, we get:\n\\[\n\\begin{equation}\n\\label{eq:lambda-equal}\nw_1 X_2^{\\rho-1} \\alpha_2 = w_2 X_1^{\\rho-1} \\alpha_1\n\\end{equation}\n\\tag{7}\\]\nManipulating Equation 7, we have:\n\\[\n\\begin{equation}\n\\frac{X_1}{X_2} = \\left(\\frac{\\alpha_2 w_1}{\\alpha_1 w_2}\\right)^{\\frac{1}{\\rho-1}}\n\\end{equation}\n\\]\nso that\n\\[\n\\begin{align}\n(\\alpha_2 w_1)^{\\frac{\\rho}{\\rho-1}} X_2^{\\rho} &= (\\alpha_1 w_2)^{\\frac{\\rho}{\\rho-1}} X_1^{\\rho} \\\\\n\\left(w_1^{\\frac{\\rho}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}}\\right) \\alpha_2 X_2^{\\rho} &= \\left(w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}}\\right) \\alpha_1 X_1^{\\rho}\n\\end{align}\n\\]\nAdding \\(\\left(w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}}\\right) \\alpha_2 X_2^{\\rho}\\) to both sides, we have\n\\[\n\\begin{align}\n\\left(w_1^{\\frac{\\rho}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}}\\right) \\alpha_2 X_2^{\\rho} + \\left(w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}}\\right) \\alpha_2 X_2^{\\rho}\n&= \\left(w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}}\\right) \\alpha_1 X_1^{\\rho} + \\left(w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}}\\right) \\alpha_2 X_2^{\\rho} \\nonumber \\\\\n\\left(w_1^{\\frac{\\rho}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}} + w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}}\\right) \\alpha_2 X_2^{\\rho}\n&= \\left(w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}}\\right) \\left(\\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho}\\right)\n\\end{align}\n\\]\nRaise both sides to the power of \\(\\frac{1}{\\rho}\\), we have\n\\[\n\\begin{equation}\n\\label{eq:x2_before_simplification}\n\\left(w_1^{\\frac{\\rho}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}} + w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}} \\right)^{\\frac{1}{\\rho}} \\alpha_2^{\\frac{1}{\\rho}} X_2\n= \\left(w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}}\\right)^{\\frac{1}{\\rho}} \\left(\\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho}\\right)^{\\frac{1}{\\rho}}\n\\end{equation}\n\\tag{8}\\]\nLet \\(K = \\left(w_1^{\\frac{\\rho}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}} + w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}} \\right)^{\\frac{1}{\\rho}}\\), observe that \\(\\frac{Q}{A} = \\left(\\alpha_1 X_1^{\\rho} + \\alpha_2 X_2^{\\rho}\\right)^{\\frac{1}{\\rho}}\\), we can simplify Equation 8 to\n\\[\n\\begin{equation}\nK \\alpha_2^{\\frac{1}{\\rho}} X_2 = \\left(w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}}\\right)^{\\frac{1}{\\rho}} \\frac{Q}{A}\n\\end{equation}\n\\]\nTherefore, \\(X_2\\) is given by\n\\[\n\\begin{equation}\n\\label{eq:x2}\nX_2 = K^{-1} w_2^{\\frac{1}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}} \\frac{Q}{A}\n\\end{equation}\n\\tag{9}\\]\nWe can similarly get \\(X_1\\)\n\\[\n\\begin{equation}\n\\label{eq:x1}\nX_1 = K^{-1} w_1^{\\frac{1}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}} \\frac{Q}{A}\n\\end{equation}\n\\tag{10}\\]\nSubstituting Equation 10 and Equation 9 into the cost function Equation 5, we have\n\\[\n\\begin{align}\nC &= w_1 X_1 + w_2 X_2 \\nonumber \\\\\n&= K^{-1} w_1^{\\frac{\\rho}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}} \\frac{Q}{A} + K^{-1} w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}} \\frac{Q}{A} \\\\\n&= \\frac{Q}{A} K^{-1} \\left(w_1^{\\frac{\\rho}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}} + w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}}\\right)\n\\end{align}\n\\]\nSince \\(K = \\left(w_1^{\\frac{\\rho}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}} + w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}} \\right)^{\\frac{1}{\\rho}}\\), we have the derived cost function:\n\n\n\n\n\n\nCost function derived from CES production function\n\n\n\n\\[\n\\begin{equation}\n\\label{eq:derived-cost-function}\nC = \\frac{Q}{A} \\left(w_1^{\\frac{\\rho}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}} + w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}}\\right)^{\\frac{\\rho-1}{\\rho}}\n\\end{equation}\n\\tag{11}\\]"
  },
  {
    "objectID": "posts/translog-production-and-cost-functions/index.html#translog-cost-function",
    "href": "posts/translog-production-and-cost-functions/index.html#translog-cost-function",
    "title": "Translog Production and Cost Functions",
    "section": "Translog Cost Function",
    "text": "Translog Cost Function\nTaking the natural logarithm of both sides of Equation Equation 11, we get:\n\\[\n\\begin{equation}\n\\label{eq:log-cost-function}\n\\ln(C) = \\ln \\left( \\frac{Q}{A} \\right) + \\frac{\\rho-1}{\\rho} \\ln \\left( w_1^{\\frac{\\rho}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}} + w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}} \\right)\n\\end{equation}\n\\tag{12}\\]\nThe Taylor expansion of \\(\\frac{\\rho-1}{\\rho} \\ln \\left( w_1^{\\frac{\\rho}{\\rho-1}} \\alpha_1^{\\frac{-1}{\\rho-1}} + w_2^{\\frac{\\rho}{\\rho-1}} \\alpha_2^{\\frac{-1}{\\rho-1}} \\right)\\) around \\(\\rho=0\\) is 2\n2 This is computed in Mathematica, too.\\[\n\\begin{align}\n\\label{eq:taylor-expansion-of-log-cost}\n&((\\alpha_2-1)\\ln\\alpha_1-\\alpha_2(\\ln\\alpha_2+\\ln w_1-\\ln w_2)+\\ln w_1)\\nonumber\\\\\n&+\\frac{1}{2}(\\alpha_2-1)\\alpha_2\\rho(\\ln \\alpha_1-\\ln \\alpha_2-\\ln w_1+\\ln w_2)^2+O\\left(\\rho^2\\right)\n\\end{align}\n\\tag{13}\\]\nOmitting \\(O\\left(\\rho ^2\\right)\\) and substituting the Taylor expansion into Equation Equation 12, we have\n\\[\n\\begin{align}\n\\ln C &= -\\ln A + \\ln Q \\nonumber\\\\\n&+((\\alpha_2-1)\\ln\\alpha_1-\\alpha_2(\\ln\\alpha_2+\\ln w_1-\\ln w_2)+\\ln w_1)\\nonumber\\\\\n&+\\frac{1}{2}(\\alpha_2-1)\\alpha_2\\rho(\\ln \\alpha_1-\\ln \\alpha_2-\\ln w_1+\\ln w_2)^2\n\\label{eq:log-cost-taylor}\n\\end{align}\n\\tag{14}\\]\nwhich clearly is a function of \\(\\ln Q\\); \\(\\ln w_1\\), \\(\\ln w_2\\) and their interaction terms.\nWe can therefore reparameterize Equation Equation 14 and get the Translog cost function:\n\\[\n\\begin{align} \\label{eq:translog-cost}\n\\ln C &= a_0 + a_1 \\ln Q \\\\\n&+ b_{11} \\ln w_1 + b_{22} \\ln w_2 + b_{12} \\ln w_1 \\ln w_2 \\nonumber\n\\end{align}\n\\tag{15}\\]\n\n\n\n\n\n\nWhy there is no interaction between \\(\\ln Q\\) and \\(\\ln w\\)?\n\n\n\nThis is NOT an error! It is because we started from a standard CES production function, which doesn’t include interaction terms.\nA more general form of translog cost function includes interaction terms \\(\\ln Q \\ln w\\) because the underlying production function is even more flexible than the standard CES production function. This is the beauty of translog.\n\n\nIn a general form, the translog cost function \\(\\ln C(Q, W)\\) as a function of output \\(Q\\) and a vector of \\(n\\) input prices \\(W\\) is represented as\n\\[\n\\begin{align}\n\\ln C(Q, W) &= \\beta_0 + \\beta_1 \\ln Q + \\frac{1}{2} \\beta_2 (\\ln Q)^2 \\\\\n&+ \\sum_{i=1}^{n} \\gamma_i \\ln W_i + \\frac{1}{2} \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\theta_{ij} \\ln W_i \\ln W_j \\nonumber \\\\\n&+ \\sum_{i=1}^{n} \\phi_i \\ln Q \\ln W_i \\nonumber\n\\label{eq:translog-cost-general}\n\\end{align}\n\\tag{16}\\]\nNote that here it includes a quadratic term for \\(\\ln Q\\) and interactions between \\(\\ln Q\\) and \\(\\ln W\\). As a result, it can approximate a wide range of very complex cost functions (hence complex underlying production function, via duality).\n\nLinear Homogeneity Constraint\nIn economic theory, a cost function is often assumed to be linearly homogeneous in input prices. This means that if all input prices \\(W_i\\) are scaled by a constant \\(\\lambda &gt; 0\\), the total cost \\(C\\) should also scale by the same constant \\(\\lambda\\). Mathematically, this is expressed as:\n\\[\n\\begin{equation}\nC(Q, \\lambda W) = \\lambda C(Q, W)\n\\end{equation}\n\\]\nLinear homogeneity is an important property because it ensures that the cost function is consistent with the idea of constant returns to scale in prices.\n\nImplications for parameters\nIf we take the total differential of the log cost, holding output constant, we have,\n\\[\n\\begin{equation}\nd\\ln C = \\sum_{i=1}^{n} \\gamma_i d\\ln W_i+ \\frac{1}{2}\\sum_{i=1}^{n}\\sum_{j=1}^{n} \\theta_{ij} \\ln W_j d\\ln W_i + \\sum_{i=1}^{n}\\phi_i \\ln Q d\\ln W_i\n\\end{equation}\n\\]\nBy assumption, all input prices scale by the same factor \\(\\lambda\\) so that \\(d\\ln W_i\\) is the same across all \\(n\\) inputs. Therefore, we can factor it out, which gives,\n\\[\n\\begin{equation}\nd\\ln C = d\\ln \\bar{W} \\sum_{i=1}^{n} \\gamma_i + d\\ln \\bar{W}^2 \\frac{1}{2}\\sum_{i=1}^{n}\\sum_{j=1}^{n} \\theta_{ij} + d\\ln \\bar{W} \\ln Q \\sum_{i=1}^{n}\\phi_i\n\\end{equation}\n\\]\nTo ensure \\(\\frac{d\\ln C}{d\\ln \\bar{W}}=1\\) hence linear homogeneity in the translog cost function, the following conditions must be met:\n\\[\n\\begin{align}\n\\sum_{i=1}^{n} \\gamma_i &= 1 \\\\\n\\sum_{j=1}^{n} \\theta_{ij} &= 0 \\quad \\text{for all } i \\\\\n\\sum_{i=1}^{n} \\phi_{i} &= 0\n\\end{align}\n\\]\n\n\n\n\n\n\nTip\n\n\n\nSee Translog Cost Function Estimation for estimation notes and code example."
  },
  {
    "objectID": "posts/use-sas-macros-on-wrds/index.html",
    "href": "posts/use-sas-macros-on-wrds/index.html",
    "title": "Use SAS Macros on WRDS",
    "section": "",
    "text": "The Wharton Research Data Services (WRDS) provides quite a handful of SAS macros that can be used directly. This article explains how to use those handy macros on WRDS when you use remote submission to run your code on the WRDS cloud. Lastly, it explains how to load and use third-party SAS macros from a URL."
  },
  {
    "objectID": "posts/use-sas-macros-on-wrds/index.html#prerequisite",
    "href": "posts/use-sas-macros-on-wrds/index.html#prerequisite",
    "title": "Use SAS Macros on WRDS",
    "section": "Prerequisite",
    "text": "Prerequisite\nBefore everything, just make sure that this autoexec.sas is located in the home folder on your WRDS cloud.\n*  The library name definitions below are used by SAS;\n*  Assign default libref for WRDS (Wharton Research Data Services);\n%include '/wrds/lib/utility/wrdslib.sas';\noptions sasautos=('/wrds/wrdsmacros/', SASAUTOS) MAUTOSOURCE;\nThis code runs automatically when you’ve connected to the WRDS cloud. The first line assigns the default library references for you to use, e.g. comp for Compustat. The second line makes available the macros. A list of these handy macros is available at the WRDS documentation.\nIf you don’t have this SAS code in the home folder, simply create one there or you can choose to include these two lines of code in your remotely submitted code."
  },
  {
    "objectID": "posts/use-sas-macros-on-wrds/index.html#simple-usage",
    "href": "posts/use-sas-macros-on-wrds/index.html#simple-usage",
    "title": "Use SAS Macros on WRDS",
    "section": "Simple usage",
    "text": "Simple usage\nLet’s say we want to winsorize a dataset by using the macro provided by WRDS (full code). Below is an example of winsorizing Total Assets AT of Compustat sample by fiscal year from 1980 to 2018.\n%let wrds=wrds-cloud.wharton.upenn.edu 4016;\noptions comamid=TCP remote=WRDS;\nsignon username=_prompt_;\n\nrsubmit;\n\n/* Create a dataset in the work directory */\ndata work.funda(keep=gvkey fyear at);\n    set comp.funda;\n    if 1980 &lt;= fyear &lt;= 2018;\n    /* Generic filter */\n    if indfmt='INDL' and datafmt='STD' and popsrc='D' and consol='C';\nrun;\n\n/* Invoke the macro */\n/* The documentation is available at:\n   https://wrds-www.wharton.upenn.edu/pages/support/research-wrds/macros/wrds-macros-winsorize/ */\n%WINSORIZE(INSET=funda,OUTSET=funda_w,SORTVAR=fyear,VARS=at,PERC1=1,TRIM=0);\n\n/* Before the winsorization */\nproc means data=work.funda; by fyear; var at; \noutput out=funda_before_win min= mean= max= / autoname; run;\n/* After the winsorization */\nproc means data=work.funda_w; by fyear; var at;\noutput out=funda_after_win min= mean= max= / autoname; run;\n\nproc print data=funda_before_win;\nproc print data=funda_after_win; run;\n\nendrsubmit;\nsignoff;\nInvoking the macro is as simple as a single line (line 18 above):\n%WINSORIZE(INSET=funda,OUTSET=funda_w,SORTVAR=fyear,VARS=at,PERC1=1,TRIM=0);\nHowever, one thing to note about this particular winsorization macro by WRDS is that a variable named a is used in line 57 and 59. So if the INSET has a variable named a as well, there’ll be possible data integrity issue. Hence, I prefer to use another version described in my other post Winsorization in SAS."
  },
  {
    "objectID": "posts/use-sas-macros-on-wrds/index.html#load-sas-macros-from-url",
    "href": "posts/use-sas-macros-on-wrds/index.html#load-sas-macros-from-url",
    "title": "Use SAS Macros on WRDS",
    "section": "Load SAS macros from URL",
    "text": "Load SAS macros from URL\nI tend to collect and store all useful macros on my personal server, hence I don’t need to worry about a loss of or changes to the macros. To use these macros, simply include them before invoking.\nfilename winsor url \"https://mingze-gao.com/utils/winsor.sas\";\n%include winsor;\nThen, I can simply call winsor as below.\n%let winsVars = tac inv_at_l drev drevadj ppe roa;\n%winsor(dsetin=work.funda, dsetout=work.funda_wins, byvar=fyear, vars=&winsVars, type=winsor, pctl=1 99);"
  },
  {
    "objectID": "posts/winsorization-in-sas/index.html",
    "href": "posts/winsorization-in-sas/index.html",
    "title": "Winsorization in SAS",
    "section": "",
    "text": "These are two versions of winsorization in SAS, of which I recommend the first one."
  },
  {
    "objectID": "posts/winsorization-in-sas/index.html#version-1-unknown-author",
    "href": "posts/winsorization-in-sas/index.html#version-1-unknown-author",
    "title": "Winsorization in SAS",
    "section": "Version 1 (Unknown Author)",
    "text": "Version 1 (Unknown Author)\n/*****************************************\nAuthor unknown - that is a pity because this macro is the best since sliced bread! \nTrim or winsorize macro\n* byvar = none for no byvar;\n* type  = delete/winsor (delete will trim, winsor will winsorize;\n*dsetin = dataset to winsorize/trim;\n*dsetout = dataset to output with winsorized/trimmed values;\n*byvar = subsetting variables to winsorize/trim on;\nSample usage:\n%winsor(dsetin=work.myDsetIn, byvar=fyear, \n        dsetout=work.myDsOut, vars=btm roa roe, type=winsor, pctl=1 99);\n****************************************/\n \n%macro winsor(dsetin=, dsetout=, byvar=none, vars=, type=winsor, pctl=1 99);\n \n%if &dsetout = %then %let dsetout = &dsetin;\n    \n%let varL=;\n%let varH=;\n%let xn=1;\n \n%do %until ( %scan(&vars,&xn)= );\n    %let token = %scan(&vars,&xn);\n    %let varL = &varL &token.L;\n    %let varH = &varH &token.H;\n    %let xn=%EVAL(&xn + 1);\n%end;\n \n%let xn=%eval(&xn-1);\n \ndata xtemp;\n    set &dsetin;\n    run;\n \n%if &byvar = none %then %do;\n \n    data xtemp;\n        set xtemp;\n        xbyvar = 1;\n        run;\n \n    %let byvar = xbyvar;\n \n%end;\n \nproc sort data = xtemp;\n    by &byvar;\n    run;\n \nproc univariate data = xtemp noprint;\n    by &byvar;\n    var &vars;\n    output out = xtemp_pctl PCTLPTS = &pctl PCTLPRE = &vars PCTLNAME = L H;\n    run;\n \ndata &dsetout;\n    merge xtemp xtemp_pctl;\n    by &byvar;\n    array trimvars{&xn} &vars;\n    array trimvarl{&xn} &varL;\n    array trimvarh{&xn} &varH;\n \n    do xi = 1 to dim(trimvars);\n \n        %if &type = winsor %then %do;\n            if not missing(trimvars{xi}) then do;\n              if (trimvars{xi} &lt; trimvarl{xi}) then trimvars{xi} = trimvarl{xi};\n              if (trimvars{xi} &gt; trimvarh{xi}) then trimvars{xi} = trimvarh{xi};\n            end;\n        %end;\n \n        %else %do;\n            if not missing(trimvars{xi}) then do;\n              if (trimvars{xi} &lt; trimvarl{xi}) then delete;\n              if (trimvars{xi} &gt; trimvarh{xi}) then delete;\n            end;\n        %end;\n \n    end;\n    drop &varL &varH xbyvar xi;\n    run;\n \n%mend winsor;"
  },
  {
    "objectID": "posts/winsorization-in-sas/index.html#version-2-wrds",
    "href": "posts/winsorization-in-sas/index.html#version-2-wrds",
    "title": "Winsorization in SAS",
    "section": "Version 2 (WRDS)",
    "text": "Version 2 (WRDS)\nA potential problem with this WRDS macro is that a variable named a is used in line 57 and 59. So if the INSET has a variable named a as well, there’ll be possible data integrity issue.\n\n\n\n\n\n\nWINSORIZE macro\n\n\n\n\n\n/* ********************************************************************************* */\n/* ******************** W R D S   R E S E A R C H   M A C R O S ******************** */\n/* ********************************************************************************* */\n/* WRDS Macro: WINSORIZE                                                             */\n/* Summary   : Winsorizes or Trims Outliers                                          */\n/* Date      : April 14, 2009                                                        */\n/* Author    : Rabih Moussawi, WRDS                                                  */\n/* Variables : - INSET and OUTSET are input and output datasets                      */\n/*             - SORTVAR: sort variable used in ranking                              */\n/*             - VARS: variables to trim and winsorize                               */\n/*             - PERC1: trimming and winsorization percent, each tail (default=1%)   */\n/*             - TRIM: trimming=1/winsorization=0, default=0                         */\n/* ********************************************************************************* */\n\n%MACRO WINSORIZE (INSET=,OUTSET=,SORTVAR=,VARS=,PERC1=1,TRIM=0);\n\n/* List of all variables */\n%let vars = %sysfunc(compbl(&vars));\n%let nvars = %nwords(&vars);\n\n/* Display Output */\n%put ### START.;\n\n/* Trimming / Winsorization Options */\n%if &trim=0 %then %put ### Winsorization; %else %put ### Trimming;\n%put ### Number of Variables:  &nvars;\n%put ### List   of Variables:  &vars;\noptions nonotes;\n\n/* Ranking within &sortvar levels */\n%put ### Sorting... ;\nproc sort data=&inset; by &sortvar; run;\n\n/* 2-tail winsorization/trimming */\n%let perc2 = %eval(100-&perc1);\n\n%let var2 = %sysfunc(tranwrd(&vars,%str( ),%str(__ )))__;\n%let var_p1 = %sysfunc(tranwrd(&vars,%str( ),%str(__&perc1 )))__&perc1 ;\n%let var_p2 = %sysfunc(tranwrd(&vars,%str( ),%str(__&perc2 )))__&perc2 ;\n\n/* Calculate upper and lower percentiles */\nproc univariate data=&inset noprint;\nby &sortvar;\nvar &vars;\noutput out=_perc pctlpts=&perc1 &perc2 pctlpre=&var2;\nrun;\n\n%if &trim=1 %then\n%let condition = %str(if myvars(i)&gt;=perct2(i) or myvars(i)&lt;=perct1(i) then myvars(i)=. );\n%else %let condition = %str(myvars(i)=min(perct2(i),max(perct1(i),myvars(i))) );\n\n%if &trim=0 %then %put ### Winsorizing at &perc1.%... ;\n%else %put ### Trimming at &perc1.%... ;\n\n/* Save output with trimmed/winsorized variables */\ndata &outset;\nmerge &inset (in=a) _perc;\nby &sortvar;\nif a;\narray myvars {&nvars} &vars;\narray perct1 {&nvars} &var_p1;\narray perct2 {&nvars} &var_p2;\ndo i = 1 to &nvars;\n    if not missing(myvars(i)) then\n    do;\n    &condition;\n    end;\nend;\ndrop i &var_p1 &var_p2;\nrun;\n\n/* House Cleaning */\nproc sql; drop table _perc; quit;\noptions notes;\n\n%put ### DONE . ; %put ;\n\n%MEND WINSORIZE;\n\n/* ********************************************************************************* */\n/* *************  Material Copyright Wharton Research Data Services  *************** */\n/* ****************************** All Rights Reserved ****************************** */\n/* ********************************************************************************* */"
  },
  {
    "objectID": "research/index.html",
    "href": "research/index.html",
    "title": "Research",
    "section": "",
    "text": "Consumer Behaviour and Credit Supply: Evidence from an Australian FinTech Lender, with Henry Leung, Linhui Liu and Buhui Qiu, Finance Research Letters, 2023. SSRN\n\nConsumer behaviour affects FinTech lending decisions.\n\nCloser Than Ever: Growing Business-level Connections Between Australia and Europe, with Boris Choy, Teresa Davis, Hanyun Ding, Massimo Garbuio, Catherine Hardy, Henry Leung, Thanh Son Luong, Greg Patmore, Sandra Peter, Buhui Qiu, Kai Riemer, John Shields, Catherine Sutton-Brady, Carlos Vazquez-Hernandez, and Eliza Wu, European Management Journal, 2023.\n\nInvited submission\n\nOrganization Capital and Executive Performance Incentives, with Henry Leung and Buhui Qiu, Journal of Banking & Finance, 2021. SSRN\n\n\n\n\n\nSpecification Curve - Organization Capital and Executive PFPS\n\n\n\nA firm’s organization capital has a substitution effect on its executive pay-for-performance sensitivity.\nOutstanding PhD Student Paper Award, 3rd Global PhD Colloquium.\nFMA 2020, 3rd Global PhD Colloquium, 32nd Annual PhD Conference in Economics and Business."
  },
  {
    "objectID": "research/index.html#publications",
    "href": "research/index.html#publications",
    "title": "Research",
    "section": "",
    "text": "Consumer Behaviour and Credit Supply: Evidence from an Australian FinTech Lender, with Henry Leung, Linhui Liu and Buhui Qiu, Finance Research Letters, 2023. SSRN\n\nConsumer behaviour affects FinTech lending decisions.\n\nCloser Than Ever: Growing Business-level Connections Between Australia and Europe, with Boris Choy, Teresa Davis, Hanyun Ding, Massimo Garbuio, Catherine Hardy, Henry Leung, Thanh Son Luong, Greg Patmore, Sandra Peter, Buhui Qiu, Kai Riemer, John Shields, Catherine Sutton-Brady, Carlos Vazquez-Hernandez, and Eliza Wu, European Management Journal, 2023.\n\nInvited submission\n\nOrganization Capital and Executive Performance Incentives, with Henry Leung and Buhui Qiu, Journal of Banking & Finance, 2021. SSRN\n\n\n\n\n\nSpecification Curve - Organization Capital and Executive PFPS\n\n\n\nA firm’s organization capital has a substitution effect on its executive pay-for-performance sensitivity.\nOutstanding PhD Student Paper Award, 3rd Global PhD Colloquium.\nFMA 2020, 3rd Global PhD Colloquium, 32nd Annual PhD Conference in Economics and Business."
  },
  {
    "objectID": "research/index.html#working-papers",
    "href": "research/index.html#working-papers",
    "title": "Research",
    "section": "📝 Working Papers",
    "text": "📝 Working Papers\n🆕 Mind the Gap: AI Adoption Disparity and Supply Chain Dynamics, with Giacinta Cestone, Jiaying Li and Ruiqi Mao.\n\nNordic Initiative for Corporate Economics (NICE) 2025 (invited), 3rd Aarhus Workshop on Strategic Interaction in Corporate Finance (scheduled).\n\nBorrower Technology Similarity and Bank Loan Contracting, with Yunying Huang, Steven Ongena and Eliza Wu.\n\nSFS Cavalcade 2024, EFA 2023 (poster), FMA 2023, 35th AFBC, Macquarie University, University of Sydney.\nSemifinalist for FMA 2023 Best Paper Award.\nCEPR Discussion Paper DP18624.\n\nLone (Loan) Wolf Pack Risk, with Iftekhar Hasan, Buhui Qiu and Eliza Wu.\n\n\n\n\n\nAggregate Syndicate Concentration\n\n\n\nWFA 2023, FIRN 2023, FIRN Banking 2022, Curtin University, Massey University, National Central University, University of Essex, University of Sydney.\nThe Brattle Group Best Paper Award, FIRN 2023.\nSUERF Policy Brief No. 586, Bank of Finland Research Discussion Paper No. 4/2023.\n\nCatering to Environmental Premium in Green Venture Financing, with Henry Leung, Tse-Chun Lin and Tracy Thi Vu.\n\nOxford Sustainable Private Markets Conference 2025, RBFC 2024, AsianFA 2024, Journal of Contemporary Accounting and Economics (JCAE) Annual Symposium 2024, 7th Advances in Venture Capital and Private Equity Research Workshop, National Taiwan University.\nPodcast by NotebookLM.\n\n(Dis)agreement at the 52 Week High: When Liquidity Becomes a Barrier, with Joshua Della Vedova, Andrew Grant, Joakim Westerholm and Barbara Bliss.\n\nPreviously titled as Investor Disagreement, Liquidity and Informational Efficiency at the 52 Week High.\nFMA-Europe 2024, 17th International Behavioural Finance Conference, EFMA 2024, Multinational Finance Society annual meeting 2024, FMA 2020.\n\nAnomalous Lending and Bank Risk, with Iftekhar Hasan, Buhui Qiu, Eliza Wu and Yan Yu.\n\nReject & Resubmit at the Management Science.\nMQBS Banking and Finance Forum 2024, FIRN 2023, Monash Winter Finance 2023, Machine Learning Methods for Business Workshop 2023, BFBRG Workshop 2022, Deakin University, Loughborough University, University of Queensland, University of Sydney.\n\nReal Estate Collateral, Lender Screening, and M&A Performance, with Thanh Son Luong and Buhui Qiu.\n\nReject & Resubmit at the Review of Corporate Finance Studies.\nFMA 2022, FIRN 2022."
  },
  {
    "objectID": "research/index.html#data-code",
    "href": "research/index.html#data-code",
    "title": "Research",
    "section": "👨‍💻 Data & Code",
    "text": "👨‍💻 Data & Code\n\n(code) Discretionary accruals\n(docs) Download M&A data from SDC\n(code & data) Historical firm HQ location 1969-2022\n(code) Merton distance-to-default (default probability)\n(code) Organization capital\n(code) Specification curve analysis - listed in Harvard Business School Research Computing Services blog. For the Stata command, see my specurve.\n(code) Textual analysis on 8K filings. For a full Python CLI application, see my edgar-analyzer.\n(code) Variance ratio test - Lo and MacKinlay (1988)"
  },
  {
    "objectID": "research/index.html#student-supervision",
    "href": "research/index.html#student-supervision",
    "title": "Research",
    "section": "‍🎓 Student Supervision",
    "text": "‍🎓 Student Supervision\nStudents for whom I am the Associate Supervisor:\n\nTracy Wu, MRes student at Macquarie University, 2024 (co-supervision with Elizabeth Sheedy).\nMeitong He, Honours student at University of Sydney, 2023 (co-supervision with Buhui Qiu). Graduated with First Class Honours."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banks-need-regulation",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banks-need-regulation",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banks need regulation",
    "text": "Banks need regulation\nDIs (banks, interchangeably) are financial institutions chartered to take deposits from the public and grant loans simultaneously. They are necessary in an economy achieving efficient allocation of financial resources.\nHowever, we also note that\n\nthe banking structure itself could cause financial fragility (Diamond and Dybvig 1983).\nthe collapse of bank credit contributes to economic crisis (Bernanke 1983).\n\nTherefore, bank failures have significant negative externality. As a result, banks are heavily regulated."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulations",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulations",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulations",
    "text": "Banking regulations\nWhat types of regulations are needed or in place for banks?\n\nentry and chartering\nsafety and soundness\ncredit allocation\nconsumer and investor protection\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#an-example-entry-and-chartering-regulation",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#an-example-entry-and-chartering-regulation",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "An example: entry and chartering regulation",
    "text": "An example: entry and chartering regulation\nEconomic theories generally view competition as improving social welfare. But it is not necessarily true for the banking sector.\n\nConsider the location model of Salop (1979).\nFree entry leads to too many banks that is sub-optimal.\nIncreasing bank costs (e.g., higher reserve requirements) does not limit bank numbers.\nCharters (business license) could help.\nChartering also helps with other regulations."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#the-gfc-and-the-new-banking-regulatory-landscape",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#the-gfc-and-the-new-banking-regulatory-landscape",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "The GFC and the new banking regulatory landscape",
    "text": "The GFC and the new banking regulatory landscape\n\n\n\n\n\n\n\n\nFigure 1: Impact of the Great Recession on GDP\n\n\n\n\n\n\nThe Global Financial Crisis (2007-2009) caused the Great Recession that persistently undermines the economy.\nThe regulations were unable to prevent the collapse of the banking sector.\nNew regulatory framework, Basel III, established in response."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#the-new-banking-regulatory-landscape",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#the-new-banking-regulatory-landscape",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "The new banking regulatory landscape",
    "text": "The new banking regulatory landscape\nBefore GFC, the banking regulations primarily focused on prudential regulations concerning the risks of individual banks.\n\nCapital adequacy: sufficient capital to cover potential losses.\nRisk management: ability to manage various risks such as credit, market, and operational risks.\nLiquidity management: enough liquid resources to meet immediate obligations.\n\n\nPost-GFC, the banking regulations have expanded to include macroprudential regulations.\n\nSystemic focus: greater emphasis on understanding and mitigating systemic risks that could destabilize the entire financial system.\nCountercyclical policies: measures introduced to mitigate the procyclical effects of previous regulatory approaches.\nStress testing: system-wide tests to assess the resilience of the financial system to shocks."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banking-and-trading-books",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banking-and-trading-books",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking and trading books",
    "text": "Banking and trading books\nA bank has a banking book and a trading book, two different ways to categorize financial assets and liabilities, each governed by different management strategies and regulatory standards.1\n\nBanking book\n\nAssets and liabilities that the bank intends to hold for the long term.\nPrimarily used for traditional banking activities, e.g., lending and taking deposits.\n\nTrading book\n\nAssets and liabilities that the bank intends to trade actively.\nThe value and income from these assets are driven by market conditions and short-term price movements.\n\n\nSee suggested readings for the boundary between banking and trading books."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#what-risks-do-banks-face",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#what-risks-do-banks-face",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "What risks do banks face?",
    "text": "What risks do banks face?\nThe most simplified balance sheet of a bank:\n\n\n\nTable 1: Typical balance sheet of a DI\n\n\n\n\n\nAssets\nLiabilities and Equity\n\n\n\n\nLoans\nDeposits\n\n\nOther assets\nOther liabilities\n\n\n\nEquity\n\n\n\n\n\n\n\nRisks on the assets side.\nRisks on the liabilities and equity side.\nOther risks beyond the balance sheet."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-assets-side",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-assets-side",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the assets side",
    "text": "Risks on the assets side\n\nLoans\nOther assets (bonds, investment securities, derivatives)\n\n\n\nFigure 2: Excerpt of CBA’s 2023 balance sheet - assets"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-assets-side---loans",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-assets-side---loans",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the assets side - loans",
    "text": "Risks on the assets side - loans\nLoans are often in the banking book and reported based on amortised book value.\nMajor risks due to uncertainties in:\n\nBorrower’s creditworthiness, credit risk\nInterest rate when rolling over / repricing the loans, interest rate risk\nExchange rate if loans are denominated in foreign currencies, foreign exchange risk\nAbility to liquidate the loans, liquidity risk\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-assets-side---other-assets",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-assets-side---other-assets",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the assets side - other assets",
    "text": "Risks on the assets side - other assets\nBonds, derivatives, investment securities, …\n\n\nFor example, a bond’s price is given by\n\\[\nP = \\sum_{t=1}^T\\frac{C}{(1+r)^t} + \\frac{F}{(1+r)^T}\n\\qquad(1)\\]\nwhere \\(C\\) is coupon payment, \\(F\\) face value, \\(T\\) maturity, and \\(r\\) interest rate.\nRisks due to uncertainties in:\n\n\\(C\\) and \\(F\\), credit risk\n\\(r\\), interest rate risk\n\n\n\n\nCode\nviewof maturity4 = Inputs.range(\n  [1, 30], \n  {value: 15, step: 1, label: \"Maturity (years):\"}\n)\nviewof couponRate4 = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.05, step: 0.01, label:\"Coupon rate:\"}\n)\nd = {\n  const f = 100;\n  let c, m;\n  c = couponRate4;\n  m = maturity4;\n  function pv(c, f, t, r) {\n    return c * (1 - (1+r)**(-t)) / r + f / (1+r)**(t)\n  }\n  const prices = {\"YTM\": [], \"Price\": []};\n  let coupon = f * c;\n  for (let ytm = 0.01; ytm &lt; 20; ytm++) {\n    let price = pv(coupon, f, m, ytm/100);\n    prices[\"YTM\"].push(ytm);\n    prices[\"Price\"].push(price);\n  }\n  return prices;\n}\n\ndata4 = transpose(d)\nPlot.plot({\n  caption: \"Assume $100 bond, annual coupons paid in arrears and effective annual discount rate.\",\n  x: {padding: 0.4, label: \"YTM (%)\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0, 100]),\n    Plot.ruleX([0]),\n    Plot.lineY(data4, {x: \"YTM\", y: \"Price\", stroke: \"blue\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMany are on the trading book.\n\nMarket risk\nLiquidity risk"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-liabilities-and-equity-side",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-liabilities-and-equity-side",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the liabilities and equity side",
    "text": "Risks on the liabilities and equity side\n\nDeposits\nOther liabilities (primarily debts)\n\n\n\nFigure 3: Excerpt of CBA’s 2023 balance sheet - liabilities"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-liabilities-and-equity-side---deposits",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-liabilities-and-equity-side---deposits",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the liabilities and equity side - deposits",
    "text": "Risks on the liabilities and equity side - deposits\n\n\nDeposits are the most important funding source of banks - 60% for Australian banks.\n\nNon-interest bearing deposits.1\nOn-demand and short-term deposits.\nTerm deposits.\nCertificates of deposits.\n\nRisks involved:\n\nInterest rate risk\nLiquidity risk\nIf foreign currencies, foreign exchange risk\n\n\n\n\n\n\n\n\nFigure 4: Funding composition of banks in Australia\n\n\n\n\nCheck if your everyday transaction accounts earn you interest!"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-liabilities-and-equity-side---debts",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-liabilities-and-equity-side---debts",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the liabilities and equity side - debts",
    "text": "Risks on the liabilities and equity side - debts\nDebts are also an important funding source of banks.\n\nAccount for about 30% of bank funding in Australia.\n\nRisks involved:\n\nInterest rate risk\nLiquidity risk\nIf foreign currencies, foreign exchange risk"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-liabilities-and-equity-side---equity",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#risks-on-the-liabilities-and-equity-side---equity",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the liabilities and equity side - equity",
    "text": "Risks on the liabilities and equity side - equity\nEquity, assets value minus liabilities.\n\nInsolvency risk\nManifestation of many other risks - a focus of banking regulations\n\nInterest rate risk: changing interest rates cause disproportionate changes in assets value and liabilities value.\nMarket risk: losses from adverse changes in market conditions, such as interest rate fluctuations or stock market declines.\nCredit risk: high default rates on loans and other credit products can erode asset values.\nLiquidity risk: inability to convert assets into cash quickly without significant losses.\nOperational risk: losses stemming from failed internal processes, systems, human errors, or external events.\nConcentration risk: overexposure to a specific borrower, industry, or geographic region."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#risks-beyond-balance-sheet",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#risks-beyond-balance-sheet",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks beyond balance sheet",
    "text": "Risks beyond balance sheet\nMany other risks:\n\nESG risk\nCybersecurity risk\n\nUniSuper1 week-long service outage in May 2024.\n\n…\n\n\n\n\n\n\n\nNote\n\n\nSee how NAB discusses risk factors, p89 of its annual report 2023.\n\n\n\nAlbeit not a DI."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#bank-failure",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#bank-failure",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Bank failure",
    "text": "Bank failure\nBank failure occurs when a bank is unable to meet its obligations to its depositors or other creditors and either goes bankrupt or must be taken over by a financial regulatory body to avoid bankruptcy.\n\n\nFigure 5: Bank failures in the US"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#silicon-valley-bank-svb-failure",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#silicon-valley-bank-svb-failure",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Silicon Valley Bank (SVB) failure",
    "text": "Silicon Valley Bank (SVB) failure\nSVB’s failure in March 2023 is the largest failure since GFC.\n\nConcentration risk: highly concentrated client base primarily in the tech and VC sectors\nInterest rate risk: a large amount of long-duration assets, like U.S. Treasury bonds and mortgage-backed securities, which decreased in value as interest rates rose sharply.\nLiquidity risk: rising interest rates led to a mismatch in the liquidity profile as SVB’s assets (long-term bonds) lost value while liabilities (deposits) demanded immediate liquidity.\nMarket risk: capital raising through asset sales and stock offerings poorly received by the market.\nBank run: news of the bank’s difficulties led to a rapid and large-scale withdrawal of deposits by clients, creating a classic bank run."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#bank-risks---our-approach",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#bank-risks---our-approach",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Bank risks - our approach",
    "text": "Bank risks - our approach\nIn this course, we will examine bank risks one by one in a three-step framework:\n\nIdentify: definition, source and nature\nMeasure: ways to gauge the exposure\nManage: strategies to mitigate"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#regulations-of-banks",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#regulations-of-banks",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Regulations of banks",
    "text": "Regulations of banks\nFailure of banks has significant negative externality.\n\nLoss of deposits for savers\nNo credit supply for borrowers\nImpact on real economy\nGlobal Financial Crisis (GFC) 2007-2009\n\nBroadly, banking regulations can be classified into two aspects:\n\nMicroprudential regulations: safety and soundness of individual institutions\nMacroprudential regulations: stability of the financial system\n\nThe two aspects are not mutually exclusive, but complementary."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#microprudential-regulations",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#microprudential-regulations",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Microprudential regulations",
    "text": "Microprudential regulations\n\nFocus:\n\nTargets the safety and soundness of individual financial institutions.\n\nObjectives:\n\nPrevent the failure of banks and other financial entities.\nProtect consumers’ deposits and maintain confidence in the financial system.\n\nMethods:\n\nSetting capital adequacy requirements.\nEnforcing liquidity requirements to manage short-term obligations.\nImplementing risk management standards and supervisory review processes.\nConducting regular inspections and audits of individual institutions."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#macroprudential-regulations",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#macroprudential-regulations",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Macroprudential regulations",
    "text": "Macroprudential regulations\n\nFocus:\n\nAims at the stability of the financial system as a whole.\n\nObjectives:\n\nPrevent systemic risks and financial crises that affect the entire economy.\nReduce financial system vulnerabilities from interconnectedness and procyclical tendencies.\n\nMethods:\n\nImplementing caps on overall credit growth and sector-specific loan concentrations.\nUsing stress tests that simulate adverse economic scenarios to gauge system-wide resilience.\nApplying countercyclical capital buffers that increase during economic booms and decrease during downturns."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#international-banking-regulatory-framework",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#international-banking-regulatory-framework",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "International banking regulatory framework",
    "text": "International banking regulatory framework\nThe Bank for International Settlements (BIS) established in 1930 is the principal centre for international central bank cooperation.\n\nWW2 to 1970s: implementing and defending the Bretton Woods system.\n1970s to 80s: managing cross-border capital flows following oil crises and the international debt crisis.\n1988 Basel Capital Accord and Basel II revision of 2001 to 2006: establishing and revising international standards for capital adequacy.\nPost-GFC: Basel III, a set of reforms designed to improve the regulation, supervision, and risk management of banks.\nNow: development of Basel IV (Basel 3.1)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia",
    "text": "Banking regulators in Australia\nThe Council of Financial Regulators (CFR) coordinates main financial regulatory agencies in Australia, including:1\n\nReserve Bank of Australia (RBA), chairs the Council\nAustralian Prudential Regulation Authority (APRA)\nAustralian Securities & Investments Commission (ASIC)\nDepartment of Treasury (the Treasury)\n\nCFR is non-statutory and has no regulatory functions."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia---rba",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia---rba",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia - RBA",
    "text": "Banking regulators in Australia - RBA\n\n\nFigure 6: Evolution of the RBA"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia---rba-1",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia---rba-1",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia - RBA",
    "text": "Banking regulators in Australia - RBA\nRBA is the central bank of Australia.\n\nIts duty is to contribute to the stability of the currency, full employment, and the economic prosperity and welfare of the Australian people.\nIt does this by conducting monetary policy to meet an agreed inflation target, working to maintain a strong financial system and efficient payments system, and issuing the nation’s banknotes.\n\nThe role and functions of the RBA explained by the Governor Michele Bullock [Video]."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia---apra",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia---apra",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia - APRA",
    "text": "Banking regulators in Australia - APRA\nAPRA, established in 1998, is an independent statutory authority that supervises institutions across banking, insurance and superannuation, and is accountable to the Australian Parliament.\nAPRA’s primary functions and objectives include:\n\nPrudential Supervision: APRA sets prudential standards and practices for financial institutions to maintain stability and prevent systemic failures. This includes regulations on capital adequacy, risk management, and governance.\nFinancial Stability: APRA contributes to the overall stability of the financial system by monitoring and mitigating risks that could lead to financial crises.\nProtection of Depositors, Policyholders, and Superannuation Fund Members: APRA ensures that institutions meet their financial promises to customers, protecting their interests and enhancing confidence in the financial system."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia---asic",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia---asic",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia - ASIC",
    "text": "Banking regulators in Australia - ASIC\nASIC is Australia’s corporate, markets, and financial services regulator.\n\nResponsible for market integrity and consumer protection across the financial system.\nSets standards for financial market behaviour with the aim to protect investor and consumer confidence.\nAdministers the Corporations Law to promote honesty and fairness in companies and markets."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia---treasury",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-australia---treasury",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia - Treasury",
    "text": "Banking regulators in Australia - Treasury\nThe Department of the Treasury (Treasury) also plays a role in the formulation and implementation of banking regulations in Australia.\n\nPolicy Development: Treasury works closely with regulatory bodies like the Reserve Bank of Australia (RBA), Australian Prudential Regulation Authority (APRA), and Australian Securities & Investments Commission (ASIC) to develop policies that ensure the stability and integrity of the banking system.\nLegislative Framework: It is involved in drafting and implementing legislation related to banking regulation, such as the Banking Act and financial sector reforms."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-the-u.s.",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-the-u.s.",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in the U.S.",
    "text": "Banking regulators in the U.S.\nSome important ones include:\n\nFederal Reserve System (The Fed): central bank of the United States.\nOffice of the Comptroller of the Currency (OCC): charters, regulates, and supervises all national banks and federal savings associations.\nFederal Deposit Insurance Corporation (FDIC): insures deposits at banks and thrift institutions, supervises financial institutions, and manages receiverships of failed banks."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-china",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-china",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in China",
    "text": "Banking regulators in China\nSome important ones include:\n\nPeople’s Bank of China (PBOC): central bank of China.\nNational Administration of Financial Regulation (NAFR): established in May 2023, replaced the former China Banking and Insurance Regulatory Commission (CBIRC)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-europe",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#banking-regulators-in-europe",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Europe",
    "text": "Banking regulators in Europe\nSome important ones include:\n\nEuropean Central Bank (ECB): oversees monetary policy for the Eurozone and supervises significant banks within member states to ensure financial stability.\nEuropean Banking Authority (EBA): develops regulatory standards and guidelines to maintain the stability and integrity of the EU’s banking sector, coordinating efforts among national regulators.\nEuropean Systemic Risk Board (ESRB): monitors and assesses systemic risks."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#suggested-readings",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nHistory of BIS\nOrigins of the Reserve Bank of Australia\nBasel Framework - Risk-based Capital Requirements (RBC), RBC25 Boundary between the banking book and the trading book\nBanks’ funding costs and lending rates\nFDIC bank failures\nAbout APRA\nASIC website\nMoU between the Treasury and the APRA"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week2/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week2/index.html#references",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nBernanke, Ben S. 1983. “Nonmonetary Effects of the Financial Crisis in the Propagation of the Great Depression.” The American Economic Review 73 (3): 257–76.\n\n\nDiamond, Douglas W., and Philip H. Dybvig. 1983. “Bank Runs, Deposit Insurance, and Liquidity.” Journal of Political Economy 91 (3): 401–19.\n\n\nSalop, Steven C. 1979. “Monopolistic Competition with Outside Goods.” The Bell Journal of Economics 10 (1): 141."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#defining-capital",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#defining-capital",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Defining “capital”",
    "text": "Defining “capital”\nUnderstanding how capital safeguards a financial institution (FI) from insolvency risk requires a clear definition of capital. However, definitions vary significantly across different perspectives:\n\nEconomist’s Perspective: Economists define an FI’s capital, or owners’ equity, as the difference between the market values of its assets and liabilities, also known as net worth. This concept aligns with market value accounting.\nAccounting Perspective: Accountants typically focus on book value, which is the historical cost of assets minus liabilities as recorded in financial statements.\nRegulatory Perspective: Regulatory bodies have crafted definitions of capital that may diverge from economic net worth to prioritize financial stability. Regulatory capital requirements often rely on historical or book value accounting concepts.\n\nRegulatory capital includes various tiers (e.g., Tier 1 and Tier 2) and is used to assess capital adequacy."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#capital-of-financial-institutions-fis",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#capital-of-financial-institutions-fis",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital of financial institutions (FIs)",
    "text": "Capital of financial institutions (FIs)\nThe major functions of capital are\n\nto absorb unanticipated losses to enable the FI to continue as a going-concern\nto protect uninsured depositors, bondholders and creditors in case of insolvency and liquidation\nto protect FI insurance funds and the taxpayer\nto protect the FI owners against increases in insurance premiums\nto partially fund the FI’s real investment activities\n\n\n\n\n\n\n\n\nWhy is capital important in a regulatory context? APRA’s explanation of capital\n\n\nFrom a prudential regulator’s perspective, capital is a measure of the financial cushion available to an institution to absorb any unexpected losses it experiences in running its business. For a bank, such losses might include loans that default and are written off. Insurers might be hit by an unexpectedly high volume of claims in the wake of a major natural disaster.\n\n\n\n\nSufficient capital levels\n\ninspire confidence in the FI\nenable the FI to continue as a going concern even in difficult times"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#example-of-bank-net-worth-capital-absorbing-losses",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#example-of-bank-net-worth-capital-absorbing-losses",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Example of bank net worth (capital) absorbing losses",
    "text": "Example of bank net worth (capital) absorbing losses\nThe marking-to-market method allows balance sheet values to reflect current rather than historic prices.\nConsider the following market value balance sheet of an FI:\n\n\n\n\n\nTable 1: Market-value-based balance sheet before loan losses\n\n\n\n\n\nAssets ($m)\nAmount\nLiabilities ($m)\nAmount\n\n\n\n\nSecurities\n70\nDeposits\n85\n\n\nLoans\n30\nNet worth\n15\n\n\nTotal assets\n100\nTotal liabilities + equity\n100\n\n\n\n\n\n\n\n\nIn this example the FI is solvent on a market value basis."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#example-of-bank-net-worth-capital-absorbing-losses-1",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#example-of-bank-net-worth-capital-absorbing-losses-1",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Example of bank net worth (capital) absorbing losses",
    "text": "Example of bank net worth (capital) absorbing losses\nThe marking-to-market method allows balance sheet values to reflect current rather than historic prices.\nConsider a fall in the market value of loans to $10 (a fall of $20m).\n\n\n\n\n\nTable 2: Market-value-based balance sheet after loan losses\n\n\n\n\n\nAssets ($m)\nAmount\nLiabilities ($m)\nAmount\n\n\n\n\nSecurities\n70\nDeposits\n85\n\n\nLoans\n10\nNet worth\n-5\n\n\nTotal assets\n80\nTotal liabilities + equity\n80\n\n\n\n\n\n\n\n\nFI is now insolvent, its net worth has declined from $15 to -$5. The owners’ net worth stake has been completely wiped out.\n\nAfter the liquidation of the remaining $80 in assets, depositors would get only 80/85 in dollars, without deposit insurance.\n\n\nThe FI’s capital is used to absorb (partially) the losses.\n\n\nThe example also shows that market valuation of the balance sheet produces an economically accurate picture of the net worth and thus the solvency position of an FI."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#the-book-value-of-capital",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#the-book-value-of-capital",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "The book value of capital",
    "text": "The book value of capital\nHowever, the FI’s balance sheet based on book value could remain unchanged.\n\n\n\nTable 3: Book-value-based balance sheet after loan losses\n\n\n\n\n\nAssets ($m)\nAmount\nLiabilities ($m)\nAmount\n\n\n\n\nSecurities\n70\nDeposits\n85\n\n\nLoans\n30\nNet worth\n15\n\n\nTotal assets\n100\nTotal liabilities + equity\n100\n\n\n\n\n\n\nNote that Table 3 looks identical to Table 1.\nWith book value accounting, FIs have discretion in how and when they report loan losses on their balance sheets.\nThis flexibility allows them to strategically manage the recognition of these losses and their subsequent effect on capital.\n\nFor example, the FI could just record an increase in loan loss provisions to reflect their expected loan losses (e.g., $5m).\n\n\n\nTable 4: Book-value-based balance sheet with loan loss provisions\n\n\n\n\n\n\n\n\n\n\n\nAssets ($m)\nAmount\nLiabilities ($m)\nAmount\n\n\n\n\nSecurities\n70\nDeposits\n85\n\n\nLoans\n30\nNet worth\n10\n\n\nless loan loss provisions\n(5)\n\n\n\n\nTotal assets\n95\nTotal liabilities + equity\n95"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#market-value-vs-book-value-of-equity",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#market-value-vs-book-value-of-equity",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Market-value vs book-value of equity",
    "text": "Market-value vs book-value of equity\nObviously, market-value-based view of capital allows for a more accurate and comprehensive description of FIs’ financial health.\n\nIf regulators close a FI before it’s market value of capital reaches zero, liability holders will not lose.\n\nBut not all assets and liabilities are valued as fair value (market value).\n\n\n\n\n\n\nNote\n\n\n\nThe Financial Accounting Standards Board (FASB) sets out Financial Accounting Standards (FAS) and the Generally Accepted Accounting Principles (GAAP), adopted in the U.S.\nThe International Accounting Standards Board (IASB) sets out the International Financial Reporting Standards (IFRS), adopted in many other places.\n\n\n\n\nAll trading assets, marketable securities (“available for sale”) are marked to market.\nLoans and debt securities held for investment or to maturity are carried at amortized cost (book value).\n\n\n\n\n\n\nTip\n\n\nRecall a bank’s banking book and trading book."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#why-not-market-value-for-all",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#why-not-market-value-for-all",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Why not market value for all?",
    "text": "Why not market value for all?\n\nDifficult to implement, especially for small banks, building societies and credit unions with large amounts of non-traded assets\nIntroduces unnecessary variability into an FI’s earnings\nFIs are less willing to take long-term asset exposures such as commercial mortgages and business loans, since long-term assets are more interest rate sensitive.\n\n\n\n\nExample balance sheet of a bank\n\n\n\n\n\n\n\n\nAssets ($m)\nAmount\nLiabilities ($m)\nAmount\n\n\n\n\nCash\n20\nDeposits\n80\n\n\n10-yr 5% corporate loans\n100\nNet worth\n40\n\n\nTotal assets\n120\nTotal liabilities + equity\n120\n\n\n\nChange in market conditions (like yield) can cause significant variation in bank’s capital value.\n\n\n\n\n\nCode\nviewof cash = Inputs.range(\n    [0, 100],\n    {value: 20, step: 1, label:\"Cash:\"}\n)\nviewof capital = Inputs.range(\n    [0, 100],\n    {value: 40, step: 1, label:\"Initial capital:\"}\n)\nd = {\n  const c = 0.05, m = 10;\n  const loan = 100;\n  const y = 0.05;\n  function pv(c, f, t, r) {\n    return c * (1 - (1+r)**(-t)) / r + f / (1+r)**(t)\n  }\n  const prices = {\"YTM\": [], \"Equity\": []};\n  let coupon = loan * c;\n  let deposits = 120 - capital;\n  for (let ytm = 0.01; ytm &lt; 20; ytm++) {\n    let mvloan = pv(coupon, loan, m, ytm/100);\n    let dy = ytm - y*100;\n    prices[\"YTM\"].push(dy);\n    prices[\"Equity\"].push(cash + mvloan - deposits);\n  }\n  return prices;\n}\n\nPlot.plot({\n  caption: \"Assume current YTM of 5%.\",\n  x: {padding: 0.4, label: \"Change in YTM (%)\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0]),\n    Plot.ruleX([0]),\n    Plot.lineY(transpose(d), {x: \"YTM\", y: \"Equity\", stroke: \"blue\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAs a result, market value accounting may interfere with FIs’ special functions as lenders and monitors and may even result in (or accentuate) a major credit crunch."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#capital-management-and-regulation",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#capital-management-and-regulation",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital management and regulation",
    "text": "Capital management and regulation\nIn summary,\n\ncapital is useful to absorb losses and to mitigate insolvency risk;\nregulators use book value accounting standards to determine the adequate capital requirements for FIs.\n\nAs a result, FI’s capital is guided by two key factors:\n\nregulated capital adequacy requirements, and\nthe risk-return trade-offs."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#who-determines-the-capital-requirements",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#who-determines-the-capital-requirements",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Who determines the capital requirements?",
    "text": "Who determines the capital requirements?\nActual capital ratios applied can be country-specific, determined by national regulators. However, the Basel Accords provide the global framework for these capital ratios.\n\nThe Basel Committee on Banking Supervision (BCBS) of the BIS sets out the 1988 Basel Capital Accord.\nMember countries of the BIS agreed and implemented the Basel Capital Accord (Basel I).\n\na minimum ratio of capital to risk-weighted assets of 8%.\n\nA series of updates led to the Basel Accord of 2006 (Basel II)\nBasel III: responding to the 2007-09 financial crisis."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#basel-i",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#basel-i",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Basel I",
    "text": "Basel I\nTwo capital ratios:\n\nTier 1 Capital Ratio\n\nPrimarily composed of common equity, retained earnings, and disclosed reserves, less goodwill and other intangibles.\nCalculation: Tier 1 Capital / Risk-Weighted Assets (RWA)\nMinimum requirement: 4%\n\nTotal Capital Ratio\n\nMinimum requirement: 8%\n\n\nFeatures:\n\nBasel I introduced the systematic measurement of capital adequacy through the use of risk-weighted assets.\nBasel I utilized RWA to account for the varying risk levels of different asset classes, including both on-balance-sheet and off-balance-sheet exposures.\n\nCriticisms:\n\nCredit Risk Focus: Basel I primarily recognized credit risk in the calculation of risk-weighted assets. It did not initially incorporate market risk or operational risk, leading to criticisms that it did not fully address the spectrum of risks faced by banks.1\n\nA revision in 1998 incorporated market risk into the framework."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#basel-ii",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#basel-ii",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Basel II",
    "text": "Basel II\nBasel II comprised three pillars:\n\nminimum capital requirements, which sought to develop and expand the standardised rules set out in the 1988 Accord\nsupervisory review of an institution’s capital adequacy and internal assessment process\neffective use of disclosure as a lever to strengthen market discipline and encourage sound banking practices\n\n\nThe measurement of capital did not change markedly in Basel II.\nThe measurement of risk was significantly enhanced to include operational risk, some market risks in the banking book, and risks associated with securitisation.\n\nUnder Basel II, two options are allowed for banks to measure their credit risk:\n\nStandardized approach. Similar to Basel I, but more risk-sensitive.\nInternal ratings-based (IRB) approach. Banks can use their internal rating system or credit scoring models to assess their portfolios, subject to regulatory approval.\n\nThree options are available for measuring operational risk:\n\nbasic indicator.\nstandardized approach.\nadvanced measurement approach."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#gfc-and-basel-2.5",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#gfc-and-basel-2.5",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "GFC and Basel 2.5",
    "text": "GFC and Basel 2.5\nThe Global Financial Crisis (GFC) in 2007-09 revealed that Basel II was flawed. For example,\n\ncredit ratings of complex securities were conducted by private companies without regulatory supervision or review\nBasel II capital adequacy formula was procyclical, meaning that the required capital was increasing as the crisis unfolded, making it even harder for banks during crisis\n\nIn response, Basel 2.5 was passed in 2009 (effective in 2013) and Basel III was passed in 2010 (phased in between 2013 and 2019).1\n\nBasel 2.5 updated capital requirements on market risk from banks’ trading activities.\n\nBasel III framework was revised and finalized in 2017 and the implementation was extended to January 1, 2022."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#basel-iii",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#basel-iii",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Basel III",
    "text": "Basel III\nBasel III is broader in perspective than just a revision of capital, capital adequacy, risk measurement and supervision. It introduced macroprudential measures, targeting the protection of the whole financial system.\nThree pillars similar to in Basel II, but with significant enhancements.\n\nImprovements to both standardized and IRB approaches in calculating adequate capital.\nInclusion of new capital conversion buffer and countercyclical capital buffer to the minimum required capital level.\nIntroduction of two minimum standards for funding liquidity: liquidity coverage ratio and net stable funding ratio.1\nHigher capital requirements for trading and derivative activities.\nEnhanced bank governance.\nEnhanced risk disclosure.\n\n\n\n\n\n\n\nNote\n\n\nBasel III is our focus, of course.\n\n\n\nThese liquidity ratios are discussed in Week 10 Liability and Liquidity Management."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#risk-based-capital-ratio-1",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#risk-based-capital-ratio-1",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-based capital ratio",
    "text": "Risk-based capital ratio\nUnder Basel III, depositary institutions (DIs) calculate and monitor four capital ratios:\n\n\n\nCommon equity Tier 1 (CET1) risk-based capital ratio \\[\n\\text{CET1 capital ratio} = \\frac{\\text{CET1 capital}}{\\text{Risk-weighted assets}}\n\\qquad(1)\\]\nTier 1 risk-based capital ratio \\[\n\\text{Tier 1 capital ratio} = \\frac{\\text{Tier 1 capital}}{\\text{Risk-weighted assets}}\n\\qquad(2)\\]\nTotal risk-based capital ratio \\[\n\\text{Total capital ratio} = \\frac{\\text{Total capital}}{\\text{Risk-weighted assets}}\n\\qquad(3)\\]\nTier 1 leverage ratio \\[\n\\text{Tier 1 leverage ratio} = \\frac{\\text{Tier 1 capital}}{\\text{Total exposure}}\n\\qquad(4)\\]\n\n\n\nThe calculation of these capital ratios is complex.\nUse risk-weighted assets (RWA) to distinguish the different credit risks of different assets.\nMeasure a DI’s credit risk (on-and off-balance-sheet).\n\n\n\n\n\n\n\nImportant\n\n\n\nAdditional capital charges for market risk and operational risk.\n\nFor now, we do not consider these risks and their impact on RWA.\nWe briefly explain how they affect RWA and capital ratios at the end of this lecture."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#standardized-and-irb-approaches-for-credit-risk",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#standardized-and-irb-approaches-for-credit-risk",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Standardized and IRB approaches for credit risk",
    "text": "Standardized and IRB approaches for credit risk\nSince Basel II, two options are available for banks to measure credit risk for calculating capital requirements.\n\nThe standardized approach.\n\nUsed by smaller depositary institutions.\n\nThe internal ratings-based (IRB) approach.\n\nUsed by large depositary institutions.\n\nUS: about 20 of the largest banking institutions with consolidated assets of $250 billion or more.1\nAustralia: currently approved for use by 6 of the largest banks in Australia.\n\n\n\nOr with consolidated on-balance-sheet foreign exposures of $10 billion or more."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#capital-ratios-of-dis-in-australia",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#capital-ratios-of-dis-in-australia",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital ratios of DIs in Australia",
    "text": "Capital ratios of DIs in Australia\n\n\n\n\n\n\n\n\nFigure 1: Capital ratios of DIs in Australia over time\n\n\n\n\n\n\n\n\n\n\nFigure 2: Capital ratios of DIs in Australia at December 2023"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#type-of-capital-cet1-capital",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#type-of-capital-cet1-capital",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Type of capital: CET1 Capital",
    "text": "Type of capital: CET1 Capital\nCET1 is the primary or core capital of a DI.\n\nCommon shares\nShare premium resulting from the issue of CET1 instruments\nRetained earnings\nAccumulated and other comprehensive income\nOther disclosed reserves\nCertain minority interests\nRegulatory adjustment applied in the calculation of CET1 Capital."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#type-of-capital-tier-1-capital",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#type-of-capital-tier-1-capital",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Type of capital: Tier 1 Capital",
    "text": "Type of capital: Tier 1 Capital\nTier 1 Capital is the sum of CET1 Capital and Additional Tier 1 Capital.\nAdditional Tier 1 Capital:\n\nInstruments issued by a DI that qualify for Additional Tier 1 Capital and are not included in CET1 capital.1\nShare premium resulting from the issue of instruments included in Additional Tier 1 Capital.2\nTier 1 minority interest not included CET1 capital.\nRegulatory adjustments applied in the calculation of Additional Tier I Capital.\n\nFor example, noncumulative perpetual preferred stock.In Table 21-3 of the textbook Saunders, Cornett, and Erhemjamts (2023), this entry incorrectly reads “Stock surplus (share premium) resulting from the issue of instruments included in Common Equity Tier I”. See page 15 of the original BIS publication “Basel III: A Global Regulatory Framework for More Resilient Banks and Banking Systems”, June 2011."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#type-of-capital-total-capital",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#type-of-capital-total-capital",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Type of capital: Total Capital",
    "text": "Type of capital: Total Capital\nTotal Capital is the sum of Tier 1 and Tier 2 capitals, where Tier 2 Capital is supplementary capital.\nTier 2 Capital:\n\nInstruments issued by a DI that qualify for Tier 2 Capital and are not included in Tier 1 capital.1\nShare premium resulting from the issue of instruments included in Tier 2 Capital.2\nTier 2 minority interest not included Tier 1 capital.\nCertain loan loss provisions.\nRegulatory adjustments applied in the calculation of Tier 2 Capital.\n\nIt includes secondary “equity-like” capital resources, for example, loan loss reserves and some convertible and subordinated debt instruments.In Table 21-3 of the textbook Saunders, Cornett, and Erhemjamts (2023), this entry incorrectly reads “Stock surplus (share premium) resulting from the issue of instruments included in Tier I capital”. See page 17 of the original BIS publication “Basel III: A Global Regulatory Framework for More Resilient Banks and Banking Systems”, June 2011."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#capital-adequacy-framework",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#capital-adequacy-framework",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital adequacy framework",
    "text": "Capital adequacy framework\n\nCredit risk\n\nThe risk-based capital ratios as described earlier.\n\nInterest rate risk\n\nNo formal add on yet.\n\nMarket risk\n\nAdditional capital charge.\n\nOperational risk\n\nAdditional capital charge."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#minimum-required-capital-adequacy-ratios",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#minimum-required-capital-adequacy-ratios",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Minimum required capital adequacy ratios",
    "text": "Minimum required capital adequacy ratios\nThe minimum required capital ratios: \\[\n\\begin{aligned}\n\\text{CET1 capital ratio} &= \\frac{\\text{CET1 capital}}{\\text{Risk-weighted assets}} \\ge 4.5\\% \\\\\n\\text{Tier 1 capital ratio} &= \\frac{\\text{Tier 1 capital}}{\\text{Risk-weighted assets}} \\ge 6\\% \\\\\n\\text{Total capital ratio} &= \\frac{\\text{Total capital}}{\\text{Risk-weighted assets}} \\ge 8\\% \\\\\n\\text{Tier 1 leverage ratio} &= \\frac{\\text{Tier 1 capital}}{\\text{Total exposure}} \\ge 4\\%\n\\end{aligned}\n\\qquad(5)\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#overview-of-capital-ratios-calculation",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#overview-of-capital-ratios-calculation",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Overview of capital ratios calculation",
    "text": "Overview of capital ratios calculation\n\nCalculate the amount of capital (CET1, Tier 1, Total Capital).\nCalculate the risk-weighted assets (RWA)1: sum of the amount of each asset multiplied by a risk weight specific to its riskiness.\n\nOn-balance-sheet:\n\nEach asset has a risk weight\nMultiply the asset by the corresponding risk weight\n\nOff-balance-sheet:\n\nConvert each asset to an on-balance-sheet equivalent\nMultiply the equivalent exposure by the corresponding risk weight\n\nSum the on-balance-sheet and off-balance-sheet RWA\n\nCalculate the capital ratios based on the amount of capital and RWA.\n\nOn- and off-balance-sheet assets whose values are adjusted for approximate credit risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#capital-ratios-calculation-risk-weighted-assets",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#capital-ratios-calculation-risk-weighted-assets",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital ratios calculation: risk-weighted assets",
    "text": "Capital ratios calculation: risk-weighted assets\nWe will use an example to showcase how to calculate risk-weighted assets.\n\nBalance sheet itemsOff-balance-sheet items\n\n\n\n\n\nAsset type\n$ million\n\n\n\n\nCash, Australian Treasury Bonds and deposits at the RBA\n20\n\n\nLocal government bonds, S&P rating of AA-\n10\n\n\nLoans to other Australian banks, S&P rating of BBB+\n5\n\n\nStandard eligible residential mortgages\n40\n\n\nCorporate loans, S&P rating of BB- to BBB+\n25\n\n\nCorporate loans, S&P rating of B+ or lower\n20\n\n\n\n\n\n\n\n\nOBS item\n$ million\n\n\n\n\nContingencies and guarantees\n\n\n\nTwo-year loan commitment\n80\n\n\nStandby letter of credit\n10\n\n\nCommercial letter of credit\n50\n\n\nMarket contracts and derivatives\n\n\n\nFour-year fixed–floating interest rate swap\n100\n\n\nTwo-year forward foreign exchange contract\n40"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-on-balance-sheet",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-on-balance-sheet",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: on-balance-sheet",
    "text": "Risk-weighted assets: on-balance-sheet\nConsider the following example balance sheet of a DI.\nWe want to calculate its on-balance-sheet RWA.\n\n\n\n\nTable 5: Example balance sheet of a DI\n\n\n\n\n\nAsset type\n$ million\n\n\n\n\nCash, Australian Treasury Bonds and deposits at the RBA\n20\n\n\nLocal government bonds, S&P rating of AA-\n10\n\n\nLoans to other Australian banks, S&P rating of BBB+\n5\n\n\nStandard eligible residential mortgages\n40\n\n\nCorporate loans, S&P rating of BB- to BBB+\n25\n\n\nCorporate loans, S&P rating of B+ or lower\n20"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-on-balance-sheet-1",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-on-balance-sheet-1",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: on-balance-sheet",
    "text": "Risk-weighted assets: on-balance-sheet\nNow map the assets’ risk weights.1\n\n\n\n\nTable 6: Example balance sheet of a DI with risk weights\n\n\n\n\n\n\n\n\n\n\nAsset type\n$ million\nRisk weight\n\n\n\n\nCash, Australian Treasury Bonds and deposits at the RBA\n20\n0%\n\n\nLocal government bonds, S&P rating of AA-\n10\n20%\n\n\nLoans to other Australian banks, S&P rating of BBB+\n5\n100%\n\n\nStandard eligible residential mortgages\n40\n35%\n\n\nCorporate loans, S&P rating of BB- to BBB+\n25\n100%\n\n\nCorporate loans, S&P rating of B+ or lower\n20\n150%\n\n\n\n\n\n\n\nEach asset is assigned to one of several categories of credit risk exposure. The risk weight for each category is determined in the Basel III."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-on-balance-sheet-2",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-on-balance-sheet-2",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: on-balance-sheet",
    "text": "Risk-weighted assets: on-balance-sheet\nCalculate the risk-weighted value for each asset.\n\n\n\n\nTable 7: Example balance sheet of a DI with risk-weighted assets\n\n\n\n\n\n\n\n\n\n\n\nAsset type\n$ million\nRisk weight\nRisk-weighted value\n\n\n\n\nCash, Australian Treasury Bonds and deposits at the RBA\n20\n0%\n0\n\n\nLocal government bonds, S&P rating of AA-\n10\n20%\n2\n\n\nLoans to other Australian banks, S&P rating of BBB+\n5\n100%\n5\n\n\nStandard eligible residential mortgages\n40\n35%\n14\n\n\nCorporate loans, S&P rating of BB- to BBB+\n25\n100%\n25\n\n\nCorporate loans, S&P rating of B+ or lower\n20\n150%\n30"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-on-balance-sheet-3",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-on-balance-sheet-3",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: on-balance-sheet",
    "text": "Risk-weighted assets: on-balance-sheet\nCalculate the total risk-weighted assets.\n\n\n\n\nTable 8: Total RWA for on-balance-sheet assets\n\n\n\n\n\n\n\n\n\n\n\nAsset type\n$ million\nRisk weight\nRisk-weighted value\n\n\n\n\nCash, Australian Treasury Bonds and deposits at the RBA\n20\n0%\n0\n\n\nLocal government bonds, S&P rating of AA-\n10\n20%\n2\n\n\nLoans to other Australian banks, S&P rating of BBB+\n5\n100%\n5\n\n\nStandard eligible residential mortgages\n40\n35%\n14\n\n\nCorporate loans, S&P rating of BB- to BBB+\n25\n100%\n25\n\n\nCorporate loans, S&P rating of B+ or lower\n20\n150%\n30\n\n\nTotal RWA\n\n\n76"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-off-balance-sheet-obs",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-off-balance-sheet-obs",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: off-balance-sheet (OBS)",
    "text": "Risk-weighted assets: off-balance-sheet (OBS)\nTwo-Step Process:\n\nThe notional amount of each OBS item is first converted into an on-balance-sheet equivalent, credit equivalent amount (CEA).\n\nThe CEA is determined by multiplying the notional amount by a credit conversion factor (CCF).\nCCF under Basel III.\nIn Australia, CCFs are specified in APRA’s APS 112. \n\nThe resulting CEA must be multiplied by the appropriate risk weight (same as those used for on-balance-sheet assets).\n\nTreatments differ for\n\nOBS guaranty-type contracts and contingent contracts, e.g., letters of credit\nderivative and market contracts, e.g., interest rate forward, option, and swap contracts"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-obs-contingent-guaranty-contracts",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-obs-contingent-guaranty-contracts",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: OBS contingent guaranty contracts",
    "text": "Risk-weighted assets: OBS contingent guaranty contracts\nConsider the following example off-balance-sheet items of a DI. We want to calculate its RWA.\nFirst, convert to on-balance-sheet CEA.1\n\n\n\nOBS item\nFace value ($ million)\nCCF\nCEA\n\n\n\n\nTwo-year loan commitment\n80\n0.4\n32\n\n\nStandby letter of credit\n10\n1\n10\n\n\nCommercial letter of credit\n50\n0.2\n10\n\n\n\nSecond, calculate RWA.2\n\n\n\nTable 9: Total RWA for OBS contingent guaranty contracts\n\n\n\n\n\n\n\n\n\n\n\nOBS item\nCEA\nRisk weight\nRisk-weighted value\n\n\n\n\nTwo-year loan commitment\n32\n20%\n6.4\n\n\nStandby letter of credit\n10\n20%\n2\n\n\nCommercial letter of credit\n10\n75%\n7.5\n\n\nTotal RWA\n\n\n15.9\n\n\n\n\n\n\nCCF for OBS contingent or guaranty contracts under Basel III.These risk weights are the same as those on-balance-sheet assets."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-obs-market-contracts-or-derivative-instruments",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-obs-market-contracts-or-derivative-instruments",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: OBS market contracts or derivative instruments",
    "text": "Risk-weighted assets: OBS market contracts or derivative instruments\nOBS market contracts and derivatives expose the DI also to counterparty risk.\nFirst, when converting to CEA, both potential future exposure and current exposure are considered.\n\nThe potential future exposure reflects the risk if a counterparty defaults in the future.\n\n\n\n\n\n\n\n\n\n\n\n\n\nType of Contract (remaining maturity)\nNotional Principal\n×\nPotential Exposure Conversion Factor\n=\nPotential Exposure\n\n\n\n\nFour-year fixed–floating interest rate swap\n$100 m\n×\n0.005\n=\n$0.5 m\n\n\nTwo-year forward foreign exchange contract\n$ 40 m\n×\n0.05\n=\n$2 m\n\n\n\n\n\nThe current exposure reflects the cost of replacing a contract if the counterparty defaults today.\n\n\n\n\n\n\n\n\n\n\nType of Contract (remaining maturity)\nReplacement Cost\nCurrent Exposure\n\n\n\n\nFour-year fixed–floating interest rate swap\n$3 m\n$3m\n\n\nTwo-year forward foreign exchange contract\n–$1 m\n$0m\n\n\n\n\nCEA = potential future exposure + current exposure\n\n\n\n\n\n\n\n\n\n\nType of Contract (remaining maturity)\nPotential Exposure\nCurrent Exposure\nCEA\n\n\n\n\nFour-year fixed–floating interest rate swap\n$0.5 m\n$3 m\n$3.5 m\n\n\nTwo-year forward foreign exchange contract\n$2 m\n$0\n$2 m\n\n\n\n\nSecond, calculate RWA. Under Basel III, the risk weight for OBS market contracts or derivative instruments is generally 100%.\n\nTotal RWA = \\(\\text{CEA} \\times \\text{risk weight} = \\text{CEA} \\times 100\\% = (3.5 + 2) \\times 100\\% = 5.5 (\\text{million})\\)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-on-and-off-balance-sheet",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#risk-weighted-assets-on-and-off-balance-sheet",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: on-and off-balance-sheet",
    "text": "Risk-weighted assets: on-and off-balance-sheet\nTotal RWA of the DI is the sum of on-balance-sheet and off-balance-sheet RWAs:\n\n\n\nTable 10: Total RWA (on-and off-balance-sheet)\n\n\n\n\n\nCategory\nRWA ($ million)\n\n\n\n\nOn-balance-sheet\n76\n\n\nOff-balance-sheet\n\n\n\n- contingencies and guarantees\n15.9\n\n\n- market contracts and derivatives\n5.5\n\n\nTotal RWA\n97.4"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#capital-ratios",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#capital-ratios",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital ratios",
    "text": "Capital ratios\nSuppose the DI’s liabilities and equity are listed below:\n\n\n\n\n\n\n\n\nLiabilities/Equity\nAmount ($ million)\nCapital class\n\n\n\n\nDemand deposits\n65\n\n\n\nCertificate of Deposits (CD)\n20\n\n\n\nSubordinated bonds\n8\nTier 2\n\n\nRetained earnings\n5\nCET1\n\n\nCommon stock\n20\nCET1\n\n\nNoncumulative perpetual preferred shares (qualifying)\n2\nAdditional Tier 1\n\n\n\nThe DI’s capital ratios are:\n\\[\n\\begin{aligned}\n\\text{CET1 capital ratio} &= \\frac{\\text{CET1 capital}}{\\text{Risk-weighted assets}}  = \\frac{25}{97.4} = 25.67\\% \\ge 4.5\\% \\\\\n\\text{Tier 1 capital ratio} &= \\frac{\\text{Tier 1 capital}}{\\text{Risk-weighted assets}} = \\frac{25+2}{97.4} = 27.72\\% \\ge 6\\% \\\\\n\\text{Total capital ratio} &= \\frac{\\text{Total capital}}{\\text{Risk-weighted assets}} = \\frac{27+8}{97.4} = 35.93\\% \\ge 8\\%\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\nCapital ratios of Australian banks\n\n\nFigure 1 and Figure 2 show the capital ratios of Australian banks."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#capital-conversion-buffer-and-countercyclical-capital-buffer-ccyb",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#capital-conversion-buffer-and-countercyclical-capital-buffer-ccyb",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital conversion buffer and countercyclical capital buffer (CCyB)",
    "text": "Capital conversion buffer and countercyclical capital buffer (CCyB)\nBasel III introduced two buffers, capital conversion buffer and countercyclical capital buffer, to the minimum required capital level.\nCapital conversion buffer:\n\n2.5% of risk weighted assets comprised of CET1 only\nDI to hold minimum of 7% common equity Tier 1 (minimum of 4.5% plus conservation buffer of 2.5%)\nIf a DI’s capital conservation buffer falls below 2.5%, constraints are imposed on the DI’s distributions (e.g. dividends and bonuses)\n\nCCyB:\n\nMay be declared by a country experiencing excess aggregate credit growth\nVary between 0 and 2.5% of risk-weighted assets comprised of CET1 only\nIf a DI’s CCyB falls below the set level, constraints are imposed on the DI’s distributions (e.g. dividends and bonuses)\n\n\n\n\n\n\n\n\nExample\n\n\nSuppose that a 2.5% capital conversion buffer currently applies and CCyB is 0, then the required CET1 capital ratio becomes 4.5%+2.5% = 7%.\nIf a bank’s CET1 capital ratio is 7.5%, it will receive no restrictions on its dividends payout, share buybacks, etc.\n\n\n\n\n\n\n\n\n\n\n\nExample\n\n\nSuppose that a 2.5% capital conversion buffer and a 1.5% CCyB currently apply, then the required CET1 capital ratio becomes 4.5%+2.5%+1.5% = 8.5%.\nIf a bank’s CET1 capital ratio is 7.5%, it will receive restrictions on its dividends payout, share buybacks, etc."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#global-systemically-important-banks-g-sibs",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#global-systemically-important-banks-g-sibs",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Global Systemically Important Banks (G-SIBs)",
    "text": "Global Systemically Important Banks (G-SIBs)\nUnder Basel III, additional capital surcharge applies on Global Systemically Important Banks (G-SIBs).\n\n1% to 3.5% in addition to the 7% minimum CET1 requirement (CET1 + capital conversion buffer).\na G-SIB must have at least 8.5% CET1 ratio to have no payment restriction.\n\nList of G-SIBs at November 2023."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#leverage-ratio",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#leverage-ratio",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Leverage ratio",
    "text": "Leverage ratio\nBasel III also introduced the Tier 1 leverage ratio to discourage the use of excessive leverage (recall Equation 5).\n\\[\n\\text{Tier 1 leverage ratio} = \\frac{\\text{Tier 1 capital}}{\\text{Total exposure (on-and off-balance-sheet)}} \\ge 4\\%\n\\]\n\nTotal exposure is equal to the DI’s total assets plus off-balance-sheet exposure.\nFor derivative securities, off-balance-sheet exposure is current exposure plus potential future exposure as described earlier.\nFor off-balance-sheet credit (loan) commitments, a conversion factor of 100 percent is applied unless the commitments are immediately cancelable."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#risk-based-capital-beyond-credit-risk",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#risk-based-capital-beyond-credit-risk",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-based capital: beyond credit risk",
    "text": "Risk-based capital: beyond credit risk\nSo far, the capital ratios (specifically, RWA) are calculated to account for the DI’s credit risk. However, a DI’s insolvency risk can also manifest from interest rate risk, market risk, operational risk, and more.\nIn Basel III, RWA should be the sum of three components:1\n\nRWA for credit risk (covered in this lecture)\nRWA for market risk. Can be calculated using two approaches:2\n\nStandardized approach proposed by regulators. Revised standards published in 2016 to be implemented in 2019.\nDI’s internal market risk model subject to regulator approval. Move towards expected shortfall rather than value at risk (VaR).\n\nRWA for operational risk. Some complicated calculation.3\n\n\n\n\n\n\n\nImportant\n\n\nThe RWA in the minimum capital ratios (Equation 5) is the sum of all three RWAs.\nWe covered only the RWA for credit risk.\n\n\n\nTo date, no formal add on has been required yet (development in progress).For details, see RBC20.9.For details, see RBC20.10."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#risk-based-capital-beyond-credit-risk-1",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#risk-based-capital-beyond-credit-risk-1",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-based capital: beyond credit risk",
    "text": "Risk-based capital: beyond credit risk\nIn the previous example, we have calculated that the DI’s RWA (for credit risk) is $97.4 million.\nNow, suppose that we have also calculated that the DI’s\n\nRWA for market risk is $10.2 million, and\nRWA for operational risk is $9 million.\n\nThe total RWA is $97.4 + $10.2 + $9 = $116.6 million.\nThe DI’s capital ratios are actually:\n\\[\n\\begin{aligned}\n\\text{CET1 capital ratio} &= \\frac{\\text{CET1 capital}}{\\text{Risk-weighted assets}}  = \\frac{25}{116.6} = 21.44\\% \\ge 4.5\\% \\\\\n\\text{Tier 1 capital ratio} &= \\frac{\\text{Tier 1 capital}}{\\text{Risk-weighted assets}} = \\frac{25+2}{116.6} = 23.16\\% \\ge 6\\% \\\\\n\\text{Total capital ratio} &= \\frac{\\text{Total capital}}{\\text{Risk-weighted assets}} = \\frac{27+8}{116.6} = 30.02\\% \\ge 8\\%\n\\end{aligned}\n\\]\n\n\n\n\n\n\nNote\n\n\nIn this course, no assessment will be on the calculation of RWA for market risk or RWA for operational risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#rwa-of-australian-banks-in-2023",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#rwa-of-australian-banks-in-2023",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "RWA of Australian banks in 2023",
    "text": "RWA of Australian banks in 2023\n\n\n\nTable 11: RWA of Australian banks in 2023 (source: Capital IQ)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCBA\nWestpac\nNAB\nANZ\nMacquarie\n\n\n\n\nRWA for credit risk\n362,869\n339,758\n355,554\n349,041\n97,485\n\n\nRWA for market risk\n61,968\n51,676\n38,274\n41,967\n11,663\n\n\nRWA for operational risk\n43,155\n55,175\n41,178\n42,319\n15,828\n\n\nOther RWA\n0\n4,809\n0\n0\n0\n\n\nTotal RWA\n467,992\n451,418\n435,006\n433,327\n124,976"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#suggested-readings",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nThe Basel Committee\nHistory of the Basel Committee\n“Capital explained” by the APRA\nBIS - Calculation of minimum risk-based capital requirements (RBC20)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week3/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week3/index.html#references",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nSaunders, Anthony, Marcia Millon Cornett, and Otgo Erhemjamts. 2023. Financial Institutions Management ISE. 11th ed. McGraw Hill."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#what-is-interest-rate-risk",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#what-is-interest-rate-risk",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "What is interest rate risk?",
    "text": "What is interest rate risk?\n\n\n\n\n\n\n\nInterest Rate Risk\n\n\nInterest rate risk is the possibility of a financial loss due to changes in interest rates.\n\n\n\n\nRecall that in Week 1, we explained one of the key functions performed by financial institutions (especially depositary institutions) is maturity transformation. For DIs, they take short-term deposits from depositors and make long-term loans to borrowers.\n\n\n\nTable 1: Typical balance sheet of a DI\n\n\n\n\n\nAssets\nLiabilities and Equity\n\n\n\n\nLoans (relatively long-term)\nDeposits (relatively short-term)\n\n\nOther assets\nOther liabilities\n\n\n\nEquity\n\n\n\n\n\n\nAs a result,\n\nThis maturity transformation means that FIs have mismatches of maturities of their liabilities (e.g., deposits) and assets (e.g., loans).\nMaturity mismatch exposes FIs to (unexpected) interest rate changes:\n\nrefinancing and reinvestment risks\nfinancial instruments have different levels of value sensitivity to interest rate changes\n\nInterest rate is volatile and can be unexpected."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#maturity-mismatch-refinancing-risk",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#maturity-mismatch-refinancing-risk",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Maturity mismatch: refinancing risk",
    "text": "Maturity mismatch: refinancing risk\nConsider an example bank that has $2 million of 10-year fixed-rate loans and $1 million of 1-year fixed-rate term deposits now. The bank expects to have the same balance sheet in the future.\nWhat would happen in 1 year from now?\n\nTerm deposits mature. Some deposits may be withdrawn.\nIn this case, the bank needs to take additional deposits to maintain the size of balance sheet.\nHowever, the interest rate (deposit rate) could be higher in the future, which means higher costs for the bank.\n\nThis is a typical refinancing risk - the costs of rolling over funds or re-borrowing funds will rise above the returns generated on investments."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#maturity-mismatch-reinvestment-risk",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#maturity-mismatch-reinvestment-risk",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Maturity mismatch: reinvestment risk",
    "text": "Maturity mismatch: reinvestment risk\nConsider another example bank that has $2 million of 1-year fixed-rate loans and $1 million of 2-year fixed-rate term deposits now. The bank expects to have the same balance sheet in the future.\nWhat would happen in 1 year from now?\n\nLoans mature.\nIn this case, the bank needs to reinvest into some other assets (e.g., make loans).\nHowever, the interest rate (on the loan) could be lower in the future, which means reduced returns for the bank.\n\nThis is a typical reinvestment risk - the returns on funds to be reinvested will fall below the cost of funds."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#financial-instruments-value-sensitivity-to-interest-rate",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#financial-instruments-value-sensitivity-to-interest-rate",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Financial instruments’ value sensitivity to interest rate",
    "text": "Financial instruments’ value sensitivity to interest rate\nThe value of longer-maturity instruments typically is more sensitive to interest rate.\n\n\nFor example, a bond’s price is given by\n\\[\nP = \\sum_{t=1}^T\\frac{C}{(1+r)^t} + \\frac{F}{(1+r)^T}\n\\qquad(1)\\]\nwhere \\(C\\) is coupon payment, \\(F\\) face value, \\(T\\) maturity, and \\(r\\) interest rate.\nIf a FI is financed by issuing long-term bonds and invests in short-term loans, given a change in interest rate, its liabilities’ value would change by more than the change in its assets’ value, thereby causing an impact on its net worth.\n\n\n\nCode\nviewof maturity4 = Inputs.range(\n  [1, 30], \n  {value: 15, step: 1, label: \"Maturity (years):\"}\n)\nviewof couponRate4 = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.05, step: 0.01, label:\"Coupon rate:\"}\n)\nd = {\n  const f = 100;\n  let c, m;\n  c = couponRate4;\n  m = maturity4;\n  function pv(c, f, t, r) {\n    return c * (1 - (1+r)**(-t)) / r + f / (1+r)**(t)\n  }\n  const prices = {\"YTM\": [], \"Price\": []};\n  let coupon = f * c;\n  for (let ytm = 0.01; ytm &lt; 20; ytm++) {\n    let price = pv(coupon, f, m, ytm/100);\n    prices[\"YTM\"].push(ytm);\n    prices[\"Price\"].push(price);\n  }\n  return prices;\n}\n\ndata4 = transpose(d)\nPlot.plot({\n  caption: \"Assume $100 bond, annual coupons paid in arrears and effective annual discount rate.\",\n  x: {padding: 0.4, label: \"YTM (%)\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0, 100]),\n    Plot.ruleX([0]),\n    Plot.lineY(data4, {x: \"YTM\", y: \"Price\", stroke: \"blue\"}),\n  ]\n})"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-level-and-movement-of-interest-rates",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-level-and-movement-of-interest-rates",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The level and movement of interest rates",
    "text": "The level and movement of interest rates\n\n\nThe relative degree of interest rate volatility is directly linked to the monetary policy of the Reserve Bank of Australia (RBA).\n\nFor example, if RBA smooths or targets the level of interest rates, unexpected interest rate shocks and interest rate volatility tend to be small.\nA change in approach from targeting interest rate (cash rate) goals towards CPI growth rate increased the interest rate volatility.\n\nNo matter what, interest rate volatility exists and thus, the appropriate measurement of management of interest rate risk is important to every FI.\n\n\n\n\n\n\n\nFigure 1: Australian inflation target"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-level-and-movement-of-interest-rates-1",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-level-and-movement-of-interest-rates-1",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The level and movement of interest rates",
    "text": "The level and movement of interest rates\n\n\n\n\n\n\n\n\nFigure 2: Australian cash rate target\n\n\n\n\n\n\n\n\n\n\nFigure 3: Australian cash rate target and 90-day bill yield"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-level-and-movement-of-interest-rates-2",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-level-and-movement-of-interest-rates-2",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The level and movement of interest rates",
    "text": "The level and movement of interest rates\n\n\n\n\n\n\n\n\nFigure 4: 10-year Australian government bond yield\n\n\n\n\n\n\n\n\n\n\nFigure 5: Policy interest rates"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-market-is-bad-at-guessing-interest-rates",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-market-is-bad-at-guessing-interest-rates",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The market is bad at guessing interest rates",
    "text": "The market is bad at guessing interest rates\n\n\n\n\n\n\nFigure 6: The market does not always correctly forecast interest rates\n\n\n\nImage source: Steven Desmyter"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#interest-rate-risk-and-basel-framework",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#interest-rate-risk-and-basel-framework",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Interest rate risk and Basel framework",
    "text": "Interest rate risk and Basel framework\nAs discussed last week, the three pillars of Basel framework (since Basel II) include:\n\nminimum capital requirements\nsupervisory review\neffective use of disclosure (for market discipline)\n\nThe Pillar 1 involves a capital adequacy framework surrounding minimum ratios of various capital (CET1, Tier 1, Total) to RWA.\n\nThe RWA is sum of RWAs for credit risk, market risk, and operational risk.\nThere is currently no “RWA for interest rate risk”.\n\nThe Interest Rate Risk in the Banking Book (IRRBB) is part of the Basel capital framework’s Pillar 2 (and Pillar 3)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#interest-rate-risk-and-basel-framework-contd",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#interest-rate-risk-and-basel-framework-contd",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Interest rate risk and Basel framework (cont’d)",
    "text": "Interest rate risk and Basel framework (cont’d)\nBasel III guidelines address the issue of interest rate risk primarily through:\nInterest Rate Risk in the Banking Book (IRRBB)\n\nBasel III includes specific guidelines on managing Interest Rate Risk in the Banking Book (IRRBB). Banks are required to identify, measure, monitor, and control IRRBB. This involves regular stress testing, scenario analysis, and the application of appropriate capital charges to cover potential losses from adverse interest rate movements.\nStress Testing: Basel III mandates regular stress testing to evaluate the impact of significant changes in interest rates on a bank’s earnings and capital. Stress testing helps banks identify vulnerabilities and prepare for potential adverse scenarios.\n\nSupervisory Review Process (Pillar 2)\n\nUnder Pillar 2, banks are required to conduct internal assessments of their capital adequacy in relation to their risk profile, including interest rate risk in the banking book (IRRBB). Supervisors also review these assessments to ensure that banks are adequately managing and mitigating their interest rate risk.\n\nDisclosure Requirements (Pillar 3)\n\nUnder Pillar 3, Basel III enhances transparency by requiring banks to disclose their exposure to interest rate risk and the measures they take to manage it. This includes detailed reporting on the impact of interest rate changes on earnings and economic value."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#an-overview",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#an-overview",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "An overview",
    "text": "An overview\nFrom here, we’re to study specific models and technique for measuring FI’s interest rate risk. However, it is helpful to first explain the general rule so to better understand the big picture.\n\nA risk causes an unwanted negative impact on a FI. To measure such risk, we need to specify a few things:\n\nWhich FI’s characteristic are we concerned about? Income, net worth, or something else?\nHow sensitive is that FI’s characteristic to this risk?\nWhat is the potential size of this risk?\nIs it based on book value or market value?\nWhat is the time frame we are looking at?\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#interest-rate-risk-models",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#interest-rate-risk-models",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Interest rate risk models",
    "text": "Interest rate risk models\nThe rest of this lecture discusses two models for measuring interest rate risk with different focuses.\n\n\n\nTable 2: A simple comparison of two interest rate risk models\n\n\n\n\n\n\n\n\n\n\n\nRepricing model\nDuration model\n\n\n\n\nWhich characteristic?\nNet interest income (NII)\nNet worth\n\n\nSensitivity measurement?\nBy assumption\nDuration\n\n\nSize of risk?\nFlexible\nFlexible\n\n\nBook value or market value?\nBook value\nMarket value\n\n\nTime frame?\nFlexible\nFlexible"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-repricing-model",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-repricing-model",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The repricing model",
    "text": "The repricing model\n\nRepricing model is also known as the funding gap model.\n\nA book value accounting cash flow analysis of the repricing gap between the interest income earned on an FI’s assets and the interest paid on its liabilities over some period.\nFocus on the changes of net interest income (NII).\n\nA simple model used by small FIs.\nAPRA requires smaller ADIs to use the repricing method to estimate interest rate exposures in their banking book for capital adequacy purposes.\n\nA revision has just been completed in early July, 2024, which will be effective in 2025.1\n\n\nSee suggested readings."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#repricing-gap-rsa-and-rsl",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#repricing-gap-rsa-and-rsl",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Repricing gap, RSA and RSL",
    "text": "Repricing gap, RSA and RSL\nRepricing gap is the difference between rate-sensitive assets (RSA) and rate-sensitive liabilities (RSL).\n\nRSA: assets whose interest rates will be repriced or changed over some future period (rate-sensitive assets)\nRSL: liabilities whose interest rates will be repriced or changed over some future period (rate-sensitive liabilities)\n\nAn asset (or liability) is “rate-sensitive” if it is repriced at or near current market interest rates within a certain time horizon (or maturity bucket). For example,\n\na variable-rate mortgage’s interest rate may be reset every quarter based on the prevailing interest rate.\ninterest rate of term deposits are also adjusted frequently.1\n\nHistorical term deposit rates of Australian banks"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#maturity-tenor-buckets",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#maturity-tenor-buckets",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Maturity (Tenor) buckets",
    "text": "Maturity (Tenor) buckets\nUnder repricing model, banks report their repricing gaps for various maturity buckets. For example,\n\nOne day (overnight).\nMore than 1 day to 3 months.\nMore than 3 months to 6 months.\nMore than 6 months to 12 months.\nMore than 1 year to 5 years.\nMore than 5 years.\n\n\n\n\n\n\n\n\nHow to determine RSA/RSL for each bucket?\n\n\nAsk a simple question: Will or can this asset or liability have its interest rate changed within the maturity bucket? If the answer is yes, it is a rate-sensitive asset or liability. If the answer is no, it is not rate sensitive."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#maturity-buckets-and-rsarsl",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#maturity-buckets-and-rsarsl",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Maturity buckets and RSA/RSL",
    "text": "Maturity buckets and RSA/RSL\nLet’s practice. Try to identify the one-year RSA and RSL given the following assets and liabilities of a bank.\n\nAssets:\n\n1-year consumer loans\n2-year consumer loans\n3-month Treasury bills\n3-year Treasury bonds\n20-year fixed rate mortgage\n30-year floating rate mortgage (repriced every quarter)\n\nLiabilities:\n\ndemand deposits (non-interest-bearing)\n3-month certificates of deposits (CDs)\n6-month commercial papers\n1-year term deposits\n2-year term deposits"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#repricing-gaps",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#repricing-gaps",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Repricing gaps",
    "text": "Repricing gaps\n\n\n\nTable 3: Repricing gaps ($ millions)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAssets\nLiabilities\nGaps\nCumulative gap\n\n\n\n\n1\nOne day\n20\n30\n-10\n-10\n\n\n2\nOne day to three months\n30\n40\n-10\n-20\n\n\n3\nThree months to six months\n70\n85\n-15\n-35\n\n\n4\nSix months to 12 months\n90\n70\n+20\n-15\n\n\n5\nOne year to five years\n40\n30\n+10\n-5\n\n\n6\nOver five years\n10\n5\n+5\n0\n\n\nTotal\n\n$260\n$260\n\n\n\n\n\n\n\n\nFor example, a negative $10 million difference between its RSA and RSL being repriced in one day (one-day bucket). A rise in the overnight rate would lower the FI’s net interest income since the FI has more rate-sensitive liabilities than assets in this bucket.\n\nA refinancing risk given RSA &lt; RSL. Increase in interest rate means more interest paid on liabilities than earned from assets."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-repricing-model-1",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-repricing-model-1",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The repricing model",
    "text": "The repricing model\nThe repricing model can be used to estimate the change in the FI’s net interest income in a particular repricing bucket if interest rates change.\n\\[\n\\Delta NII_i = (GAP_i) \\times \\Delta R_i = (RSA_i - RSL_i) \\times \\Delta R_i\n\\]\nwhere:\n\n\\(\\Delta NII_i\\) is the change in net interest income in the \\(i\\)th bucket.\n\\(GAP_i\\) is the dollar size of the gap between the book value of RSA and RSL in maturity bucket \\(i\\).\n\\(\\Delta R_i\\) is the change in the level of interest rates impacting assets and liabilities in the \\(i\\)th bucket."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-repricing-model-examples",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-repricing-model-examples",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The repricing model: examples",
    "text": "The repricing model: examples\n\n\n\n\n\n\n\nOne-day repricing gap\n\n\nIn the first bucket of Table 3, if the gap is negative $10 million and overnight interest rate rises by 1 percent, the annualized change in the FI’s future NII is:\n\\[\n\\Delta NII_i = GAP_i \\times \\Delta R_i = -10 \\text{ million} \\times 0.01 = -100,000\n\\]\nSo, the repricing model suggests a loss of $100,000 in net interest income for the FI.\n\n\n\n\n\n\n\n\n\n\n\nOne-year repricing gap\n\n\nIt is common to also estimate the one-year (cumulative) repricing gap, which is -$15 million from Table 3.\n\\[\n\\Delta NII_i = CGAP_i \\times \\Delta R_i = -15 \\text{ million} \\times 0.01 = -150,000\n\\]\nIf the average interest rises by 1 percent, the model suggests a loss of $150,000 in net interest income."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-repricing-model-examples-1",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-repricing-model-examples-1",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The repricing model: examples",
    "text": "The repricing model: examples\nAssume both RSAs and RSLs equal $155 million. Suppose that there is a general interest rate rise and that the rates on RSAs rise by 1.2 percent and rates on RSLs rise by only 1 percent. What is the resulting change in NII?\n\n\\[\n\\Delta NII_i = RSA_i \\times \\Delta R^A_i - RSL_i \\times \\Delta R^L_i = (\\$155M \\times 0.012) - (\\$155M \\times 0.01) = \\$310,000\n\\]\n\nSuppose the RSA is $155 million and the RSL is $140 million. Interest rates rise by 1.2% on RSAs and 1% on RSLs. What is the change in NII?\n\n\\[\n\\Delta NII_i = RSA_i \\times \\Delta R_i^A - RSL_i \\times \\Delta R_i^L = (\\$155M \\times 0.012) - (\\$140M \\times 0.01) = \\$460,000\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#real-world-application-of-repricing-model",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#real-world-application-of-repricing-model",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Real-world application of repricing model",
    "text": "Real-world application of repricing model\nLet see a real-world application of repricing model by Texas Capital Bank, a (relatively small) commercial bank headquartered in Dallas, Texas, United States.\nWe can find its annual reports from SEC’s EDGAR system, which allows us to search for any corporate filings.\n\nIts most recent annual report is filed on 2024-02-13.\nCheck Item 7A. Quantitative and qualitative disclosure about market risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-repricing-model-problems",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-repricing-model-problems",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The repricing model: problems",
    "text": "The repricing model: problems\nThe repricing model is very simple and intuitive, but is NOT an accurate measure of interest rate risk.\nMajor shortcomings:\n\nIt is over-aggregative.\nIt ignores the market value effects of interest rate changes: it focuses on the income and ignores the capital gains/losses.\nIt uses the banking book and hence book values of assets and liabilities.\nIt fails to deal with the problem of rate-insensitive asset and liability runoffs and prepayments.\nIt ignores cash flows from off-balance-sheet activities."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#motivation",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#motivation",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Motivation",
    "text": "Motivation\nIn the early 2000s, the BIS issued a consultative document suggesting a standardized model be used by regulators in evaluating a bank’s interest rate risk exposure. The approach suggested is firmly based on market value accounting and the duration gap model.\nThe duration gap (model):\n\nconsiders market values and the maturity distributions of an FI’s assets and liabilities.\nconsiders the degree of leverage on an FI’s balance sheet.\nconsiders the timing of the payment or arrival of cash flows on assets and liabilities.\nis a more comprehensive measure of an FI’s interest rate risk.\n\nBigger banks have adopted duration model as their primary measure of interest rate risk.1\nBiggest banks may be allowed to use their internal models subject to regulatory approval."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#duration",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#duration",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration",
    "text": "Duration\nThe essence of duration gap model is the concept of duration, which is covered in introductory finance courses.\nSimply put, duration is the weighted-average time to maturity on the loan using the relative present values of the cash flows as weights.\n\\[\nD = \\sum_{t=1}^{N} w_t \\times t\n\\]\nwhere \\(D\\) is the duration, and\n\\[\nw_t = \\frac{\\text{PV of the cash flow at time } t}{\\text{Total PV of all cash flows}}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#duration-example",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#duration-example",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration: example",
    "text": "Duration: example\nConsider the duration of a 3-year coupon bond with a face value of $1,000, a coupon rate of 5%, and a yield to maturity of 4%. The bond pays annual coupons.\n\n\nCode\nimport pandas as pd\n\n# Parameters\nface_value, coupon_rate, yield_to_maturity, years = 1000, 0.05, 0.04, 3\nannual_coupon_payment = face_value * coupon_rate\n\n# Initialize and calculate values\ndata = [\n    (t, annual_coupon_payment if t &lt; years else annual_coupon_payment + face_value)\n    for t in range(1, years + 1)\n]\ntotal_pv = sum(payment / (1 + yield_to_maturity) ** t for t, payment in data)\ntable = [\n    (\n        t,\n        payment,\n        pv := payment / (1 + yield_to_maturity) ** t,\n        weight := pv / total_pv,\n        t * weight,\n    )\n    for t, payment in data\n]\n\n# Create DataFrame\ndf = pd.DataFrame(\n    table,\n    columns=[\n        \"Time (Years)\",\n        \"Payment ($)\",\n        \"PV of Payment ($)\",\n        \"Weight (PV/Total PV)\",\n        \"Weighted Time\",\n    ],\n)\n\n# Add totals row\ntotals = df.sum(numeric_only=True)\ntotals = pd.DataFrame(totals).T\ntotals[\"Time (Years)\"] = \"Total\"\ndf = pd.concat([df, totals], ignore_index=True)\n\ndf.style.highlight_max([\"Weighted Time\"]).format(precision=2).hide()\n\n\n\n\nTable 4: Calculating the duration of a 3-year bond\n\n\n\n\n\n\n\n\nTime (Years)\nPayment ($)\nPV of Payment ($)\nWeight (PV/Total PV)\nWeighted Time\n\n\n\n\n1\n50.00\n48.08\n0.05\n0.05\n\n\n2\n50.00\n46.23\n0.04\n0.09\n\n\n3\n1050.00\n933.45\n0.91\n2.72\n\n\nTotal\n1150.00\n1027.75\n1.00\n2.86\n\n\n\n\n\n\n\n\nThe bond’s duration is 2.86 years."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#duration-another-example",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#duration-another-example",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration: another example",
    "text": "Duration: another example\nConsider the duration of a 5-year coupon bond with a face value of $1,000, a coupon rate of 4%, and a yield to maturity of 6%. The bond pays annual coupons.\n\n\nCode\nimport pandas as pd\n\n# Parameters\nface_value, coupon_rate, yield_to_maturity, years = 1000, 0.04, 0.06, 5\nannual_coupon_payment = face_value * coupon_rate\n\n# Initialize and calculate values\ndata = [\n    (t, annual_coupon_payment if t &lt; years else annual_coupon_payment + face_value)\n    for t in range(1, years + 1)\n]\ntotal_pv = sum(payment / (1 + yield_to_maturity) ** t for t, payment in data)\ntable = [\n    (\n        t,\n        payment,\n        pv := payment / (1 + yield_to_maturity) ** t,\n        weight := pv / total_pv,\n        t * weight,\n    )\n    for t, payment in data\n]\n\n# Create DataFrame\ndf = pd.DataFrame(\n    table,\n    columns=[\n        \"Time (Years)\",\n        \"Payment ($)\",\n        \"PV of Payment ($)\",\n        \"Weight (PV/Total PV)\",\n        \"Weighted Time\",\n    ],\n)\n\n# Add totals row\ntotals = df.sum(numeric_only=True)\ntotals = pd.DataFrame(totals).T\ntotals[\"Time (Years)\"] = \"Total\"\ndf = pd.concat([df, totals], ignore_index=True)\n\ndf.style.highlight_max([\"Weighted Time\"]).format(precision=2).hide()\n\n\n\n\nTable 5: Calculating the duration of a 5-year bond\n\n\n\n\n\n\n\n\nTime (Years)\nPayment ($)\nPV of Payment ($)\nWeight (PV/Total PV)\nWeighted Time\n\n\n\n\n1\n40.00\n37.74\n0.04\n0.04\n\n\n2\n40.00\n35.60\n0.04\n0.08\n\n\n3\n40.00\n33.58\n0.04\n0.11\n\n\n4\n40.00\n31.68\n0.03\n0.14\n\n\n5\n1040.00\n777.15\n0.85\n4.24\n\n\nTotal\n1200.00\n915.75\n1.00\n4.61\n\n\n\n\n\n\n\n\nThe bond’s duration is 4.61 years."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-economic-meaning-of-duration",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-economic-meaning-of-duration",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The economic meaning of duration",
    "text": "The economic meaning of duration\nWe are interested in the sensitivity of bond price to interest rate.\n\nThat is, how much the price of a bond changes when the interest changes.\n\nDuration directly measures the interest rate sensitivity of an asset or liability:\n\\[\n\\frac{\\Delta P}{P} = - D \\times \\frac{\\Delta R}{1+R} = - MD \\times \\Delta R\n\\qquad(2)\\]\nwhere\n\n\\(\\Delta P\\) is the price change of assets or liabilities\n\\(\\Delta R\\) is the change of interest rate\n\\(MD\\) is the modified duration that equals to \\(\\frac{D}{1+R}\\)\n\nThe larger the numerical value of \\(D\\), the more sensitive is the price of that asset or liability to changes or shocks in interest rates.\n\n\n\n\n\n\nImportant\n\n\nThe relationship is only true for small changes in the yield."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-economic-meaning-of-duration-1",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-economic-meaning-of-duration-1",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The economic meaning of duration",
    "text": "The economic meaning of duration\nWhy does it work?\n\\[\n\\frac{\\Delta P}{P} = - D \\times \\frac{\\Delta R}{1+R} = - MD \\times \\Delta R\n\\]\n\nWe can write out the price formula of a bond and take its partial derivative with respect to yield.\nSee my detailed explanation here.\n\nWhy is it only true for small changes in the yield?\n\nBecause duration also changes as yield changes.\nWe assumed the duration is constant given a small \\(\\Delta R\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#duration-and-price-changes-example",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#duration-and-price-changes-example",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration and price changes: example",
    "text": "Duration and price changes: example\nConsider the previous example of a 5-year annual-coupon bond in Table 5 with a 4% coupon rate and 6% yield. It has a duration of 4.61 years.\nWhat is the price change if the interest rate (yield) decreases by 1 percent (\\(\\Delta R=-0.01\\))?\n\n\n\n\n\n\nNote\n\n\nRecall Equation 2 that \\(\\frac{\\Delta P}{P} = - D \\times \\frac{\\Delta R}{1+R} = - MD \\times \\Delta R\\).\n\\[\n\\text{Modified duration} = MD = \\frac{D}{1+R} = \\frac{4.61}{1+0.06} = 4.349\n\\]\nSo, we have\n\\[\n\\Delta P =  - MD \\times P \\times \\Delta R = - 4.349 \\times \\$1000 \\times (-0.01) = \\$43.49\n\\]\nThat is, a one percentage point (100 basis points) decrease in yield would increase bond price by $43.49.\nNote that \\(MD\\times P\\) is also named “dollar duration”, i.e., modified duration times the bond price."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#features-of-duration",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#features-of-duration",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Features of duration",
    "text": "Features of duration\n\nDuration increases with the maturity of a fixed-income security, but at a decreasing rate.\nDuration decreases as the yield on a security increases.\nDuration decreases as the coupon or interest payment increases."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#duration-and-interest-rate-risk-management",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#duration-and-interest-rate-risk-management",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration and interest rate risk management",
    "text": "Duration and interest rate risk management\nNow that we have refreshed our knowledge of duration, how is duration relevant in FI’s interest rate risk management?\nLet’s consider two cases.\n\nA single security.\nA portfolio of securities (e.g., the balance sheet)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#duration-and-interest-rate-risk-management-single-security",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#duration-and-interest-rate-risk-management-single-security",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration and interest rate risk management: single security",
    "text": "Duration and interest rate risk management: single security\nSuperannuation funds or insurers often have to make a specific amount of payment to their policyholders at a given future date. How to guarantee it? Investments may decrease in value if interest rate changes over the period.\nThere are two options:\n\nBuy a zero-coupon bond which matures exactly when the payment is made in the future.\nBuy bond(s) with a duration that matches the payment date.1\n\nHowever,\n\nOption 1 is very difficult because there simply may not be any such zero-coupon bonds with desirable maturities.\nOption 2 is manageable and practical!\n\nWe can show that its value at payment date is unaffected by interest rate changes."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#duration-and-interest-rate-risk-management-balance-sheet",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#duration-and-interest-rate-risk-management-balance-sheet",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration and interest rate risk management: balance sheet",
    "text": "Duration and interest rate risk management: balance sheet\nDuration can be used to measure a financial institution’s duration gap to evaluate the FI’s overall interest rate exposure. It is possible to calculate the duration of the asset portfolio and of the liability portfolio.\n\nDuration of a portfolio is the weighted average duration of its components.\n\n\n\nDuration of assets portfolio:\n\\[\nD_A = \\sum_{i=1}^{N_A} w_{iA} \\times D^A_i\n\\]\nwhere \\(N_A\\) is the total number of assets, \\(w_{iA}\\) is the market value weight of asset \\(i\\), \\(D^A_i\\) is the duration of asset \\(i\\).\nSo, change of assets value for a given change in interest rate is\n\\[\n\\Delta A = - D_A \\times A \\times \\frac{\\Delta R}{1+R}\n\\qquad(3)\\]\n\nDuration of liabilities portfolio:\n\\[\nD_L = \\sum_{i=1}^{N_L} w_{iL} \\times D^L_i\n\\]\nwhere \\(N_L\\) is the total number of liabilities, \\(w_{iL}\\) is the market value weight of liability \\(i\\), \\(D^L_i\\) is the duration of liability \\(i\\).\nSo, change of liabilities for a given change in interest rate is\n\\[\n\\Delta L = - D_L \\times L \\times \\frac{\\Delta R}{1+R}\n\\qquad(4)\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-duration-model",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-duration-model",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The duration model",
    "text": "The duration model\nWe know that total assets (\\(A\\)) is the sum of liabilities (\\(L\\)) and equity (\\(E\\)): \\(A=E+L\\).\nTherefore, \\(E = A - L\\), and \\(\\Delta E = \\Delta A - \\Delta L\\).\nMaking use of the previous results Equation 3 and Equation 4, we have\n\\[\n\\Delta E = \\left[- D_A \\times A \\times \\frac{\\Delta R}{1+R}\\right] -  \\left[- D_L \\times L \\times \\frac{\\Delta R}{1+R}\\right]\n\\qquad(5)\\]\nIf the level of interest and expected shock to interest rates are the same for both assets and liabilities, then:\n\\[\n\\Delta E = - (D_A - D_L k) \\times A \\times \\frac{\\Delta R}{1+R}\n\\qquad(6)\\]\nwhere \\(k=\\frac{L}{A}\\) measures the FI’s leverage."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-duration-model-1",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-duration-model-1",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The duration model",
    "text": "The duration model\nLet’s examine the duration model Equation 6:\n\\[\n\\Delta E = - (D_A - D_L k) \\times A \\times \\frac{\\Delta R}{1+R}\n\\]\nThe effect of interest rate changes on the market value of an FI’s net worth breaks down into three effects:\n\nThe leverage-adjusted duration gap: \\((D_A-D_L k)\\)\nThe size of the FI: \\(A\\)\nThe size of the interest rate shock: \\(\\frac{\\Delta R}{1+R}\\)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#the-duration-model-example",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#the-duration-model-example",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The duration model: example",
    "text": "The duration model: example\nSuppose a FI has total assets of $100 million and total liabilities of $90 million.\nAssume that the average duration of assets is 5 years, while the average duration of liabilities is 3 years. The current interest rate is 10%, but is expected to increase to 11% in the future.\nWe can calculate the expected change in the FI’s net worth as follows:\n\\[\n\\Delta E = - (D_A - D_L k) \\times A \\times \\frac{\\Delta R}{1+R} = -(5 - 3\\times 0.9) \\times \\$100 \\times \\frac{0.01}{1+0.1} = -\\$2.09\n\\]\nThis means that the FI could lose $2.09 million in net worth if interest rates rose by 1 per cent.\nHow can the FI manage the interest rate exposure?\n\nReduce \\(D_A\\), and/or\nIncrease \\(D_L\\), and/or\nIncrease leverage \\(k\\), and/or\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#immunization-and-regulatory-considerations",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#immunization-and-regulatory-considerations",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Immunization and regulatory considerations",
    "text": "Immunization and regulatory considerations\nRegulators, like APRA in Australia, require banks to hold a minimum amount of capital against their (risk-weighted) assets.\n\nWe have discussed capital management and adequacy last week.\nThe simplest ratio is: \\(\\frac{E}{A}\\).\n\nThus, in order to comply with regulations, the aim of risk management should not be \\(\\Delta E=0\\) but \\(\\Delta (\\frac{E}{A}) = 0\\).\nInstead of setting \\(D_A-D_L k=0\\), the bank now needs to target \\(D_A-D_L=0\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#difficulties-in-applying-duration-model",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#difficulties-in-applying-duration-model",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Difficulties in applying duration model",
    "text": "Difficulties in applying duration model\n\nDuration matching can be costly.\nImmunization is a dynamic problem.\nLarge interest rate changes can happen.\nConvexity."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#suggested-readings",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nRBA Financial Stability Review October 2023 - Focus Topic: Interest Rate Risk.\nBIS Standards IRRBB.\nReporting Standard ARS 117.0 Repricing Analysis.\nRepricing model’s application - page 31 of the Westpac NZ Banking Group’s interim report March 2024.\nDuration model’s application - Table 25 of the FreddieMac’s quarterly report June 2023.\nIf you need read more on fixed income securities, feel free to read some of my posts:\n\nIntroduction to fixed income securities\nBond price and yields\nBond price volatility (sensitivity)\nYield curve and term structure of interest rates"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week4/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week4/index.html#references",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#introduction",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#introduction",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Introduction",
    "text": "Introduction\nIn last week, we discussed interest rate risk: changes in interest rates could affect a FI’s income and net worth.\n\nInterest rate changes affect mostly the banking book.\nThe trading book is exposed to market risk.\n\n\n\n\n\n\n\n\n\n\nAssets\nLiabilities\n\n\n\n\nBanking book\nCash\nDeposits\n\n\n\nLoans\nOther liabilities\n\n\n\nOther assets\nCapital\n\n\nTrading book\nBonds (long)\nBonds (short)\n\n\n\nCommodities (long)\nCommodities (short)\n\n\n\nFX (long)\nFX (short)\n\n\n\nEquities (long)\nEquities (short)\n\n\n\nMortgage-backed securities (long)\n\n\n\n\nDerivatives1 (long)\nDerivatives (short)\n\n\n\n\n\n\n\n\n\n\nMarket Risk\n\n\nMarket risk is uncertainty of an FI’s earnings on its trading portfolio caused by changes, particularly extreme changes, in market conditions such as the price of an asset, interest rates, market volatility, and market liquidity.\n\n\n\n\nDerivatives are off-balance-sheet."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#introduction-contd",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#introduction-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Introduction (cont’d)",
    "text": "Introduction (cont’d)\nIntuitively, trading book includes assets, liabilities and derivatives that are actively traded in some financial markets and hence exposed to uncertainties of these markets."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#market-risk-exposure",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#market-risk-exposure",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Market risk exposure",
    "text": "Market risk exposure\nFIs are concerned about the potential impact of changing market conditions on their trading book and ultimately their net worth and solvency.\nA natural question becomes:\n\nHow to quantify such impact? What is the potential change in value of trading portfolio for a given period?\n\nMore specifically,\n\nWhat is the worst loss we can expect not to exceed with a given confidence level over a specific time horizon?\nWhat is the expected loss when losses exceed a certain level over a specific time horizon?\n\nAnswering these questions leads to the development of two important concepts for measuring market risk exposure:\n\nValue at Risk (VaR).\nExpected Shortfall (ES).\n\nWe start with the concept of Value at Risk (VaR), then discuss its limitations and the use of Expected Shortfall (ES)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#concept-of-var",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#concept-of-var",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Concept of VaR",
    "text": "Concept of VaR\nSuppose we know the distribution of an asset’s returns over a specific period (in the future), then for a given confidence level \\(c\\in[0,1]\\) (e.g., \\(c=0.95\\)), we can partition the distribution into two parts: one (in red) that represents a proportion of \\((1-c)\\) of the distribution and the other (in blue) accounting the remaining \\(c\\) proportion.\n\n\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Set seed for reproducibility\nnp.random.seed(42)\n\n# Parameters\nmu = 0  # Mean of returns\nsigma = 0.01  # Standard deviation of returns\nn = 10000  # Number of simulations\nconfidence_level = 0.95\n\n# Simulate returns\nreturns = np.random.normal(mu, sigma, n)\n\n# Calculate VaR\nVaR = np.percentile(returns, (1 - confidence_level) * 100)\n\n# Plot histogram with different colors for bars below and above VaR\nplt.figure(figsize=(10, 6))\n\n# Histogram data\nn, bins, patches = plt.hist(returns, bins=50, alpha=0.75, edgecolor=\"black\")\n\n# Change color of bars\nfor i in range(len(patches)):\n    if bins[i] &lt; VaR:\n        patches[i].set_facecolor(\"#A6192E\")\n    else:\n        patches[i].set_facecolor(\"#D6D2C4\")\n\n# Add VaR line\nplt.axvline(VaR, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2)\nplt.title(\"Simulated Distribution of Returns with VaR\")\nplt.xlabel(\"Return\")\nplt.ylabel(\"Frequency\")\nplt.legend([\"VaR at 95%\", \"Returns\"])\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\nFigure 1: Distribution of expected returns and VaR\n\n\n\n\n\n\nTherefore, the cutoff value of returns that separates the two parts defines:\n\na minimum return that we are confident 95% of the time, or\na maximum loss that we are confident 95% of the time."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#another-example-of-var",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#another-example-of-var",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Another example of VaR",
    "text": "Another example of VaR\nThis VaR concept does not depend on the shape of return distribution.\nFor example, below we have an interestingly shaped return distribution. Given a confidence level of 99%, we can find the 99% VaR.\n\n\nCode\n# Simulate returns with a non-normal distribution (e.g., bimodal distribution)\nnp.random.seed(42)\n\n# Parameters for bimodal distribution\nn = 10000\nmu1, sigma1, weight1 = -0.01, 0.01, 0.5\nmu2, sigma2, weight2 = 0.03, 0.02, 0.5\n\n# Generate bimodal returns\nreturns1 = np.random.normal(mu1, sigma1, int(n * weight1))\nreturns2 = np.random.normal(mu2, sigma2, int(n * weight2))\nreturns = np.concatenate([returns1, returns2])\n\n# Calculate VaR\nconfidence_level = 0.99\nVaR = np.percentile(returns, (1 - confidence_level) * 100)\n\n# Plot histogram with different colors for bars below and above VaR\nplt.figure(figsize=(10, 6))\n\n# Histogram data\nn, bins, patches = plt.hist(returns, bins=50, alpha=0.75, edgecolor=\"black\")\n\n# Change color of bars\nfor i in range(len(patches)):\n    if bins[i] &lt; VaR:\n        patches[i].set_facecolor(\"#A6192E\")\n    else:\n        patches[i].set_facecolor(\"#D6D2C4\")\n\n# Add VaR line\nplt.axvline(VaR, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2)\nplt.title(\"Simulated Distribution of Returns with VaR (Non-Normal Distribution)\")\nplt.xlabel(\"Return\")\nplt.ylabel(\"Frequency\")\nplt.legend([\"VaR at 99%\", \"Returns\"])\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\nFigure 2: Distribution of expected returns and VaR (another example)\n\n\n\n\n\nFrom the plot, we can say that 99% of the time, the asset’s return will be in the blue region, which means that it will not fall below the 99% VaR (recall that VaR is a cutoff value)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#models-for-computing-var",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#models-for-computing-var",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Models for computing VaR",
    "text": "Models for computing VaR\nOver the years, many models have been developed to compute VaR.\nThis is because we do not have the return distribution of trading portfolio over a specific period in the future.\n\nIf we do, then VaR is unambiguous.\n\nTherefore, different assumptions lead to different models and approaches. We are interested in three in this course:\n\nRiskMetrics (variance-covariance approach)\nHistoric or back simulation\nMonte Carlo simulation"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics",
    "text": "VaR: RiskMetrics\n\n“At close of business each day tell me what the market risks are across all businesses and locations”\nSir Dennis Weatherstone, 1989, former chairman of J.P. Morgan & Co., now JPMorgan Chase.\n\n\nManagers at JPM needs to respond with “I am X% sure that the FI will not lose more than $VAR in the next T days.”\nBasically, the FI manager wants a single dollar number that tells him or her the FI’s market risk exposure over the next days—especially if those days turn out to be extremely “bad” days.\n\n\n\nA very difficult task given that in 1994, JPMorgan had 14 active trading locations with 120 independent units trading fixed-income securities, foreign exchange, commodities, derivatives, emerging-market securities, and proprietary assets.\n\n\n\n\nJPMorgan developed RiskMetrics model."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-contd",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics (cont’d)",
    "text": "VaR: RiskMetrics (cont’d)\nIn a nutshell, we are concerned about the market risk exposure on a daily basis. Market risk exposure over longer periods, under some assumptions, can be viewed as a simple transformation from the daily exposure.\nThe market risk is measured by the daily earnings at risk (DEAR): \\[\n\\text{DEAR} = \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price sensitivity of the position}\\right) \\times \\left(\\text{potential adverse move}\\right)\n\\]\nSince price sensitivity multiplied by adverse move measures the degree of price volatility of an asset, we can write this equation as: \\[\n\\text{DEAR} = \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price volatility}\\right)\n\\]\n\n\n\n\n\n\n\nDear DEAR and VaR\n\n\nDEAR is basically 1-day dollar VaR in the context of RiskMetrics model.\n\n\n\n\n\nIf we assume that shocks are independent, daily volatility is approximately constant, and that the FI holds this asset for \\(N\\) number of days, then the \\(N\\)-day VaR is related to DEAR by: \\[\nN\\text{-day VaR} = \\left(\\text{DEAR}\\right) \\times \\sqrt{N}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-contd-1",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics (cont’d)",
    "text": "VaR: RiskMetrics (cont’d)\nNext, we will apply RiskMetrics model on:\n\nfixed-income securities\nforeign exchange (FX)\nequities\n\nAfterwards, we will study how to compute portfolio VaR.\n\n\n\n\n\n\nNote\n\n\nRecall that we need a single number across all asset classes for the aggregate market risk exposure. Aggregation is necessary."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-fixed-income-securities",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-fixed-income-securities",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for fixed-income securities",
    "text": "VaR: RiskMetrics for fixed-income securities\nSuppose an FI has a $1 million market value position in zero-coupon bonds of 7 years to maturity with a face value of $1,631,483. Today’s yield on these bonds is 7.243%.\n\nHow to estimates its DEAR? Some additional assumptions are required.\n\n\nChecking the formula: \\[\n\\text{DEAR} = \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price sensitivity of the position}\\right) \\times \\left(\\text{potential adverse move}\\right)\n\\]\n\n\nOf these three components:\n\ndollar market value of the position is $1 million.\nprice sensitivity of bonds (w.r.t. yield) is measured by (modified) duration (recall last week’s material). \\[\nMD = \\frac{D}{1+R} = \\frac{7}{1+0.07243} = 6.527\n\\]\npotential adverse move (in yield) depends on the assumption of yield distribution and our chosen confidence level."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for fixed-income securities (cont’d)",
    "text": "VaR: RiskMetrics for fixed-income securities (cont’d)\nIn terms of the “potential adverse move in yield”, let’s assume we are concerned about bad yield changes such that there is only a 1% chance that the yield changes will exceed this amount.1\nNote that bond prices decrease with yields. So, we want to know:\n\nthe “maximum upward change in the 7-year rates” (over a day) with a 1% possibility.\n\nWith RiskMetrics, we assume that changes in (7-year) yields follow a Normal distribution. We further assume that2\n\nthe mean \\(\\mu\\) of daily changes in yield is 0bps.\nthe standard deviation \\(\\sigma\\) of daily changes in yield is 10bps.\n\nIn other words, we set a confidence level of 99%.These come from some sophisticated estimations."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd-1",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for fixed-income securities (cont’d)",
    "text": "VaR: RiskMetrics for fixed-income securities (cont’d)\n\n\nTherefore, we can get distribution of daily changes in (7-year) yields as below.\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import norm\n\n# Parameters for normal distribution\nmu = 0  # mean\nsigma = 10  # standard deviation (10 bps)\n\n# Generate data\nx = np.linspace(mu - 4 * sigma, mu + 4 * sigma, 1000)\ny = norm.pdf(x, mu, sigma)\n\n# Calculate the value at 2.33 standard deviations from the mean\nthreshold = mu + 2.33 * sigma\n\n# Plot normal distribution\nplt.figure(figsize=(10, 6))\nplt.plot(x, y, label=\"Normal Distribution\", color=\"#D6D2C4\")\n\n# Fill the upper 1% area\nx_fill = np.linspace(threshold, mu + 4 * sigma, 100)\ny_fill = norm.pdf(x_fill, mu, sigma)\nplt.fill_between(x_fill, y_fill, color=\"#A6192E\", alpha=0.5, label=\"Upper 1% Area\")\n\n# Mark mean and threshold\nplt.axvline(mu, color=\"green\", linestyle=\"dashed\", linewidth=2, label=\"Mean\")\nplt.axvline(\n    threshold, color=\"orange\", linestyle=\"dashed\", linewidth=2, label=\"2.33 Std Dev\"\n)\n\nplt.title(\"Normal Distribution with Mean and 2.33 Standard Deviation\")\nplt.xlabel(\"Value (bps)\")\nplt.ylabel(\"Probability Density\")\nplt.legend()\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\nFigure 3: Normal distribution of changes in 7-year yields\n\n\n\n\n\n\nThe good mathematical property of normal distribution allows us to know that the upper 1% area is separated from the lower 99% by the value \\(\\mu+2.33\\sigma\\).\nSince \\(\\mu=0\\) and \\(\\sigma=10\\text{bps}\\), the cutoff value is \\(2.33\\sigma=23.3\\text{bps}\\).\n\n\n\n\n\n\nNote\n\n\nIt means that, we are 99% confident that the maximum daily upward (adverse) change in (7-year) yields is 23.3 basis points (bps)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd-2",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd-2",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for fixed-income securities (cont’d)",
    "text": "VaR: RiskMetrics for fixed-income securities (cont’d)\nNow we can put everything together.\n\\[\n\\text{DEAR} = \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price sensitivity of the position}\\right) \\times \\left(\\text{potential adverse move}\\right)\n\\]\nOf these three components:\n\ndollar market value of the position is $1 million.\nprice sensitivity of bonds (w.r.t. yield) as measured by modified duration is 6.527.\npotential adverse move (in yield) is 23.3bps or 0.00233%.\n\nSo,\n\\[\n\\begin{aligned}\n\\text{DEAR} &= \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price sensitivity of the position}\\right) \\times \\left(\\text{potential adverse move}\\right) \\\\\n&= \\$1,000,000 \\times 6.527 \\times 0.00233 \\\\\n&= \\$15,207.91\n\\end{aligned}\n\\]\nThat is, the potential daily loss in earnings on the $1 million position is $15,207.91 if the 1 bad day in 100 occurs tomorrow."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-fx",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-fx",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for FX",
    "text": "VaR: RiskMetrics for FX\nThe method of DEAR calculation for FX is largely the same.\n\\[\n\\text{DEAR} = \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price volatility}\\right)\n\\]\nSuppose the FI had a €800,000 trading position in spot euros at the close of business today. The current exchange rate is €0.8/$1 (or $1.25/€1).\n\nDollar market value of the position is \\(€800,000 \\times \\$1.25/€1=\\$1 \\text{ million}\\).\nSuppose that we find the standard deviation of changes in daily exchange rate is 56.5bps, and mean change is 0.\nAgain with a 99% confidence level, the potential adverse move is \\(2.33\\times 56.5\\text{bps}=131.645\\text{bps}\\).\n\nAs a result,\n\\[\n\\begin{aligned}\n\\text{DEAR} &= \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price volatility}\\right) \\\\\n&= \\$1,000,000 \\times 0.0131645 \\\\\n&= \\$13,164\n\\end{aligned}\n\\]\nThis is the potential daily earnings exposure to adverse euro to dollar exchange rate changes for the FI from the €800,000 spot currency holdings."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-equities",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-equities",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for equities",
    "text": "VaR: RiskMetrics for equities\nFundamentally, there is nothing different when applying RiskMetrics DEAR on equity positions.\nRecall that the Capital Market Pricing Model (CAPM) states that for an individual stock \\(i\\), its total risk is its systematic risk plus indiosyncratic (unsystematic) risk.\n\\[\n\\begin{aligned}\n\\text{Total risk} &= \\text{systematic risk} + \\text{unsystematic risk} \\\\\n\\sigma^2_{it} &= \\beta^2_{i} \\sigma^2_{mt} + \\sigma^2_{eit}\n\\end{aligned}\n\\]\nSystematic risk reflects the co-movement of that stock with the market portfolio reflected by the stock’s beta (\\(\\beta_i\\)) and the volatility of the market portfolio (\\(\\sigma_{mt}\\)), while unsystematic risk is specific to the firm itself (\\(\\sigma_{eit}\\)).\nIn a very well diversified portfolio, unsystematic risk can be largely diversified away (i.e., will equal zero), leaving behind systematic (undiversifiable) market risk.\nIf an FI’s equity portfolio largely replicate the market portfolio (index), its beta equals 1 and its standard deviation will be equal to the standard deviation of the market portfolio."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-equities-contd",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-riskmetrics-for-equities-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for equities (cont’d)",
    "text": "VaR: RiskMetrics for equities (cont’d)\nSuppose the FI holds a $1 million equity portfolio that reflects a market index, then the DEAR of the portfolio is\n\\[\n\\begin{aligned}\n\\text{DEAR} &= \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{stock market return volatility}\\right) \\\\\n&= \\$1,000,000 \\times 2.33\\sigma_{m} \\\\\n\\end{aligned}\n\\]\n\n\n\n\n\n\nNote\n\n\nHere, we’ve assumed that the daily returns follow a normal distribution and the mean daily return is 0. Further, we’ve assumed a 99% confidence level.\n\n\n\nIf we find that standard deviation of daily returns \\(\\sigma_m\\) is 200bps, then \\(2.33\\sigma_m=466\\text{bps}\\). This means that we believe that the adverse change in the daily returns of stock market could exceed 466bps only 1% of the time. As such,\n\\[\n\\begin{aligned}\n\\text{DEAR} &= \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{stock market return volatility}\\right) \\\\\n&= \\$1,000,000 \\times 0.0466 \\\\\n&= \\$46,600\n\\end{aligned}\n\\]\nThat is, the potential daily loss in earnings on the $1 million stock position is $46,600 if the 1 bad day in 100 occurs tomorrow."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-portfolio-aggregation",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-portfolio-aggregation",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: portfolio aggregation",
    "text": "VaR: portfolio aggregation\nNow, we have calculated the individual DEAR for the three positions:\n\nSeven-year, zero-coupon bonds = $15,207.91\nEuro spot = $13,164\nEquities = $46,600\n\nYet the manager needs a single number aggregating all positions.\n\nCan we add up the individual DEARs and report it?\n\n\n\n\n\n\n\n\nImportant\n\n\nNO. We cannot sum individual DEAR (or VaR) to compute the aggregate VaR.\n\n\n\nIf you recall, earlier when we introduce the difference models for calculating VaR, we mentioned that RiskMetrics is sometimes all called the “variance-covariance approach”.\n\nSo far, we have only used the “variance” (standard deviation of potential changes), but not the “covariance”!\nAsset shocks (adverse moves) very often are correlated."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-portfolio-aggregation-contd",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-portfolio-aggregation-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: portfolio aggregation (cont’d)",
    "text": "VaR: portfolio aggregation (cont’d)\nIn the case of three individual positions, taking into account correlations, the aggregate DEAR is computed as\n\\[\n\\text{DEAR (aggregate)} = \\sqrt{\\text{D}_1^2 + \\text{D}_2^2 + \\text{D}_3^2 \\\\\n+ 2 \\cdot \\text{D}_1 \\cdot \\text{D}_2 \\cdot \\rho_{12} + 2 \\cdot \\text{D}_1 \\cdot \\text{D}_3 \\cdot \\rho_{13} + 2 \\cdot \\text{D}_2 \\cdot \\text{D}_3 \\cdot \\rho_{23}}\n\\]\nwhere:\n\n\\(\\text{D}_1, \\text{D}_2, \\text{D}_3\\) are the DEARs for the three individual positions.\n\\(\\rho_{12}, \\rho_{13}, \\rho_{23}\\) are the correlation coefficients between the pairs of positions."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-portfolio-aggregation-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-portfolio-aggregation-contd-1",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: portfolio aggregation (cont’d)",
    "text": "VaR: portfolio aggregation (cont’d)\nSuppose we have the following correlation matrix for the daily changes in 7-year rates, changes in euro/dollar spot exchange rates, and changes in equity market returns.\n\n\n\n\n\n\n\n\n\n\n7-Year Rates\nEuro/Dollar Spot Rates\nEquity Market Returns\n\n\n\n\n7-Year Rates\n1.0\n-0.2\n0.4\n\n\nEuro/Dollar Spot Rates\n\n1.0\n0.1\n\n\nEquity Market Returns\n\n\n1.0\n\n\n\nWe will use the correlations to compute the aggregate DEAR (VaR).\n\\[\n\\begin{aligned}\n\\text{DEAR (aggregate)} &= \\sqrt{\\text{D}_1^2 + \\text{D}_2^2 + \\text{D}_3^2 + 2 \\cdot \\text{D}_1 \\cdot \\text{D}_2 \\cdot \\rho_{12} + 2 \\cdot \\text{D}_1 \\cdot \\text{D}_3 \\cdot \\rho_{13} + 2 \\cdot \\text{D}_2 \\cdot \\text{D}_3 \\cdot \\rho_{23}} \\\\\n&= \\sqrt{15207.91^2 + 13164^2 + 46600^2 + 2 \\cdot 15207.91 \\cdot 13164 \\cdot (-0.2)\n+ 2 \\cdot 15207.91 \\cdot 46600 \\cdot (0.4) + 2 \\cdot 13164 \\cdot 46600 \\cdot (0.1)} \\\\\n&= 56441.93\n\\end{aligned}\n\\]\nThat is, this FI with the three positions in fixed-income securities, FX, and equities has an aggregate DEAR of $56,441.93."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-criticisms-against-riskmetrics",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-criticisms-against-riskmetrics",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: criticisms against RiskMetrics",
    "text": "VaR: criticisms against RiskMetrics\nObviously, the assumption of all assets’ returns (or changes) follow a normal distribution is not ideal.\n\nSome assets’ returns are known to have skewness.\nEmpirically, asset returns have long tails.\n\nMoreover, calculating covariances is practically challenging.\n\nWith \\(N\\) assets, there are \\(\\frac{N(N-1)}{2}\\) covariances to compute.\n\n\\[\n\\begin{bmatrix}\n\\sigma_{1}^2 & \\sigma_{12} & \\sigma_{13} & \\cdots & \\sigma_{1N} \\\\\n\\sigma_{21} & \\sigma_{2}^2 & \\sigma_{23} & \\cdots & \\sigma_{2N} \\\\\n\\sigma_{31} & \\sigma_{32} & \\sigma_{3}^2 & \\cdots & \\sigma_{3N} \\\\\n\\vdots      & \\vdots      & \\vdots      & \\ddots & \\vdots      \\\\\n\\sigma_{N1} & \\sigma_{N2} & \\sigma_{N3} & \\cdots & \\sigma_{N}^2 \\\\\n\\end{bmatrix}\n\\]\n\nAn equity portfolio of 500 stocks suggests a total of 124,750 covariance items.\nThere are also many more fixed-income securities, etc."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-historic-or-back-simulation",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-historic-or-back-simulation",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: historic or back simulation",
    "text": "VaR: historic or back simulation\nMany FIs have developed market risk models that employed a historic or back simulation approach.\nEssential idea is to revalue current asset portfolio on basis of past actual prices (returns).\nSimply put, this approach is to\n\nCollect the past 500 days’ actual prices (returns).\nRevalue the asset using the 1% worst case, i.e., the portfolio is revalued as the 5th lowest value out of 500."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-historic-or-back-simulation-contd",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-historic-or-back-simulation-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: historic or back simulation (cont’d)",
    "text": "VaR: historic or back simulation (cont’d)\nThe advantages of historic approach are that\n\nit is simple,\nit does not require that asset returns be normally distributed, and\nit does not require that the correlations or standard deviations of asset returns be calculated.\n\nHowever,\n\n500 observations is not very many from a statistical standpoint.\nIncreasing the number of observations by going back further in time is not desirable.\n\nAs one goes back further in time, past observations may become decreasingly relevant in predicting VaR in the future.\n\n\nHow to improve?\n\nCould weight recent observations more heavily and go further back.\nCould generate additional observations (Monte Carlo simulation)!"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-monte-carlo-simulation",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-monte-carlo-simulation",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: Monte Carlo simulation",
    "text": "VaR: Monte Carlo simulation\nThe Monte Carlo simulation approach of calculating a portfolio’s VaR can be summarized as\n\nGenerate Random Scenarios:\n\nUse statistical methods to simulate a large number of possible future returns for each asset in the portfolio, reflecting their expected returns, volatilities, and correlations.\n\nConstruct Portfolio Returns:\n\nAggregate the simulated asset returns to calculate the portfolio return for each scenario, considering the weights of each asset in the portfolio.\n\nDetermine VaR:\n\nAnalyze the distribution of simulated portfolio returns and identify the threshold loss value that will not be exceeded with a specified confidence level (e.g., 95% or 99%). This threshold is the Value at Risk (VaR)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-monte-carlo-simulation-contd",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-monte-carlo-simulation-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: Monte Carlo simulation (cont’d)",
    "text": "VaR: Monte Carlo simulation (cont’d)\nSuppose we have a portfolio of \\(N\\) assets. Therefore, we have a vector of these assets’ returns \\(\\mu\\) and their covariance matrix \\(\\Sigma\\):\n\\[\n\\mu = \\begin{bmatrix}\n\\mu_1 \\\\\n\\mu_2 \\\\\n\\vdots \\\\\n\\mu_N\n\\end{bmatrix}, \\quad\n\\Sigma = \\begin{bmatrix}\n\\sigma_{1}^2 & \\sigma_{12} & \\cdots & \\sigma_{1N} \\\\\n\\sigma_{21} & \\sigma_{2}^2 & \\cdots & \\sigma_{2N} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\sigma_{N1} & \\sigma_{N2} & \\cdots & \\sigma_{N}^2\n\\end{bmatrix}\n\\]\nWe apply Cholesky Decomposition on the covariance matrix \\(\\Sigma\\) to get a lower triangular matrix \\(L\\) and its transpose \\(L'\\), such that \\[\n\\Sigma = L L'\n\\]\nNext, we generate standard normal random variable, \\(Z\\), where \\(M\\) is the number of scenarios: \\[\nZ = \\begin{bmatrix}\nz_{11} & z_{12} & \\cdots & z_{1N} \\\\\nz_{21} & z_{22} & \\cdots & z_{2N} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nz_{M1} & z_{M2} & \\cdots & z_{MN}\n\\end{bmatrix}\n\\]\nThe simulated asset returns are given by \\(\\mu + Z L'\\)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-monte-carlo-simulation-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-monte-carlo-simulation-contd-1",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: Monte Carlo simulation (cont’d)",
    "text": "VaR: Monte Carlo simulation (cont’d)\nWith the simulated asset returns for \\(M\\) scenarios, we can compute the portfolio return in these \\(M\\) scenarios.\n\nThis leads to a distribution of potential portfolio returns, which enables the calculation of VaR."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#var-monte-carlo-simulation-example",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#var-monte-carlo-simulation-example",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: Monte Carlo simulation (example)",
    "text": "VaR: Monte Carlo simulation (example)\n\n\n\nNumber of Assets: 3\nMean Returns\n\nAsset 1: 0.10% per period\nAsset 2: 0.12% per period\nAsset 3: 0.08% per period\n\nCovariance Matrix \\(\\Sigma\\) \\[\n\\Sigma = \\begin{bmatrix}\n0.0001 & 0.00002 & 0.000015 \\\\\n0.00002 & 0.0001 & 0.000025 \\\\\n0.000015 & 0.000025 & 0.0001\n\\end{bmatrix}\n\\]\nPortfolio Weights:\n\nAsset 1: 40%\nAsset 2: 30%\nAsset 3: 30%\n\nSimulation Parameters:\n\nNumber of Scenarios: 10,000\nConfidence Level: 95%\n\n\n\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Parameters\nnp.random.seed(42)\nn_assets = 3\nn_scenarios = 10000\nconfidence_level = 0.95\n\n# Mean returns and covariance matrix for the assets\nmean_returns = np.array([0.001, 0.0012, 0.0008])  # Example mean returns\ncov_matrix = np.array(\n    [\n        [0.0001, 0.00002, 0.000015],\n        [0.00002, 0.0001, 0.000025],\n        [0.000015, 0.000025, 0.0001],\n    ]\n)  # Example covariance matrix\n\n# Cholesky decomposition of the covariance matrix\nL = np.linalg.cholesky(cov_matrix)\n\n# Generate standard normal random variables\nZ = np.random.normal(size=(n_scenarios, n_assets))\n\n# Simulate asset returns\nsimulated_returns = Z @ L.T + mean_returns\n\n# Given weights\nweights = np.array([0.4, 0.3, 0.3])  # Example weights\n\n# Calculate portfolio returns\nportfolio_returns = simulated_returns @ weights\n\n# Calculate VaR\nVaR = np.percentile(portfolio_returns, (1 - confidence_level) * 100)\n\n# Plotting the portfolio returns and VaR\nplt.figure(figsize=(10, 6))\nplt.hist(portfolio_returns, bins=50, alpha=0.75, color=\"#D6D2C4\", edgecolor=\"black\")\nplt.axvline(VaR, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2)\nplt.title(\"Simulated Portfolio Returns with VaR\")\nplt.xlabel(\"Portfolio Return\")\nplt.ylabel(\"Frequency\")\nplt.legend([\"VaR at 95%\", \"Portfolio Returns\"])\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\nFigure 4: Distributions of portfolio returns from Monte Carlo simulation"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#why-var-could-be-misleading",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#why-var-could-be-misleading",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Why VaR could be misleading?",
    "text": "Why VaR could be misleading?\nVaR tells the FI manager the loss at a particular point on the probability distribution (i.e., 99th percentile).\nIt, however, fails to incorporate information regarding the shape of the probability distribution below that particular point.\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Parameters\nnp.random.seed(42)\nn_scenarios = 10000\nconfidence_level = 0.95\n\n# Distribution 1: Normal distribution\nmu1, sigma1 = 0, 0.01\nreturns1 = np.random.normal(mu1, sigma1, n_scenarios)\nVaR1 = np.percentile(returns1, (1 - confidence_level) * 100)\n\n# Adjust Distribution 2: Mixture of normal distributions\nmu2, sigma2 = 0.01, 0.01\nextreme_mu, extreme_sigma = -0.04, 0.02\n\n# Create a mixture distribution that has the same VaR as Distribution 1\n# Adjust the proportion and parameters of the extreme component to match the target VaR\nfor _ in range(1000):\n    extreme_component = np.random.normal(\n        extreme_mu, extreme_sigma, int(n_scenarios * 0.05)\n    )\n    normal_component = np.random.normal(mu2, sigma2, int(n_scenarios * 0.95))\n    returns2 = np.concatenate([extreme_component, normal_component])\n    VaR2 = np.percentile(returns2, (1 - confidence_level) * 100)\n    if abs(VaR2 - VaR1) &lt; 0.0001:\n        break\n\n# Calculate ES\nES1 = np.mean(returns1[returns1 &lt;= VaR1])\nES2 = np.mean(returns2[returns2 &lt;= VaR2])\n\n# Plot histograms\nplt.figure(figsize=(14, 6))\n\n# Plot for Distribution 1\nplt.subplot(1, 2, 1)\nplt.hist(returns1, bins=50, alpha=0.75, color=\"#D6D2C4\", edgecolor=\"black\")\nplt.axvline(VaR1, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2)\nplt.axvline(ES1, color=\"green\", linestyle=\"dashed\", linewidth=2)\nplt.title(\"Distribution 1 (Normal)\")\nplt.xlabel(\"Return\")\nplt.ylabel(\"Frequency\")\nplt.legend([\"VaR at 95%\", \"ES\", \"Returns\"])\nplt.grid(True)\n\n# Plot for Distribution 2\nplt.subplot(1, 2, 2)\nplt.hist(returns2, bins=50, alpha=0.75, color=\"#D6D2C4\", edgecolor=\"black\")\nplt.axvline(VaR2, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2)\nplt.axvline(ES2, color=\"green\", linestyle=\"dashed\", linewidth=2)\nplt.title(\"Distribution 2 (Mixture)\")\nplt.xlabel(\"Return\")\nplt.ylabel(\"Frequency\")\nplt.legend([\"VaR at 95%\", \"ES\", \"Returns\"])\nplt.grid(True)\n\nplt.tight_layout()\nplt.show()\n\nprint(f\"Left: 95% VaR={VaR1:.5f}; Right: 95% VaR={VaR2:.5f}\")\nprint(f\"Left: Average loss beyond VaR is {ES1:.5f}\")\nprint(f\"Right: Average loss beyond VaR is {ES2:.5f}\")\n\n\n\n\n\n\n\n\nFigure 5: Distributions with same VaR but different ES\n\n\n\n\n\nLeft: 95% VaR=-0.01655; Right: 95% VaR=-0.01654\nLeft: Average loss beyond VaR is -0.02075\nRight: Average loss beyond VaR is -0.04258"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#es-conditional-var",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#es-conditional-var",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "ES: conditional VaR",
    "text": "ES: conditional VaR\nThe drawbacks of VaR became painfully evident during the financial crisis as asset returns plummeted into the fat-tail region of non-normally shaped distributions.\nFI managers and regulators were forced to recognize that VaR projections of possible losses far underestimated actual losses on extreme bad days.\nNow, regulators have replaced VaR with the expected shortfall (ES) measure as the main measure of market risk.\nExpected shortfall, aka “conditional VaR”, estimates the expected value of losses beyond a given confidence level—that is, it is the average of VaRs beyond a given confidence level."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#es-definition",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#es-definition",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "ES: definition",
    "text": "ES: definition\nFor a given confidence level \\(c\\) and a continuous probability distribution, ES can be calculated as \\[\nES(c) = \\frac{1}{1-c}\\int_c^1 VaR(c)du\n\\]\nThat is, for a confidence level of, say, 95% (i.e., \\(c\\)), we measure the area under the probability distribution from the 95th to 100th percentile.\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Parameters\nnp.random.seed(42)\nn_scenarios = 10000\nconfidence_level = 0.95\n\n# Adjust Distribution: Mixture of normal distributions\nmu2, sigma2 = 0, 0.01\nextreme_mu, extreme_sigma = -0.05, 0.02\n\n# Create a mixture distribution that has the desired VaR\nextreme_component = np.random.normal(extreme_mu, extreme_sigma, int(n_scenarios * 0.1))\nnormal_component = np.random.normal(mu2, sigma2, int(n_scenarios * 0.9))\nreturns = np.concatenate([extreme_component, normal_component])\nVaR = np.percentile(returns, (1 - confidence_level) * 100)\n\n# Calculate ES\nES = np.mean(returns[returns &lt;= VaR])\n\n# Plot histogram\nplt.figure(figsize=(10, 6))\n\n# Histogram data\nn, bins, patches = plt.hist(returns, bins=50, alpha=0.75, edgecolor=\"black\")\n\n# Highlight bars below VaR\nfor i in range(len(patches)):\n    if bins[i] &lt; VaR:\n        patches[i].set_facecolor(\"#A6192E\")\n    else:\n        patches[i].set_facecolor(\"#D6D2C4\")\n\n# Add VaR and ES lines\nplt.axvline(VaR, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2, label=\"VaR at 95%\")\nplt.axvline(ES, color=\"purple\", linestyle=\"dashed\", linewidth=2, label=\"ES\")\n\nplt.title(\"Simulated Portfolio Returns with VaR and ES\")\nplt.xlabel(\"Return\")\nplt.ylabel(\"Frequency\")\nplt.legend()\nplt.grid(True)\n\nplt.show()\n\n\n\n\n\n\n\n\nFigure 6: Distribution of expected returns and ES"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#es-advantages-and-potential-problems",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#es-advantages-and-potential-problems",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "ES: advantages and (potential) problems",
    "text": "ES: advantages and (potential) problems\nES is the average of losses that occur beyond the VaR level. It provides a better risk assessment by considering the tail of the loss distribution.\nIn addition, an important advantage of ES over VaR is that ES is additive.\n\nThis means that the ES of a portfolio equals the sum of individual assets’ ESs.\nThe same does not hold true for VaR: recall that we have to consider covariances.\n\nPotential issues with the use of ES include:\n\nEstimation challenges, model dependency, computational complexity."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#bis-regulatory-models-1",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#bis-regulatory-models-1",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "BIS regulatory models",
    "text": "BIS regulatory models\nTwo major ways of calculating market risk exposures and capital requirements:\n\nThe BIS standardized framework\nBanks’ internal model approach (IMA), to be approved by regulatory supervisors\n\ne.g., RiskMetrics, back simulation, Monte Carlo, etc.\nmodels based on expected shortfall1\n\n\n\n\n\n\n\n\nImportant\n\n\nNote that the ultimate objective of measuring market risk exposure is to determine the appropriate capital requirement.\n\n\n\nIn Basel III, market risk measurement is shifted from VaR to ES. However, its implementation varies across countries."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#basel-iii-and-its-implementation",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#basel-iii-and-its-implementation",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Basel III and its implementation",
    "text": "Basel III and its implementation\nWith Basel III now being implemented by countries, the market risk measures are shifting from VaR to ES.\nThe implementation is planned to be phased in over five year since January, 2023.\nIn UK and US, the implementation is set to be applicable in 2025.\nIn Australia, APRA is reviewing the currently in force Prudential Standard APS 116 Capital Adequacy: Market Risk.\n\nAs at the time of this lecture, APRA will delay the effective dates of APS 116 from 2025 to 2026.\nThat is, currently, Australian banks using IMA measure market risks based on VaR.\n\n\n\n\n\n\n\nNote\n\n\nGlobally, banks are in need of talents with specialized knowledge in the field!"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#regulatory-model-standardized-framework",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#regulatory-model-standardized-framework",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Regulatory model: standardized framework",
    "text": "Regulatory model: standardized framework\nThe standardized framework is primarily designed for (smaller) banks that do not use internal models.\n\nCalculation is more formulaic and prescriptive, focusing on specific risk weights and capital charges for different types of assets and market risks.\n\nThe standardized approach capital requirement is the simple sum of three components:\n\nthe capital requirement under the sensitivities-based method,\nthe default risk capital (DRC) requirement, and\nthe residual risk add-on (RRAO).\n\n\n\n\n\n\n\nNote\n\n\nFor a detailed description, see MAR21, MAR22, and MAR23 in BIS Minimum capital requirements for market risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#regulatory-model-ima",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#regulatory-model-ima",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Regulatory model: IMA",
    "text": "Regulatory model: IMA\n\n\n\n\n\n\nImportant\n\n\nBanks’ IMA for market risk currently is based on VaR, but very soon (in the coming years) will be based on ES. Therefore, only the proposed ES-based IMA will be briefly explained here.\n\n\n\nGeneral steps:\n\nCalculation of expected shortfall\nCalculation of capital requirement for modellable risk factors\nCalculation of capital requirement for non-modellable risk factors\nCalculation of default risk capital requirement\nCalculation of capital requirement for model-ineligible trading desks\nAggregation of capital requirement\n\n\n\n\n\n\n\nNote\n\n\nFor a detailed description, see MAR33 in BIS Minimum capital requirements for market risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#suggested-readings",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nBIS The market risk framework in brief\nBIS Minimum capital requirements for market risk\nAPRA Prudential Standard APS 116 Capital Adequacy: Market Risk\nAPRA’s Policy Priorities\nBank of England Implementation of the Basel 3.1 standards: Market risk"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week5/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week5/index.html#references",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#introduction",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#introduction",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Introduction",
    "text": "Introduction\nIn Week 3, we discussed capital adequacy and the (Pillar 1 of Basel) minimum capital requirements, which involves the calculation of risk-weighted assets (RWA) that account for the various risks facing banks.\nAs suggested by Table 1 below, credit risk is likely the most significant risk factor, the risk that the promised cash flows from loans and securities may not be paid in full (e.g., borrower defaults).\n\n\n\nTable 1: RWA of Australian banks in 2023 (source: Capital IQ)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCBA\nWestpac\nNAB\nANZ\nMacquarie\n\n\n\n\nRWA for credit risk\n362,869\n339,758\n355,554\n349,041\n97,485\n\n\nRWA for market risk\n61,968\n51,676\n38,274\n41,967\n11,663\n\n\nRWA for operational risk\n43,155\n55,175\n41,178\n42,319\n15,828\n\n\nOther RWA\n0\n4,809\n0\n0\n0\n\n\nTotal RWA\n467,992\n451,418\n435,006\n433,327\n124,976\n\n\n\n\n\n\n\nFIs (banks) transform financial claims of household savers (e.g., deposits) into claims (e.g., loans) issued to corporations, individuals and governments.\nFIs accept the credit risk on these loans in exchange for a fair return sufficient to cover the cost of funding to household savers and the credit risk involved in lending."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#introduction-contd",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#introduction-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Introduction (cont’d)",
    "text": "Introduction (cont’d)\nThis week:\n\napproaches to analyzing and measuring the credit or default risk on individual loans (and bonds).\n\nNext week (after mid-term exam):\n\nmethods for evaluating the risk of the overall loan portfolio, or loan concentration risk.\n\nMeasurement of the credit risk on individual loans or bonds is crucial if an FI manager is to\n\nprice a loan or value a bond correctly, and\nset appropriate limits on the amount of credit extended to any one borrower or the loss exposure it accepts from any particular counterparty."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#importance-of-credit-risk-management",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#importance-of-credit-risk-management",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Importance of credit risk management",
    "text": "Importance of credit risk management\nCredit risk management is important because it involves the determination of many features of a loan (debt) instrument: interest rate, maturity, collateral requirement, and covenants.\n\nInadequate credit risk management could lead to higher default rates and bank insolvency, especially when markets are competitive and margins are low.\n\nDefault of one major borrower can have significant impact on value and reputation of many FIs.\n\nDirect impact on all lenders involved.\nContagion or spill-over effect on other FIs in the financial system.\n\nMajor economic or natural events can cause significant impact on many FIs loan portfolios.\n\nThe 2007-09 subprime mortgage crisis.\nFloods, earthquakes, etc."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#credit-risk-related-events",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#credit-risk-related-events",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit risk-related events",
    "text": "Credit risk-related events\nSubprime mortgage crisis and the resulting GFC 2007-09.\n\nBanks provided risky mortgages to subprime borrowers with poor credit.\nA housing boom led to speculative investments and rising home prices.\nLenders bundled these mortgages into mortgage-backed securities (MBS) and sold them to investors.\nMany loans had adjustable rates, which increased over time, causing payment difficulties.\nRising defaults led to a housing market collapse, triggering widespread financial losses.\nBanks and investors holding MBS faced a credit crisis, leading to bank failures and liquidity issues."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#credit-risk-related-events-contd",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#credit-risk-related-events-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit risk-related events (cont’d)",
    "text": "Credit risk-related events (cont’d)\nU.S. student loan debt and its future?\n\n$1.73 trillion student loan debt as at September 2021, 7.8% is in default.\n1 out of 10 Americans has defaulted on a student loan.\nPersonal consequences: homeownership, marriage, retirement savings, etc.\nEconomic burden: loan defaults can weigh down the entire country."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#banks-in-australia-non-performing-assets",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#banks-in-australia-non-performing-assets",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Banks in Australia: non-performing assets",
    "text": "Banks in Australia: non-performing assets\n\n\nFigure 1: Non-performing assets of banks in Australia"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#types-of-loans",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#types-of-loans",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Types of loans",
    "text": "Types of loans\nThe loans made by FIs can be broadly categorized into:\n\nCommercial and industrial (C&I) loans\nReal estate loans\nConsumer (individual) loans\nOthers"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#types-of-loans-ci-loans",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#types-of-loans-ci-loans",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Types of loans: C&I loans",
    "text": "Types of loans: C&I loans\nCommercial loans vary significantly in their features.\n\nMaturity, from a few weeks to years.\nAmount, from very small to millions or billions.\nSyndicated or not.\n\nA syndicated loan is one provided by a group of FIs as opposed to a single lender.\n\nSecured or unsecured.\nSpot loans vs loan commitment.\n\nSpot loan: a loan in which the loan amount is withdrawn immediately by the borrower.\nLoan commitment (or line of credit): a credit facility with a maximum size and a maximum period of time over which the borrower can withdraw funds."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#types-of-loans-real-estate-loans",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#types-of-loans-real-estate-loans",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Types of loans: real estate loans",
    "text": "Types of loans: real estate loans\nReal estate loans include residential loans (primarily mortgage loans) and commercial real estate loans.\nAs with C&I loans, residential mortgages differ widely in their characteristics:\n\nLoan size\nLTV (loan-to-value ratio): the ratio of the loan to the property’s price\nMaturity\nMortgage interest rates and fees: adjustable-rate mortgages (ARMs) and fixed-rate mortgages\n\nResidential mortgages are typically very long-term loans with 20yrs+ maturity.\n\nHousing price can fall below the loan amount, causing defaults and eventually foreclosures."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#types-of-loans-consumer-loans",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#types-of-loans-consumer-loans",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Types of loans: consumer loans",
    "text": "Types of loans: consumer loans\nConsumer (personal) loans include, for example, personal and auto loans.\nCredit cards are a type of consumer loan financing."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#types-of-loans-other-loans",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#types-of-loans-other-loans",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Types of loans: other loans",
    "text": "Types of loans: other loans\n“Other loans” include a variety of borrowers and types, including for example\n\nfarmers\nother banks\nnonbank FIs (e.g., broker margin loans)\nstate and local governments"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#calculating-the-return-on-a-loan",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#calculating-the-return-on-a-loan",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Calculating the return on a loan",
    "text": "Calculating the return on a loan\nOnce the decision to make a loan has been made, the pricing of the loan is an important aspect of credit risk management, which includes adjustments for the perceived credit risk of the borrower as well as any fees and collateral backing the loan.\nA traditional return on assets approach to calculate the return on a loan is explained here."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#contractually-promised-return-on-a-loan",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#contractually-promised-return-on-a-loan",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Contractually promised return on a loan",
    "text": "Contractually promised return on a loan\nFactors affecting the promised loan return:\n\nLoan interest rate\nCredit risk premium\nFees\nCollateral\nNon-price terms"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#contractually-promised-return-on-a-loan-contd",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#contractually-promised-return-on-a-loan-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Contractually promised return on a loan (cont’d)",
    "text": "Contractually promised return on a loan (cont’d)\n\n\nSuppose that an FI makes a spot one-year $1 million loan. The loan rate may be set as\n\\[\n\\begin{aligned}\n\\text{Base lending rate } BR &= 8\\% \\\\\n\\text{+ Credit risk premium } \\phi &= 2\\% \\\\\nBR + \\phi &= 10\\%\n\\end{aligned}\n\\]\n\nThe base lending rate (BR) reflects the FI’s weighted-average cost of capital (WACC) or its marginal cost of funds.\n\nFor example, LIBOR-the London Inter-Bank Offered Rate.\nLIBOR manipulation scandal led to its phasing out and replacement by more transparent and reliable rates like SOFR-the Secured Overnight Financing Rate.\nThe Australian equivalent is the Bank Bill Swap Rate (BBSW).\n\nThe base lending rate could also reflect the prime lending rate, the interest rate that commercial banks charge their most creditworthy and low-risk corporate customers.\n\n\n\n\n\n\nNote\n\n\nLIBOR/SOFR (BBSW) more commonly used for short-term loans, while prime rates more for long-term loans.\n\n\n\nA credit risk premium is added to the base lending rate."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#contractually-promised-return-on-a-loan-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#contractually-promised-return-on-a-loan-contd-1",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Contractually promised return on a loan (cont’d)",
    "text": "Contractually promised return on a loan (cont’d)\nDirect and indirect fees and charges:\n\nLoan origination fee (\\(f\\)) for processing the application.\nCompensating balance requirement (\\(b\\)) to be held as (demand) deposits.\n\nA portion of the loan that the borrower must keep in a deposit account, typically earning little or no interest, which helps the bank secure funds and reduce the effective loan amount while still charging interest on the full loan value.\n\nReserve requirement (\\(RR\\)) imposed by regulatory authority on the demand deposits.\n\n\n\n\n\n\n\n\nNumeric example\n\n\n\nIf a borrower takes a loan of $100,000 but must maintain a compensating balance of 10%, they need to keep $10,000 in a non-interest-bearing deposit account with the bank. Thus, they effectively receive $90,000 but pay interest on the full $100,000.\nThe bank receives this $10,000 in deposits. Given a reserve requirement of 5%, the bank must keep \\(\\$10,000 \\times 5\\%=\\$500\\) in reserve (cash or deposits with the central bank)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#contractually-promised-return-on-a-loan-contd-2",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#contractually-promised-return-on-a-loan-contd-2",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Contractually promised return on a loan (cont’d)",
    "text": "Contractually promised return on a loan (cont’d)\nThe gross return on loan (\\(k\\)) per dollar lent is given by \\[\n1+k = 1+\\frac{f+(BR+\\phi)}{1-[b(1-RR)]}\n\\]\n\n\n\n\n\n\n\nAn annotated version of the formula\n\n\n\\[\n1+k=1+\\frac{\\overbrace{f+(BR+\\phi)}^{\\text{interest and fees earned}}}{\\underbrace{1}_{\\$1 \\text{ loan}}-[\\underbrace{b}_{\\text{amount of loan deposited with the bank}}\\times \\underbrace{(1-RR)}_{\\text{not reserved for regulatory compliance}}]}\n\\]\n\nFor every $1 the FI lends, it retains \\(b\\) as compensating balance. The borrower receives \\(1-b\\).\nSince \\(b\\) is held by the borrower at the FI as a demand deposit account, regulatory authority requires the bank to hold reserves at a rate \\(RR\\) against the compensating balance.\nThe net outflow by the bank per $1 of loans made is therefore \\(1-[b(1-RR)]\\), 1 minus the reserve-adjusted compensating balance requirement."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#contractually-promised-return-on-a-loan-contd-3",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#contractually-promised-return-on-a-loan-contd-3",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Contractually promised return on a loan (cont’d)",
    "text": "Contractually promised return on a loan (cont’d)\nSuppose a bank does the following:\n\nSets the loan rate on a prospective loan at 10% (where \\(BR\\)=6% and \\(\\phi\\)=4%)\nCharges a 12.5 basis point (or 0.125%) loan origination fee \\(f\\) to the borrower\nImposes an 8% compensating balance requirement \\(b\\) to be held as non-interest-bearing demand deposits\nSets aside reserve, at a rate of 10% of deposits, held at the central bank (i.e. \\(RR\\) is 10%)\n\nWhat is the contractually promised gross return on the loan? \\[\n\\begin{aligned}\n1+k &= 1+\\frac{f+(BR+\\phi)}{1-[b(1-RR)]} \\\\\n1+k &= 1+\\frac{0.00125+(0.06+0.04)}{1-[0.08(1-0.1)]} \\\\\n1+k &= 1+\\frac{0.10125}{0.928} \\\\\nk &= 10.91\\%\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#some-notes",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#some-notes",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Some notes",
    "text": "Some notes\nSince March 26, 2020, reserve requirements (\\(RR\\)) are eliminated for all depositary institutions in the U.S.\nAs commercial lending markets have become more competitive, both origination fees (\\(f\\)) and compensating balances (\\(b\\)) are becoming less important.\nAs a result, the credit risk premium (\\(\\phi\\)) is the primary determinant for the promised return of a loan, once the base rate is set.\n\n\n\n\n\n\nNote\n\n\nTo achieve a target promised gross return (\\(k\\)) on a loan, an FI can use various combinations of fees, compensation balances, and risk margins."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#the-expected-return-on-a-loan",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#the-expected-return-on-a-loan",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "The expected return on a loan",
    "text": "The expected return on a loan\nThe promised return on a loan (\\(k\\)) can differ from the expected return and the actual return on the loan because of default risk.\nAt the time the loan is made, the expected return \\(E(r)\\) per dollar lent is related to the promised return \\(k\\) as follows: \\[\n1+E(r) = p(1+k) + (1-p)\\times 0\n\\] where \\(p\\) is the probability of complete repayment of the loan and \\((1-p)\\) is the probability of default, in which case the FI receives nothing.1 The expected return is a weighted average of:\n\nFull repayment: \\((1+k)\\) with probability of \\(p\\)\nNo repayment: 0 with probability of \\((1-p)\\)\n\nIf \\(p&lt;1\\):\n\nDefault risk exists\nFI needs to set risk premium\nFI needs to recognize that higher fees and charges might decrease \\(p\\)\n\nIn practice, the FI may recover part of the loan."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#the-expected-return-on-a-loan-contd",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#the-expected-return-on-a-loan-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "The expected return on a loan (cont’d)",
    "text": "The expected return on a loan (cont’d)\nSuppose a bank does the following:\n\nSets the loan rate on a prospective loan at 10%\nExpects a probability of default of 5%\nRecovers nothing if the loan is defaulted\n\nWhat is the expected return on the loan?\nThe probability of default \\((1-p)=0.05\\); loan rate is 10%. \\[\n\\begin{aligned}\n1+E(r) &= p(1+k) = (1-0.05)(1+0.1) = 1.045 \\\\\n  E(r) &= 0.045\n\\end{aligned}\n\\] Expected return on this loan is 4.5%."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#some-notes-1",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#some-notes-1",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Some notes",
    "text": "Some notes\nFIs usually control credit risk along two dimensions:\n\nthe price or promised return dimension, and\nthe quantity or credit availability dimension.\n\nThe quantity dimension applies more in retail (e.g., consumer) loans.\nThe price dimension applies more in wholesale (e.g., C&I) loans."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#retail",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#retail",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Retail",
    "text": "Retail\nRetail loans to household borrowers (consumers) tend to have smaller size and higher costs of information collection, and as a result, retail lending decisions tend to be “accept or reject” decisions.\n\nBorrowers of a similar loan product, regardless of their credit risk, are often charged the same credit risk premium.\n\nRetail customers are more likely to be sorted or rationed by loan quantity restrictions than by price (interest rate) differences.\n\nIn finance words, an FI controls its credit risk at the retail level by credit rationing.\n\n\n\n\n\n\n\nNote\n\n\nResidential mortgages are a good example. Two mortgage borrowers may pay the same mortgage rate while their LTVs are different."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#wholesale",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#wholesale",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Wholesale",
    "text": "Wholesale\nAt the wholesale (C&I) level, FIs use both interest rates and credit quantity to control credit risk.\n\nAs long as they are compensated with sufficiently high credit risk premium, FIs may be willing to lend to high-risk wholesale borrowers.\nHowever, higher interest rates may increase the probability of borrower’s default, reducing expected return.\n\n\n\n\n\n\n\nNote\n\n\nAnother important consideration is that only high-risk borrowers may be willing to borrow at high interest rates. This is an “adverse selection” problem.\n\n\n\n\nAs a result, FIs may credit ration its wholesale loans beyond certain interest rate level. That is, the FI can establish an upper ceiling on the amount of loan it is willing to lend.\n\n\n\n\n\n\n\nTip\n\n\nSometimes, an FI can achieve a higher expected return on its loan portfolio if it cuts its loan rates."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#it-is-all-about-information",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#it-is-all-about-information",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "It is all about information",
    "text": "It is all about information\nTo calibrate the credit risk exposure, FIs need to estimate the borrower’s default probability, which largely depends on their ability to collect and analyze information, cost-efficiently.\n\nAt the retail level, such information may be collected internally (e.g., past banking records) or externally (e.g., credit reports from rating agencies).\n\nThere are three main credit reporting bodies in Australia: Equifax, illion and Experian\n\nAt the wholesale level, such information comes from multiple sources:\n\nLarge, public firms: financial statements, stock and bond prices, analysts’ reports, etc.\nSmaller, private firms: financial statements (if any)\n\n\n\n\n\n\n\n\nNote\n\n\nAdvances in technologies make it easier to collect and analyze information of smaller borrowers."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#protection-against-credit-risk",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#protection-against-credit-risk",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Protection against credit risk",
    "text": "Protection against credit risk\nLoan covenants are often used mitigate credit risk. Covenants are loan contract terms that restrict or encourage various actions to enhance the probability of repayment.\n\nFor example, covenants may limit the type and amount of new debt, investments, and asset sales the borrower can undertake while the loan is outstanding.\nFinancial covenants may restrict changes in the borrower’s financial ratios such as leverage or current ratio."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#example-loan-contract-covenants",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#example-loan-contract-covenants",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Example loan contract covenants",
    "text": "Example loan contract covenants\nCredit Agreement, dated as of October 2, 2017, among Cincinnati Bell Inc. (borrower), Morgan Stanley Senior Funding Inc. (lead bank) and other lenders.\n\nArticle VII Affirmative Covenants\nArticle VIII Negative Covenants"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#default-risk-models-1",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#default-risk-models-1",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Default risk models",
    "text": "Default risk models\nMany different qualitative and quantitative models are employed to assess the default risk on loans and bonds.\n\nThey are not mutually exclusive.\nAn FI manager may use both qualitative and quantitative models and use more than one model to reach a credit decision.\n\nA significant amount of investments into the development of highly effective credit risk models."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#qualitative-models",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#qualitative-models",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Qualitative models",
    "text": "Qualitative models\nBorrower-specific factors are considered as well as market or systematic factors.\nSpecific factors include:\n\nReputation: implicit contract\nLeverage (capital structure)\nVolatility of earnings\nCollateral\n\nMarket-specific factors include:\n\nBusiness cycle\nLevel of interest rates\n\n\n\n\n\n\n\nNote\n\n\nA LOT more factors are considered in practice than we can discuss here."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#quantitative-models",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#quantitative-models",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Quantitative models",
    "text": "Quantitative models\nCredit scoring models use observed borrower characteristics to\n\neither calculate a score representing the applicant’s default probability, or\nsort borrowers into different default risk classes.\n\n\n\nScoring models might help to:\n\nEstablish factors that help to explain default risk\nEvaluate the relative importance of these factors\nImprove the pricing of default risk\nSort out bad loan applicants\nMore easily calculate reserve needs\n\n\nThree broad types\n\nLinear probability models\nLogit models\nLinear discriminant analysis"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#credit-scoring-linear-probability-models",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#credit-scoring-linear-probability-models",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit scoring: linear probability models",
    "text": "Credit scoring: linear probability models\nUses past data, such as financial ratios, as inputs into a linear model to explain repayment experience on old loans.\n\\[\nPD_i = \\sum^n_{j=1} \\beta_j X_{ij} + \\text{error}\n\\] where\n\n\\(PD_i\\) is the probability of default of borrower \\(i\\)\n\\(\\beta_j\\) is the estimated importance of the \\(j\\)th variable (e.g, leverage)\n\\(X_{ij}\\) is a set of causal variables that reflect quantitative information about the \\(i\\)th borrower"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#credit-scoring-linear-probability-models-contd",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#credit-scoring-linear-probability-models-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit scoring: linear probability models (cont’d)",
    "text": "Credit scoring: linear probability models (cont’d)\nSuppose there were two factors influencing the past default behaviour of borrowers: the leverage (D/E) and sales-asset ratio (S/A).\nBased on past default (repayment) experience, the linear probability model is estimated as:\n\\[\nPD = 0.5\\times \\frac{D}{E} - 0.0525 \\times \\frac{S}{A}\n\\]\nAssume a prospective borrower has a \\(D/E\\) of 0.3 and an \\(S/A\\) of 2. Its estimated default probability is \\[\nPD = 0.5\\times 0.3 - 0.0525 \\times 2 = 0.045\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#credit-scoring-logit-models",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#credit-scoring-logit-models",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit scoring: logit models",
    "text": "Credit scoring: logit models\n\n\n\n\n\n\nCaution\n\n\nLinear probability model has a weakness being that the estimated probability may be smaller than 0 or larger than 1. This can be addressed by the logit model.\n\n\n\nEssentially, this is done by plugging the estimated value of \\(PD\\) from the linear probability model (in previous example, \\(PD=0.045\\)), into the following formula:\n\\[\nF(PD) = \\frac{1}{1+e^{-PD}}\n\\] where \\(F(PD)\\) is the logistically transformed value of \\(PD\\).\n\nOther alternatives include Probit and other variants with nonlinear indicator functions."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#credit-scoring-linear-discriminant-analysis",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#credit-scoring-linear-discriminant-analysis",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit scoring: linear discriminant analysis",
    "text": "Credit scoring: linear discriminant analysis\n\nLinear probability and logit models estimate a default probability (a value from 0 to 1) if a loan is made.\nDiscriminant models divide borrowers into high/low default risk classes based on observed characteristics.\n\nAltman’s Z score model for manufacturing firms:\n\n\n\\[\nZ = 1.2 X_1 + 1.4 X_2 + 3.3 X_3 + 0.6 X_4 + 1.0 X_5\n\\] where\n\n\\(X_1 = \\text{Working capital / Total assets}\\).\n\\(X_2 = \\text{Retained earnings / Total assets}\\).\n\\(X_3 = \\text{Earnings before interest and taxes / Total assets}\\).\n\\(X_4 = \\text{Market value of equity / Book value of total liabilities}\\).\n\\(X_5 = \\text{Sales / Total assets}\\).\n\n\nThe classification:\n\nHigh default risk: \\(Z&lt;1.81\\)\nIndeterminant defaualt risk: \\(1.81&lt;Z&lt;2.99\\)\nLow default risk: \\(Z&gt;2.99\\)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#weaknesses-of-credit-scoring-models",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#weaknesses-of-credit-scoring-models",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Weaknesses of credit scoring models",
    "text": "Weaknesses of credit scoring models\n\nWeights in any credit scoring model unlikely to be constant over longer periods of time\nVariables in any credit scoring model unlikely to be constant over longer periods of time\nModels ignore hard-to-quantify factors such as borrower reputation\nThere is no centralised database on defaulted business loans for proprietary or other reasons\nDiscriminant models make broad distinction between borrower categories, that is, good and bad borrowers, yet in the real world various gradations of default exist, from non-payment or delay of interest payments (nonperforming assets) to outright default on all promised interest and principal payments\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#newer-models-of-credit-risk-measurement-and-pricing",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#newer-models-of-credit-risk-measurement-and-pricing",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Newer models of credit risk measurement and pricing",
    "text": "Newer models of credit risk measurement and pricing\nNewer credit risk models use finance theory and more widely available financial market data to make inference about default probabilities on debt and loan instruments.\nA lot of research is taking place and we consider a number of these newer approaches here, including\n\nTerm structure of credit risk approach (also called reduced-form models)\nMortality rate derivation of credit risk\nRAROC\nOption models (also called structural models since they are based on an economic model of why firms default)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#term-structure-derivation-of-credit-risk",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#term-structure-derivation-of-credit-risk",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Term structure derivation of credit risk",
    "text": "Term structure derivation of credit risk\nA simple key idea: extract the expected default rates from the current term structure of interest rates.\nA risk-neutral FI would be indifferent between investing in a risk-free government bond and a risky corporate loan/bond.\n\nRisk-free return: \\(1+i\\)\nCorporate bond’s expected return: \\(p(1+k)+(1-p)(1+k)\\gamma\\)\n\nwhere \\(\\gamma\\) is the recovery rate if the loan defaults.\nWe can set \\(p(1+k)+(1-p)(1+k)\\gamma = 1 + i\\) and compute the risk-neutral default probability \\((1-p)\\).\n\nMay be generalised to loans with any maturity or to adjust for varying default recovery rates.\nThe loan can be assessed using the inferred probabilities from comparable quality bonds."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#mortality-rate-derivation-of-credit-risk",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#mortality-rate-derivation-of-credit-risk",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Mortality rate derivation of credit risk",
    "text": "Mortality rate derivation of credit risk\nRather than extracting expected default rates from the current term structure of interest rates, the probability of default is estimated from past data on defaults, similar to the process employed by insurance companies to price policies.\n\n\n\n\n\n\nTip\n\n\nInsurance companies do not estimate an individual’s future health condition, but rather, use historic data to statistically examine a pool of people with similar characteristics (e.g., age, gender, medical history) to calculate the probability of mortality or other health-related risks over time.\n\n\n\nFor example, for grade B bonds, the marginal mortality rate (MMR) for the first year of issue is \\[\nMMR_1 = \\frac{\\text{Total value of grade B bonds default in year 1 of issue}}{\\text{Total value of grade B bonds outstanding in year 1 of issue}}\n\\] We can similarly construct \\(MMR_2\\), \\(MMR_3\\), …, and construct a MMR curve.\n\nMortality rate approach has a number of conceptual and applicability problems.\nHistoric, backward-looking, sensitive to the period chosen for analysis."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#raroc",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#raroc",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "RAROC",
    "text": "RAROC\nRisk-adjusted return on capital (RAROC) was pioneered by Bankers Trust (acquired by Deutsche bank in 1998).\n\\[\nRAROC = \\frac{\\text{One-year net income on a loan}}{\\text{Loan risk}}\n\\] where \\[\n\\text{One-year net income on loan} = (\\text{Spread} + \\text{Fees}) \\times \\text{Dollar value of the loan outstanding}\n\\] and Loan risk can be measure by, for example, duration. \\[\n\\frac{\\Delta LN}{LN} = - D_{LN} \\frac{\\Delta R}{1+R}\n\\] so that \\[\n\\underbrace{\\Delta LN}_{\\text{dollar risk exposure}} = - \\underbrace{D_{LN}}_{\\text{duration of loan}} \\times \\underbrace{LN}_{\\text{loan amount}} \\times \\underbrace{\\frac{\\Delta R}{1+R}}_{\\text{shock}}\n\\]\n\nLoan approval if RAROC &gt; benchmark return on capital."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#option-models-of-default-risk",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#option-models-of-default-risk",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Option models of default risk",
    "text": "Option models of default risk\nRationale:\n\nA borrower borrows to invest.\nIf its investments are successful, the borrower repays.\nIf its investments fail and the borrower cannot repay the lender,\n\nThe borrower has an option to default on its debt, simply turning any remaining assets over to the lender.\n\nThe borrower’s (equity holders’) loss is capped due to limited liability.\n\n\n\n\n\n\n\nNote\n\n\nThe KMV Corporation1 turned this relatively simple idea into a credit monitoring model.\nMany of the largest U.S. FIs are now using this model to determine the expected default frequency (EDF) of large corporations.\n\n\n\nThe KMV Corporation was purchased by Moody’s in 2002 and is now part of Moody’s Analytics Enterprise Risk Solutions."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#option-models-of-default-risk-contd",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#option-models-of-default-risk-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Option models of default risk (cont’d)",
    "text": "Option models of default risk (cont’d)\nWe can use option pricing models like Merton (1974) and Black and Scholes (1973) to estimate default probability. The option valuation models can also be applied to calculate the default risk premium.\nMerton (1974) shows that the market value of risky loan made by a lender to a borrower is\n\n\n\\[\nL(\\tau) = B e^{-i\\tau} [(1/d) N(h_1) + N(h_2)]\n\\] where\n\n\\(\\tau\\) is the time remaining to loan maturity\n\\(i\\) is the risk-free rate\n\\(d\\) is the borrower’s leverage ratio measured as \\(B e^{-i\\tau} / A\\), where \\(A\\) is assets’ value\n\\(N(\\cdot)\\) is the cumulative normal distribution function\n\n\n\\[\n\\begin{aligned}\nh_1 &= - \\frac{[\\frac{1}{2} \\sigma^2 \\tau - \\ln(d)]}{\\sigma \\sqrt{\\tau}} \\\\\nh_2 &= - \\frac{[\\frac{1}{2} \\sigma^2 \\tau + \\ln(d)]}{\\sigma \\sqrt{\\tau}}\n\\end{aligned}\n\\]\n\n\\(\\sigma^2\\) measures the asset risk of the borrower, which is the variance of the rate of change in the value of the underlying assets of the borrower\n\n\nThe equilibrium default risk premium (\\(\\phi\\)) that the borrower should be charged is\n\\[\n\\phi = k(\\tau) - i = -\\frac{1}{\\tau} \\ln [N(h_2)+(1/d) N(h_1)]\n\\]\n\n\\(k(\\tau)\\) is the contractually promised return"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#option-models-of-default-risk-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#option-models-of-default-risk-contd-1",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Option models of default risk (cont’d)",
    "text": "Option models of default risk (cont’d)\n\n\nCode\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nmu = 3  # mean\nsigma = 1  # standard deviation\n\nx = np.linspace(0, 6, 300)\ny = (1 / (np.sqrt(2 * np.pi) * sigma)) * np.exp(-0.5 * ((x - mu) / sigma) ** 2)\n\nfig, ax = plt.subplots(figsize=(8, 6))\n\nax.plot(x, y, color='blue')\n\nx_fill = np.linspace(0, 0.8, 100)\ny_fill = (1 / (np.sqrt(2 * np.pi) * sigma)) * np.exp(-0.5 * ((x_fill - mu) / sigma) ** 2)\nax.fill_between(x_fill, y_fill, color='blue', alpha=0.3)\n\nax.annotate('Probability of default\\n(EDF)', xy=(0.5, 0.0), xytext=(0.01, 0.1),\n            arrowprops=dict(facecolor='black', arrowstyle='-&gt;'), fontsize=12)\n\nax.annotate('Market value at time 0', xy=(3, 0.0), xytext=(3, 0.2),\n            arrowprops=dict(facecolor='black', arrowstyle='-&gt;'), fontsize=12)\n\n# Set limits and labels\nax.set_xlim([0, 6])\nax.set_ylim([0, 0.5])\nax.set_xticklabels([])\nax.set_yticklabels([])\nax.set_xlabel('Market value of assets at loan maturity')\nax.set_ylabel('Probability')\n\n# Show plot\nplt.show()\n\n\n\n\n\n\n\n\nFigure 2: EDF and assets value"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#suggested-readings",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nRBA Interest Rate Benchmark Reform in Australia.\nRisk Management Association (RMA) content on credit risk.\n\nRMA provides average balance sheet and income data for more than 400 industries, common ratios computed for each size group and industry, five-year trend data, and financial statement data for more than 100,000 commercial borrowers.\n\n\nIf you’re into Math and would like to see some code,\n\nMerton distance to default (DD)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week6/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week6/index.html#references",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nBlack, Fischer, and Myron Scholes. 1973. “The Pricing of Options and Corporate Liabilities.” Journal of Political Economy 81 (3): 637–54. http://www.jstor.org/stable/1831029.\n\n\nMerton, Robert C. 1974. “On the Pricing of Corporate Debt: The Risk Structure of Interest Rates*.” The Journal of Finance 29 (2): 449–70. https://doi.org/10.1111/j.1540-6261.1974.tb03058.x."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#introduction",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#introduction",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Introduction",
    "text": "Introduction\n\nIn Week 6, we discussed alternative ways by which FI managers can measure the default (credit) risk on individual loans.\nFIs typically hold a portfolio of loans and hence credit risk should also be measured and managed in a portfolio context.\nThis week, we discuss several models used by FI managers to assess the risk of the overall loan portfolio.\nWe will also discuss the use of derivatives to manage credit risk."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#simple-models",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#simple-models",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Simple models",
    "text": "Simple models\n\n\n\n\n\n\nCaution\n\n\nA large credit risk exposure to a single borrower or group of related borrowers poses a potential threat to a bank’s safety and soundness.\n\n\n\n\nRegulations are in place to limit such exposure.\nAs a result, individual loans rarely cause material losses or bank failures.\nPrimary cause of credit-related distress is that pools of individual loans sharing similar characteristics perform similarly, especially during extreme conditions.\nAn important lesson learned is that products exposed to the same types of risks can have different names and under different business units.\n\nTwo simple models widely employed to measure credit risk concentration in the loan portfolio:\n\nMigration analysis\nConcentration limits"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#simple-model-migration-analysis",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#simple-model-migration-analysis",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Simple model: migration analysis",
    "text": "Simple model: migration analysis\n\nTrack credit ratings of certain types of loans or certain sectors, either externally from credit rating agencies or internally.\nIf actual rating deteriorates faster than historical experience, limit lending to that loan class or sector.\nHistorical credit migration measured through loan migration matrix (or transition matrix).\n\n\n\n\nTable 1: Example loan migration matrix\n\n\n\n\n\n\nAAA-A\nBBB-B\nCCC-C\nDefault\n\n\n\n\nAAA-A\n0.85\n0.10\n0.04\n0.01\n\n\nBBB-B\n0.12\n0.83\n0.03\n0.02\n\n\nCCC-C\n0.03\n0.13\n0.80\n0.04\n\n\n\n\n\n\nTable 1, for example, shows the transition probabilities of loans that began the year with a certain credit rating being upgraded/downgraded to a certain rating, or default.\n\n\nThe probability of AAA-rated loan at the start of a year being downgraded to BBB to B by the year’s end is 0.10.\nThe probability of AAA-rated loan at the start of a year being downgraded to CCC to C by the year’s end is 0.04.\nThe probability of AAA-rated loan at the start of a year defaults by the year’s end is 0.01."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#simple-model-migration-analysis-contd",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#simple-model-migration-analysis-contd",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Simple model: migration analysis (cont’d)",
    "text": "Simple model: migration analysis (cont’d)\nIn practice, FIs use migration matrices with many more rating classes.\nMigration analysis is used not only to evaluate commercial loan portfolios, but also to analyze credit card portfolios and consumer loans.\nHowever, potential problems with migration analysis include, for example:\n\nUse of historical data.\nRating agencies usually downgrade only after the firm has experienced a downturn."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#simple-model-concentration-limits",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#simple-model-concentration-limits",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Simple model: concentration limits",
    "text": "Simple model: concentration limits\n\nLimits set on the maximum loan size to an individual borrower/sector or geographical area.\nUsed to reduce exposures to certain industries and to increase exposure to others.\nUse of aggregate limits for industries in which performance is highly correlated.\nBank regulators also limit loan concentrations to individual borrowers to a maximum of 15% of a bank’s capital.\n\n\\[\n\\text{Concentration limit} = \\text{Maximum loss as a percentage of capital} \\times \\frac{1}{\\text{Loss rate}}\n\\]\n\n\n\n\n\n\n\nExample\n\n\nIf an FI’s manager is unwilling to permit losses exceeding 15% of the FI’s capital, with an estimated loss rate in a particular industry of 40 per cent, then the manager should set a concentration limit on the exposure to that industry as \\(15\\%\\times \\frac{1}{0.4}=37.5\\%\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#simple-model-concentration-limits-contd",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#simple-model-concentration-limits-contd",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Simple model: concentration limits (cont’d)",
    "text": "Simple model: concentration limits (cont’d)\nBelow is an industry breakdown of Bank of Queensland’s (BOQ) credit exposure as reported in FY2023’s annual report.\n\n\n\nTable 2: Proportionate credit exposures of lending activities of BOQ FY23\n\n\n\n\n\nSector\n$m\n% of Total Exposure\n\n\n\n\nResidential mortgages\n62,738\n77.8\n\n\nProperty and construction\n6,887\n8.5\n\n\nHealthcare\n2,763\n3.4\n\n\nProfessional services\n2,431\n3.0\n\n\nAgriculture\n1,232\n1.5\n\n\nTransportation\n606\n0.8\n\n\nManufacturing and mining\n682\n0.8\n\n\nHospitality and accommodation\n841\n1.0\n\n\nOther\n2,453\n3.0\n\n\nTotal\n80,633\n100.0"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#loan-portfolio-diversification-and-mpt",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#loan-portfolio-diversification-and-mpt",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Loan portfolio diversification and MPT",
    "text": "Loan portfolio diversification and MPT\nMPT can be used to measure and control an FI’s aggregate credit risk exposure.\nAny model that seeks to estimate an efficient frontier for loans needs to determine and measure three things:\n\nThe expected return on individual loans\nThe risk of individual loans\nThe correlation of default risks between loans\n\nExpected return \\(R_p\\) of a portfolio of \\(N\\) assets:\n\\[\nR_p = \\sum_{i=1}^N X_i R_i\n\\]\nwhere\n\n\\(R_i\\) is the expected return on the \\(i\\)th asset\n\\(X_i\\) is the proportion of the asset portfolio invested in the \\(i\\)th asset (the desired concentration amount)"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#loan-portfolio-diversification-and-mpt-contd",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#loan-portfolio-diversification-and-mpt-contd",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Loan portfolio diversification and MPT (cont’d)",
    "text": "Loan portfolio diversification and MPT (cont’d)\nVariance of returns (or risk) of the portfolio \\(\\sigma_p^2\\) can be calculated as\n\\[\n\\begin{aligned}\n\\sigma_i^2 &= \\sum_{i=1}^N X_i^2 \\sigma^2_i + \\sum_{i=1}^N \\sum_{j=1}^N X_i X_j \\sigma_{ij} \\\\\n           &= \\sum_{i=1}^N X_i^2 \\sigma^2_i + \\sum_{i=1}^N \\sum_{j=1}^N X_i X_j \\rho_{ij} \\sigma_i \\sigma_j\n\\end{aligned}\n\\]\nwhere\n\n\\(\\rho_{ij}\\) is the correlation between the returns on the \\(i\\)th asset \\(j\\)th asset\n\\(\\sigma_i^2\\) is the variance of returns on the \\(i\\)th asset\n\\(\\sigma_{ij}^2\\) is the covariance of returns between the \\(i\\)th asset and \\(j\\)th asset"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#loan-portfolio-diversification-and-mpt-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#loan-portfolio-diversification-and-mpt-contd-1",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Loan portfolio diversification and MPT (cont’d)",
    "text": "Loan portfolio diversification and MPT (cont’d)\nThe fundamental lesson of MPT is that by taking advantage of its size, an FI can diversify considerable amounts of credit risk as long as the returns on different assets are imperfectly correlated with respect to their default risk adjusted returns.\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Define annualized returns and covariance matrix for two assets\nmean_returns = np.array([0.04, 0.1])  # Expected annual returns for two assets\ncov_matrix = np.array([[0.06, 0.02], [0.02, 0.10]])  # Covariance matrix of returns\nindividual_volatility = np.sqrt(np.diag(cov_matrix))  # Volatility of individual assets\n\n# Define the number of portfolios to simulate\nnum_portfolios = 10000\n\n# Initialize empty lists to store portfolio returns, volatilities, and weights\nresults = np.zeros((3, num_portfolios))\n\n# Simulate random portfolios\nfor i in range(num_portfolios):\n    # Generate random weights for the two assets\n    weights = np.random.random(2)\n    weights /= np.sum(weights)  # Ensure weights sum to 1\n\n    # Calculate portfolio return and volatility (risk)\n    portfolio_return = np.dot(weights, mean_returns)\n    portfolio_volatility = np.sqrt(np.dot(weights.T, np.dot(cov_matrix, weights)))\n\n    # Store the results\n    results[0, i] = portfolio_volatility\n    results[1, i] = portfolio_return\n    results[2, i] = portfolio_return / portfolio_volatility  # Sharpe ratio\n\n# Calculate the Global Minimum Variance Portfolio (GMVP)\ninv_cov_matrix = np.linalg.inv(cov_matrix)\nones = np.ones(len(mean_returns))\nweights_gmvp = inv_cov_matrix.dot(ones) / ones.T.dot(inv_cov_matrix).dot(ones)\ngmvp_return = weights_gmvp.dot(mean_returns)\ngmvp_volatility = np.sqrt(weights_gmvp.T.dot(cov_matrix).dot(weights_gmvp))\n\n# Plot the efficient frontier\nplt.figure(figsize=(10, 6))\nplt.scatter(\n    results[0, :], results[1, :], c=results[2, :], cmap=\"Blues\", marker=\"o\", alpha=1\n)\nplt.colorbar(label=\"Sharpe Ratio\")\n\n# Plot individual assets as red dots\nplt.scatter(\n    individual_volatility[0],\n    mean_returns[0],\n    # color=\"red\",\n    marker=\"o\",\n    s=100,\n    label=\"Asset 1\",\n)\nplt.scatter(\n    individual_volatility[1],\n    mean_returns[1],\n    # color=\"blue\",\n    marker=\"o\",\n    s=100,\n    label=\"Asset 2\",\n)\n# Plot GMVP\nplt.scatter(gmvp_volatility, gmvp_return, color=\"red\", marker=\"X\", s=100, label=\"GMVP\")\n\n# Set axis limits to start from 0\nplt.xlim(0, np.max(results[0, :]) + 0.02)  # Add a small margin on the right\nplt.ylim(0, np.max(results[1, :]) + 0.02)  # Add a small margin on the top\n\n# Annotate the plot\nplt.title(\"Efficient Frontier with Two Assets\")\nplt.xlabel(\"Volatility (Risk)\")\nplt.ylabel(\"Expected Return\")\nplt.legend(loc=\"upper left\")\nplt.show()\n\n\n\n\n\n\n\n\nFigure 1: MPT and efficient frontier\n\n\n\n\n\nMinimum risk portfolio (Global Minimum Variance Portfolio, GMVP)\n\nCombination of assets that reduces the variance of portfolio returns on the lowest feasible level."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#moodys-analytics-riskfrontier-model",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#moodys-analytics-riskfrontier-model",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Moody’s Analytics RiskFrontier Model",
    "text": "Moody’s Analytics RiskFrontier Model\nMoody’s Analytics RiskFrontier model (previously Portfolio Manager model) estimates the return, risk and correlations between loans in an FI’s loan portfolio (with its own proprietary methods), which are then incorporated into the standard MPT equations to get an estimate of the risk and return of the FI’s loan portfolio.\n\nMoody’s Analytics Credit Monitor model estimates EDF (Expected Default Frequency) to examine the default risk of individual loans.\nMoody’s Analytics RiskFrontier model then uses EDF to identify the overall risk of the loan portfolio.\n\nDoes not require loan returns to be normally distributed\nApplies MPT to the loan portfolio, although many loans have non-traded aspects"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#moodys-analytics-riskfrontier-model-contd",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#moodys-analytics-riskfrontier-model-contd",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Moody’s Analytics RiskFrontier Model (cont’d)",
    "text": "Moody’s Analytics RiskFrontier Model (cont’d)\nIn Moody’s Analytics RiskFrontier model, portfolio return and risk are a function of:\n\nthe extent to which loan (exposure) values can change over a one-year horizon, and\n\nbased on EDF and the loss given default (LGD)\n\nhow these value changes move together across different loans in the loan portfolio (correlations).\n\nbased on the joint impact of close to 1,000 different systematic factors, which reflect the global economy, region, industry, and country"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#moodys-analytics-riskfrontier-model-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#moodys-analytics-riskfrontier-model-contd-1",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Moody’s Analytics RiskFrontier Model (cont’d)",
    "text": "Moody’s Analytics RiskFrontier Model (cont’d)\nRequired input variables:\n\n\n\\(R_i\\): Expected return on a loan to a borrower \\(i\\) is the loan’s all-in-drawn spread (\\(AIS\\)) minus expected loss (expected default frequency times loss given default (LGD)).1 \\[\nR_i = AIS_i - E(L_i) = AIS_i - (EDF_i\\times LGD_i)\n\\]\n\nThe Basel Committee assessed a fixed 45% LGD on secured loans if fully secured by physical, non–real estate collateral and 40% if fully secured by receivables.\n\n\n\n\n\n\\(\\sigma_i\\): Risk of a loan to borrower \\(i\\), “unexpected loss”, is the volatility of the loan’s default rate \\(\\sigma_{D_i}\\) times the amount lost given default (LGD).2 \\[\n\\sigma_i = UL_i = \\sigma_{D_i} \\times LGD_i = \\sqrt{EDF_i(1-EDF_i)} \\times LGD_i\n\\]\n\nAssume defaults are binomially distributed (default or not), the standard deviation of default rate (\\(\\sigma_{D_i}\\)) is \\(\\sqrt{EDF_i(1-EDF_i)}\\).\n\n\n\n\n\n\\(\\rho_{ij}\\): Correlation of default risks between borrowers \\(i\\) and \\(j\\) is the correlation between the systematic return components of the asset returns of \\(i\\) and \\(j\\).\n\n\nIn the textbook Saunders, Cornett, and Erhemjamts (2023), this equation has a typo: \\(E(L_i)\\) is written as \\(R(L_i)\\). Note that \\(E(\\cdot)\\) represents the “expectation” sign and \\(L_i\\) stands for loan loss.In the textbook Saunders, Cornett, and Erhemjamts (2023), this equation is entirely incorrectly written."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#moodys-analytics-riskfrontier-model-contd-2",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#moodys-analytics-riskfrontier-model-contd-2",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Moody’s Analytics RiskFrontier Model (cont’d)",
    "text": "Moody’s Analytics RiskFrontier Model (cont’d)\nTo measure the unobservable default risk correlation between any two borrowers, the Moody’s Analytics Global Correlation Model (GCORR) uses the systematic asset return components of the two borrowers and calculates a correlation that is based on a factor model rather than direct historical observations.\n\n\nFigure 2: GCorr Corporate Factor Structure\nFigure 2 provides a visual representation of the Moody’s Analytics GCorr Corporate factor structure."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#moodys-analytics-riskfrontier-model-example",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#moodys-analytics-riskfrontier-model-example",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Moody’s Analytics RiskFrontier Model (example)",
    "text": "Moody’s Analytics RiskFrontier Model (example)\nSuppose that an FI holds two loans with the following characteristics. Assume that the correlation \\(\\rho_{12}=-0.25\\), what are the return and risk of the portfolio?\n\n\n\n\n\n\n\n\n\n\n\nLoan \\(i\\)\n\\(X_i\\)\nSpread between loan rate and FI’s cost of funds\nFees\nLGD\nEDF\n\n\n\n\n1\n0.6\n5%\n2%\n25%\n3%\n\n\n2\n0.4\n4.5%\n1.5%\n20%\n2%\n\n\n\nThe return and risk on loan 1 are:\n\n\\[\n\\begin{aligned}\nR_1 &= (0.05+0.02) - (0.03\\times0.25) = 0.0625 \\\\\n\\sigma_1 &= \\sqrt{0.03\\times0.97} \\times 0.25 = 0.04265\n\\end{aligned}\n\\]\n\nThe return and risk on loan 2 are:\n\n\\[\n\\begin{aligned}\nR_2 &= (0.045+0.015) - (0.02\\times0.2) = 0.056 \\\\\n\\sigma_2 &= \\sqrt{0.02\\times0.98} \\times 0.2 = 0.028\n\\end{aligned}\n\\]\n\nThe return and risk of the portfolio are then:\n\n\\[\n\\begin{aligned}\nR_p &= 0.6\\times 0.0625 + 0.4\\times 0.056 = 0.0599 \\text{ or } 5.99\\%  \\\\\n\\sigma_p^2 &= (0.6)^2(0.04265)^2 + (0.4)^2(0.028)^2 + 2(0.6)(0.4)(-0.25)(0.04265)(0.028) = 0.0006369 \\\\\n\\sigma_p &= \\sqrt{0.0006369} = 0.0252 = 2.52\\%\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#partial-application-of-portfolio-theory",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#partial-application-of-portfolio-theory",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Partial application of portfolio theory",
    "text": "Partial application of portfolio theory\n\nLoan volume-based models\nLoan loss ratio-based models"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#partial-application-of-portfolio-theory-loan-volume-based-models",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#partial-application-of-portfolio-theory-loan-volume-based-models",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Partial application of portfolio theory: Loan volume-based models",
    "text": "Partial application of portfolio theory: Loan volume-based models\nDirect application of MPT is often difficult for FIs lacking information on market prices because many of the loans are not always able to be bought and sold in established markets.\nData can be gathered from:\n\nReports to the central bank\nData on shared national credit\nCommercial databases\n\nData provides market benchmarks against which FIs can compare their loan portfolios.\n\n\n\nTable 3: Allocation of the Loan Portfolio to Different Sectors (in percentages)\n\n\n\n\n\n\n(1) National\n(2) Bank A\n(3) Bank B\n\n\n\n\nReal estate\n45%\n65%\n10%\n\n\nC&I\n30\n20\n25\n\n\nIndividual\n15\n10\n55\n\n\nOthers\n10\n5\n10\n\n\nTotal\n100\n100\n100"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#partial-application-of-portfolio-theory-loan-volume-based-models-contd",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#partial-application-of-portfolio-theory-loan-volume-based-models-contd",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Partial application of portfolio theory: Loan volume-based models (cont’d)",
    "text": "Partial application of portfolio theory: Loan volume-based models (cont’d)\n\nDeviations from the market portfolio benchmark indicate the relative degree of loan concentration.\nRelative measure of loan allocation deviation:\n\n\\[\n\\sigma_j = \\sqrt{\\frac{\\sum_{i=1}^N (X_{ij}-X{i})^2}{N}}\n\\]\nwhere\n\n\\(\\sigma_j\\) is the standard deviation of bank \\(j\\)’s asset allocation proportions from the national benchmark\n\\(X_i\\) is the national asset allocations\n\\(X_{ij}\\) is the asset allocation proportions of the \\(j\\)th bank\n\\(N\\) is the number of observations or loan categories"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#partial-application-of-portfolio-theory-loan-volume-based-models-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#partial-application-of-portfolio-theory-loan-volume-based-models-contd-1",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Partial application of portfolio theory: Loan volume-based models (cont’d)",
    "text": "Partial application of portfolio theory: Loan volume-based models (cont’d)\nRefer to Table 3. We get the deviation of Bank A’s loan portfolio allocation as follows:\n\\[\n\\begin{aligned}\n(X_{1A}-X_1)^2 &= (0.65-0.45)^2 = 0.04 \\\\\n(X_{2A}-X_2)^2 &= (0.20-0.30)^2 = 0.01 \\\\\n(X_{3A}-X_3)^2 &= (0.10-0.15)^2 = 0.0025 \\\\\n(X_{4A}-X_4)^2 &= (0.05-0.10)^2 = 0.0025\n\\end{aligned}\n\\] and therefore \\[\n\\sigma_A = \\sqrt{\\frac{0.04+0.01+0.0025+0.0025}{4}} = 11.73\\%\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#partial-application-of-portfolio-theory-loan-loss-ratio-based-models",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#partial-application-of-portfolio-theory-loan-loss-ratio-based-models",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Partial application of portfolio theory: Loan loss ratio-based models",
    "text": "Partial application of portfolio theory: Loan loss ratio-based models\nEstimates systematic loan loss risk of a particular sector or industry to the loan loss risk of an FI’s total loan portfolio\nUse of time-series regression of quarterly losses:\n\\[\n\\frac{\\text{Sectoral losses in the } i\\text{th sector}}{\\text{Loans to the } i\\text{th sector}} = \\alpha + \\beta \\frac{\\text{Total loan losses}}{\\text{Total loans}}\n\\]\nwhere\n\n\\(\\alpha\\) measures the loan loss rate for a sector that has no sensitivity to losses on the aggregate loan portfolio\n\\(\\beta\\) measures the systematic loss sensitivity of the \\(i\\)th sector loans to total loan losses\n\nThe implication of this model is that sectors with lower \\(\\beta\\)s could have higher concentration limits than high \\(\\beta\\) sectors—since low \\(\\beta\\) loan sector risks (loan losses) are less systematic (that is, are more diversifiable in a portfolio sense)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#regulatory-models",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#regulatory-models",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Regulatory models",
    "text": "Regulatory models\n\nFederal Reserve’s 1994 Ruling on Credit Concentration Risk:\n\nAdopted a subjective approach based on examiner discretion.\nRejected technical models due to insufficient data and undeveloped methods at the time.\n\n2006 Regulatory Changes:\n\nBank for International Settlements (BIS): Released guidance on credit risk assessment and valuation for loans, structured around 10 principles on risk assessment and supervisory evaluation.\nOffice of the Comptroller of the Currency (OCC): Released guidance on sound risk management practices for commercial real estate lending.\n\nOCC/Fed Joint Study on 2006 CRE Concentration Guidance (April 2013):\n\n13% of banks with construction loans exceeding 100% of capital failed.\n23% of banks exceeding both construction and total CRE lending criteria failed, compared to only 0.5% of banks that did not exceed either criterion.\nRegulators encouraged financial institutions to review their policies and practices related to CRE lending."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#credit-derivatives",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#credit-derivatives",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit derivatives",
    "text": "Credit derivatives\n\nDiversification of loan portfolio helps FIs to manage their credit risk exposure.\nNew types of derivative instruments are now available to better allow FIs to hedge their credit risk both on individual loans or on loan portfolios.\n\nCredit forwards, options, and swaps.\n\nThese credit derivatives allow FIs to separate the credit risk exposure from the lending process itself."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#credit-forward-contracts-and-credit-risk-hedging",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#credit-forward-contracts-and-credit-risk-hedging",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit forward contracts and credit risk hedging",
    "text": "Credit forward contracts and credit risk hedging\nA credit forward is a forward agreement that hedges against an increase in default risk on a loan (a decline in credit quality of borrower) after the loan rate is determined and the loan is issued.\n\nCommon buyers are insurance companies who bears the risk of an increase in default risk on the benchmark bond of the borrower\nCommon sellers are banks\nSpecifies a credit spread on a benchmark bond issued by a borrower\nExample: BBB bond at time of origination may have 2 per cent spread over US Treasury of same maturity"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#credit-forward-contracts-and-credit-risk-hedging-contd",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#credit-forward-contracts-and-credit-risk-hedging-contd",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit forward contracts and credit risk hedging (cont’d)",
    "text": "Credit forward contracts and credit risk hedging (cont’d)\n\n\n\nTable 4: Payment pattern on a credit forward contract\n\n\n\n\n\n\n\n\n\n\nCredit Spread at End of Forward Agreement\nCredit Spread Seller (bank)\nCredit Spread Buyer (counterparty)\n\n\n\n\n\\(\\phi_T&gt;\\phi_F\\)\nReceives \\((\\phi_T - \\phi_F) \\times MD \\times A\\)\nPays \\((\\phi_T - \\phi_F) \\times MD \\times A\\)\n\n\n\\(\\phi_T&lt;\\phi_F\\)\nPays \\((\\phi_F - \\phi_T) \\times MD \\times A\\)\nReceives \\((\\phi_F - \\phi_T) \\times MD \\times A\\)\n\n\n\n\n\n\nwhere\n\n\\(\\phi_F\\) is the credit spread on which the credit forward contract is written\n\\(\\phi_T\\) is the actual credit spread on the bond when the credit forward matures\n\\(MD\\) is the modified duration on the benchmark bond\n\\(A\\) is the principal amount of the forward agreement\n\nPayout by the bank is capped since \\(\\phi_T\\geq 0\\) (credit spread is non-negative).\n\nWhen a bank gives a loan, it is similar to writing a put option\nWhen a bank sells a credit forward, the payoff is similar to buying a put option"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#credit-options",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#credit-options",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit options",
    "text": "Credit options\nUse of options to hedge credit risk is a relatively new phenomenon. In September 2021, commercial bank holdings of credit options totaled $233 billion, which represented 6.05% of all credit derivatives outstanding.\n\nA credit spread call option is a call option whose payoff increases as the (default) risk premium or yield spread on a specified benchmark bond of the borrower increases above some exercise spread.\nA digital default option is an option that pays a stated amount in the event of a loan default (the extreme case of increased credit risk)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#credit-default-swaps-cds",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#credit-default-swaps-cds",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit (default) swaps (CDS)",
    "text": "Credit (default) swaps (CDS)\n\nFastest-growing types of swaps. Most important type of credit derivatives.\nIn 2000, commercial banks’ total notional principal for outstanding credit derivatives was $426 billion.\nBy March 2008, this amount had risen to $16.44 trillion, before falling to $13.44 trillion in 2009.\nBy September 2011, the amount increased to $15.66 trillion, of which $15.31 trillion was CDSs.\nDue to post-GFC regulations, the notional value of credit derivatives held by banks dropped to $3.9 trillion in September 2021, with $3.4 trillion of this amount being CDS contracts.\n\nWhy CDS?\n\nCredit risk is still more likely to cause an FI to fail than is either interest rate risk or FX risk.\nCDSs allow FIs to maintain long-term customer lending relationships without bearing the full credit risk exposure from those relationships."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#basics-of-cds",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#basics-of-cds",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Basics of CDS",
    "text": "Basics of CDS\n\nCDS Payments: The buyer makes periodic payments to the seller (quarterly, semi-annually, or annually) until the end of the swap or a credit event (e.g., default) occurs.\nSettlement: Upon default, settlement involves either physical delivery of bonds (loans) or a cash payment.\n\nThe protection buyer receives a payment upon the occurrence of a credit event trigger, but the swap “expires worthless” if no trigger occurs.\n\nCheapest-to-Deliver Option: The CDS buyer has the option to deliver the cheapest qualifying bond or loan when a default happens.\nNo requirement that the CDS buyer actually owns the underlying reference securities.\nThe CDS buyer hedges its exposure to default risk, but there is still counterparty credit risk in the event that the seller fails to perform their obligations under the terms of the contract.1\n\nWe examine two types of credit swaps:\n\ntotal return swap\npure credit swap\n\nSearch and read about the concern in September 2008 with regard to AIG, an active CDS seller."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#credit-swaps-total-return-swaps",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#credit-swaps-total-return-swaps",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit swaps: total return swaps",
    "text": "Credit swaps: total return swaps\nA total return swap involves swapping an obligation to pay interest at a specified fixed or floating rate for payments representing the total return on a loan or a bond (interest and principal value changes) of a specified amount.\nThe figure below illustrates a total return swap.1\n\n\n\n\n\nThe FI lender pays a fixed annual rate \\(f\\) plus changes in the market value of the loan and receives a variable rate payment (e.g., 1-year LIBOR).\n\nInterest rate risk remains\n\nIn the textbook Saunders, Cornett, and Erhemjamts (2023), Figure 25-4 incorrectly has \\(f-\\frac{P_t-P_0}{P_0}\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#credit-swaps-total-return-swaps-contd",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#credit-swaps-total-return-swaps-contd",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit swaps: total return swaps (cont’d)",
    "text": "Credit swaps: total return swaps (cont’d)\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nnp.random.seed(8003)\n# Parameters for the TRS\nnotional = 1_000_000  # Notional amount (1 million)\nfixed_rate = 0.03  # Fixed annual rate paid by the TRS receiver (3%)\nasset_volatility = 0.1  # Volatility of the asset's return (10%)\nyears = 5  # Time period of the TRS (5 years)\nperiods_per_year = 4  # Payments per year (quarterly)\n\n\n# Generate the timeline for TRS payments\ndef generate_trs_timeline(\n    notional, fixed_rate, asset_volatility, years, periods_per_year=4\n):\n    # Set up the timeline with quarterly periods\n    total_periods = periods_per_year * years\n    time_points = np.arange(1, total_periods + 1) / periods_per_year\n\n    # Calculate the periodic fixed payment amount (quarterly)\n    periodic_fixed_payment = (\n        -notional * fixed_rate / periods_per_year\n    )  # Fixed payment made by TRS receiver\n\n    # Simulate random returns on the asset\n    asset_returns = np.random.normal(loc=0, scale=asset_volatility, size=total_periods)\n\n    # Initialize lists to store the results\n    total_returns = np.zeros(total_periods)\n    payments = np.zeros(total_periods)\n\n    for period in range(total_periods):\n        # Total return on the asset (positive or negative)\n        total_return = notional * asset_returns[period]\n        total_returns[period] = total_return\n\n        # Net payment for the TRS receiver (positive if receiving total return, minus fixed payment)\n        payments[period] = total_return + periodic_fixed_payment\n\n    return time_points, payments, total_returns\n\n\n# Simulate TRS payments with different asset volatilities\nvolatilities = [0.05]  # Different volatilities to simulate\nsimulations = {}\n\nfor vol in volatilities:\n    timeline, payments, total_returns = generate_trs_timeline(\n        notional, fixed_rate, vol, years, periods_per_year\n    )\n    simulations[vol] = payments\n\n# Plot the timelines as bar charts\nplt.figure(figsize=(12, 8))\nbar_width = 0.2  # Width of each bar\n\n# Generate bar charts for each volatility\nfor idx, (vol, payments) in enumerate(simulations.items()):\n    plt.bar(\n        timeline + idx * bar_width * 0.1,\n        payments,\n        width=bar_width,\n        color=\"#A6192E\",\n        label=f\"Volatility: {vol*100:.0f}%\",\n    )\n\n# Customize the plot\nplt.title(f\"{years}-Year Total Return Swap Payments Example\")\nplt.xlabel(\"Time (Years)\")\nplt.ylabel(\"Net Payment Amount ($)\")\nplt.axhline(0, color=\"black\", linewidth=1)\nplt.grid(True)\nplt.legend()\n\n# Show the plot\nplt.show()\n\n\n\n\n\n\n\n\nFigure 3: Total Return Swap Payments Example"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#credit-swaps-pure-credit-swaps",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#credit-swaps-pure-credit-swaps",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit swaps: pure credit swaps",
    "text": "Credit swaps: pure credit swaps\nInterest-rate sensitive element stripped out leaving only the credit risk.\nSimilar to buying an insurance:\n\nIf default, the counterparty makes the default payment\nIf not default, the FI receives nothing from the counterparty."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#credit-swaps-pure-credit-swaps-contd",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#credit-swaps-pure-credit-swaps-contd",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit swaps: pure credit swaps (cont’d)",
    "text": "Credit swaps: pure credit swaps (cont’d)\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nnp.random.seed(8003)\n# Parameters for the CDS\nnotional = 1_000_000  # Notional amount (1 million)\ncds_spread = 0.02  # Annual CDS spread (2%)\nrecovery_rate = 0.9  # Recovery rate in case of default (10%)\nyears = 5  # Time period of the CDS (5 years)\nperiods_per_year = 4  # Payments per year (quarterly)\n\n\n# Generate the timeline for CDS payments\ndef generate_cds_timeline(\n    notional, cds_spread, default_probability, recovery_rate, years, periods_per_year=4\n):\n    # Set up the timeline with quarterly periods\n    total_periods = periods_per_year * years\n    time_points = np.arange(1, total_periods + 1) / periods_per_year\n\n    # Calculate the periodic payment amount (quarterly)\n    periodic_payment = (\n        -notional * cds_spread / periods_per_year\n    )  # Negative for payments\n\n    # Initialize lists to store the results\n    payments = np.zeros(total_periods)\n\n    # Simulate payments and default events\n    for period in range(total_periods):\n        if np.random.rand() &lt; default_probability / periods_per_year:\n            # Default occurs at this period\n            default_loss = notional * (\n                1 - recovery_rate\n            )  # Positive for the payment received on default\n            payments[period] = default_loss\n            payments[period + 1 :] = 0  # No more payments after default\n            break\n        else:\n            # Regular payment\n            payments[period] = periodic_payment\n\n    return time_points, payments\n\n\n# Simulate multiple series with different default probabilities\ndefault_probabilities = [0.02, 0.1]  # Different default probabilities\ncolors = [\"#D6D2C4\", \"#A6192E\"]\n\nsimulations = {}\n\n# Generate timelines for each default probability\nfor prob in default_probabilities:\n    timeline, payments = generate_cds_timeline(\n        notional, cds_spread, prob, recovery_rate, years, periods_per_year\n    )\n    simulations[prob] = payments\n\n# Plot the timelines as bar charts\nplt.figure(figsize=(12, 8))\nbar_width = 0.2  # Width of each bar\n\n# Generate bar charts for each probability\nfor idx, (prob, payments) in enumerate(simulations.items()):\n    plt.bar(\n        timeline + idx * bar_width * 0.1,\n        payments,\n        width=bar_width,\n        color=colors[idx],\n        label=f\"Default Probability: {prob*100:.0f}%\",\n    )\n\nplt.title(f\"{years}-Year Pure CDS Payments Example\")\nplt.xlabel(\"Time (Years)\")\nplt.ylabel(\"Payment Amount ($)\")\nplt.axhline(0, color=\"black\", linewidth=1)\nplt.grid(True)\nplt.legend()\nplt.show()\n\n\n\n\n\n\n\n\nFigure 4: Pure CDS Payments Example"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#suggested-readings",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nMoody’s Analytics An Overview of Modelling Credit Portfolios"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week8/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week8/index.html#references",
    "title": "AFIN8003 Week 8 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nSaunders, Anthony, Marcia Millon Cornett, and Otgo Erhemjamts. 2023. Financial Institutions Management ISE. 11th ed. McGraw Hill."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#introduction",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#introduction",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Introduction",
    "text": "Introduction\nLiquidity risk is a normal aspect of everyday management of a financial institution (FI).\n\nDepository institutions (DIs) are more exposed to liquidity risk than others\nIn extreme cases liquidity risk can threaten the solvency of an FI\nThe Global Financial Crisis commencing in 2008 was, in part, due to liquidity risk\nLiquidity risk may result from asset side or liability side\n\nWe focus on the risk exposure of DIs."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#causes-of-liquidity-risk",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#causes-of-liquidity-risk",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Causes of liquidity risk",
    "text": "Causes of liquidity risk\nLiquidity risk can arise on both sides of the balance sheet: the asset side as well as the liability side\n\n\n\nLiability side\n\nDepositors and other claim holders decide to cash in their financial claims immediately\n\nThe DI has to borrow additional funds or sell assets\n\nDI need to be able to predict the distribution of net deposit drains\n\nThe difference between deposit withdrawals and deposit additions on any specific normal banking day\n\n\n\n\n\nAsset side\n\nRisk from OBS loan commitments and other credit lines\nChange of the value of investment securities portfolios due to unexpected changes of interest rates\nProblems associated with ‘quick’ asset sales/fire-sales\n\nHigh costs for turning illiquid assets into cash\nLow sales price; in worst case, fire-sale price"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liability-side-liquidity-risk",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liability-side-liquidity-risk",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liability-side liquidity risk",
    "text": "Liability-side liquidity risk\n\nA DI’s balance sheet typically features a large amount of short-term liabilities funding relatively long-term assets.\n\nShort-term liabilities: demand deposits, other transaction accounts, etc.\nLong-term assets: mortgages, C&I loans, etc.\n\nDemand deposit accounts, money market deposit accounts (MMDAs), and other transaction accounts allow holders to demand immediate repayment of the face value in cash.\n\nFor example, a DI with 20% of its liabilities in demand deposits, MMDAs, and other transaction accounts must be ready to liquidate assets to cover that amount on any banking day.\n\n\n\n\n\n\n\n\nNote\n\n\nAs of June 2021, U.S. commercial banks had total deposits representing 82.19% of total liabilities and capital.\n\nCash assets accounted for only 15.45% of total assets."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liability-side-liquidity-risk-contd",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liability-side-liquidity-risk-contd",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liability-side liquidity risk (cont’d)",
    "text": "Liability-side liquidity risk (cont’d)\nFor CBA, cash and liquid assets account for 9.3% of total assets.\n\n\nFigure 1: Excerpt of CBA’s 2023 balance sheet - assets"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liability-side-liquidity-risk-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liability-side-liquidity-risk-contd-1",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liability-side liquidity risk (cont’d)",
    "text": "Liability-side liquidity risk (cont’d)\nFor CBA, deposits and other public borrowings account for 73.25% of total liabilities.\n\n\nFigure 2: Excerpt of CBA’s 2023 balance sheet - liabilities"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liability-side-liquidity-risk-contd-2",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liability-side-liquidity-risk-contd-2",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liability-side liquidity risk (cont’d)",
    "text": "Liability-side liquidity risk (cont’d)\n\n\n\n\n\n\n\nIt’s not that bad.\n\n\n\nNormally, only a small proportion of its deposits will be withdrawn on any given day.\nFurther, deposit withdrawals may in part be offset by the inflow of new deposits1 (and the DI’s income).\n\n\n\n\n\nMost demand deposits are relatively “stable”, acting as consumer core deposits on a daily basis.\n\nCore deposits are those deposits that provide a DI with a long-term funding source.\n\nThe DI manager must monitor and predict the net deposit drains on any given normal banking day.\n\nBeyond predictable daily seasonality in deposit flows, other seasonal variations exist.\nMany of these seasonal variations are somewhat predictable.\nRetail DIs often experience above-average deposit outflows around the end of the year and in the summer (due to Christmas and the vacation season).\nRural DIs may experience a deposit inflow–outflow cycle aligned with the local agricultural cycle.\n\nDuring the planting and growing season, deposits tend to fall.\nDuring the harvest season, deposits tend to rise as crops are sold.\n\n\nLarge inflow of deposits may also cause issues if the DI cannot find sufficiently attractive investments."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#net-deposit-drains",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#net-deposit-drains",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Net deposit drains",
    "text": "Net deposit drains\n\n\n\n\nCode\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Data for the plot\nx = np.linspace(-10, 15, 1000)\ny = np.exp(-0.5 * ((x - 5) / 4)**2) / (4 * np.sqrt(2 * np.pi))\n\n# Plotting\nplt.figure(figsize=(10, 6))\nplt.plot(x, y, color='gray')\n\n# Adding vertical lines for 0 and 5%\nplt.axvline(x=0, color='black', linestyle='-', label='0')\nplt.axvline(x=5, color='gray', linestyle='--', label='5%')\n\n# Show x-axis\nplt.xlabel(\"% Net deposit drain (cash outflow)\")\n\n# Show the plot\nplt.show()\n\n\n\n\n\n\n\n\nFigure 3: A hypothetical distribution of net deposit drains\n\n\n\n\n\n\nConsider a probability distribution of net deposit drains that is assumed to be strongly peaked at the 5 percent net deposit withdrawal level, as shown in Figure 3.\n\nThis DI expects approximately 5 percent of its net deposit funds to be withdrawn on any given day with the highest probability.\nA positive net drain on deposits, so its new deposit funds and other cash flows are expected to be insufficient to offset deposit withdrawals.\n\nAs a result, the liability side of the DI’s balance sheet is contracting."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#net-deposit-drains-contd",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#net-deposit-drains-contd",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Net deposit drains (cont’d)",
    "text": "Net deposit drains (cont’d)\n\n\n\n\nCode\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Data for the plot\nx = np.linspace(-10, 15, 1000)\ny = np.exp(-0.5 * ((x + 2) / 2 )**2) / (4 * np.sqrt(2 * 0.1 * np.pi))\n\n# Plotting\nplt.figure(figsize=(10, 6))\nplt.plot(x, y, color='gray')\n\n# Adding vertical lines for 0 and 5%\nplt.axvline(x=0, color='black', linestyle='-', label='0')\nplt.axvline(x=-2, color='gray', linestyle='--', label='-2%')\n\n# Show x-axis\nplt.xlabel(\"% Net deposit drain (cash outflow)\")\n\n# Show the plot\nplt.show()\n\n\n\n\n\n\n\n\nFigure 4: Another hypothetical distribution of net deposit drains\n\n\n\n\n\n\nConsider another probability distribution of net deposit drains that is assumed to be strongly peaked at the -2 percent net deposit withdrawal level, as shown in Figure 4.\n\nA negative net drain on deposits, so its new deposit funds and other cash flows are expected to be larger than deposit withdrawals.\n\nAs a result, this DI is expected to grow with an expanding balance sheet."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#managing-net-deposit-drains",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#managing-net-deposit-drains",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Managing net deposit drains",
    "text": "Managing net deposit drains\nGenerally a drain on deposits at DIs can be managed by\n\npurchased liquidity management\nstored liquidity management\n\nTraditionally, DIs have relied on stored liquidity management. Today, most DIs rely on purchased liquidity management.\n\n\n\n\n\n\nNote\n\n\nWe will discuss in greater detail liquidity management in next week."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#purchased-liquidity-management",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#purchased-liquidity-management",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Purchased liquidity management",
    "text": "Purchased liquidity management\n\nA DI manager seeking to purchase liquidity turns to markets for purchased funds.\nOptions include the cash market and the repurchase agreement markets, which are interbank markets for short-term loans.\nAlternatively, the DI manager could:\n\nIssue additional wholesale certificates of deposit.\nSell notes and bonds.\n\nBorrowed funds (at market rates) are likely to be at higher rates than interest paid on deposits."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#purchased-liquidity-management-contd",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#purchased-liquidity-management-contd",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Purchased liquidity management (cont’d)",
    "text": "Purchased liquidity management (cont’d)\n\n\nPanel A: Balance sheet immediately before and after deposit drain\n\n\n\n\n\n\n\n\n\n\n\n\nAssets\nDeposits\nBorrowed funds\nOther liabilities\nTotal Liabilities\n\n\n\n\nBefore the drain\n100\n70\n10\n20\n100\n\n\nAfter the drain\n100\n65\n10\n20\n95\n\n\n\nPanel B: Adjusting to a deposit drain through purchased liquidity management\n\n\n\n\n\n\n\n\n\n\n\n\nAssets\nDeposits\nBorrowed funds\nOther liabilities\nTotal Liabilities\n\n\n\n\nAfter liquidity management\n100\n65\n15\n20\n100\n\n\n\n\n\nPurchased liquidity management allows DIs to maintain their overall balance sheet size\nA liability-side adjustment to the balance sheet to cover a deposit drain"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#stored-liquidity-management",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#stored-liquidity-management",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Stored liquidity management",
    "text": "Stored liquidity management\n\nA DI manager could also liquidate some of its assets, utilizing its stored liquidity.\nTraditionally, U.S. DIs hold cash reserves at the Federal Reserve and in their vaults to meet liquidity needs.\nThe Federal Reserve sets minimum reserve requirements for banks’ cash reserves.\nDespite these requirements, DIs often hold cash reserves above the minimum to manage liquidity drains.\n\n\n\n\n\n\n\nNote\n\n\n\nIn U.S., the Fed reduced the reserve requirement to 0, effective March 26, 2020.\nIn Australia, the RBA does not impose formal reserve requirements."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#stored-liquidity-management-contd",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#stored-liquidity-management-contd",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Stored liquidity management (cont’d)",
    "text": "Stored liquidity management (cont’d)\n\n\nPanel A: Balance sheet immediately before deposit drain\n\n\n\n\nAssets\n\nLiabilities\n\n\n\n\n\nCash\n9\n\nDeposits\n70\n\n\n\n\n\nBorrowed funds\n10\n\n\nOther asset\n91\n\nOther liabilities\n20\n\n\nTotal\n100\n\nTotal\n100\n\n\n\nPanel B: Adjusting to a deposit drain through stored liquidity management\n\n\n\n\nAssets\n\nLiabilities\n\n\n\n\n\nCash\n4\n\nDeposits\n65\n\n\n\n\n\nBorrowed funds\n10\n\n\nOther assets\n91\n\nOther liabilities\n20\n\n\nTotal\n95\n\nTotal\n95\n\n\n\n\n\nSize of balance sheet decreases\nDIs tend to prudently hold low-rate excess reserve assets to meet liquidity drains"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#asset-side-liquidity-risk",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#asset-side-liquidity-risk",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Asset-side liquidity risk",
    "text": "Asset-side liquidity risk\nThis far we have discussed the liability-side liquidity risk due to net deposit drains.\nOn the asset side, liquidity problems can arise due to\n\nloan requests\nthe exercise by borrowers of their loan commitments and other credit lines! (e.g., at the onset of COVID-19)\n\nSee for example Acharya et al. (2024)."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#asset-side-liquidity-risk-contd",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#asset-side-liquidity-risk-contd",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Asset-side liquidity risk (cont’d)",
    "text": "Asset-side liquidity risk (cont’d)\n\n\nBalance Sheet Immediately Before and After Exercise\n\nBefore Exercise\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n100\n\n\nOther assets\n138\nBorrowed funds\n20\n\n\n\n\nOther liabilities\n5\n\n\n\n\nEquity\n25\n\n\nTotal\n150\nTotal\n150\n\n\n\n\nAfter Exercise\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n100\n\n\nOther assets\n143\nBorrowed funds\n20\n\n\n\n\nOther liabilities\n5\n\n\n\n\nEquity\n25\n\n\nTotal\n155\nTotal\n150\n\n\n\n\nAdjusting the Balance Sheet to a Loan Commitment Exercise\n\nPurchased Liquidity Management\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n100\n\n\nOther assets\n143\nBorrowed funds\n25\n\n\nOther liabilities\n5\nOther liabilities\n5\n\n\n\n\nEquity\n25\n\n\nTotal\n155\nTotal\n155\n\n\n\n\nStored Liquidity Management\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n7\nDeposits\n100\n\n\nOther assets\n143\nBorrowed funds\n20\n\n\n\n\nOther liabilities\n5\n\n\n\n\nEquity\n25\n\n\nTotal\n150\nTotal\n150"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#asset-side-liquidity-risk-investment-portfolio",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#asset-side-liquidity-risk-investment-portfolio",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Asset-side liquidity risk (investment portfolio)",
    "text": "Asset-side liquidity risk (investment portfolio)\nAnother type of asset-side liquidity risk arises from the investment portfolio.\n\nRising interest rates reduce the value of investment portfolios.\nLiquidity in a particular market could deteriorate because no one wants to buy.\n\nTechnological development is claimed to have improved the liquidity of financial markets. But given the herding hebaviour in the market, liquidity could still dry up and investment securities only sold at fire-sale prices.\n\nThe FI must fund the loss in value on the balance sheet such that loan requests and deposit withdrawals can be met.\nThe result is increased liquidity risk for the FI."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#asset-side-liquidity-risk-investment-portfolio-contd",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#asset-side-liquidity-risk-investment-portfolio-contd",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Asset-side liquidity risk (investment portfolio) (cont’d)",
    "text": "Asset-side liquidity risk (investment portfolio) (cont’d)\n\n\nBalance Sheet Immediately Before and After Drop in Investment Portfolio Value\n\nBefore Drop in Value\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n100\n\n\nInvestment portfolio\n50\nBorrowed funds\n20\n\n\nOther assets\n88\nOther liabilities\n5\n\n\n\n\nEquity\n25\n\n\nTotal\n150\nTotal\n150\n\n\n\n\nAfter Drop in Value\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n100\n\n\nInvestment portfolio\n45\nBorrowed funds\n20\n\n\nOther assets\n88\nOther liabilities\n5\n\n\n\n\nEquity\n20\n\n\nTotal\n145\nTotal\n145\n\n\n\n\nAdjusting the Balance Sheet for a Drop in Investment Portfolio Value\n\nPurchased Liquidity Management\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n105\n\n\nInvestment portfolio\n50\nBorrowed funds\n20\n\n\nOther assets\n88\nOther liabilities\n5\n\n\n\n\nEquity\n20\n\n\nTotal\n150\nTotal\n150\n\n\n\n\nStored Liquidity Management\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n7\nDeposits\n100\n\n\nInvestment portfolio\n50\nBorrowed funds\n20\n\n\nOther assets\n88\nOther liabilities\n5\n\n\n\n\nEquity\n20\n\n\nTotal\n145\nTotal\n145"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#measuring-a-dis-liquidity-risk-exposure",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#measuring-a-dis-liquidity-risk-exposure",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Measuring a DI’s liquidity risk exposure",
    "text": "Measuring a DI’s liquidity risk exposure\n\nFinancing gap and the financing requirement.\n\n\nFinancing gap is the difference between a DI’s average loans and average (core) deposits:\n\n\\[\n\\text{Financing gap} = \\text{Average loans} - \\text{Average deposits}\n\\]\nA positive financing gap implies that the DI must fund it using its cash and liquid assets and/or borrowing funds in the money market. Therefore,\n\\[\n\\text{Financing gap} = -\\text{Liquid assets} + \\text{Borrowerd funds}\n\\]\nWe thus have the following relationship:\n\\[\n\\text{Financing gap} + \\text{Liquid assets} = \\text{Financing requirement (borrowed funds)}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#measuring-a-dis-liquidity-risk-exposure-contd",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#measuring-a-dis-liquidity-risk-exposure-contd",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Measuring a DI’s liquidity risk exposure (cont’d)",
    "text": "Measuring a DI’s liquidity risk exposure (cont’d)\n\nPeer group ratio comparison\n\nComparison of certain key ratios and balance sheet features of the DI with similar DIs, for example,\n\nLoans to deposits\nLoans to assets\nCore deposits to total assets\n(Unused) loan commitments to assets"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#measuring-a-dis-liquidity-risk-exposure-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#measuring-a-dis-liquidity-risk-exposure-contd-1",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Measuring a DI’s liquidity risk exposure (cont’d)",
    "text": "Measuring a DI’s liquidity risk exposure (cont’d)\n\nLiquidity index\n\nDeveloped by Jim Pierce at the Federal Reserve, liquidity index measures the potential losses an FI could suffer from a sudden or fire-sale disposal of assets compared with the amount it would receive at a fair market value established under normal market (sale) conditions.\n\\[\nI = \\sum_{i=1}^N \\left(W_i \\times \\frac{P_i}{P^*_i}\\right)\n\\]\nwhere\n\n\\(W_i\\) is the percentage of each asset in the FI’s portfolio\n\\(P_i\\) is the immediate sale price\n\\(P^*_i\\) is the fair market price\n\nThe liquidity index should lie between 0 and 1."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-risk-measures",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-risk-measures",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity risk measures",
    "text": "Liquidity risk measures\n\nDuring the financial crisis, many DIs struggled to maintain adequate liquidity.\nCentral banks had to provide extraordinary levels of liquidity assistance to sustain the financial system.\nDespite this support, some DIs failed or were forced into mergers.\nIn response, the BIS’s Basel Committee on Banking Supervision introduced two new regulatory standards for liquidity risk supervision:\n\nLiquidity Coverage Ratio (LCR):\n\nCame into effect on January 1, 2015.\nGradually implemented, reaching full compliance on January 1, 2019.\n\nNet Stable Funding Ratio (NSFR):\n\nBecame a minimum standard on January 1, 2018.\n\n\nThese rules apply to:\n\nLarge, internationally active banking organizations with $250 billion or more in total consolidated assets.\nOrganizations with $10 billion or more in total on-balance-sheet foreign exposure.\nConsolidated subsidiary depository institutions with $10 billion or more in total assets."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR)",
    "text": "Liquidity Coverage Ratio (LCR)\n\nThe Liquidity Coverage Ratio (LCR) is designed to ensure that a DI maintains sufficient high-quality liquid assets (HQLA).\nThese HQLA must be easily convertible to cash to meet liquidity needs over a 30-day period.\nThe LCR is based on an “acute liquidity stress scenario” defined by supervisors.\n\nThe scenario includes both institution-specific and systemic shocks.\nIt reflects actual conditions experienced during the global financial crisis.\n\nThe purpose of maintaining the LCR is to ensure that DIs can survive severe liquidity stress for at least 30 days.\nThe LCR is reported to DI supervisors on a monthly basis.\n\n\\[\n\\text{Minimum LCR} = \\frac{\\text{Stock of HQLAs}}{\\text{Total net cash outflows over next 30 calendar days}} \\ge 100\\%\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr-contd",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr-contd",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR) (cont’d)",
    "text": "Liquidity Coverage Ratio (LCR) (cont’d)\nThe stock of HQLAs is defined as follows:\n\nLiquid assets in the stock must remain liquid in times of stress (i.e., convertible into cash at little loss of value and can be used at the central bank discount window as collateral).\nLiquid assets in the stock must be “unencumbered”, i.e., free of legal, regulatory, contractual, or other restrictions on the ability of the bank to liquidate, sell, transfer, or assign the asset.\nLiquid assets in the stock are divided into level 1 and level 2. Level 1 amount has no cap, and level 2 amount is capped at 40 percent of the stock.\n\nLevel 1 assets are limited to:\n\nCash, central bank reserves, marketable securities representing claims on or guaranteed by sovereigns, central banks, public sector entities (PSE), and some supranational institutions (e.g., BIS, IMF, ECB, multilateral development banks).1\n\nLevel 2A assets (15% haircut):\n\nEligible marketable securities representing claims on or guaranteed by sovereigns, central banks, PSEs, or multilateral development banks.\nEligible corporate debt securities and covered bonds.\n\nLevel 2B assets:\n\nEligible residential mortgage backed securities (25% haircut).\nEligible corporate debt securities and equities (50% haircut).\n\n\n\nThere’re more restrictions."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr-contd-1",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR) (cont’d)",
    "text": "Liquidity Coverage Ratio (LCR) (cont’d)\nThe total net cash outflows is defined as:\n\n\\[\n\\text{Total net cash outflows over next 30 calendar days} = Out - \\min(In, 75\\% \\times Out)\n\\]\nwhere\n\n\\(Out\\) is total expected cash outflows\n\\(In\\) is total expected cash inflows\n\nCash inflows and outflows are computed based on the type of assets/liabilities and associated draw-down factors.\n\n\n\n\n\n\nNote\n\n\nFor a detailed calculation of cash outflows and inflows, refer to textbook Saunders, Cornett, and Erhemjamts (2023) or to the suggested readings."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr-example",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr-example",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR): example",
    "text": "Liquidity Coverage Ratio (LCR): example\nConsider the following balance sheet (in million of dollars) of a bank. Calculate the bank’s LCR.\n\nAssume that the cash inflows over the next 30 days from the bank’s assets are $5 million.\n\n\n\n\n\n\n\n\n\n\n\n\nAssets\n$\nLiquidity Level\nLiabilities and Equity\n$\nRun-Off Factor\n\n\n\n\nCash\n5\nLevel 1\nStable retail deposits\n95\n3%\n\n\nDeposits at the Fed\n15\nLevel 1\nLess Stable retail deposits\n40\n10\n\n\nTreasury securities\n100\nLevel 1\nUnsecured wholesale funding from:\n\n\n\n\nGNMA securities\n75\nLevel 2A\n- Stable small business deposits\n100\n5\n\n\nLoans to A-rated corporations\n110\nLevel 2A\n- Less Stable small business deposits\n80\n10\n\n\nLoans to B-rated corporations\n85\nLevel 2B\n- Nonfinancial corporates\n50\n75\n\n\nPremises\n20\n\nEquity\n45\n\n\n\nTotal\n410\n\nTotal\n410"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr-example-contd",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr-example-contd",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR): example (cont’d)",
    "text": "Liquidity Coverage Ratio (LCR): example (cont’d)\nThe LCR is calculated as follows:\nFirst, calculate the amount of HQLA.\n\nLevel 1 assets is \\(5+15+100=120\\) million\n\nBefore adjustment for capps,\n\nLevel 2A assets is \\((75+110)\\times (1-15\\%) = 157.25\\) million1\nLevel 2B assets is \\(85\\times (1-50\\%)=42.5\\) million2\n\nHowever, Level 2 assets is capped at 40% of HQLA!\n\nGiven that Level 1 assets is 120 million, which should account for at least \\(1-40\\%=60\\%\\) of HQLA.\nHQLA should be \\(120/(1-40\\%) = 200\\) million, which means a maximum of \\(200-120=80\\) million Level 2 assets.\nThe Level 2 assets after haircut is larger than the cap - they will not further increase HQLA.\n\nTherefore, the HQLA is 200 million.\nThere is a 15% haircut applied on the value of Level 2A assets.There is a 50% haircut applied on the value of Level 2B assets."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr-example-contd-1",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-coverage-ratio-lcr-example-contd-1",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR): example (cont’d)",
    "text": "Liquidity Coverage Ratio (LCR): example (cont’d)\nNext, calculate the total net cash outflows over next 30 days.\nCash outflows are:\n\nStable retail deposits: \\(95\\times 0.03 = 2.85\\)\nLess stable retail deposits: \\(40\\times 0.1 = 4\\)\nStable small business deposits: \\(100\\times 0.05 = 5\\)\nLess stable small business deposits: \\(80\\times 0.1 =8\\)\nNonfinancial corporates: \\(50\\times 0.75 = 37.5\\)\n\nTherefore,\n\nTotal cash outflows over next 30 days is 57.35 million.\nTotal cash inflows over next 30 days is 5 million (assumed).\nTotal net cash outflows over next 30 days is 52.35 million.\n\nLastly, calculate LCR:\n\\[\n\\text{LCR} = \\frac{\\text{Stock of HQLAs}}{\\text{Total net cash outflows over next 30 calendar days}} = \\frac{200}{52.35} = 382.04\\% \\ge 100\\%\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#net-stable-funding-ratio-nsfr",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#net-stable-funding-ratio-nsfr",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Net Stable Funding Ratio (NSFR)",
    "text": "Net Stable Funding Ratio (NSFR)\n\nThe Net Stable Funding Ratio (NSFR) focuses on long-term liquidity management on a DI’s balance sheet.\nIt evaluates liquidity across the entire balance sheet, encouraging the use of stable sources of financing.\nThe NSFR requires a minimum amount of stable funding over a one-year time horizon.\n\nIt aims to limit the reliance on short-term wholesale funding, a significant issue during the financial crisis.\n\nThe NSFR has been reported to DI supervisors quarterly since 2018.\n\n\\[\n\\text{NSFR} = \\frac{\\text{Available amount of stable funding}}{\\text{Required amount of stable funding}} \\ge 100\\%\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#net-stable-funding-ratio-nsfr-1",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#net-stable-funding-ratio-nsfr-1",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Net Stable Funding Ratio (NSFR)",
    "text": "Net Stable Funding Ratio (NSFR)\nAvailable stable funding (ASF) includes:\n\nBank capital\nPreferred stock with a maturity &gt; 1 year\nLiabilities with maturities &gt; 1 year\nThe portion of retail deposits and wholesale deposit expected to stay with bank during a period of idiosyncratic stress\n\nThese equity and liabilities are assigned to one of five categories, each with a specific ASF factor.\nASF is calculated as the sum of the weighted amounts."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#net-stable-funding-ratio-nsfr-2",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#net-stable-funding-ratio-nsfr-2",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Net Stable Funding Ratio (NSFR)",
    "text": "Net Stable Funding Ratio (NSFR)\nRequired stable funding (RSF) is calculated as the sum of\n\nthe value of the on-balance-sheet assets multiplied by a specific RSF factor assigned to each particular asset type, and\nthe amount of off-balance-sheet (OBS) activities (or potential liquidity exposure) multiplied by the associated RSF factor."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-risk-of-australian-banks-fy2023",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-risk-of-australian-banks-fy2023",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity risk of Australian banks (FY2023)",
    "text": "Liquidity risk of Australian banks (FY2023)\n\n\n\n\n\n\n\n\n\n\n\nCBA\nNAB\nANZ\nWestpac\n\n\n\n\nCash Outflows\n\n\n\n\n\n\nRetail And Counterparties Deposits Outflow\n37,416\n29,947\n25,517\n29,304\n\n\nStable Deposits\n12,700\n5,843\n5,879\n7,969\n\n\nLess Stable Deposits\n24,716\n24,104\n19,638\n21,335\n\n\nUnsecured Wholesale Funding Outflow\n82,444\n82,299\n146,698\n76,953\n\n\nOperational Deposit Outflow\n22,219\n21,540\n22,553\n18,631\n\n\nNon Operational Deposits Outflow\n49,236\n47,619\n111,549\n47,073\n\n\nUnsecured Debt Outflow\n10,989\n13,140\n12,596\n11,249\n\n\nSecured Wholesale Funding Outflow\n6,839\n10,701\n5,405\n3,891\n\n\nAdditional Outflow Requirements\n26,186\n38,693\n70,639\n30,463\n\n\nDerivative Expo And Other Collateral Requirement\n7,557\n8,154\n48,206\n12,462\n\n\nLoss of Funding on Debt Products\n0\n0\n0\n136\n\n\nCredit And Liquidity Facilities\n18,629\n30,539\n22,433\n17,865\n\n\nOther Contractual Funding Obligation\n0\n81\n0\n4,515\n\n\nOther Contingent Funding Obligation\n10,373\n5,219\n8,024\n4,082\n\n\nTotal Cash Outflow\n163,258\n166,940\n256,283\n149,208"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-risk-of-australian-banks-fy2023-1",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-risk-of-australian-banks-fy2023-1",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity risk of Australian banks (FY2023)",
    "text": "Liquidity risk of Australian banks (FY2023)\n\n\n\n\n\n\n\n\n\n\n\nCBA\nNAB\nANZ\nWestpac\n\n\n\n\nCash Inflows\n\n\n\n\n\n\nSecured Lending\n2,328\n3,898\n1,549\n0\n\n\nInflows From Fully Performing Exposures\n9,520\n11,788\n17,190\n5,020\n\n\nOther Cash Inflows\n6,753\n1,589\n36,016\n7,988\n\n\nTotal Cash Inflow\n18,601\n17,275\n54,755\n13,008"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-risk-of-australian-banks-fy2023-2",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-risk-of-australian-banks-fy2023-2",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity risk of Australian banks (FY2023)",
    "text": "Liquidity risk of Australian banks (FY2023)\n\n\n\n\n\n\n\n\n\n\n\nCBA\nNAB\nANZ\nWestpac\n\n\n\n\nLiquidity Coverage Ratio (LCR)\n\n\n\n\n\n\nAverage High Quality Liquid Assets\n189,419\n209,561\n267,905\n181,882\n\n\nAverage Net Cash Outflows\n144,657\n149,665\n201,528\n136,200\n\n\nAverage Liquidity Coverage Ratio\n131.00\n140.00\n132.90\n134.00\n\n\nNet Stable Funding Ratio (NSFR)\n\n\n\n\n\n\nAvailable Stable Funding\n860,999\n646,508\n625,285\n707,893\n\n\nRequired Stable Funding\n693,453\n556,016\n537,430\n615,341\n\n\nNet Stable Funding Ratio\n124.00\n116.00\n116.35\n115.00"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-planning",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-planning",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity planning",
    "text": "Liquidity planning\n\nLiquidity planning is crucial for managing liquidity risk and costs, helping with borrowing priorities and minimizing excess reserves.\nComponents of a liquidity plan:\n\nManagerial responsibilities: Assign roles during a liquidity crisis and manage public disclosures.\nList of fund providers: Identify likely fund withdrawers and patterns, including sensitivity to funding composition changes.\nWithdrawal estimates: Assess potential deposit and fund withdrawals over different time horizons and identify funding sources.\nInternal limits and asset disposal: Set borrowing limits for subsidiaries and branches, determine acceptable risk premiums, and sequence asset disposals.\n\nThe plan involves key departments like the money desk and Treasury for daily liability funding."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-risk-unexpected-deposit-drains-and-bank-runs",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#liquidity-risk-unexpected-deposit-drains-and-bank-runs",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Liquidity risk, unexpected deposit drains, and bank runs",
    "text": "Liquidity risk, unexpected deposit drains, and bank runs\nMajor liquidity problems can arise, however, if deposit drains are abnormally large and unexpected, which may occur for a number of reasons, including:\n\nConcerns about a DI’s solvency relative to those of other DIs.\nFailure of a related DI (the contagion effect).\nSudden changes in investor preferences regarding holding nonbank financial assets (such as T-bills or mutual fund shares) relative to deposits.\n\nIn these cases, unexpected deposit drains could trigger a bank run that may eventually force a bank into insolvency.\nIn the worst case, a bank panic may occur - systemic or contagious bank run on deposits of banking industry."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#bank-runs-the-discount-window-and-deposit-insurance",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#bank-runs-the-discount-window-and-deposit-insurance",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Bank runs, the discount window, and deposit insurance",
    "text": "Bank runs, the discount window, and deposit insurance\nThe two major liquidity risk insulation devices are deposit insurance and the discount window.\n\nDeposit insurance\nDiscount window:\n\nA facility provided by central banks where FIs can borrow short-term funds to meet liquidity needs, typically at an interest rate called the “discount rate.”\nDuring the March 2023 United States bank failures, banks drew $153 billion from the discount window as of 15 March 2023, a new record.\n\n\nNot without economic costs\n\nProtection may encourage DIs to increase liquidity risk"
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#life-insurance-companies",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#life-insurance-companies",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Life insurance companies",
    "text": "Life insurance companies\n\nLife insurance companies hold cash reserves and liquid assets to meet policy cancellations (surrenders) and working capital needs.\nPremium income and returns on investments usually cover policyholder surrenders, with government bonds serving as a liquidity buffer.\nIf premium income is insufficient, insurers may sell liquid assets to meet demands.\nA loss of confidence in an insurer can lead to a run, with mass policy surrenders forcing asset liquidations at potentially low prices.\nForced liquidations can push insurers towards insolvency, similar to banks (DIs).\n\n\n\n\n\n\n\nNote\n\n\nAn example is the case of Equitable Life. Increase in surrenders after it received an adverse legal ruling contributed to its failing. Its 256-year history ended in June 2018, after an 18-year-long winding-down process."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#property-casualty-insurers",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#property-casualty-insurers",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Property-casualty insurers",
    "text": "Property-casualty insurers\n\nProperty–casualty (PC) insurers sell policies insuring against certain contingencies impacting either real property or individuals.\nLarge unexpected claims may materialize and exceed the flow of premium income and income returns from assets.\n\nFor example, natural disasters."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#suggested-readings",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nAPRA Explains: Liquidity in banking.\nRBA: The Implementation of Monetary Policy: Domestic Market Operations.\nBIS: LCR - Liquidity Coverage Ratio.\nAcharya, V. V., Engle, R., Jager, M., & Steffen, S. (2024). Why Did Bank Stocks Crash during COVID-19? The Review of Financial Studies, 37, 2627–2684."
  },
  {
    "objectID": "teaching/AFIN8003/2024S2/Week9/index.html#references",
    "href": "teaching/AFIN8003/2024S2/Week9/index.html#references",
    "title": "AFIN8003 Week 9 - Liquidity Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nAcharya, Viral V, Robert Engle, Maximilian Jager, and Sascha Steffen. 2024. “Why Did Bank Stocks Crash During COVID-19?” The Review of Financial Studies 37 (9): 2627–84. https://doi.org/10.1093/rfs/hhae028.\n\n\nSaunders, Anthony, Marcia Millon Cornett, and Otgo Erhemjamts. 2023. Financial Institutions Management ISE. 11th ed. McGraw Hill."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#unit-convenor",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#unit-convenor",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Unit Convenor",
    "text": "Unit Convenor\n\n\n\nDr. Mingze Gao.\nLecturer in Finance, MQBS.\nPhD in Finance (USyd), Grad.Cert. in Computing (UNSW), BCom (Hon) in Finance (USyd), BCom in Econometrics and Finance (USyd).\nPostdoctoral Research Fellow (USyd), 2021-2023.\nResearch in banking and corporate finance.\n\nContact:\n\nRoom 554, 4ER.\nEmail: mingze.gao@mq.edu.au\nWebsite: https://mingze-gao.com"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#about-this-course",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#about-this-course",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "About this course",
    "text": "About this course\nCourse description:\n\nThis unit applies finance theory to the context of operational decision-making and risk management in banking and financial intermediation.\nThe major decision areas for banking management are covered within a regulatory and corporate responsibility framework.\nMajor risks of banks and financial intermediation are being examined.\n\nKey approaches:\n\nResearch-informed teaching.\nAustralian focus with global evidence.\nPriority on bank risk management."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#course-materials",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#course-materials",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Course materials",
    "text": "Course materials\nThe course materials are prepared based on several sources. Additional references are provided at the end of each week’s slides.\n\nSaunders, Cornett, and Erhemjamts (2023)\nFreixas and Rochet (2023)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#weekly-topics",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#weekly-topics",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Weekly topics",
    "text": "Weekly topics\n\nIntroduction to banking and financial intermediation\nRisks and regulation\nCapital management and adequacy\nInterest rate risk\nMarket risk (guest lecture)\nCredit risk I: individual loan risk\nCredit risk II: loan portfolio and concentration risk\nLiquidity risk\nLiability and liquidity management\nSovereign risk, foreign exchange risk, and off-balance-sheet risk\nLoan sales and securitisation\nEmerging topics in bank risk management\nReview"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#assessments",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#assessments",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Assessments",
    "text": "Assessments\nThere are three assessments in this course.\n\n\n\n\n\n\n\n\n\nAssessment\nWeight\nHurdle\nWhen\n\n\n\n\nIndividual assignment\n30%\nNo\nDue in Week 8\n\n\nGroup assignment\n30%\nNo\nDue in Week 12\n\n\nFinal exam\n40%\nNo\nUniversity Examination Period"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#financial-system",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#financial-system",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Financial system",
    "text": "Financial system\nA financial system encompasses various financial intermediaries, markets, regulators, and infrastructure in the generation and distribution of financial resources.\n\nA well developed smoothly functioning facilitates the efficient life-cycle allocation of household consumption and the efficient allocation of physical capital to its most productive use in the business sector (Merton 1993).\nRobert Merton, Nobel laureate (1997)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#financial-intermediation",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#financial-intermediation",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Financial intermediation",
    "text": "Financial intermediation\nFinancial intermediation is part of the financial system.\n\nIt is the process by which financial intermediaries, such as banks, facilitate the flow of funds between savers and borrowers.\nBanks are a major part of financial intermediation.\n\nBanks were essentially the only provider of financial intermediation.\nSince 1970s, dramatic development development of the financial market:\n\nOther intermediaries performing similar functions of banks.\nFinTech, bigtech in money and credit services.\nCryptocurrencies, central bank digital currencies.\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#why-is-banking-and-financial-intermediation-necessary",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#why-is-banking-and-financial-intermediation-necessary",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Why is banking and financial intermediation necessary?",
    "text": "Why is banking and financial intermediation necessary?\nA historical perspective:\n\nFinance is critical in real economic activities.\n\nExcessive debt levels and liquidity constraints could lead to downward spirals in economic activity, as witnessed during the Great Depression (Fisher 1933)1\n\n“Finance is a veil”, late 50s to early 70s.\n\nIn a frictionless market, firm value is not affected by its capital structure so that financial intermediaries can be redundant (Modigliani and Miller 1958).\n\nFinance is relevant, since 70s.\n\nMarket frictions amplify economic cycles, particularly during downturns. Monetary factors alone are insufficient to explain the Great Depression’s depth and persistence - it’s more because of the collapse of the bank credit (Bernanke 1983, the “financial accelerator”).\n\n\nNobel prize in economics started in 1969. Irving Fisher died in 1947. He would have won a Nobel prize."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#why-is-banking-and-financial-intermediation-necessary-1",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#why-is-banking-and-financial-intermediation-necessary-1",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Why is banking and financial intermediation necessary?",
    "text": "Why is banking and financial intermediation necessary?\nA banking analogue of the Modigliani and Miller (1958) theorem showing that banks are useless with perfect financial markets.\n\nAn economy of firms, households, banks and a bond market.\n\nHouseholds consume, and lend through banks or through the bond market.\nFirms produce, and borrow from banks or from households through the bond market.\nBanks borrow from households and lend to firms.\n\n\nIn a competitive equilibrium, banks make zero profit and have no impact on other agents’ decisions. Firms are indifferent between bank credit and bonds. (Freixas and Rochet 2023)\n\nBanks and bond market are perfect substitutes in a market without frictions."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#why-is-banking-and-financial-intermediation-necessary-2",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#why-is-banking-and-financial-intermediation-necessary-2",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Why is banking and financial intermediation necessary?",
    "text": "Why is banking and financial intermediation necessary?\nThe existence of banks (and other financial intermediaries) must be justified by their roles in mitigating market frictions.\n\nInformation asymmetry.\n…\n\nFrom an industrial organization perspective, the structure and competition of banking sector should have a unique impact on the economy, which warrants for regulation.\n\nThe services provided by banks to borrowers and savers must be costly.\n\nMonitoring costs.\nLiquidity costs.\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#empirical-evidence",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#empirical-evidence",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Empirical evidence",
    "text": "Empirical evidence\n\n\nFigure 1: The share of financial sector of economic output is relatively stable"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#importance-of-banks-and-financial-intermediaries",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#importance-of-banks-and-financial-intermediaries",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Importance of banks and financial intermediaries",
    "text": "Importance of banks and financial intermediaries\nWe start this banking course by studying the importance of banks in improving the efficient allocation of financial resources in the economy.\n\nSpecifically, why market frictions necessitate banks.\nA simple look at the Diamond and Dybvig (1983) model."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#an-economy-without-financial-intermediaries",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#an-economy-without-financial-intermediaries",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "An economy without financial intermediaries",
    "text": "An economy without financial intermediaries\nThe Diamond and Dybvig (1983) model\n\n\n\n\n\n\nFigure 2: A simple diagram of an economy without financial intermediaries\n\n\n\nSome frictions render this setup unappealing.\n\nHouseholds are uncertain about when they will need their money. They might need it either in the short term or in the long term.\nFirms need long-term capital in production.\nBanks1 are best positioned to perform maturity transformation.\n\nWe later define what is a bank."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#model-setup",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#model-setup",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Model setup",
    "text": "Model setup\nThe Diamond and Dybvig (1983) model\nLet’s see a simplified Diamond and Dybvig (1983) model:1\n\nThree dates, \\(t=0,1,2.\\)\nEach household has initial goods of 1 unit at \\(t=0\\).\n\nThey can invest long-term to earn \\(R&gt;1\\) at \\(t=2\\) for consumption, or\nstore it for consumption at \\(t=1\\) or \\(t=2\\), which remains 1 unit.\nIf they choose to liquidate the long-term investment at \\(t=1\\), they get \\(l&lt;1\\) (costly liquidation).\n\nHousehold do not know whether they need to consume early at \\(t=1\\).\n\nA sudden need for money, e.g., medical bills (note there that we do not introduce insurance - but banks can provide such liquidity insurance).\nKey assumption.\n\n\nDouglas Diamond and Philip Dybvig won the Nobel price in 2022, together with Ben Bernanke."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#model-implications",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#model-implications",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Model implications",
    "text": "Model implications\nThe Diamond and Dybvig (1983) model\nNot bothered by math, the implications are:\n\n\nWe can determine the theoretical optimal allocation.\nWithout transactions between agents, the allocation is inefficient.\nWith transactions (financial market/bond market), the allocation is still not efficient.\n\nConsumption can be transferred between \\(t=1\\) and \\(t=2\\).\nLiquidation costs avoided.\n\nThe optimal allocation can be achieved with competitive banks offering deposit contracts and investing in the long-term.\n\nA bank simultaneously take deposits from the public and grant loans to borrowers.\nTransform short-term deposits to long-term assets."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#maturity-transformation-by-bank",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#maturity-transformation-by-bank",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Maturity transformation by bank",
    "text": "Maturity transformation by bank\nThe Diamond and Dybvig (1983) model\n\n\nFigure 3: A simple diagram of bank’s maturity transformation\n\nThis structure, however, gives rise to bank runs where everyone withdraws at \\(t=1\\).\n\nThe Silicon Valley Bank (SVB) failure in March 2023 is a typical bank run.\n\nNo other risks considered."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#beyond-maturity-transformation",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#beyond-maturity-transformation",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Beyond maturity transformation",
    "text": "Beyond maturity transformation\nAsset transformation, risk transformation and liquidity transformation.\n\nBanks make investments in borrowers - primary claims - illiquid and risky.\nSavers deposit in banks - secondary claims - liquid and low risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#information-frictions",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#information-frictions",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Information frictions",
    "text": "Information frictions\nBanks do more than maturity transformation.\nBanks are also better positioned to mitigate informational frictions in the market due to economies of scale.\n\nThe cost advantages by spreading the costs over a large number of customers, transactions, and output.\nThe costs arise from all aspects of lending process: screening, monitoring, and auditing; all of which can be costly for individual household lenders."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#information-asymmetry-and-costs",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#information-asymmetry-and-costs",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Information asymmetry and costs",
    "text": "Information asymmetry and costs\n\nScreening costs in the context of adverse selection (Broecker 1990).\n\nBorrower knows better about its quality than lenders.\nOccurs before a loan is made.\n\nMonitoring costs in the context of moral hazard (Holmstrom and Tirole 1997).\n\nBorrower could engage in opportunistic behaviour with private benefits at the cost of lenders.\nOccurs after a loan is made.\n\nAuditing costs in the context of borrower failing to meet contractual obligations.\n\nRenegotiate loan terms, recover loan value, etc.\nOccurs in case of non-compliance."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#banks-as-delegated-monitor",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#banks-as-delegated-monitor",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks as delegated monitor",
    "text": "Banks as delegated monitor\nDiamond (1984) model, overly simplified:\n\n\\(n\\) large borrowers, each requires \\(1\\) unit of funds and costs \\(K\\) to monitor, and\n\\(nm\\) small savers each with \\(1/m\\) units of funds (\\(m&gt;1\\)); a total of \\(n\\) units of funds.\nTotal monitoring costs is \\(nmK\\) if savers individually monitor, but\n\\(mK\\) if the bank acts as the monitor on behalf of savers.\n\n\n\nFigure 4: A simple diagram of bank as delegated monitor"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#banks-as-delegated-monitor-1",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#banks-as-delegated-monitor-1",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks as delegated monitor",
    "text": "Banks as delegated monitor\nEconomies of scale is evident:\n\nTotal monitoring costs reduced from \\(nmK\\) to \\(mK\\).\nDelegated monitoring reduces unnecessary duplication of monitoring costs.\nThe more savers, the lower the cost per saver.\n\nA caveat. It must be that the cost of delegation is smaller than the benefits gained from economies of scale. The delegated monitor needs to be monitored, too.\n\nRequirement is that the bank needs to be sufficiently diversified (Diamond 1984)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#the-holmstrom1997-model",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#the-holmstrom1997-model",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "The Holmstrom and Tirole (1997) model",
    "text": "The Holmstrom and Tirole (1997) model\nKey insights:\n\nFirms with profitable projects will still be credit rationed if they do not have sufficient internal capital - they will not be able to raise capital from the market.\nBanks can alleviate this problem by providing credit to firms and monitoring borrowers.\nBanks improve the market."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#changing-dynamics",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#changing-dynamics",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Changing dynamics",
    "text": "Changing dynamics\nFinTech, bigtech, and more\n\nTraditional “banks”, taking deposits and grant loans, are facing increasing challenges.\nGlobal competition with other banks.\nCompetition with nonbanks or “shadow banks”.\n\nMany of banks’ functions can be now performed by nonbanks.\nFor example, FinTech firms may better reduce information asymmetry through screening and monitoring based on big data and advanced technologies (AI/ML), improved and customized services, and reduced cost of search and match with platform economy.\nMore importantly, nonbanks are not regulated or less regulated than banks.\n\nCentral bank digital currencies (CBDC).\n\nIncreased funding costs for banks if households hold CBDC instead of bank deposits.\n\nTechnological advancement.\n\nOnline/mobile banking simplifies transfer of funds.\n\nTransition from “originate and hold” to “originate and distribute” business model."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#types-of-financial-institutions",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#types-of-financial-institutions",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Types of financial institutions",
    "text": "Types of financial institutions\nThe Australian’s central bank, Reserve Bank of Australia (RBA), classifies financial institutions into broadly three categories:1\n\nAuthorised depository-taking institutions (ADI)\nNon-ADI financial institutions\nInsurers and fund managers\n\nhttps://www.rba.gov.au/fin-stability/fin-inst/main-types-of-financial-institutions.html"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#authorised-depository-taking-institutions-adi",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#authorised-depository-taking-institutions-adi",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Authorised depository-taking institutions (ADI)",
    "text": "Authorised depository-taking institutions (ADI)\nFinancial institutions authorised by the Australia Prudential Regulation Authority (APRA) to carry out financial intermediation are called authorised depository institutions (ADIs).\n\nThese depository-taking institutions (DIs) are the focus of this course.\nThree DI groups in Australia: banks, building societies and credit unions.\n\n\n\n\nTable 1: Typical balance sheet of a DI\n\n\n\n\n\nAssets\nLiabilities and Equity\n\n\n\n\nLoans\nDeposits\n\n\nOther assets\nOther liabilities\n\n\n\nEquity"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#banks",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#banks",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks",
    "text": "Banks\nDepositary-taking institutions (DI)\n\nBanks are the largest depository institutions in terms of size.\nMajor difference between banks and credit unions/savings institutions: banks have more varied assets and liabilities.\nDifferences in operating characteristics and profitability across size classes - for instance, with regards to the size of the commercial loan portfolio."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#largest-banks-globally",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#largest-banks-globally",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Largest banks globally",
    "text": "Largest banks globally\nLargest banks by total assets in 2024, according to S&P Global Market Intelligence:\n\n\n\n\n\n\n\n\n\nRank\nCompany\nHeadquarter\nTotal assets ($B)\n\n\n\n\n1\nIndustrial and Commercial Bank of China Ltd.\nChina\n6,303.44\n\n\n2\nAgricultural Bank of China Ltd.\nChina\n5,623.12\n\n\n3\nChina Construction Bank Corp.\nChina\n5,400.28\n\n\n4\nBank of China Ltd.\nChina\n4,578.28\n\n\n5\nJPMorgan Chase & Co.\nUS\n3,875.39\n\n\n6\nBank of America Corp.\nUS\n3,180.15\n\n\n7\nHSBC Holdings PLC\nUK\n2,919.84\n\n\n8\nBNP Paribas SA\nFrance\n2,867.44\n\n\n9\nMitsubishi UFJ Financial Group Inc.\nJapan\n2,816.77\n\n\n10\nCrédit Agricole Group\nFrance\n2,736.95\n\n\n\n…\n\n\n\n\n42\nCommonwealth Bank of Australia\nAustralia\n868.74"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#banks-in-australia",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#banks-in-australia",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks in Australia",
    "text": "Banks in Australia\nFour major banks: CBA, ANZ, NAB, and Westpac.\n\nnational focus, “four pillars policy”\noffer corporate and retail banking services in Australia, NZ and Papua New Guinea\nthey also operate in Asia, the US and the UK\nfocus on lending (around 70 per cent).\n\nOther major banks: Macquarie Bank, Bendigo and Adelaide Bank, Bank of Queensland, Suncorp, AMP Bank, etc.\nRegional banks\n\nregional focus with operations across state borders\nlarge proportion of assets invested in residential housing loans due to their origins as building societies\nfocus on lending"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#banks-in-australia-funding-composition",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#banks-in-australia-funding-composition",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks in Australia: funding composition",
    "text": "Banks in Australia: funding composition\n\n\nFigure 5: Funding composition of banks in Australia"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#banks-in-australia-net-interest-margin",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#banks-in-australia-net-interest-margin",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks in Australia: net interest margin",
    "text": "Banks in Australia: net interest margin\n\n\nFigure 6: NIM of banks in Australia"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#banks-in-australia-non-performing-assets",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#banks-in-australia-non-performing-assets",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Banks in Australia: non-performing assets",
    "text": "Banks in Australia: non-performing assets\n\n\nFigure 7: Non-performing assets of banks in Australia"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#credit-unions-and-building-societies",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#credit-unions-and-building-societies",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Credit unions and building societies",
    "text": "Credit unions and building societies\nDepositary-taking institutions (DI)\nCredit Unions\n\nMutual cooperative organisations that provide deposit facilities, personal and housing loans and payments services to their members, who are usually linked by way of some common bond\nPrimarily provide deposit facilities, personal and housing loans and payments services\nMembers are usually linked by a common bond, such as a trade union or locality\nIn 2014 there were 84 credit unions in Australia, compared to 348 in 1992\n\nBuilding Societies\n\nDIs that traditionally were mutually owned, but are increasingly issuing share capital\nDepositors are members of the society  \nIn 2014 there were 9 building societies, compared to 31 in 1992\n\nBoth credit unions and building societies are subject to the same prudential regulations as banks.\nOnly 36 credit unions and building societies in 2023."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#non-adi-financial-institutions",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#non-adi-financial-institutions",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Non-ADI financial institutions",
    "text": "Non-ADI financial institutions\n\nMoney market corporations (broker-dealers)\n\nPrimarily wholesale credit market.\nInvesting, investment banking, market making, trading.\n\nFinance companies\n\nLoans to households and SMEs.\nFunding from debentures and unsecured notes.\n\nSecuritisers\n\nSpecial-purpose vehicles (SPVs) that issue securities backed by pools of assets (e.g. residential mortgage-backed securities)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#insurers-and-fund-managers",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#insurers-and-fund-managers",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Insurers and fund managers",
    "text": "Insurers and fund managers\n\nInsurance companies\n\nLife insurers: provide life, accident and disability insurance, annuities, investment and superannuation products.\nGeneral insurers: provide insurance for property, motor vehicles, employers’ liability, etc.\nHealth insurers: provide insurance for private health costs.\n\nMedibank, Bupa, HCF, etc.\n\n\nSuperannuation and approved deposit funds\nPublic unit trusts\nCash management trusts\nCommon funds\nFriendly societies"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#life-insurers-in-australia",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#life-insurers-in-australia",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Life insurers in Australia",
    "text": "Life insurers in Australia\nTop 10 life insurers by total assets in 2023:\n\n\n\n\n\n\n\n\nCompany\nTotal Assets\nShare\n\n\n\n\nResolution Life Australasia Limited (former AMP)\n25,636,094,000\n21.11%\n\n\nChallenger Life Company Limited\n25,025,565,000\n20.61%\n\n\nAIA Australia Limited\n14,999,640,516\n12.35%\n\n\nTAL Life Limited\n12,451,370,000\n10.25%\n\n\nZurich Australia Limited\n8,268,873,000\n6.81%\n\n\nMLC Limited\n6,775,456,183\n5.58%\n\n\nMunich Reinsurance Company of Australasia Limited\n5,401,974,315\n4.45%\n\n\nSwiss Re Life & Health Australia Limited\n3,454,823,000\n2.85%\n\n\nTAL Life Insurance Services Limited\n3,200,477,631\n2.64%\n\n\nHannover Life Re of Australasia Ltd\n3,053,576,000\n2.51%"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#superannuation-funds",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#superannuation-funds",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Superannuation funds",
    "text": "Superannuation funds\nAustralian governments have encouraged national savings over last decades through:\n\ntaxation incentives,\nlegislative requirements, and\naward superannuation.\n\nSector represents 30% of the assets of all FIs as at December 2021.\nManaged by:\n\nspecialist superannuation fund managers, e.g., UniSuper\nself-managed superannuation funds (SMSF)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#non-bank-financial-institutions-nbfis",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#non-bank-financial-institutions-nbfis",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Non-bank financial institutions (NBFIs)",
    "text": "Non-bank financial institutions (NBFIs)\n\nNon-bank FIs’ assets"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#suggested-readings",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nThe Financial Stability Review published semi-annually by the RBA.\n\nMost recent issue: March 2024."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week1/index.html#references",
    "href": "teaching/AFIN8003/2025S1/Week1/index.html#references",
    "title": "AFIN8003 Week 1 - Introduction",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nBernanke, Ben S. 1983. “Nonmonetary Effects of the Financial Crisis in the Propagation of the Great Depression.” The American Economic Review 73 (3): 257–76.\n\n\nBroecker, Thorsten. 1990. “Credit-Worthiness Tests and Interbank Competition.” Econometrica 58 (2): 429.\n\n\nDiamond, Douglas W. 1984. “Financial Intermediation and Delegated Monitoring.” The Review of Economic Studies 51 (3): 393–414.\n\n\nDiamond, Douglas W., and Philip H. Dybvig. 1983. “Bank Runs, Deposit Insurance, and Liquidity.” Journal of Political Economy 91 (3): 401–19.\n\n\nFisher, Irving. 1933. “The Debt-Deflation Theory of Great Depressions.” Econometrica 1 (4): 337.\n\n\nFreixas, Xavier, and Jean-Charles Rochet. 2023. Microeconomics of Banking. 3rd ed. MIT Press.\n\n\nHolmstrom, Bengt, and Jean Tirole. 1997. “Financial Intermediation, Loanable Funds, and the Real Sector.” Quarterly Journal of Economics 112 (3): 663–91.\n\n\nMerton, R C. 1993. Operation and Regulation in Financial Intermediation: A Functional Perspective. Edited by P Englund. Stockholm: Economic Council.\n\n\nModigliani, F, and M H Miller. 1958. “The Cost of Capital, Corporation Finance and the Theory of Investment.” The American Economic Review 48 (3): 261–97.\n\n\nSaunders, Anthony, Marcia Millon Cornett, and Otgo Erhemjamts. 2023. Financial Institutions Management ISE. 11th ed. McGraw Hill."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banks-need-regulation",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banks-need-regulation",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banks need regulation",
    "text": "Banks need regulation\nDIs (banks, interchangeably) are financial institutions chartered to take deposits from the public and grant loans simultaneously. They are necessary in an economy achieving efficient allocation of financial resources.\nHowever, we also note that\n\nthe banking structure itself could cause financial fragility (Diamond and Dybvig 1983).\nthe collapse of bank credit contributes to economic crisis (Bernanke 1983).\n\nTherefore, bank failures have significant negative externality. As a result, banks are heavily regulated."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulations",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulations",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulations",
    "text": "Banking regulations\nWhat types of regulations are needed or in place for banks?\n\nentry and chartering\nsafety and soundness\ncredit allocation\nconsumer and investor protection\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#an-example-entry-and-chartering-regulation",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#an-example-entry-and-chartering-regulation",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "An example: entry and chartering regulation",
    "text": "An example: entry and chartering regulation\nEconomic theories generally view competition as improving social welfare. But it is not necessarily true for the banking sector.\n\nConsider the location model of Salop (1979).\nFree entry leads to too many banks that is sub-optimal.\nIncreasing bank costs (e.g., higher reserve requirements) does not limit bank numbers.\nCharters (business license) could help.\nChartering also helps with other regulations."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#the-gfc-and-the-new-banking-regulatory-landscape",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#the-gfc-and-the-new-banking-regulatory-landscape",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "The GFC and the new banking regulatory landscape",
    "text": "The GFC and the new banking regulatory landscape\n\n\n\n\n\n\n\n\nFigure 1: Impact of the Great Recession on GDP\n\n\n\n\n\n\nThe Global Financial Crisis (2007-2009) caused the Great Recession that persistently undermines the economy.\nThe regulations were unable to prevent the collapse of the banking sector.\nNew regulatory framework, Basel III, established in response."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#the-new-banking-regulatory-landscape",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#the-new-banking-regulatory-landscape",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "The new banking regulatory landscape",
    "text": "The new banking regulatory landscape\nBefore GFC, the banking regulations primarily focused on prudential regulations concerning the risks of individual banks.\n\nCapital adequacy: sufficient capital to cover potential losses.\nRisk management: ability to manage various risks such as credit, market, and operational risks.\nLiquidity management: enough liquid resources to meet immediate obligations.\n\n\nPost-GFC, the banking regulations have expanded to include macroprudential regulations.\n\nSystemic focus: greater emphasis on understanding and mitigating systemic risks that could destabilize the entire financial system.\nCountercyclical policies: measures introduced to mitigate the procyclical effects of previous regulatory approaches.\nStress testing: system-wide tests to assess the resilience of the financial system to shocks."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banking-and-trading-books",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banking-and-trading-books",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking and trading books",
    "text": "Banking and trading books\nA bank has a banking book and a trading book, two different ways to categorize financial assets and liabilities, each governed by different management strategies and regulatory standards.1\n\nBanking book\n\nAssets and liabilities that the bank intends to hold for the long term.\nPrimarily used for traditional banking activities, e.g., lending and taking deposits.\n\nTrading book\n\nAssets and liabilities that the bank intends to trade actively.\nThe value and income from these assets are driven by market conditions and short-term price movements.\n\n\nSee suggested readings for the boundary between banking and trading books."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#what-risks-do-banks-face",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#what-risks-do-banks-face",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "What risks do banks face?",
    "text": "What risks do banks face?\nThe most simplified balance sheet of a bank:\n\n\n\nTable 1: Typical balance sheet of a DI\n\n\n\n\n\nAssets\nLiabilities and Equity\n\n\n\n\nLoans\nDeposits\n\n\nOther assets\nOther liabilities\n\n\n\nEquity\n\n\n\n\n\n\n\nRisks on the assets side.\nRisks on the liabilities and equity side.\nOther risks beyond the balance sheet."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-assets-side",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-assets-side",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the assets side",
    "text": "Risks on the assets side\n\nLoans\nOther assets (bonds, investment securities, derivatives)\n\n\n\nFigure 2: Excerpt of CBA’s 2023 balance sheet - assets"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-assets-side---loans",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-assets-side---loans",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the assets side - loans",
    "text": "Risks on the assets side - loans\nLoans are often in the banking book and reported based on amortised book value.\nMajor risks due to uncertainties in:\n\nBorrower’s creditworthiness, credit risk\nInterest rate when rolling over / repricing the loans, interest rate risk\nExchange rate if loans are denominated in foreign currencies, foreign exchange risk\nAbility to liquidate the loans, liquidity risk\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-assets-side---other-assets",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-assets-side---other-assets",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the assets side - other assets",
    "text": "Risks on the assets side - other assets\nBonds, derivatives, investment securities, …\n\n\nFor example, a bond’s price is given by\n\\[\nP = \\sum_{t=1}^T\\frac{C}{(1+r)^t} + \\frac{F}{(1+r)^T}\n\\qquad(1)\\]\nwhere \\(C\\) is coupon payment, \\(F\\) face value, \\(T\\) maturity, and \\(r\\) interest rate.\nRisks due to uncertainties in:\n\n\\(C\\) and \\(F\\), credit risk\n\\(r\\), interest rate risk\n\n\n\n\nCode\nviewof maturity4 = Inputs.range(\n  [1, 30], \n  {value: 15, step: 1, label: \"Maturity (years):\"}\n)\nviewof couponRate4 = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.05, step: 0.01, label:\"Coupon rate:\"}\n)\nd = {\n  const f = 100;\n  let c, m;\n  c = couponRate4;\n  m = maturity4;\n  function pv(c, f, t, r) {\n    return c * (1 - (1+r)**(-t)) / r + f / (1+r)**(t)\n  }\n  const prices = {\"YTM\": [], \"Price\": []};\n  let coupon = f * c;\n  for (let ytm = 0.01; ytm &lt; 20; ytm++) {\n    let price = pv(coupon, f, m, ytm/100);\n    prices[\"YTM\"].push(ytm);\n    prices[\"Price\"].push(price);\n  }\n  return prices;\n}\n\ndata4 = transpose(d)\nPlot.plot({\n  caption: \"Assume $100 bond, annual coupons paid in arrears and effective annual discount rate.\",\n  x: {padding: 0.4, label: \"YTM (%)\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0, 100]),\n    Plot.ruleX([0]),\n    Plot.lineY(data4, {x: \"YTM\", y: \"Price\", stroke: \"blue\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMany are on the trading book.\n\nMarket risk\nLiquidity risk"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-liabilities-and-equity-side",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-liabilities-and-equity-side",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the liabilities and equity side",
    "text": "Risks on the liabilities and equity side\n\nDeposits\nOther liabilities (primarily debts)\n\n\n\nFigure 3: Excerpt of CBA’s 2023 balance sheet - liabilities"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-liabilities-and-equity-side---deposits",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-liabilities-and-equity-side---deposits",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the liabilities and equity side - deposits",
    "text": "Risks on the liabilities and equity side - deposits\n\n\nDeposits are the most important funding source of banks - 60% for Australian banks.\n\nNon-interest bearing deposits.1\nOn-demand and short-term deposits.\nTerm deposits.\nCertificates of deposits.\n\nRisks involved:\n\nInterest rate risk\nLiquidity risk\nIf foreign currencies, foreign exchange risk\n\n\n\n\n\n\n\n\nFigure 4: Funding composition of banks in Australia\n\n\n\n\nCheck if your everyday transaction accounts earn you interest!"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-liabilities-and-equity-side---debts",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-liabilities-and-equity-side---debts",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the liabilities and equity side - debts",
    "text": "Risks on the liabilities and equity side - debts\nDebts are also an important funding source of banks.\n\nAccount for about 30% of bank funding in Australia.\n\nRisks involved:\n\nInterest rate risk\nLiquidity risk\nIf foreign currencies, foreign exchange risk"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-liabilities-and-equity-side---equity",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#risks-on-the-liabilities-and-equity-side---equity",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks on the liabilities and equity side - equity",
    "text": "Risks on the liabilities and equity side - equity\nEquity, assets value minus liabilities.\n\nInsolvency risk\nManifestation of many other risks - a focus of banking regulations\n\nInterest rate risk: changing interest rates cause disproportionate changes in assets value and liabilities value.\nMarket risk: losses from adverse changes in market conditions, such as interest rate fluctuations or stock market declines.\nCredit risk: high default rates on loans and other credit products can erode asset values.\nLiquidity risk: inability to convert assets into cash quickly without significant losses.\nOperational risk: losses stemming from failed internal processes, systems, human errors, or external events.\nConcentration risk: overexposure to a specific borrower, industry, or geographic region."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#risks-beyond-balance-sheet",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#risks-beyond-balance-sheet",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Risks beyond balance sheet",
    "text": "Risks beyond balance sheet\nMany other risks:\n\nESG risk\nCybersecurity risk \n…\n\n\n\n\n\n\n\nNote\n\n\nSee how NAB discusses risk factors, p89 of its annual report 2023."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#bank-failure",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#bank-failure",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Bank failure",
    "text": "Bank failure\nBank failure occurs when a bank is unable to meet its obligations to its depositors or other creditors and either goes bankrupt or must be taken over by a financial regulatory body to avoid bankruptcy.\n\n\nFigure 5: Bank failures in the US"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#silicon-valley-bank-svb-failure",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#silicon-valley-bank-svb-failure",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Silicon Valley Bank (SVB) failure",
    "text": "Silicon Valley Bank (SVB) failure\nSVB’s failure in March 2023 is the largest failure since GFC.\n\nConcentration risk: highly concentrated client base primarily in the tech and VC sectors\nInterest rate risk: a large amount of long-duration assets, like U.S. Treasury bonds and mortgage-backed securities, which decreased in value as interest rates rose sharply.\nLiquidity risk: rising interest rates led to a mismatch in the liquidity profile as SVB’s assets (long-term bonds) lost value while liabilities (deposits) demanded immediate liquidity.\nMarket risk: capital raising through asset sales and stock offerings poorly received by the market.\nBank run: news of the bank’s difficulties led to a rapid and large-scale withdrawal of deposits by clients, creating a classic bank run."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#bank-risks---our-approach",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#bank-risks---our-approach",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Bank risks - our approach",
    "text": "Bank risks - our approach\nIn this course, we will examine bank risks one by one in a three-step framework:\n\nIdentify: definition, source and nature\nMeasure: ways to gauge the exposure\nManage: strategies to mitigate"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#regulations-of-banks",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#regulations-of-banks",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Regulations of banks",
    "text": "Regulations of banks\nFailure of banks has significant negative externality.\n\nLoss of deposits for savers\nNo credit supply for borrowers\nImpact on real economy\nGlobal Financial Crisis (GFC) 2007-2009\n\nBroadly, banking regulations can be classified into two aspects:\n\nMicroprudential regulations: safety and soundness of individual institutions\nMacroprudential regulations: stability of the financial system\n\nThe two aspects are not mutually exclusive, but complementary."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#microprudential-regulations",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#microprudential-regulations",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Microprudential regulations",
    "text": "Microprudential regulations\n\nFocus:\n\nTargets the safety and soundness of individual financial institutions.\n\nObjectives:\n\nPrevent the failure of banks and other financial entities.\nProtect consumers’ deposits and maintain confidence in the financial system.\n\nMethods:\n\nSetting capital adequacy requirements.\nEnforcing liquidity requirements to manage short-term obligations.\nImplementing risk management standards and supervisory review processes.\nConducting regular inspections and audits of individual institutions."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#macroprudential-regulations",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#macroprudential-regulations",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Macroprudential regulations",
    "text": "Macroprudential regulations\n\nFocus:\n\nAims at the stability of the financial system as a whole.\n\nObjectives:\n\nPrevent systemic risks and financial crises that affect the entire economy.\nReduce financial system vulnerabilities from interconnectedness and procyclical tendencies.\n\nMethods:\n\nImplementing caps on overall credit growth and sector-specific loan concentrations.\nUsing stress tests that simulate adverse economic scenarios to gauge system-wide resilience.\nApplying countercyclical capital buffers that increase during economic booms and decrease during downturns."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#international-banking-regulatory-framework",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#international-banking-regulatory-framework",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "International banking regulatory framework",
    "text": "International banking regulatory framework\nThe Bank for International Settlements (BIS) established in 1930 is the principal centre for international central bank cooperation.\n\nWW2 to 1970s: implementing and defending the Bretton Woods system.\n1970s to 80s: managing cross-border capital flows following oil crises and the international debt crisis.\n1988 Basel Capital Accord and Basel II revision of 2001 to 2006: establishing and revising international standards for capital adequacy.\nPost-GFC: Basel III, a set of reforms designed to improve the regulation, supervision, and risk management of banks.\nNow: development of Basel IV (Basel 3.1)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia",
    "text": "Banking regulators in Australia\nThe Council of Financial Regulators (CFR) coordinates main financial regulatory agencies in Australia, including:1\n\nReserve Bank of Australia (RBA), chairs the Council\nAustralian Prudential Regulation Authority (APRA)\nAustralian Securities & Investments Commission (ASIC)\nDepartment of Treasury (the Treasury)\n\nCFR is non-statutory and has no regulatory functions."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia---rba",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia---rba",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia - RBA",
    "text": "Banking regulators in Australia - RBA\n\n\nFigure 6: Evolution of the RBA"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia---rba-1",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia---rba-1",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia - RBA",
    "text": "Banking regulators in Australia - RBA\nRBA is the central bank of Australia.\n\nIts duty is to contribute to the stability of the currency, full employment, and the economic prosperity and welfare of the Australian people.\nIt does this by conducting monetary policy to meet an agreed inflation target, working to maintain a strong financial system and efficient payments system, and issuing the nation’s banknotes.\n\nThe role and functions of the RBA explained by the Governor Michele Bullock [Video]."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia---apra",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia---apra",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia - APRA",
    "text": "Banking regulators in Australia - APRA\nAPRA, established in 1998, is an independent statutory authority that supervises institutions across banking, insurance and superannuation, and is accountable to the Australian Parliament.\nAPRA’s primary functions and objectives include:\n\nPrudential Supervision: APRA sets prudential standards and practices for financial institutions to maintain stability and prevent systemic failures. This includes regulations on capital adequacy, risk management, and governance.\nFinancial Stability: APRA contributes to the overall stability of the financial system by monitoring and mitigating risks that could lead to financial crises.\nProtection of Depositors, Policyholders, and Superannuation Fund Members: APRA ensures that institutions meet their financial promises to customers, protecting their interests and enhancing confidence in the financial system."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia---asic",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia---asic",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia - ASIC",
    "text": "Banking regulators in Australia - ASIC\nASIC is Australia’s corporate, markets, and financial services regulator.\n\nResponsible for market integrity and consumer protection across the financial system.\nSets standards for financial market behaviour with the aim to protect investor and consumer confidence.\nAdministers the Corporations Law to promote honesty and fairness in companies and markets."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia---treasury",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-australia---treasury",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Australia - Treasury",
    "text": "Banking regulators in Australia - Treasury\nThe Department of the Treasury (Treasury) also plays a role in the formulation and implementation of banking regulations in Australia.\n\nPolicy Development: Treasury works closely with regulatory bodies like the Reserve Bank of Australia (RBA), Australian Prudential Regulation Authority (APRA), and Australian Securities & Investments Commission (ASIC) to develop policies that ensure the stability and integrity of the banking system.\nLegislative Framework: It is involved in drafting and implementing legislation related to banking regulation, such as the Banking Act and financial sector reforms."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-the-u.s.",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-the-u.s.",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in the U.S.",
    "text": "Banking regulators in the U.S.\nSome important ones include:\n\nFederal Reserve System (The Fed): central bank of the United States.\nOffice of the Comptroller of the Currency (OCC): charters, regulates, and supervises all national banks and federal savings associations.\nFederal Deposit Insurance Corporation (FDIC): insures deposits at banks and thrift institutions, supervises financial institutions, and manages receiverships of failed banks."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-china",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-china",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in China",
    "text": "Banking regulators in China\nSome important ones include:\n\nPeople’s Bank of China (PBOC): central bank of China.\nNational Administration of Financial Regulation (NAFR): established in May 2023, replaced the former China Banking and Insurance Regulatory Commission (CBIRC)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-europe",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#banking-regulators-in-europe",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Banking regulators in Europe",
    "text": "Banking regulators in Europe\nSome important ones include:\n\nEuropean Central Bank (ECB): oversees monetary policy for the Eurozone and supervises significant banks within member states to ensure financial stability.\nEuropean Banking Authority (EBA): develops regulatory standards and guidelines to maintain the stability and integrity of the EU’s banking sector, coordinating efforts among national regulators.\nEuropean Systemic Risk Board (ESRB): monitors and assesses systemic risks."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#suggested-readings",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nHistory of BIS\nOrigins of the Reserve Bank of Australia\nBasel Framework - Risk-based Capital Requirements (RBC), RBC25 Boundary between the banking book and the trading book\nBanks’ funding costs and lending rates\nFDIC bank failures\nAbout APRA\nASIC website\nMoU between the Treasury and the APRA"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week2/index.html#references",
    "href": "teaching/AFIN8003/2025S1/Week2/index.html#references",
    "title": "AFIN8003 Week 2 - Risks and Regulation",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nBernanke, Ben S. 1983. “Nonmonetary Effects of the Financial Crisis in the Propagation of the Great Depression.” The American Economic Review 73 (3): 257–76.\n\n\nDiamond, Douglas W., and Philip H. Dybvig. 1983. “Bank Runs, Deposit Insurance, and Liquidity.” Journal of Political Economy 91 (3): 401–19.\n\n\nSalop, Steven C. 1979. “Monopolistic Competition with Outside Goods.” The Bell Journal of Economics 10 (1): 141."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#defining-capital",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#defining-capital",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Defining “capital”",
    "text": "Defining “capital”\nUnderstanding how capital safeguards a financial institution (FI) from insolvency risk requires a clear definition of capital. However, definitions vary significantly across different perspectives:\n\nEconomist’s Perspective: Economists define an FI’s capital, or owners’ equity, as the difference between the market values of its assets and liabilities, also known as net worth. This concept aligns with market value accounting.\nAccounting Perspective: Accountants typically focus on book value, which is the historical cost of assets minus liabilities as recorded in financial statements.\nRegulatory Perspective: Regulatory bodies have crafted definitions of capital that may diverge from economic net worth to prioritize financial stability. Regulatory capital requirements often rely on historical or book value accounting concepts.\n\nRegulatory capital includes various tiers (e.g., Tier 1 and Tier 2) and is used to assess capital adequacy."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#capital-of-financial-institutions-fis",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#capital-of-financial-institutions-fis",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital of financial institutions (FIs)",
    "text": "Capital of financial institutions (FIs)\nThe major functions of capital are\n\nto absorb unanticipated losses to enable the FI to continue as a going-concern\nto protect uninsured depositors, bondholders and creditors in case of insolvency and liquidation\nto protect FI insurance funds and the taxpayer\nto protect the FI owners against increases in insurance premiums\nto partially fund the FI’s real investment activities\n\n\n\n\n\n\n\n\nWhy is capital important in a regulatory context? APRA’s explanation of capital\n\n\nFrom a prudential regulator’s perspective, capital is a measure of the financial cushion available to an institution to absorb any unexpected losses it experiences in running its business. For a bank, such losses might include loans that default and are written off. Insurers might be hit by an unexpectedly high volume of claims in the wake of a major natural disaster.\n\n\n\n\nSufficient capital levels\n\ninspire confidence in the FI\nenable the FI to continue as a going concern even in difficult times"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#example-of-bank-net-worth-capital-absorbing-losses",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#example-of-bank-net-worth-capital-absorbing-losses",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Example of bank net worth (capital) absorbing losses",
    "text": "Example of bank net worth (capital) absorbing losses\nThe marking-to-market method allows balance sheet values to reflect current rather than historic prices.\nConsider the following market value balance sheet of an FI:\n\n\n\n\n\nTable 1: Market-value-based balance sheet before loan losses\n\n\n\n\n\nAssets ($m)\nAmount\nLiabilities ($m)\nAmount\n\n\n\n\nSecurities\n70\nDeposits\n85\n\n\nLoans\n30\nNet worth\n15\n\n\nTotal assets\n100\nTotal liabilities + equity\n100\n\n\n\n\n\n\n\n\nIn this example the FI is solvent on a market value basis."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#example-of-bank-net-worth-capital-absorbing-losses-1",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#example-of-bank-net-worth-capital-absorbing-losses-1",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Example of bank net worth (capital) absorbing losses",
    "text": "Example of bank net worth (capital) absorbing losses\nThe marking-to-market method allows balance sheet values to reflect current rather than historic prices.\nConsider a fall in the market value of loans to $10 (a fall of $20m).\n\n\n\n\n\nTable 2: Market-value-based balance sheet after loan losses\n\n\n\n\n\nAssets ($m)\nAmount\nLiabilities ($m)\nAmount\n\n\n\n\nSecurities\n70\nDeposits\n85\n\n\nLoans\n10\nNet worth\n-5\n\n\nTotal assets\n80\nTotal liabilities + equity\n80\n\n\n\n\n\n\n\n\nFI is now insolvent, its net worth has declined from $15 to -$5. The owners’ net worth stake has been completely wiped out.\n\nAfter the liquidation of the remaining $80 in assets, depositors would get only 80/85 in dollars, without deposit insurance.\n\n\nThe FI’s capital is used to absorb (partially) the losses.\n\n\nThe example also shows that market valuation of the balance sheet produces an economically accurate picture of the net worth and thus the solvency position of an FI."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#the-book-value-of-capital",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#the-book-value-of-capital",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "The book value of capital",
    "text": "The book value of capital\nHowever, the FI’s balance sheet based on book value could remain unchanged.\n\n\n\nTable 3: Book-value-based balance sheet after loan losses\n\n\n\n\n\nAssets ($m)\nAmount\nLiabilities ($m)\nAmount\n\n\n\n\nSecurities\n70\nDeposits\n85\n\n\nLoans\n30\nNet worth\n15\n\n\nTotal assets\n100\nTotal liabilities + equity\n100\n\n\n\n\n\n\nNote that Table 3 looks identical to Table 1.\nWith book value accounting, FIs have discretion in how and when they report loan losses on their balance sheets.\nThis flexibility allows them to strategically manage the recognition of these losses and their subsequent effect on capital.\n\nFor example, the FI could just record an increase in loan loss provisions to reflect their expected loan losses (e.g., $5m).\n\n\n\nTable 4: Book-value-based balance sheet with loan loss provisions\n\n\n\n\n\n\n\n\n\n\n\nAssets ($m)\nAmount\nLiabilities ($m)\nAmount\n\n\n\n\nSecurities\n70\nDeposits\n85\n\n\nLoans\n30\nNet worth\n10\n\n\nless loan loss provisions\n(5)\n\n\n\n\nTotal assets\n95\nTotal liabilities + equity\n95"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#market-value-vs-book-value-of-equity",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#market-value-vs-book-value-of-equity",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Market-value vs book-value of equity",
    "text": "Market-value vs book-value of equity\nObviously, market-value-based view of capital allows for a more accurate and comprehensive description of FIs’ financial health.\n\nIf regulators close a FI before it’s market value of capital reaches zero, liability holders will not lose.\n\nBut not all assets and liabilities are valued as fair value (market value).\n\n\n\n\n\n\nNote\n\n\n\nThe Financial Accounting Standards Board (FASB) sets out Financial Accounting Standards (FAS) and the Generally Accepted Accounting Principles (GAAP), adopted in the U.S.\nThe International Accounting Standards Board (IASB) sets out the International Financial Reporting Standards (IFRS), adopted in many other places.\n\n\n\n\nAll trading assets, marketable securities (“available for sale”) are marked to market.\nLoans and debt securities held for investment or to maturity are carried at amortized cost (book value).\n\n\n\n\n\n\nTip\n\n\nRecall a bank’s banking book and trading book."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#why-not-market-value-for-all",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#why-not-market-value-for-all",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Why not market value for all?",
    "text": "Why not market value for all?\n\nDifficult to implement, especially for small banks, building societies and credit unions with large amounts of non-traded assets\nIntroduces unnecessary variability into an FI’s earnings\nFIs are less willing to take long-term asset exposures such as commercial mortgages and business loans, since long-term assets are more interest rate sensitive.\n\n\n\n\nExample balance sheet of a bank\n\n\n\n\n\n\n\n\nAssets ($m)\nAmount\nLiabilities ($m)\nAmount\n\n\n\n\nCash\n20\nDeposits\n80\n\n\n10-yr 5% corporate loans\n100\nNet worth\n40\n\n\nTotal assets\n120\nTotal liabilities + equity\n120\n\n\n\nChange in market conditions (like yield) can cause significant variation in bank’s capital value.\n\n\n\n\n\nCode\nviewof cash = Inputs.range(\n    [0, 100],\n    {value: 20, step: 1, label:\"Cash:\"}\n)\nviewof capital = Inputs.range(\n    [0, 100],\n    {value: 40, step: 1, label:\"Initial capital:\"}\n)\nd = {\n  const c = 0.05, m = 10;\n  const loan = 100;\n  const y = 0.05;\n  function pv(c, f, t, r) {\n    return c * (1 - (1+r)**(-t)) / r + f / (1+r)**(t)\n  }\n  const prices = {\"YTM\": [], \"Equity\": []};\n  let coupon = loan * c;\n  let deposits = 120 - capital;\n  for (let ytm = 0.01; ytm &lt; 20; ytm++) {\n    let mvloan = pv(coupon, loan, m, ytm/100);\n    let dy = ytm - y*100;\n    prices[\"YTM\"].push(dy);\n    prices[\"Equity\"].push(cash + mvloan - deposits);\n  }\n  return prices;\n}\n\nPlot.plot({\n  caption: \"Assume current YTM of 5%.\",\n  x: {padding: 0.4, label: \"Change in YTM (%)\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0]),\n    Plot.ruleX([0]),\n    Plot.lineY(transpose(d), {x: \"YTM\", y: \"Equity\", stroke: \"blue\"}),\n  ]\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAs a result, market value accounting may interfere with FIs’ special functions as lenders and monitors and may even result in (or accentuate) a major credit crunch."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#capital-management-and-regulation",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#capital-management-and-regulation",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital management and regulation",
    "text": "Capital management and regulation\nIn summary,\n\ncapital is useful to absorb losses and to mitigate insolvency risk;\nregulators use book value accounting standards to determine the adequate capital requirements for FIs.\n\nAs a result, FI’s capital is guided by two key factors:\n\nregulated capital adequacy requirements, and\nthe risk-return trade-offs."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#who-determines-the-capital-requirements",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#who-determines-the-capital-requirements",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Who determines the capital requirements?",
    "text": "Who determines the capital requirements?\nActual capital ratios applied can be country-specific, determined by national regulators. However, the Basel Accords provide the global framework for these capital ratios.\n\nThe Basel Committee on Banking Supervision (BCBS) of the BIS sets out the 1988 Basel Capital Accord.\nMember countries of the BIS agreed and implemented the Basel Capital Accord (Basel I).\n\na minimum ratio of capital to risk-weighted assets of 8%.\n\nA series of updates led to the Basel Accord of 2006 (Basel II)\nBasel III: responding to the 2007-09 financial crisis."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#basel-i",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#basel-i",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Basel I",
    "text": "Basel I\nTwo capital ratios:\n\nTier 1 Capital Ratio\n\nPrimarily composed of common equity, retained earnings, and disclosed reserves, less goodwill and other intangibles.\nCalculation: Tier 1 Capital / Risk-Weighted Assets (RWA)\nMinimum requirement: 4%\n\nTotal Capital Ratio\n\nMinimum requirement: 8%\n\n\nFeatures:\n\nBasel I introduced the systematic measurement of capital adequacy through the use of risk-weighted assets.\nBasel I utilized RWA to account for the varying risk levels of different asset classes, including both on-balance-sheet and off-balance-sheet exposures.\n\nCriticisms:\n\nCredit Risk Focus: Basel I primarily recognized credit risk in the calculation of risk-weighted assets. It did not initially incorporate market risk or operational risk, leading to criticisms that it did not fully address the spectrum of risks faced by banks.1\n\nA revision in 1998 incorporated market risk into the framework."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#basel-ii",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#basel-ii",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Basel II",
    "text": "Basel II\nBasel II comprised three pillars:\n\nminimum capital requirements, which sought to develop and expand the standardised rules set out in the 1988 Accord\nsupervisory review of an institution’s capital adequacy and internal assessment process\neffective use of disclosure as a lever to strengthen market discipline and encourage sound banking practices\n\n\nThe measurement of capital did not change markedly in Basel II.\nThe measurement of risk was significantly enhanced to include operational risk, some market risks in the banking book, and risks associated with securitisation.\n\nUnder Basel II, two options are allowed for banks to measure their credit risk:\n\nStandardized approach. Similar to Basel I, but more risk-sensitive.\nInternal ratings-based (IRB) approach. Banks can use their internal rating system or credit scoring models to assess their portfolios, subject to regulatory approval.\n\nThree options are available for measuring operational risk:\n\nbasic indicator.\nstandardized approach.\nadvanced measurement approach."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#gfc-and-basel-2.5",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#gfc-and-basel-2.5",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "GFC and Basel 2.5",
    "text": "GFC and Basel 2.5\nThe Global Financial Crisis (GFC) in 2007-09 revealed that Basel II was flawed. For example,\n\ncredit ratings of complex securities were conducted by private companies without regulatory supervision or review\nBasel II capital adequacy formula was procyclical, meaning that the required capital was increasing as the crisis unfolded, making it even harder for banks during crisis\n\nIn response, Basel 2.5 was passed in 2009 (effective in 2013) and Basel III was passed in 2010 (phased in between 2013 and 2019).1\n\nBasel 2.5 updated capital requirements on market risk from banks’ trading activities.\n\nBasel III framework was revised and finalized in 2017 and the implementation was extended to January 1, 2022."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#basel-iii",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#basel-iii",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Basel III",
    "text": "Basel III\nBasel III is broader in perspective than just a revision of capital, capital adequacy, risk measurement and supervision. It introduced macroprudential measures, targeting the protection of the whole financial system.\nThree pillars similar to in Basel II, but with significant enhancements.\n\nImprovements to both standardized and IRB approaches in calculating adequate capital.\nInclusion of new capital conversion buffer and countercyclical capital buffer to the minimum required capital level.\nIntroduction of two minimum standards for funding liquidity: liquidity coverage ratio and net stable funding ratio.1\nHigher capital requirements for trading and derivative activities.\nEnhanced bank governance.\nEnhanced risk disclosure.\n\n\n\n\n\n\n\nNote\n\n\nBasel III is our focus, of course.\n\n\n\nThese liquidity ratios are discussed in Week 10 Liability and Liquidity Management."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#risk-based-capital-ratio-1",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#risk-based-capital-ratio-1",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-based capital ratio",
    "text": "Risk-based capital ratio\nUnder Basel III, depositary institutions (DIs) calculate and monitor four capital ratios:\n\n\n\nCommon equity Tier 1 (CET1) risk-based capital ratio \\[\n\\text{CET1 capital ratio} = \\frac{\\text{CET1 capital}}{\\text{Risk-weighted assets}}\n\\qquad(1)\\]\nTier 1 risk-based capital ratio \\[\n\\text{Tier 1 capital ratio} = \\frac{\\text{Tier 1 capital}}{\\text{Risk-weighted assets}}\n\\qquad(2)\\]\nTotal risk-based capital ratio \\[\n\\text{Total capital ratio} = \\frac{\\text{Total capital}}{\\text{Risk-weighted assets}}\n\\qquad(3)\\]\nTier 1 leverage ratio \\[\n\\text{Tier 1 leverage ratio} = \\frac{\\text{Tier 1 capital}}{\\text{Total exposure}}\n\\qquad(4)\\]\n\n\n\nThe calculation of these capital ratios is complex.\nUse risk-weighted assets (RWA) to distinguish the different credit risks of different assets.\nMeasure a DI’s credit risk (on-and off-balance-sheet).\n\n\n\n\n\n\n\nImportant\n\n\n\nAdditional capital charges for market risk and operational risk.\n\nFor now, we do not consider these risks and their impact on RWA.\nWe briefly explain how they affect RWA and capital ratios at the end of this lecture."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#standardized-and-irb-approaches-for-credit-risk",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#standardized-and-irb-approaches-for-credit-risk",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Standardized and IRB approaches for credit risk",
    "text": "Standardized and IRB approaches for credit risk\nSince Basel II, two options are available for banks to measure credit risk for calculating capital requirements.\n\nThe standardized approach.\n\nUsed by smaller depositary institutions.\n\nThe internal ratings-based (IRB) approach.\n\nUsed by large depositary institutions.\n\nUS: about 20 of the largest banking institutions with consolidated assets of $250 billion or more.1\nAustralia: currently approved for use by 6 of the largest banks in Australia.\n\n\n\nOr with consolidated on-balance-sheet foreign exposures of $10 billion or more."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#capital-ratios-of-dis-in-australia",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#capital-ratios-of-dis-in-australia",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital ratios of DIs in Australia",
    "text": "Capital ratios of DIs in Australia\n\n\n\n\n\n\n\n\nFigure 1: Capital ratios of DIs in Australia over time\n\n\n\n\n\n\n\n\n\n\nFigure 2: Capital ratios of DIs in Australia at December 2023"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#type-of-capital-cet1-capital",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#type-of-capital-cet1-capital",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Type of capital: CET1 Capital",
    "text": "Type of capital: CET1 Capital\nCET1 is the primary or core capital of a DI.\n\nCommon shares\nShare premium resulting from the issue of CET1 instruments\nRetained earnings\nAccumulated and other comprehensive income\nOther disclosed reserves\nCertain minority interests\nRegulatory adjustment applied in the calculation of CET1 Capital."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#type-of-capital-tier-1-capital",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#type-of-capital-tier-1-capital",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Type of capital: Tier 1 Capital",
    "text": "Type of capital: Tier 1 Capital\nTier 1 Capital is the sum of CET1 Capital and Additional Tier 1 Capital.\nAdditional Tier 1 Capital:\n\nInstruments issued by a DI that qualify for Additional Tier 1 Capital and are not included in CET1 capital.1\nShare premium resulting from the issue of instruments included in Additional Tier 1 Capital.2\nTier 1 minority interest not included CET1 capital.\nRegulatory adjustments applied in the calculation of Additional Tier I Capital.\n\nFor example, noncumulative perpetual preferred stock.In Table 21-3 of the textbook Saunders, Cornett, and Erhemjamts (2023), this entry incorrectly reads “Stock surplus (share premium) resulting from the issue of instruments included in Common Equity Tier I”. See page 15 of the original BIS publication “Basel III: A Global Regulatory Framework for More Resilient Banks and Banking Systems”, June 2011."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#type-of-capital-total-capital",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#type-of-capital-total-capital",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Type of capital: Total Capital",
    "text": "Type of capital: Total Capital\nTotal Capital is the sum of Tier 1 and Tier 2 capitals, where Tier 2 Capital is supplementary capital.\nTier 2 Capital:\n\nInstruments issued by a DI that qualify for Tier 2 Capital and are not included in Tier 1 capital.1\nShare premium resulting from the issue of instruments included in Tier 2 Capital.2\nTier 2 minority interest not included Tier 1 capital.\nCertain loan loss provisions.\nRegulatory adjustments applied in the calculation of Tier 2 Capital.\n\nIt includes secondary “equity-like” capital resources, for example, loan loss reserves and some convertible and subordinated debt instruments.In Table 21-3 of the textbook Saunders, Cornett, and Erhemjamts (2023), this entry incorrectly reads “Stock surplus (share premium) resulting from the issue of instruments included in Tier I capital”. See page 17 of the original BIS publication “Basel III: A Global Regulatory Framework for More Resilient Banks and Banking Systems”, June 2011."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#capital-adequacy-framework",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#capital-adequacy-framework",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital adequacy framework",
    "text": "Capital adequacy framework\n\nCredit risk\n\nThe risk-based capital ratios as described earlier.\n\nInterest rate risk\n\nNo formal add on yet.\n\nMarket risk\n\nAdditional capital charge.\n\nOperational risk\n\nAdditional capital charge."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#minimum-required-capital-adequacy-ratios",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#minimum-required-capital-adequacy-ratios",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Minimum required capital adequacy ratios",
    "text": "Minimum required capital adequacy ratios\nThe minimum required capital ratios: \\[\n\\begin{aligned}\n\\text{CET1 capital ratio} &= \\frac{\\text{CET1 capital}}{\\text{Risk-weighted assets}} \\ge 4.5\\% \\\\\n\\text{Tier 1 capital ratio} &= \\frac{\\text{Tier 1 capital}}{\\text{Risk-weighted assets}} \\ge 6\\% \\\\\n\\text{Total capital ratio} &= \\frac{\\text{Total capital}}{\\text{Risk-weighted assets}} \\ge 8\\% \\\\\n\\text{Tier 1 leverage ratio} &= \\frac{\\text{Tier 1 capital}}{\\text{Total exposure}} \\ge 4\\%\n\\end{aligned}\n\\qquad(5)\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#overview-of-capital-ratios-calculation",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#overview-of-capital-ratios-calculation",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Overview of capital ratios calculation",
    "text": "Overview of capital ratios calculation\n\nCalculate the amount of capital (CET1, Tier 1, Total Capital).\nCalculate the risk-weighted assets (RWA)1: sum of the amount of each asset multiplied by a risk weight specific to its riskiness.\n\nOn-balance-sheet:\n\nEach asset has a risk weight\nMultiply the asset by the corresponding risk weight\n\nOff-balance-sheet:\n\nConvert each asset to an on-balance-sheet equivalent\nMultiply the equivalent exposure by the corresponding risk weight\n\nSum the on-balance-sheet and off-balance-sheet RWA\n\nCalculate the capital ratios based on the amount of capital and RWA.\n\nOn- and off-balance-sheet assets whose values are adjusted for approximate credit risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#capital-ratios-calculation-risk-weighted-assets",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#capital-ratios-calculation-risk-weighted-assets",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital ratios calculation: risk-weighted assets",
    "text": "Capital ratios calculation: risk-weighted assets\nWe will use an example to showcase how to calculate risk-weighted assets.\n\nBalance sheet itemsOff-balance-sheet items\n\n\n\n\n\nAsset type\n$ million\n\n\n\n\nCash, Australian Treasury Bonds and deposits at the RBA\n20\n\n\nLocal government bonds, S&P rating of AA-\n10\n\n\nLoans to other Australian banks, S&P rating of BBB+\n5\n\n\nStandard eligible residential mortgages\n40\n\n\nCorporate loans, S&P rating of BB- to BBB+\n25\n\n\nCorporate loans, S&P rating of B+ or lower\n20\n\n\n\n\n\n\n\n\nOBS item\n$ million\n\n\n\n\nContingencies and guarantees\n\n\n\nTwo-year loan commitment\n80\n\n\nStandby letter of credit\n10\n\n\nCommercial letter of credit\n50\n\n\nMarket contracts and derivatives\n\n\n\nFour-year fixed–floating interest rate swap\n100\n\n\nTwo-year forward foreign exchange contract\n40"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-on-balance-sheet",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-on-balance-sheet",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: on-balance-sheet",
    "text": "Risk-weighted assets: on-balance-sheet\nConsider the following example balance sheet of a DI.\nWe want to calculate its on-balance-sheet RWA.\n\n\n\n\nTable 5: Example balance sheet of a DI\n\n\n\n\n\nAsset type\n$ million\n\n\n\n\nCash, Australian Treasury Bonds and deposits at the RBA\n20\n\n\nLocal government bonds, S&P rating of AA-\n10\n\n\nLoans to other Australian banks, S&P rating of BBB+\n5\n\n\nStandard eligible residential mortgages\n40\n\n\nCorporate loans, S&P rating of BB- to BBB+\n25\n\n\nCorporate loans, S&P rating of B+ or lower\n20"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-on-balance-sheet-1",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-on-balance-sheet-1",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: on-balance-sheet",
    "text": "Risk-weighted assets: on-balance-sheet\nNow map the assets’ risk weights.1\n\n\n\n\nTable 6: Example balance sheet of a DI with risk weights\n\n\n\n\n\n\n\n\n\n\nAsset type\n$ million\nRisk weight\n\n\n\n\nCash, Australian Treasury Bonds and deposits at the RBA\n20\n0%\n\n\nLocal government bonds, S&P rating of AA-\n10\n20%\n\n\nLoans to other Australian banks, S&P rating of BBB+\n5\n100%\n\n\nStandard eligible residential mortgages\n40\n35%\n\n\nCorporate loans, S&P rating of BB- to BBB+\n25\n100%\n\n\nCorporate loans, S&P rating of B+ or lower\n20\n150%\n\n\n\n\n\n\n\nEach asset is assigned to one of several categories of credit risk exposure. The risk weight for each category is determined in the Basel III."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-on-balance-sheet-2",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-on-balance-sheet-2",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: on-balance-sheet",
    "text": "Risk-weighted assets: on-balance-sheet\nCalculate the risk-weighted value for each asset.\n\n\n\n\nTable 7: Example balance sheet of a DI with risk-weighted assets\n\n\n\n\n\n\n\n\n\n\n\nAsset type\n$ million\nRisk weight\nRisk-weighted value\n\n\n\n\nCash, Australian Treasury Bonds and deposits at the RBA\n20\n0%\n0\n\n\nLocal government bonds, S&P rating of AA-\n10\n20%\n2\n\n\nLoans to other Australian banks, S&P rating of BBB+\n5\n100%\n5\n\n\nStandard eligible residential mortgages\n40\n35%\n14\n\n\nCorporate loans, S&P rating of BB- to BBB+\n25\n100%\n25\n\n\nCorporate loans, S&P rating of B+ or lower\n20\n150%\n30"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-on-balance-sheet-3",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-on-balance-sheet-3",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: on-balance-sheet",
    "text": "Risk-weighted assets: on-balance-sheet\nCalculate the total risk-weighted assets.\n\n\n\n\nTable 8: Total RWA for on-balance-sheet assets\n\n\n\n\n\n\n\n\n\n\n\nAsset type\n$ million\nRisk weight\nRisk-weighted value\n\n\n\n\nCash, Australian Treasury Bonds and deposits at the RBA\n20\n0%\n0\n\n\nLocal government bonds, S&P rating of AA-\n10\n20%\n2\n\n\nLoans to other Australian banks, S&P rating of BBB+\n5\n100%\n5\n\n\nStandard eligible residential mortgages\n40\n35%\n14\n\n\nCorporate loans, S&P rating of BB- to BBB+\n25\n100%\n25\n\n\nCorporate loans, S&P rating of B+ or lower\n20\n150%\n30\n\n\nTotal RWA\n\n\n76"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-off-balance-sheet-obs",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-off-balance-sheet-obs",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: off-balance-sheet (OBS)",
    "text": "Risk-weighted assets: off-balance-sheet (OBS)\nTwo-Step Process:\n\nThe notional amount of each OBS item is first converted into an on-balance-sheet equivalent, credit equivalent amount (CEA).\n\nThe CEA is determined by multiplying the notional amount by a credit conversion factor (CCF).\nCCF under Basel III.\nIn Australia, CCFs are specified in APRA’s APS 112. \n\nThe resulting CEA must be multiplied by the appropriate risk weight (same as those used for on-balance-sheet assets).\n\nTreatments differ for\n\nOBS guaranty-type contracts and contingent contracts, e.g., letters of credit\nderivative and market contracts, e.g., interest rate forward, option, and swap contracts"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-obs-contingent-guaranty-contracts",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-obs-contingent-guaranty-contracts",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: OBS contingent guaranty contracts",
    "text": "Risk-weighted assets: OBS contingent guaranty contracts\nConsider the following example off-balance-sheet items of a DI. We want to calculate its RWA.\nFirst, convert to on-balance-sheet CEA.1\n\n\n\nOBS item\nFace value ($ million)\nCCF\nCEA\n\n\n\n\nTwo-year loan commitment\n80\n0.4\n32\n\n\nStandby letter of credit\n10\n1\n10\n\n\nCommercial letter of credit\n50\n0.2\n10\n\n\n\nSecond, calculate RWA.2\n\n\n\nTable 9: Total RWA for OBS contingent guaranty contracts\n\n\n\n\n\n\n\n\n\n\n\nOBS item\nCEA\nRisk weight\nRisk-weighted value\n\n\n\n\nTwo-year loan commitment\n32\n20%\n6.4\n\n\nStandby letter of credit\n10\n20%\n2\n\n\nCommercial letter of credit\n10\n75%\n7.5\n\n\nTotal RWA\n\n\n15.9\n\n\n\n\n\n\nCCF for OBS contingent or guaranty contracts under Basel III.These risk weights are the same as those on-balance-sheet assets."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-obs-market-contracts-or-derivative-instruments",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-obs-market-contracts-or-derivative-instruments",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: OBS market contracts or derivative instruments",
    "text": "Risk-weighted assets: OBS market contracts or derivative instruments\nOBS market contracts and derivatives expose the DI also to counterparty risk.\nFirst, when converting to CEA, both potential future exposure and current exposure are considered.\n\nThe potential future exposure reflects the risk if a counterparty defaults in the future.\n\n\n\n\n\n\n\n\n\n\n\n\n\nType of Contract (remaining maturity)\nNotional Principal\n×\nPotential Exposure Conversion Factor\n=\nPotential Exposure\n\n\n\n\nFour-year fixed–floating interest rate swap\n$100 m\n×\n0.005\n=\n$0.5 m\n\n\nTwo-year forward foreign exchange contract\n$ 40 m\n×\n0.05\n=\n$2 m\n\n\n\n\n\nThe current exposure reflects the cost of replacing a contract if the counterparty defaults today.\n\n\n\n\n\n\n\n\n\n\nType of Contract (remaining maturity)\nReplacement Cost\nCurrent Exposure\n\n\n\n\nFour-year fixed–floating interest rate swap\n$3 m\n$3m\n\n\nTwo-year forward foreign exchange contract\n–$1 m\n$0m\n\n\n\n\nCEA = potential future exposure + current exposure\n\n\n\n\n\n\n\n\n\n\nType of Contract (remaining maturity)\nPotential Exposure\nCurrent Exposure\nCEA\n\n\n\n\nFour-year fixed–floating interest rate swap\n$0.5 m\n$3 m\n$3.5 m\n\n\nTwo-year forward foreign exchange contract\n$2 m\n$0\n$2 m\n\n\n\n\nSecond, calculate RWA. Under Basel III, the risk weight for OBS market contracts or derivative instruments is generally 100%.\n\nTotal RWA = \\(\\text{CEA} \\times \\text{risk weight} = \\text{CEA} \\times 100\\% = (3.5 + 2) \\times 100\\% = 5.5 (\\text{million})\\)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-on-and-off-balance-sheet",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#risk-weighted-assets-on-and-off-balance-sheet",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-weighted assets: on-and off-balance-sheet",
    "text": "Risk-weighted assets: on-and off-balance-sheet\nTotal RWA of the DI is the sum of on-balance-sheet and off-balance-sheet RWAs:\n\n\n\nTable 10: Total RWA (on-and off-balance-sheet)\n\n\n\n\n\nCategory\nRWA ($ million)\n\n\n\n\nOn-balance-sheet\n76\n\n\nOff-balance-sheet\n\n\n\n- contingencies and guarantees\n15.9\n\n\n- market contracts and derivatives\n5.5\n\n\nTotal RWA\n97.4"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#capital-ratios",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#capital-ratios",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital ratios",
    "text": "Capital ratios\nSuppose the DI’s liabilities and equity are listed below:\n\n\n\n\n\n\n\n\nLiabilities/Equity\nAmount ($ million)\nCapital class\n\n\n\n\nDemand deposits\n65\n\n\n\nCertificate of Deposits (CD)\n20\n\n\n\nSubordinated bonds\n8\nTier 2\n\n\nRetained earnings\n5\nCET1\n\n\nCommon stock\n20\nCET1\n\n\nNoncumulative perpetual preferred shares (qualifying)\n2\nAdditional Tier 1\n\n\n\nThe DI’s capital ratios are:\n\\[\n\\begin{aligned}\n\\text{CET1 capital ratio} &= \\frac{\\text{CET1 capital}}{\\text{Risk-weighted assets}}  = \\frac{25}{97.4} = 25.67\\% \\ge 4.5\\% \\\\\n\\text{Tier 1 capital ratio} &= \\frac{\\text{Tier 1 capital}}{\\text{Risk-weighted assets}} = \\frac{25+2}{97.4} = 27.72\\% \\ge 6\\% \\\\\n\\text{Total capital ratio} &= \\frac{\\text{Total capital}}{\\text{Risk-weighted assets}} = \\frac{27+8}{97.4} = 35.93\\% \\ge 8\\%\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\nCapital ratios of Australian banks\n\n\nFigure 1 and Figure 2 show the capital ratios of Australian banks."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#capital-conversion-buffer-and-countercyclical-capital-buffer-ccyb",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#capital-conversion-buffer-and-countercyclical-capital-buffer-ccyb",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Capital conversion buffer and countercyclical capital buffer (CCyB)",
    "text": "Capital conversion buffer and countercyclical capital buffer (CCyB)\nBasel III introduced two buffers, capital conversion buffer and countercyclical capital buffer, to the minimum required capital level.\nCapital conversion buffer:\n\n2.5% of risk weighted assets comprised of CET1 only\nDI to hold minimum of 7% common equity Tier 1 (minimum of 4.5% plus conservation buffer of 2.5%)\nIf a DI’s capital conservation buffer falls below 2.5%, constraints are imposed on the DI’s distributions (e.g. dividends and bonuses)\n\nCCyB:\n\nMay be declared by a country experiencing excess aggregate credit growth\nVary between 0 and 2.5% of risk-weighted assets comprised of CET1 only\nIf a DI’s CCyB falls below the set level, constraints are imposed on the DI’s distributions (e.g. dividends and bonuses)\n\n\n\n\n\n\n\n\nExample\n\n\nSuppose that a 2.5% capital conversion buffer currently applies and CCyB is 0, then the required CET1 capital ratio becomes 4.5%+2.5% = 7%.\nIf a bank’s CET1 capital ratio is 7.5%, it will receive no restrictions on its dividends payout, share buybacks, etc.\n\n\n\n\n\n\n\n\n\n\n\nExample\n\n\nSuppose that a 2.5% capital conversion buffer and a 1.5% CCyB currently apply, then the required CET1 capital ratio becomes 4.5%+2.5%+1.5% = 8.5%.\nIf a bank’s CET1 capital ratio is 7.5%, it will receive restrictions on its dividends payout, share buybacks, etc."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#global-systemically-important-banks-g-sibs",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#global-systemically-important-banks-g-sibs",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Global Systemically Important Banks (G-SIBs)",
    "text": "Global Systemically Important Banks (G-SIBs)\nUnder Basel III, additional capital surcharge applies on Global Systemically Important Banks (G-SIBs).\n\n1% to 3.5% in addition to the 7% minimum CET1 requirement (CET1 + capital conversion buffer).\na G-SIB must have at least 8.5% CET1 ratio to have no payment restriction.\n\nList of G-SIBs at November 2023."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#leverage-ratio",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#leverage-ratio",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Leverage ratio",
    "text": "Leverage ratio\nBasel III also introduced the Tier 1 leverage ratio to discourage the use of excessive leverage (recall Equation 5).\n\\[\n\\text{Tier 1 leverage ratio} = \\frac{\\text{Tier 1 capital}}{\\text{Total exposure (on-and off-balance-sheet)}} \\ge 4\\%\n\\]\n\nTotal exposure is equal to the DI’s total assets plus off-balance-sheet exposure.\nFor derivative securities, off-balance-sheet exposure is current exposure plus potential future exposure as described earlier.\nFor off-balance-sheet credit (loan) commitments, a conversion factor of 100 percent is applied unless the commitments are immediately cancelable."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#risk-based-capital-beyond-credit-risk",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#risk-based-capital-beyond-credit-risk",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-based capital: beyond credit risk",
    "text": "Risk-based capital: beyond credit risk\nSo far, the capital ratios (specifically, RWA) are calculated to account for the DI’s credit risk. However, a DI’s insolvency risk can also manifest from interest rate risk, market risk, operational risk, and more.\nIn Basel III, RWA should be the sum of three components:1\n\nRWA for credit risk (covered in this lecture)\nRWA for market risk. Can be calculated using two approaches:2\n\nStandardized approach proposed by regulators. Revised standards published in 2016 to be implemented in 2019.\nDI’s internal market risk model subject to regulator approval. Move towards expected shortfall rather than value at risk (VaR).\n\nRWA for operational risk. Some complicated calculation.3\n\n\n\n\n\n\n\nImportant\n\n\nThe RWA in the minimum capital ratios (Equation 5) is the sum of all three RWAs.\nWe covered only the RWA for credit risk.\n\n\n\nTo date, no formal add on has been required yet (development in progress).For details, see RBC20.9.For details, see RBC20.10."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#risk-based-capital-beyond-credit-risk-1",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#risk-based-capital-beyond-credit-risk-1",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Risk-based capital: beyond credit risk",
    "text": "Risk-based capital: beyond credit risk\nIn the previous example, we have calculated that the DI’s RWA (for credit risk) is $97.4 million.\nNow, suppose that we have also calculated that the DI’s\n\nRWA for market risk is $10.2 million, and\nRWA for operational risk is $9 million.\n\nThe total RWA is $97.4 + $10.2 + $9 = $116.6 million.\nThe DI’s capital ratios are actually:\n\\[\n\\begin{aligned}\n\\text{CET1 capital ratio} &= \\frac{\\text{CET1 capital}}{\\text{Risk-weighted assets}}  = \\frac{25}{116.6} = 21.44\\% \\ge 4.5\\% \\\\\n\\text{Tier 1 capital ratio} &= \\frac{\\text{Tier 1 capital}}{\\text{Risk-weighted assets}} = \\frac{25+2}{116.6} = 23.16\\% \\ge 6\\% \\\\\n\\text{Total capital ratio} &= \\frac{\\text{Total capital}}{\\text{Risk-weighted assets}} = \\frac{27+8}{116.6} = 30.02\\% \\ge 8\\%\n\\end{aligned}\n\\]\n\n\n\n\n\n\nNote\n\n\nIn this course, no assessment will be on the calculation of RWA for market risk or RWA for operational risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#rwa-of-australian-banks-in-2023",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#rwa-of-australian-banks-in-2023",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "RWA of Australian banks in 2023",
    "text": "RWA of Australian banks in 2023\n\n\n\nTable 11: RWA of Australian banks in 2023 (source: Capital IQ)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCBA\nWestpac\nNAB\nANZ\nMacquarie\n\n\n\n\nRWA for credit risk\n362,869\n339,758\n355,554\n349,041\n97,485\n\n\nRWA for market risk\n61,968\n51,676\n38,274\n41,967\n11,663\n\n\nRWA for operational risk\n43,155\n55,175\n41,178\n42,319\n15,828\n\n\nOther RWA\n0\n4,809\n0\n0\n0\n\n\nTotal RWA\n467,992\n451,418\n435,006\n433,327\n124,976"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#suggested-readings",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nThe Basel Committee\nHistory of the Basel Committee\n“Capital explained” by the APRA\nBIS - Calculation of minimum risk-based capital requirements (RBC20)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week3/index.html#references",
    "href": "teaching/AFIN8003/2025S1/Week3/index.html#references",
    "title": "AFIN8003 Week 3 - Capital Management and Adequacy",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nSaunders, Anthony, Marcia Millon Cornett, and Otgo Erhemjamts. 2023. Financial Institutions Management ISE. 11th ed. McGraw Hill."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#what-is-interest-rate-risk",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#what-is-interest-rate-risk",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "What is interest rate risk?",
    "text": "What is interest rate risk?\n\n\n\n\n\n\n\nInterest Rate Risk\n\n\nInterest rate risk is the possibility of a financial loss due to changes in interest rates.\n\n\n\n\nRecall that in Week 1, we explained one of the key functions performed by financial institutions (especially depositary institutions) is maturity transformation. For DIs, they take short-term deposits from depositors and make long-term loans to borrowers.\n\n\n\nTable 1: Typical balance sheet of a DI\n\n\n\n\n\nAssets\nLiabilities and Equity\n\n\n\n\nLoans (relatively long-term)\nDeposits (relatively short-term)\n\n\nOther assets\nOther liabilities\n\n\n\nEquity\n\n\n\n\n\n\nAs a result,\n\nThis maturity transformation means that FIs have mismatches of maturities of their liabilities (e.g., deposits) and assets (e.g., loans).\nMaturity mismatch exposes FIs to (unexpected) interest rate changes:\n\nrefinancing and reinvestment risks\nfinancial instruments have different levels of value sensitivity to interest rate changes\n\nInterest rate is volatile and can be unexpected."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#maturity-mismatch-refinancing-risk",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#maturity-mismatch-refinancing-risk",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Maturity mismatch: refinancing risk",
    "text": "Maturity mismatch: refinancing risk\nConsider an example bank that has $2 million of 10-year fixed-rate loans and $1 million of 1-year fixed-rate term deposits now. The bank expects to have the same balance sheet in the future.\nWhat would happen in 1 year from now?\n\nTerm deposits mature. Some deposits may be withdrawn.\nIn this case, the bank needs to take additional deposits to maintain the size of balance sheet.\nHowever, the interest rate (deposit rate) could be higher in the future, which means higher costs for the bank.\n\nThis is a typical refinancing risk - the costs of rolling over funds or re-borrowing funds will rise above the returns generated on investments."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#maturity-mismatch-reinvestment-risk",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#maturity-mismatch-reinvestment-risk",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Maturity mismatch: reinvestment risk",
    "text": "Maturity mismatch: reinvestment risk\nConsider another example bank that has $2 million of 1-year fixed-rate loans and $1 million of 2-year fixed-rate term deposits now. The bank expects to have the same balance sheet in the future.\nWhat would happen in 1 year from now?\n\nLoans mature.\nIn this case, the bank needs to reinvest into some other assets (e.g., make loans).\nHowever, the interest rate (on the loan) could be lower in the future, which means reduced returns for the bank.\n\nThis is a typical reinvestment risk - the returns on funds to be reinvested will fall below the cost of funds."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#financial-instruments-value-sensitivity-to-interest-rate",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#financial-instruments-value-sensitivity-to-interest-rate",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Financial instruments’ value sensitivity to interest rate",
    "text": "Financial instruments’ value sensitivity to interest rate\nThe value of longer-maturity instruments typically is more sensitive to interest rate.\n\n\nFor example, a bond’s price is given by\n\\[\nP = \\sum_{t=1}^T\\frac{C}{(1+r)^t} + \\frac{F}{(1+r)^T}\n\\qquad(1)\\]\nwhere \\(C\\) is coupon payment, \\(F\\) face value, \\(T\\) maturity, and \\(r\\) interest rate.\nIf a FI is financed by issuing long-term bonds and invests in short-term loans, given a change in interest rate, its liabilities’ value would change by more than the change in its assets’ value, thereby causing an impact on its net worth.\n\n\n\nCode\nviewof maturity4 = Inputs.range(\n  [1, 30], \n  {value: 15, step: 1, label: \"Maturity (years):\"}\n)\nviewof couponRate4 = Inputs.range(\n    [0.01, 0.2],\n    {value: 0.05, step: 0.01, label:\"Coupon rate:\"}\n)\nd = {\n  const f = 100;\n  let c, m;\n  c = couponRate4;\n  m = maturity4;\n  function pv(c, f, t, r) {\n    return c * (1 - (1+r)**(-t)) / r + f / (1+r)**(t)\n  }\n  const prices = {\"YTM\": [], \"Price\": []};\n  let coupon = f * c;\n  for (let ytm = 0.01; ytm &lt; 20; ytm++) {\n    let price = pv(coupon, f, m, ytm/100);\n    prices[\"YTM\"].push(ytm);\n    prices[\"Price\"].push(price);\n  }\n  return prices;\n}\n\ndata4 = transpose(d)\nPlot.plot({\n  caption: \"Assume $100 bond, annual coupons paid in arrears and effective annual discount rate.\",\n  x: {padding: 0.4, label: \"YTM (%)\"},\n  grid: true,\n  marks: [\n    Plot.ruleY([0, 100]),\n    Plot.ruleX([0]),\n    Plot.lineY(data4, {x: \"YTM\", y: \"Price\", stroke: \"blue\"}),\n  ]\n})"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-level-and-movement-of-interest-rates",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-level-and-movement-of-interest-rates",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The level and movement of interest rates",
    "text": "The level and movement of interest rates\n\n\nThe relative degree of interest rate volatility is directly linked to the monetary policy of the Reserve Bank of Australia (RBA).\n\nFor example, if RBA smooths or targets the level of interest rates, unexpected interest rate shocks and interest rate volatility tend to be small.\nA change in approach from targeting interest rate (cash rate) goals towards CPI growth rate increased the interest rate volatility.\n\nNo matter what, interest rate volatility exists and thus, the appropriate measurement of management of interest rate risk is important to every FI.\n\n\n\n\n\n\n\nFigure 1: Australian inflation target"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-level-and-movement-of-interest-rates-1",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-level-and-movement-of-interest-rates-1",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The level and movement of interest rates",
    "text": "The level and movement of interest rates\n\n\n\n\n\n\n\n\nFigure 2: Australian cash rate target\n\n\n\n\n\n\n\n\n\n\nFigure 3: Australian cash rate target and 90-day bill yield"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-level-and-movement-of-interest-rates-2",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-level-and-movement-of-interest-rates-2",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The level and movement of interest rates",
    "text": "The level and movement of interest rates\n\n\n\n\n\n\n\n\nFigure 4: 10-year Australian government bond yield\n\n\n\n\n\n\n\n\n\n\nFigure 5: Policy interest rates"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-market-is-bad-at-guessing-interest-rates",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-market-is-bad-at-guessing-interest-rates",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The market is bad at guessing interest rates",
    "text": "The market is bad at guessing interest rates\n\n\n\n\n\n\nFigure 6: The market does not always correctly forecast interest rates\n\n\n\nImage source: Steven Desmyter"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#interest-rate-risk-and-basel-framework",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#interest-rate-risk-and-basel-framework",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Interest rate risk and Basel framework",
    "text": "Interest rate risk and Basel framework\nAs discussed last week, the three pillars of Basel framework (since Basel II) include:\n\nminimum capital requirements\nsupervisory review\neffective use of disclosure (for market discipline)\n\nThe Pillar 1 involves a capital adequacy framework surrounding minimum ratios of various capital (CET1, Tier 1, Total) to RWA.\n\nThe RWA is sum of RWAs for credit risk, market risk, and operational risk.\nThere is currently no “RWA for interest rate risk”.\n\nThe Interest Rate Risk in the Banking Book (IRRBB) is part of the Basel capital framework’s Pillar 2 (and Pillar 3)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#interest-rate-risk-and-basel-framework-contd",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#interest-rate-risk-and-basel-framework-contd",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Interest rate risk and Basel framework (cont’d)",
    "text": "Interest rate risk and Basel framework (cont’d)\nBasel III guidelines address the issue of interest rate risk primarily through:\nInterest Rate Risk in the Banking Book (IRRBB)\n\nBasel III includes specific guidelines on managing Interest Rate Risk in the Banking Book (IRRBB). Banks are required to identify, measure, monitor, and control IRRBB. This involves regular stress testing, scenario analysis, and the application of appropriate capital charges to cover potential losses from adverse interest rate movements.\nStress Testing: Basel III mandates regular stress testing to evaluate the impact of significant changes in interest rates on a bank’s earnings and capital. Stress testing helps banks identify vulnerabilities and prepare for potential adverse scenarios.\n\nSupervisory Review Process (Pillar 2)\n\nUnder Pillar 2, banks are required to conduct internal assessments of their capital adequacy in relation to their risk profile, including interest rate risk in the banking book (IRRBB). Supervisors also review these assessments to ensure that banks are adequately managing and mitigating their interest rate risk.\n\nDisclosure Requirements (Pillar 3)\n\nUnder Pillar 3, Basel III enhances transparency by requiring banks to disclose their exposure to interest rate risk and the measures they take to manage it. This includes detailed reporting on the impact of interest rate changes on earnings and economic value."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#an-overview",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#an-overview",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "An overview",
    "text": "An overview\nFrom here, we’re to study specific models and technique for measuring FI’s interest rate risk. However, it is helpful to first explain the general rule so to better understand the big picture.\n\nA risk causes an unwanted negative impact on a FI. To measure such risk, we need to specify a few things:\n\nWhich FI’s characteristic are we concerned about? Income, net worth, or something else?\nHow sensitive is that FI’s characteristic to this risk?\nWhat is the potential size of this risk?\nIs it based on book value or market value?\nWhat is the time frame we are looking at?\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#interest-rate-risk-models",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#interest-rate-risk-models",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Interest rate risk models",
    "text": "Interest rate risk models\nThe rest of this lecture discusses two models for measuring interest rate risk with different focuses.\n\n\n\nTable 2: A simple comparison of two interest rate risk models\n\n\n\n\n\n\n\n\n\n\n\nRepricing model\nDuration model\n\n\n\n\nWhich characteristic?\nNet interest income (NII)\nNet worth\n\n\nSensitivity measurement?\nBy assumption\nDuration\n\n\nSize of risk?\nFlexible\nFlexible\n\n\nBook value or market value?\nBook value\nMarket value\n\n\nTime frame?\nFlexible\nFlexible"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-repricing-model",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-repricing-model",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The repricing model",
    "text": "The repricing model\n\nRepricing model is also known as the funding gap model.\n\nA book value accounting cash flow analysis of the repricing gap between the interest income earned on an FI’s assets and the interest paid on its liabilities over some period.\nFocus on the changes of net interest income (NII).\n\nA simple model used by small FIs.\nAPRA requires smaller ADIs to use the repricing method to estimate interest rate exposures in their banking book for capital adequacy purposes.\n\nA revision has just been completed in early July, 2024, which will be effective in 2025.1\n\n\nSee suggested readings."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#repricing-gap-rsa-and-rsl",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#repricing-gap-rsa-and-rsl",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Repricing gap, RSA and RSL",
    "text": "Repricing gap, RSA and RSL\nRepricing gap is the difference between rate-sensitive assets (RSA) and rate-sensitive liabilities (RSL).\n\nRSA: assets whose interest rates will be repriced or changed over some future period (rate-sensitive assets)\nRSL: liabilities whose interest rates will be repriced or changed over some future period (rate-sensitive liabilities)\n\nAn asset (or liability) is “rate-sensitive” if it is repriced at or near current market interest rates within a certain time horizon (or maturity bucket). For example,\n\na variable-rate mortgage’s interest rate may be reset every quarter based on the prevailing interest rate.\ninterest rate of term deposits are also adjusted frequently.1\n\nHistorical term deposit rates of Australian banks"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#maturity-tenor-buckets",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#maturity-tenor-buckets",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Maturity (Tenor) buckets",
    "text": "Maturity (Tenor) buckets\nUnder repricing model, banks report their repricing gaps for various maturity buckets. For example,\n\nOne day (overnight).\nMore than 1 day to 3 months.\nMore than 3 months to 6 months.\nMore than 6 months to 12 months.\nMore than 1 year to 5 years.\nMore than 5 years.\n\n\n\n\n\n\n\n\nHow to determine RSA/RSL for each bucket?\n\n\nAsk a simple question: Will or can this asset or liability have its interest rate changed within the maturity bucket? If the answer is yes, it is a rate-sensitive asset or liability. If the answer is no, it is not rate sensitive."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#maturity-buckets-and-rsarsl",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#maturity-buckets-and-rsarsl",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Maturity buckets and RSA/RSL",
    "text": "Maturity buckets and RSA/RSL\nLet’s practice. Try to identify the one-year RSA and RSL given the following assets and liabilities of a bank.\n\nAssets:\n\n1-year consumer loans\n2-year consumer loans\n3-month Treasury bills\n3-year Treasury bonds\n20-year fixed rate mortgage\n30-year floating rate mortgage (repriced every quarter)\n\nLiabilities:\n\ndemand deposits (non-interest-bearing)\n3-month certificates of deposits (CDs)\n6-month commercial papers\n1-year term deposits\n2-year term deposits"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#repricing-gaps",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#repricing-gaps",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Repricing gaps",
    "text": "Repricing gaps\n\n\n\nTable 3: Repricing gaps ($ millions)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAssets\nLiabilities\nGaps\nCumulative gap\n\n\n\n\n1\nOne day\n20\n30\n-10\n-10\n\n\n2\nOne day to three months\n30\n40\n-10\n-20\n\n\n3\nThree months to six months\n70\n85\n-15\n-35\n\n\n4\nSix months to 12 months\n90\n70\n+20\n-15\n\n\n5\nOne year to five years\n40\n30\n+10\n-5\n\n\n6\nOver five years\n10\n5\n+5\n0\n\n\nTotal\n\n$260\n$260\n\n\n\n\n\n\n\n\nFor example, a negative $10 million difference between its RSA and RSL being repriced in one day (one-day bucket). A rise in the overnight rate would lower the FI’s net interest income since the FI has more rate-sensitive liabilities than assets in this bucket.\n\nA refinancing risk given RSA &lt; RSL. Increase in interest rate means more interest paid on liabilities than earned from assets."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-repricing-model-1",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-repricing-model-1",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The repricing model",
    "text": "The repricing model\nThe repricing model can be used to estimate the change in the FI’s net interest income in a particular repricing bucket if interest rates change.\n\\[\n\\Delta NII_i = (GAP_i) \\times \\Delta R_i = (RSA_i - RSL_i) \\times \\Delta R_i\n\\]\nwhere:\n\n\\(\\Delta NII_i\\) is the change in net interest income in the \\(i\\)th bucket.\n\\(GAP_i\\) is the dollar size of the gap between the book value of RSA and RSL in maturity bucket \\(i\\).\n\\(\\Delta R_i\\) is the change in the level of interest rates impacting assets and liabilities in the \\(i\\)th bucket."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-repricing-model-examples",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-repricing-model-examples",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The repricing model: examples",
    "text": "The repricing model: examples\n\n\n\n\n\n\n\nOne-day repricing gap\n\n\nIn the first bucket of Table 3, if the gap is negative $10 million and overnight interest rate rises by 1 percent, the annualized change in the FI’s future NII is:\n\\[\n\\Delta NII_i = GAP_i \\times \\Delta R_i = -10 \\text{ million} \\times 0.01 = -100,000\n\\]\nSo, the repricing model suggests a loss of $100,000 in net interest income for the FI.\n\n\n\n\n\n\n\n\n\n\n\nOne-year repricing gap\n\n\nIt is common to also estimate the one-year (cumulative) repricing gap, which is -$15 million from Table 3.\n\\[\n\\Delta NII_i = CGAP_i \\times \\Delta R_i = -15 \\text{ million} \\times 0.01 = -150,000\n\\]\nIf the average interest rises by 1 percent, the model suggests a loss of $150,000 in net interest income."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-repricing-model-examples-1",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-repricing-model-examples-1",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The repricing model: examples",
    "text": "The repricing model: examples\nAssume both RSAs and RSLs equal $155 million. Suppose that there is a general interest rate rise and that the rates on RSAs rise by 1.2 percent and rates on RSLs rise by only 1 percent. What is the resulting change in NII?\n\n\\[\n\\Delta NII_i = RSA_i \\times \\Delta R^A_i - RSL_i \\times \\Delta R^L_i = (\\$155M \\times 0.012) - (\\$155M \\times 0.01) = \\$310,000\n\\]\n\nSuppose the RSA is $155 million and the RSL is $140 million. Interest rates rise by 1.2% on RSAs and 1% on RSLs. What is the change in NII?\n\n\\[\n\\Delta NII_i = RSA_i \\times \\Delta R_i^A - RSL_i \\times \\Delta R_i^L = (\\$155M \\times 0.012) - (\\$140M \\times 0.01) = \\$460,000\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#real-world-application-of-repricing-model",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#real-world-application-of-repricing-model",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Real-world application of repricing model",
    "text": "Real-world application of repricing model\nLet see a real-world application of repricing model by Texas Capital Bank, a (relatively small) commercial bank headquartered in Dallas, Texas, United States.\nWe can find its annual reports from SEC’s EDGAR system, which allows us to search for any corporate filings.\n\nIts most recent annual report is filed on 2025-02-11.\nCheck Item 7A. Quantitative and qualitative disclosure about market risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-repricing-model-problems",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-repricing-model-problems",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The repricing model: problems",
    "text": "The repricing model: problems\nThe repricing model is very simple and intuitive, but is NOT an accurate measure of interest rate risk.\nMajor shortcomings:\n\nIt is over-aggregative.\nIt ignores the market value effects of interest rate changes: it focuses on the income and ignores the capital gains/losses.\nIt uses the banking book and hence book values of assets and liabilities.\nIt fails to deal with the problem of rate-insensitive asset and liability runoffs and prepayments.\nIt ignores cash flows from off-balance-sheet activities."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#motivation",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#motivation",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Motivation",
    "text": "Motivation\nIn the early 2000s, the BIS issued a consultative document suggesting a standardized model be used by regulators in evaluating a bank’s interest rate risk exposure. The approach suggested is firmly based on market value accounting and the duration gap model.\nThe duration gap (model):\n\nconsiders market values and the maturity distributions of an FI’s assets and liabilities.\nconsiders the degree of leverage on an FI’s balance sheet.\nconsiders the timing of the payment or arrival of cash flows on assets and liabilities.\nis a more comprehensive measure of an FI’s interest rate risk.\n\nBigger banks have adopted duration model as their primary measure of interest rate risk.1\nBiggest banks may be allowed to use their internal models subject to regulatory approval."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#duration",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#duration",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration",
    "text": "Duration\nThe essence of duration gap model is the concept of duration, which is covered in introductory finance courses.\nSimply put, duration is the weighted-average time to maturity on the loan using the relative present values of the cash flows as weights.\n\\[\nD = \\sum_{t=1}^{N} w_t \\times t\n\\]\nwhere \\(D\\) is the duration, and\n\\[\nw_t = \\frac{\\text{PV of the cash flow at time } t}{\\text{Total PV of all cash flows}}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#duration-example",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#duration-example",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration: example",
    "text": "Duration: example\nConsider the duration of a 3-year coupon bond with a face value of $1,000, a coupon rate of 5%, and a yield to maturity of 4%. The bond pays annual coupons.\n\n\nCode\nimport pandas as pd\n\n# Parameters\nface_value, coupon_rate, yield_to_maturity, years = 1000, 0.05, 0.04, 3\nannual_coupon_payment = face_value * coupon_rate\n\n# Initialize and calculate values\ndata = [\n    (t, annual_coupon_payment if t &lt; years else annual_coupon_payment + face_value)\n    for t in range(1, years + 1)\n]\ntotal_pv = sum(payment / (1 + yield_to_maturity) ** t for t, payment in data)\ntable = [\n    (\n        t,\n        payment,\n        pv := payment / (1 + yield_to_maturity) ** t,\n        weight := pv / total_pv,\n        t * weight,\n    )\n    for t, payment in data\n]\n\n# Create DataFrame\ndf = pd.DataFrame(\n    table,\n    columns=[\n        \"Time (Years)\",\n        \"Payment ($)\",\n        \"PV of Payment ($)\",\n        \"Weight (PV/Total PV)\",\n        \"Weighted Time\",\n    ],\n)\n\n# Add totals row\ntotals = df.sum(numeric_only=True)\ntotals = pd.DataFrame(totals).T\ntotals[\"Time (Years)\"] = \"Total\"\ndf = pd.concat([df, totals], ignore_index=True)\n\ndf.style.highlight_max([\"Weighted Time\"]).format(precision=2).hide()\n\n\n\n\nTable 4: Calculating the duration of a 3-year bond\n\n\n\n\n\n\n\n\nTime (Years)\nPayment ($)\nPV of Payment ($)\nWeight (PV/Total PV)\nWeighted Time\n\n\n\n\n1\n50.00\n48.08\n0.05\n0.05\n\n\n2\n50.00\n46.23\n0.04\n0.09\n\n\n3\n1050.00\n933.45\n0.91\n2.72\n\n\nTotal\n1150.00\n1027.75\n1.00\n2.86\n\n\n\n\n\n\n\n\nThe bond’s duration is 2.86 years."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#duration-another-example",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#duration-another-example",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration: another example",
    "text": "Duration: another example\nConsider the duration of a 5-year coupon bond with a face value of $1,000, a coupon rate of 4%, and a yield to maturity of 6%. The bond pays annual coupons.\n\n\nCode\nimport pandas as pd\n\n# Parameters\nface_value, coupon_rate, yield_to_maturity, years = 1000, 0.04, 0.06, 5\nannual_coupon_payment = face_value * coupon_rate\n\n# Initialize and calculate values\ndata = [\n    (t, annual_coupon_payment if t &lt; years else annual_coupon_payment + face_value)\n    for t in range(1, years + 1)\n]\ntotal_pv = sum(payment / (1 + yield_to_maturity) ** t for t, payment in data)\ntable = [\n    (\n        t,\n        payment,\n        pv := payment / (1 + yield_to_maturity) ** t,\n        weight := pv / total_pv,\n        t * weight,\n    )\n    for t, payment in data\n]\n\n# Create DataFrame\ndf = pd.DataFrame(\n    table,\n    columns=[\n        \"Time (Years)\",\n        \"Payment ($)\",\n        \"PV of Payment ($)\",\n        \"Weight (PV/Total PV)\",\n        \"Weighted Time\",\n    ],\n)\n\n# Add totals row\ntotals = df.sum(numeric_only=True)\ntotals = pd.DataFrame(totals).T\ntotals[\"Time (Years)\"] = \"Total\"\ndf = pd.concat([df, totals], ignore_index=True)\n\ndf.style.highlight_max([\"Weighted Time\"]).format(precision=2).hide()\n\n\n\n\nTable 5: Calculating the duration of a 5-year bond\n\n\n\n\n\n\n\n\nTime (Years)\nPayment ($)\nPV of Payment ($)\nWeight (PV/Total PV)\nWeighted Time\n\n\n\n\n1\n40.00\n37.74\n0.04\n0.04\n\n\n2\n40.00\n35.60\n0.04\n0.08\n\n\n3\n40.00\n33.58\n0.04\n0.11\n\n\n4\n40.00\n31.68\n0.03\n0.14\n\n\n5\n1040.00\n777.15\n0.85\n4.24\n\n\nTotal\n1200.00\n915.75\n1.00\n4.61\n\n\n\n\n\n\n\n\nThe bond’s duration is 4.61 years."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-economic-meaning-of-duration",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-economic-meaning-of-duration",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The economic meaning of duration",
    "text": "The economic meaning of duration\nWe are interested in the sensitivity of bond price to interest rate.\n\nThat is, how much the price of a bond changes when the interest changes.\n\nDuration directly measures the interest rate sensitivity of an asset or liability:\n\\[\n\\frac{\\Delta P}{P} = - D \\times \\frac{\\Delta R}{1+R} = - MD \\times \\Delta R\n\\qquad(2)\\]\nwhere\n\n\\(\\Delta P\\) is the price change of assets or liabilities\n\\(\\Delta R\\) is the change of interest rate\n\\(MD\\) is the modified duration that equals to \\(\\frac{D}{1+R}\\)\n\nThe larger the numerical value of \\(D\\), the more sensitive is the price of that asset or liability to changes or shocks in interest rates.\n\n\n\n\n\n\nImportant\n\n\nThe relationship is only true for small changes in the yield."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-economic-meaning-of-duration-1",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-economic-meaning-of-duration-1",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The economic meaning of duration",
    "text": "The economic meaning of duration\nWhy does it work?\n\\[\n\\frac{\\Delta P}{P} = - D \\times \\frac{\\Delta R}{1+R} = - MD \\times \\Delta R\n\\]\n\nWe can write out the price formula of a bond and take its partial derivative with respect to yield.\nSee my detailed explanation here.\n\nWhy is it only true for small changes in the yield?\n\nBecause duration also changes as yield changes.\nWe assumed the duration is constant given a small \\(\\Delta R\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#duration-and-price-changes-example",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#duration-and-price-changes-example",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration and price changes: example",
    "text": "Duration and price changes: example\nConsider the previous example of a 5-year annual-coupon bond in Table 5 with a 4% coupon rate and 6% yield. It has a duration of 4.61 years.\nWhat is the price change if the interest rate (yield) decreases by 1 percent (\\(\\Delta R=-0.01\\))?\n\n\n\n\n\n\nNote\n\n\nRecall Equation 2 that \\(\\frac{\\Delta P}{P} = - D \\times \\frac{\\Delta R}{1+R} = - MD \\times \\Delta R\\).\n\\[\n\\text{Modified duration} = MD = \\frac{D}{1+R} = \\frac{4.61}{1+0.06} = 4.349\n\\]\nSo, we have\n\\[\n\\Delta P =  - MD \\times P \\times \\Delta R = - 4.349 \\times \\$1000 \\times (-0.01) = \\$43.49\n\\]\nThat is, a one percentage point (100 basis points) decrease in yield would increase bond price by $43.49.\nNote that \\(MD\\times P\\) is also named “dollar duration”, i.e., modified duration times the bond price."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#features-of-duration",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#features-of-duration",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Features of duration",
    "text": "Features of duration\n\nDuration increases with the maturity of a fixed-income security, but at a decreasing rate.\nDuration decreases as the yield on a security increases.\nDuration decreases as the coupon or interest payment increases."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#duration-and-interest-rate-risk-management",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#duration-and-interest-rate-risk-management",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration and interest rate risk management",
    "text": "Duration and interest rate risk management\nNow that we have refreshed our knowledge of duration, how is duration relevant in FI’s interest rate risk management?\nLet’s consider two cases.\n\nA single security.\nA portfolio of securities (e.g., the balance sheet)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#duration-and-interest-rate-risk-management-single-security",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#duration-and-interest-rate-risk-management-single-security",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration and interest rate risk management: single security",
    "text": "Duration and interest rate risk management: single security\nSuperannuation funds or insurers often have to make a specific amount of payment to their policyholders at a given future date. How to guarantee it? Investments may decrease in value if interest rate changes over the period.\nThere are two options:\n\nBuy a zero-coupon bond which matures exactly when the payment is made in the future.\nBuy bond(s) with a duration that matches the payment date.1\n\nHowever,\n\nOption 1 is very difficult because there simply may not be any such zero-coupon bonds with desirable maturities.\nOption 2 is manageable and practical!\n\nWe can show that its value at payment date is unaffected by interest rate changes."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#duration-and-interest-rate-risk-management-balance-sheet",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#duration-and-interest-rate-risk-management-balance-sheet",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Duration and interest rate risk management: balance sheet",
    "text": "Duration and interest rate risk management: balance sheet\nDuration can be used to measure a financial institution’s duration gap to evaluate the FI’s overall interest rate exposure. It is possible to calculate the duration of the asset portfolio and of the liability portfolio.\n\nDuration of a portfolio is the weighted average duration of its components.\n\n\n\nDuration of assets portfolio:\n\\[\nD_A = \\sum_{i=1}^{N_A} w_{iA} \\times D^A_i\n\\]\nwhere \\(N_A\\) is the total number of assets, \\(w_{iA}\\) is the market value weight of asset \\(i\\), \\(D^A_i\\) is the duration of asset \\(i\\).\nSo, change of assets value for a given change in interest rate is\n\\[\n\\Delta A = - D_A \\times A \\times \\frac{\\Delta R}{1+R}\n\\qquad(3)\\]\n\nDuration of liabilities portfolio:\n\\[\nD_L = \\sum_{i=1}^{N_L} w_{iL} \\times D^L_i\n\\]\nwhere \\(N_L\\) is the total number of liabilities, \\(w_{iL}\\) is the market value weight of liability \\(i\\), \\(D^L_i\\) is the duration of liability \\(i\\).\nSo, change of liabilities for a given change in interest rate is\n\\[\n\\Delta L = - D_L \\times L \\times \\frac{\\Delta R}{1+R}\n\\qquad(4)\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-duration-model",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-duration-model",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The duration model",
    "text": "The duration model\nWe know that total assets (\\(A\\)) is the sum of liabilities (\\(L\\)) and equity (\\(E\\)): \\(A=E+L\\).\nTherefore, \\(E = A - L\\), and \\(\\Delta E = \\Delta A - \\Delta L\\).\nMaking use of the previous results Equation 3 and Equation 4, we have\n\\[\n\\Delta E = \\left[- D_A \\times A \\times \\frac{\\Delta R}{1+R}\\right] -  \\left[- D_L \\times L \\times \\frac{\\Delta R}{1+R}\\right]\n\\qquad(5)\\]\nIf the level of interest and expected shock to interest rates are the same for both assets and liabilities, then:\n\\[\n\\Delta E = - (D_A - D_L k) \\times A \\times \\frac{\\Delta R}{1+R}\n\\qquad(6)\\]\nwhere \\(k=\\frac{L}{A}\\) measures the FI’s leverage."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-duration-model-1",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-duration-model-1",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The duration model",
    "text": "The duration model\nLet’s examine the duration model Equation 6:\n\\[\n\\Delta E = - (D_A - D_L k) \\times A \\times \\frac{\\Delta R}{1+R}\n\\]\nThe effect of interest rate changes on the market value of an FI’s net worth breaks down into three effects:\n\nThe leverage-adjusted duration gap: \\((D_A-D_L k)\\)\nThe size of the FI: \\(A\\)\nThe size of the interest rate shock: \\(\\frac{\\Delta R}{1+R}\\)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#the-duration-model-example",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#the-duration-model-example",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "The duration model: example",
    "text": "The duration model: example\nSuppose a FI has total assets of $100 million and total liabilities of $90 million.\nAssume that the average duration of assets is 5 years, while the average duration of liabilities is 3 years. The current interest rate is 10%, but is expected to increase to 11% in the future.\nWe can calculate the expected change in the FI’s net worth as follows:\n\\[\n\\Delta E = - (D_A - D_L k) \\times A \\times \\frac{\\Delta R}{1+R} = -(5 - 3\\times 0.9) \\times \\$100 \\times \\frac{0.01}{1+0.1} = -\\$2.09\n\\]\nThis means that the FI could lose $2.09 million in net worth if interest rates rose by 1 per cent.\nHow can the FI manage the interest rate exposure?\n\nReduce \\(D_A\\), and/or\nIncrease \\(D_L\\), and/or\nIncrease leverage \\(k\\), and/or\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#immunization-and-regulatory-considerations",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#immunization-and-regulatory-considerations",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Immunization and regulatory considerations",
    "text": "Immunization and regulatory considerations\nRegulators, like APRA in Australia, require banks to hold a minimum amount of capital against their (risk-weighted) assets.\n\nWe have discussed capital management and adequacy last week.\nThe simplest ratio is: \\(\\frac{E}{A}\\).\n\nThus, in order to comply with regulations, the aim of risk management should not be \\(\\Delta E=0\\) but \\(\\Delta (\\frac{E}{A}) = 0\\).\nInstead of setting \\(D_A-D_L k=0\\), the bank now needs to target \\(D_A-D_L=0\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#difficulties-in-applying-duration-model",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#difficulties-in-applying-duration-model",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Difficulties in applying duration model",
    "text": "Difficulties in applying duration model\n\nDuration matching can be costly.\nImmunization is a dynamic problem.\nLarge interest rate changes can happen.\nConvexity."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#suggested-readings",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nRBA Financial Stability Review October 2023 - Focus Topic: Interest Rate Risk.\nBIS Standards IRRBB.\nReporting Standard ARS 117.0 Repricing Analysis.\nRepricing model’s application - page 31 of the Westpac NZ Banking Group’s interim report March 2024.\nDuration model’s application - Table 25 of the FreddieMac’s quarterly report June 2023.\nIf you need read more on fixed income securities, feel free to read some of my posts:\n\nIntroduction to fixed income securities\nBond price and yields\nBond price volatility (sensitivity)\nYield curve and term structure of interest rates"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week4/index.html#references",
    "href": "teaching/AFIN8003/2025S1/Week4/index.html#references",
    "title": "AFIN8003 Week 4 - Interest Rate Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#david-chan",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#david-chan",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "David Chan",
    "text": "David Chan\nDavid Chan has over 25 years’ experience in financial markets and is currently at ASX as Senior Manager Clearing Risk Data Analytics & Framework. In this role, David is responsible for the development of data & risk analytics platform, clearing risk management monitoring & review framework.\nPrior to joining ASX, David was Executive Manager Strategic Risk Oversight at Commonwealth Bank of Australia, with responsibility for oversight trading book for Global Markets. In this role, David covered a range of asset classes including FX, rates, equities, and commodities with a special focus on XVA portfolio and capital optimization.\nPrior to working at Commonwealth Bank, David held a number of senior risk management, finance and operations roles at Agricultural Bank of China International, Mirae Asset and JP Morgan in Hong Kong and Sydney.\nDavid’s expertise across sell side and buy side trading, treasury management, asset management, financing and prime brokerage. With strong interest in financial products and hedge strategies, portfolio management & optimization, forecasting and predictive analysis, unauthorised trading oversight.\nDavid holds a Bachelor’s degree in Computing Studies from Hong Kong Polytechnic University and a Master of Applied Finance from the University of Melbourne."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#introduction",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#introduction",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Introduction",
    "text": "Introduction\nIn last week, we discussed interest rate risk: changes in interest rates could affect a FI’s income and net worth.\n\nInterest rate changes affect mostly the banking book.\nThe trading book is exposed to market risk.\n\n\n\n\n\n\n\n\n\n\nAssets\nLiabilities\n\n\n\n\nBanking book\nCash\nDeposits\n\n\n\nLoans\nOther liabilities\n\n\n\nOther assets\nCapital\n\n\nTrading book\nBonds (long)\nBonds (short)\n\n\n\nCommodities (long)\nCommodities (short)\n\n\n\nFX (long)\nFX (short)\n\n\n\nEquities (long)\nEquities (short)\n\n\n\nMortgage-backed securities (long)\n\n\n\n\nDerivatives1 (long)\nDerivatives (short)\n\n\n\n\n\n\n\n\n\n\nMarket Risk\n\n\nMarket risk is uncertainty of an FI’s earnings on its trading portfolio caused by changes, particularly extreme changes, in market conditions such as the price of an asset, interest rates, market volatility, and market liquidity.\n\n\n\n\nDerivatives are off-balance-sheet."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#introduction-contd",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#introduction-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Introduction (cont’d)",
    "text": "Introduction (cont’d)\nIntuitively, trading book includes assets, liabilities and derivatives that are actively traded in some financial markets and hence exposed to uncertainties of these markets."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#market-risk-exposure",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#market-risk-exposure",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Market risk exposure",
    "text": "Market risk exposure\nFIs are concerned about the potential impact of changing market conditions on their trading book and ultimately their net worth and solvency.\nA natural question becomes:\n\nHow to quantify such impact? What is the potential change in value of trading portfolio for a given period?\n\nMore specifically,\n\nWhat is the worst loss we can expect not to exceed with a given confidence level over a specific time horizon?\nWhat is the expected loss when losses exceed a certain level over a specific time horizon?\n\nAnswering these questions leads to the development of two important concepts for measuring market risk exposure:\n\nValue at Risk (VaR).\nExpected Shortfall (ES).\n\nWe start with the concept of Value at Risk (VaR), then discuss its limitations and the use of Expected Shortfall (ES)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#concept-of-var",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#concept-of-var",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Concept of VaR",
    "text": "Concept of VaR\nSuppose we know the distribution of an asset’s returns over a specific period (in the future), then for a given confidence level \\(c\\in[0,1]\\) (e.g., \\(c=0.95\\)), we can partition the distribution into two parts: one (in red) that represents a proportion of \\((1-c)\\) of the distribution and the other (in blue) accounting the remaining \\(c\\) proportion.\n\n\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Set seed for reproducibility\nnp.random.seed(42)\n\n# Parameters\nmu = 0  # Mean of returns\nsigma = 0.01  # Standard deviation of returns\nn = 10000  # Number of simulations\nconfidence_level = 0.95\n\n# Simulate returns\nreturns = np.random.normal(mu, sigma, n)\n\n# Calculate VaR\nVaR = np.percentile(returns, (1 - confidence_level) * 100)\n\n# Plot histogram with different colors for bars below and above VaR\nplt.figure(figsize=(10, 6))\n\n# Histogram data\nn, bins, patches = plt.hist(returns, bins=50, alpha=0.75, edgecolor=\"black\")\n\n# Change color of bars\nfor i in range(len(patches)):\n    if bins[i] &lt; VaR:\n        patches[i].set_facecolor(\"#A6192E\")\n    else:\n        patches[i].set_facecolor(\"#D6D2C4\")\n\n# Add VaR line\nplt.axvline(VaR, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2)\nplt.title(\"Simulated Distribution of Returns with VaR\")\nplt.xlabel(\"Return\")\nplt.ylabel(\"Frequency\")\nplt.legend([\"VaR at 95%\", \"Returns\"])\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\nFigure 1: Distribution of expected returns and VaR\n\n\n\n\n\n\nTherefore, the cutoff value of returns that separates the two parts defines:\n\na minimum return that we are confident 95% of the time, or\na maximum loss that we are confident 95% of the time."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#another-example-of-var",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#another-example-of-var",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Another example of VaR",
    "text": "Another example of VaR\nThis VaR concept does not depend on the shape of return distribution.\nFor example, below we have an interestingly shaped return distribution. Given a confidence level of 99%, we can find the 99% VaR.\n\n\nCode\n# Simulate returns with a non-normal distribution (e.g., bimodal distribution)\nnp.random.seed(42)\n\n# Parameters for bimodal distribution\nn = 10000\nmu1, sigma1, weight1 = -0.01, 0.01, 0.5\nmu2, sigma2, weight2 = 0.03, 0.02, 0.5\n\n# Generate bimodal returns\nreturns1 = np.random.normal(mu1, sigma1, int(n * weight1))\nreturns2 = np.random.normal(mu2, sigma2, int(n * weight2))\nreturns = np.concatenate([returns1, returns2])\n\n# Calculate VaR\nconfidence_level = 0.99\nVaR = np.percentile(returns, (1 - confidence_level) * 100)\n\n# Plot histogram with different colors for bars below and above VaR\nplt.figure(figsize=(10, 6))\n\n# Histogram data\nn, bins, patches = plt.hist(returns, bins=50, alpha=0.75, edgecolor=\"black\")\n\n# Change color of bars\nfor i in range(len(patches)):\n    if bins[i] &lt; VaR:\n        patches[i].set_facecolor(\"#A6192E\")\n    else:\n        patches[i].set_facecolor(\"#D6D2C4\")\n\n# Add VaR line\nplt.axvline(VaR, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2)\nplt.title(\"Simulated Distribution of Returns with VaR (Non-Normal Distribution)\")\nplt.xlabel(\"Return\")\nplt.ylabel(\"Frequency\")\nplt.legend([\"VaR at 99%\", \"Returns\"])\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\nFigure 2: Distribution of expected returns and VaR (another example)\n\n\n\n\n\nFrom the plot, we can say that 99% of the time, the asset’s return will be in the blue region, which means that it will not fall below the 99% VaR (recall that VaR is a cutoff value)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#models-for-computing-var",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#models-for-computing-var",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Models for computing VaR",
    "text": "Models for computing VaR\nOver the years, many models have been developed to compute VaR.\nThis is because we do not have the return distribution of trading portfolio over a specific period in the future.\n\nIf we do, then VaR is unambiguous.\n\nTherefore, different assumptions lead to different models and approaches. We are interested in three in this course:\n\nRiskMetrics (variance-covariance approach)\nHistoric or back simulation\nMonte Carlo simulation"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics",
    "text": "VaR: RiskMetrics\n\n“At close of business each day tell me what the market risks are across all businesses and locations”\nSir Dennis Weatherstone, 1989, former chairman of J.P. Morgan & Co., now JPMorgan Chase.\n\n\nManagers at JPM needs to respond with “I am X% sure that the FI will not lose more than $VAR in the next T days.”\nBasically, the FI manager wants a single dollar number that tells him or her the FI’s market risk exposure over the next days—especially if those days turn out to be extremely “bad” days.\n\n\n\nA very difficult task given that in 1994, JPMorgan had 14 active trading locations with 120 independent units trading fixed-income securities, foreign exchange, commodities, derivatives, emerging-market securities, and proprietary assets.\n\n\n\n\nJPMorgan developed RiskMetrics model."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-contd",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics (cont’d)",
    "text": "VaR: RiskMetrics (cont’d)\nIn a nutshell, we are concerned about the market risk exposure on a daily basis. Market risk exposure over longer periods, under some assumptions, can be viewed as a simple transformation from the daily exposure.\nThe market risk is measured by the daily earnings at risk (DEAR): \\[\n\\text{DEAR} = \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price sensitivity of the position}\\right) \\times \\left(\\text{potential adverse move}\\right)\n\\]\nSince price sensitivity multiplied by adverse move measures the degree of price volatility of an asset, we can write this equation as: \\[\n\\text{DEAR} = \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price volatility}\\right)\n\\]\n\n\n\n\n\n\n\nDear DEAR and VaR\n\n\nDEAR is basically 1-day dollar VaR in the context of RiskMetrics model.\n\n\n\n\n\nIf we assume that shocks are independent, daily volatility is approximately constant, and that the FI holds this asset for \\(N\\) number of days, then the \\(N\\)-day VaR is related to DEAR by: \\[\nN\\text{-day VaR} = \\left(\\text{DEAR}\\right) \\times \\sqrt{N}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-contd-1",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics (cont’d)",
    "text": "VaR: RiskMetrics (cont’d)\nNext, we will apply RiskMetrics model on:\n\nfixed-income securities\nforeign exchange (FX)\nequities\n\nAfterwards, we will study how to compute portfolio VaR.\n\n\n\n\n\n\nNote\n\n\nRecall that we need a single number across all asset classes for the aggregate market risk exposure. Aggregation is necessary."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-fixed-income-securities",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-fixed-income-securities",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for fixed-income securities",
    "text": "VaR: RiskMetrics for fixed-income securities\nSuppose an FI has a $1 million market value position in zero-coupon bonds of 7 years to maturity with a face value of $1,631,483. Today’s yield on these bonds is 7.243%.\n\nHow to estimates its DEAR? Some additional assumptions are required.\n\n\nChecking the formula: \\[\n\\text{DEAR} = \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price sensitivity of the position}\\right) \\times \\left(\\text{potential adverse move}\\right)\n\\]\n\n\nOf these three components:\n\ndollar market value of the position is $1 million.\nprice sensitivity of bonds (w.r.t. yield) is measured by (modified) duration (recall last week’s material). \\[\nMD = \\frac{D}{1+R} = \\frac{7}{1+0.07243} = 6.527\n\\]\npotential adverse move (in yield) depends on the assumption of yield distribution and our chosen confidence level."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for fixed-income securities (cont’d)",
    "text": "VaR: RiskMetrics for fixed-income securities (cont’d)\nIn terms of the “potential adverse move in yield”, let’s assume we are concerned about bad yield changes such that there is only a 1% chance that the yield changes will exceed this amount.1\nNote that bond prices decrease with yields. So, we want to know:\n\nthe “maximum upward change in the 7-year rates” (over a day) with a 1% possibility.\n\nWith RiskMetrics, we assume that changes in (7-year) yields follow a Normal distribution. We further assume that2\n\nthe mean \\(\\mu\\) of daily changes in yield is 0bps.\nthe standard deviation \\(\\sigma\\) of daily changes in yield is 10bps.\n\nIn other words, we set a confidence level of 99%.These come from some sophisticated estimations."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd-1",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for fixed-income securities (cont’d)",
    "text": "VaR: RiskMetrics for fixed-income securities (cont’d)\n\n\nTherefore, we can get distribution of daily changes in (7-year) yields as below.\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import norm\n\n# Parameters for normal distribution\nmu = 0  # mean\nsigma = 10  # standard deviation (10 bps)\n\n# Generate data\nx = np.linspace(mu - 4 * sigma, mu + 4 * sigma, 1000)\ny = norm.pdf(x, mu, sigma)\n\n# Calculate the value at 2.33 standard deviations from the mean\nthreshold = mu + 2.33 * sigma\n\n# Plot normal distribution\nplt.figure(figsize=(10, 6))\nplt.plot(x, y, label=\"Normal Distribution\", color=\"#D6D2C4\")\n\n# Fill the upper 1% area\nx_fill = np.linspace(threshold, mu + 4 * sigma, 100)\ny_fill = norm.pdf(x_fill, mu, sigma)\nplt.fill_between(x_fill, y_fill, color=\"#A6192E\", alpha=0.5, label=\"Upper 1% Area\")\n\n# Mark mean and threshold\nplt.axvline(mu, color=\"green\", linestyle=\"dashed\", linewidth=2, label=\"Mean\")\nplt.axvline(\n    threshold, color=\"orange\", linestyle=\"dashed\", linewidth=2, label=\"2.33 Std Dev\"\n)\n\nplt.title(\"Normal Distribution with Mean and 2.33 Standard Deviation\")\nplt.xlabel(\"Value (bps)\")\nplt.ylabel(\"Probability Density\")\nplt.legend()\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\nFigure 3: Normal distribution of changes in 7-year yields\n\n\n\n\n\n\nThe good mathematical property of normal distribution allows us to know that the upper 1% area is separated from the lower 99% by the value \\(\\mu+2.33\\sigma\\).\nSince \\(\\mu=0\\) and \\(\\sigma=10\\text{bps}\\), the cutoff value is \\(2.33\\sigma=23.3\\text{bps}\\).\n\n\n\n\n\n\nNote\n\n\nIt means that, we are 99% confident that the maximum daily upward (adverse) change in (7-year) yields is 23.3 basis points (bps)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd-2",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-fixed-income-securities-contd-2",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for fixed-income securities (cont’d)",
    "text": "VaR: RiskMetrics for fixed-income securities (cont’d)\nNow we can put everything together.\n\\[\n\\text{DEAR} = \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price sensitivity of the position}\\right) \\times \\left(\\text{potential adverse move}\\right)\n\\]\nOf these three components:\n\ndollar market value of the position is $1 million.\nprice sensitivity of bonds (w.r.t. yield) as measured by modified duration is 6.527.\npotential adverse move (in yield) is 23.3bps or 0.00233%.\n\nSo,\n\\[\n\\begin{aligned}\n\\text{DEAR} &= \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price sensitivity of the position}\\right) \\times \\left(\\text{potential adverse move}\\right) \\\\\n&= \\$1,000,000 \\times 6.527 \\times 0.00233 \\\\\n&= \\$15,207.91\n\\end{aligned}\n\\]\nThat is, the potential daily loss in earnings on the $1 million position is $15,207.91 if the 1 bad day in 100 occurs tomorrow."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-fx",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-fx",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for FX",
    "text": "VaR: RiskMetrics for FX\nThe method of DEAR calculation for FX is largely the same.\n\\[\n\\text{DEAR} = \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price volatility}\\right)\n\\]\nSuppose the FI had a €800,000 trading position in spot euros at the close of business today. The current exchange rate is €0.8/$1 (or $1.25/€1).\n\nDollar market value of the position is \\(€800,000 \\times \\$1.25/€1=\\$1 \\text{ million}\\).\nSuppose that we find the standard deviation of changes in daily exchange rate is 56.5bps, and mean change is 0.\nAgain with a 99% confidence level, the potential adverse move is \\(2.33\\times 56.5\\text{bps}=131.645\\text{bps}\\).\n\nAs a result,\n\\[\n\\begin{aligned}\n\\text{DEAR} &= \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{price volatility}\\right) \\\\\n&= \\$1,000,000 \\times 0.0131645 \\\\\n&= \\$13,164\n\\end{aligned}\n\\]\nThis is the potential daily earnings exposure to adverse euro to dollar exchange rate changes for the FI from the €800,000 spot currency holdings."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-equities",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-equities",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for equities",
    "text": "VaR: RiskMetrics for equities\nFundamentally, there is nothing different when applying RiskMetrics DEAR on equity positions.\nRecall that the Capital Market Pricing Model (CAPM) states that for an individual stock \\(i\\), its total risk is its systematic risk plus indiosyncratic (unsystematic) risk.\n\\[\n\\begin{aligned}\n\\text{Total risk} &= \\text{systematic risk} + \\text{unsystematic risk} \\\\\n\\sigma^2_{it} &= \\beta^2_{i} \\sigma^2_{mt} + \\sigma^2_{eit}\n\\end{aligned}\n\\]\nSystematic risk reflects the co-movement of that stock with the market portfolio reflected by the stock’s beta (\\(\\beta_i\\)) and the volatility of the market portfolio (\\(\\sigma_{mt}\\)), while unsystematic risk is specific to the firm itself (\\(\\sigma_{eit}\\)).\nIn a very well diversified portfolio, unsystematic risk can be largely diversified away (i.e., will equal zero), leaving behind systematic (undiversifiable) market risk.\nIf an FI’s equity portfolio largely replicate the market portfolio (index), its beta equals 1 and its standard deviation will be equal to the standard deviation of the market portfolio."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-equities-contd",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-riskmetrics-for-equities-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: RiskMetrics for equities (cont’d)",
    "text": "VaR: RiskMetrics for equities (cont’d)\nSuppose the FI holds a $1 million equity portfolio that reflects a market index, then the DEAR of the portfolio is\n\\[\n\\begin{aligned}\n\\text{DEAR} &= \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{stock market return volatility}\\right) \\\\\n&= \\$1,000,000 \\times 2.33\\sigma_{m} \\\\\n\\end{aligned}\n\\]\n\n\n\n\n\n\nNote\n\n\nHere, we’ve assumed that the daily returns follow a normal distribution and the mean daily return is 0. Further, we’ve assumed a 99% confidence level.\n\n\n\nIf we find that standard deviation of daily returns \\(\\sigma_m\\) is 200bps, then \\(2.33\\sigma_m=466\\text{bps}\\). This means that we believe that the adverse change in the daily returns of stock market could exceed 466bps only 1% of the time. As such,\n\\[\n\\begin{aligned}\n\\text{DEAR} &= \\left(\\text{dollar market value of the position}\\right) \\times \\left(\\text{stock market return volatility}\\right) \\\\\n&= \\$1,000,000 \\times 0.0466 \\\\\n&= \\$46,600\n\\end{aligned}\n\\]\nThat is, the potential daily loss in earnings on the $1 million stock position is $46,600 if the 1 bad day in 100 occurs tomorrow."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-portfolio-aggregation",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-portfolio-aggregation",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: portfolio aggregation",
    "text": "VaR: portfolio aggregation\nNow, we have calculated the individual DEAR for the three positions:\n\nSeven-year, zero-coupon bonds = $15,207.91\nEuro spot = $13,164\nEquities = $46,600\n\nYet the manager needs a single number aggregating all positions.\n\nCan we add up the individual DEARs and report it?\n\n\n\n\n\n\n\n\nImportant\n\n\nNO. We cannot sum individual DEAR (or VaR) to compute the aggregate VaR.\n\n\n\nIf you recall, earlier when we introduce the difference models for calculating VaR, we mentioned that RiskMetrics is sometimes all called the “variance-covariance approach”.\n\nSo far, we have only used the “variance” (standard deviation of potential changes), but not the “covariance”!\nAsset shocks (adverse moves) very often are correlated."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-portfolio-aggregation-contd",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-portfolio-aggregation-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: portfolio aggregation (cont’d)",
    "text": "VaR: portfolio aggregation (cont’d)\nIn the case of three individual positions, taking into account correlations, the aggregate DEAR is computed as\n\\[\n\\text{DEAR (aggregate)} = \\sqrt{\\text{D}_1^2 + \\text{D}_2^2 + \\text{D}_3^2 \\\\\n+ 2 \\cdot \\text{D}_1 \\cdot \\text{D}_2 \\cdot \\rho_{12} + 2 \\cdot \\text{D}_1 \\cdot \\text{D}_3 \\cdot \\rho_{13} + 2 \\cdot \\text{D}_2 \\cdot \\text{D}_3 \\cdot \\rho_{23}}\n\\]\nwhere:\n\n\\(\\text{D}_1, \\text{D}_2, \\text{D}_3\\) are the DEARs for the three individual positions.\n\\(\\rho_{12}, \\rho_{13}, \\rho_{23}\\) are the correlation coefficients between the pairs of positions."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-portfolio-aggregation-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-portfolio-aggregation-contd-1",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: portfolio aggregation (cont’d)",
    "text": "VaR: portfolio aggregation (cont’d)\nSuppose we have the following correlation matrix for the daily changes in 7-year rates, changes in euro/dollar spot exchange rates, and changes in equity market returns.\n\n\n\n\n\n\n\n\n\n\n7-Year Rates\nEuro/Dollar Spot Rates\nEquity Market Returns\n\n\n\n\n7-Year Rates\n1.0\n-0.2\n0.4\n\n\nEuro/Dollar Spot Rates\n\n1.0\n0.1\n\n\nEquity Market Returns\n\n\n1.0\n\n\n\nWe will use the correlations to compute the aggregate DEAR (VaR).\n\\[\n\\begin{aligned}\n\\text{DEAR (aggregate)} &= \\sqrt{\\text{D}_1^2 + \\text{D}_2^2 + \\text{D}_3^2 + 2 \\cdot \\text{D}_1 \\cdot \\text{D}_2 \\cdot \\rho_{12} + 2 \\cdot \\text{D}_1 \\cdot \\text{D}_3 \\cdot \\rho_{13} + 2 \\cdot \\text{D}_2 \\cdot \\text{D}_3 \\cdot \\rho_{23}} \\\\\n&= \\sqrt{15207.91^2 + 13164^2 + 46600^2 + 2 \\cdot 15207.91 \\cdot 13164 \\cdot (-0.2)\n+ 2 \\cdot 15207.91 \\cdot 46600 \\cdot (0.4) + 2 \\cdot 13164 \\cdot 46600 \\cdot (0.1)} \\\\\n&= 56441.93\n\\end{aligned}\n\\]\nThat is, this FI with the three positions in fixed-income securities, FX, and equities has an aggregate DEAR of $56,441.93."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-criticisms-against-riskmetrics",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-criticisms-against-riskmetrics",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: criticisms against RiskMetrics",
    "text": "VaR: criticisms against RiskMetrics\nObviously, the assumption of all assets’ returns (or changes) follow a normal distribution is not ideal.\n\nSome assets’ returns are known to have skewness.\nEmpirically, asset returns have long tails.\n\nMoreover, calculating covariances is practically challenging.\n\nWith \\(N\\) assets, there are \\(\\frac{N(N-1)}{2}\\) covariances to compute.\n\n\\[\n\\begin{bmatrix}\n\\sigma_{1}^2 & \\sigma_{12} & \\sigma_{13} & \\cdots & \\sigma_{1N} \\\\\n\\sigma_{21} & \\sigma_{2}^2 & \\sigma_{23} & \\cdots & \\sigma_{2N} \\\\\n\\sigma_{31} & \\sigma_{32} & \\sigma_{3}^2 & \\cdots & \\sigma_{3N} \\\\\n\\vdots      & \\vdots      & \\vdots      & \\ddots & \\vdots      \\\\\n\\sigma_{N1} & \\sigma_{N2} & \\sigma_{N3} & \\cdots & \\sigma_{N}^2 \\\\\n\\end{bmatrix}\n\\]\n\nAn equity portfolio of 500 stocks suggests a total of 124,750 covariance items.\nThere are also many more fixed-income securities, etc."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-historic-or-back-simulation",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-historic-or-back-simulation",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: historic or back simulation",
    "text": "VaR: historic or back simulation\nMany FIs have developed market risk models that employed a historic or back simulation approach.\nEssential idea is to revalue current asset portfolio on basis of past actual prices (returns).\nSimply put, this approach is to\n\nCollect the past 500 days’ actual prices (returns).\nRevalue the asset using the 1% worst case, i.e., the portfolio is revalued as the 5th lowest value out of 500."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-historic-or-back-simulation-contd",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-historic-or-back-simulation-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: historic or back simulation (cont’d)",
    "text": "VaR: historic or back simulation (cont’d)\nThe advantages of historic approach are that\n\nit is simple,\nit does not require that asset returns be normally distributed, and\nit does not require that the correlations or standard deviations of asset returns be calculated.\n\nHowever,\n\n500 observations is not very many from a statistical standpoint.\nIncreasing the number of observations by going back further in time is not desirable.\n\nAs one goes back further in time, past observations may become decreasingly relevant in predicting VaR in the future.\n\n\nHow to improve?\n\nCould weight recent observations more heavily and go further back.\nCould generate additional observations (Monte Carlo simulation)!"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-monte-carlo-simulation",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-monte-carlo-simulation",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: Monte Carlo simulation",
    "text": "VaR: Monte Carlo simulation\nThe Monte Carlo simulation approach of calculating a portfolio’s VaR can be summarized as\n\nGenerate Random Scenarios:\n\nUse statistical methods to simulate a large number of possible future returns for each asset in the portfolio, reflecting their expected returns, volatilities, and correlations.\n\nConstruct Portfolio Returns:\n\nAggregate the simulated asset returns to calculate the portfolio return for each scenario, considering the weights of each asset in the portfolio.\n\nDetermine VaR:\n\nAnalyze the distribution of simulated portfolio returns and identify the threshold loss value that will not be exceeded with a specified confidence level (e.g., 95% or 99%). This threshold is the Value at Risk (VaR)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-monte-carlo-simulation-contd",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-monte-carlo-simulation-contd",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: Monte Carlo simulation (cont’d)",
    "text": "VaR: Monte Carlo simulation (cont’d)\nSuppose we have a portfolio of \\(N\\) assets. Therefore, we have a vector of these assets’ returns \\(\\mu\\) and their covariance matrix \\(\\Sigma\\):\n\\[\n\\mu = \\begin{bmatrix}\n\\mu_1 \\\\\n\\mu_2 \\\\\n\\vdots \\\\\n\\mu_N\n\\end{bmatrix}, \\quad\n\\Sigma = \\begin{bmatrix}\n\\sigma_{1}^2 & \\sigma_{12} & \\cdots & \\sigma_{1N} \\\\\n\\sigma_{21} & \\sigma_{2}^2 & \\cdots & \\sigma_{2N} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\sigma_{N1} & \\sigma_{N2} & \\cdots & \\sigma_{N}^2\n\\end{bmatrix}\n\\]\nWe apply Cholesky Decomposition on the covariance matrix \\(\\Sigma\\) to get a lower triangular matrix \\(L\\) and its transpose \\(L'\\), such that \\[\n\\Sigma = L L'\n\\]\nNext, we generate standard normal random variable, \\(Z\\), where \\(M\\) is the number of scenarios: \\[\nZ = \\begin{bmatrix}\nz_{11} & z_{12} & \\cdots & z_{1N} \\\\\nz_{21} & z_{22} & \\cdots & z_{2N} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nz_{M1} & z_{M2} & \\cdots & z_{MN}\n\\end{bmatrix}\n\\]\nThe simulated asset returns are given by \\(\\mu + Z L'\\)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-monte-carlo-simulation-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-monte-carlo-simulation-contd-1",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: Monte Carlo simulation (cont’d)",
    "text": "VaR: Monte Carlo simulation (cont’d)\nWith the simulated asset returns for \\(M\\) scenarios, we can compute the portfolio return in these \\(M\\) scenarios.\n\nThis leads to a distribution of potential portfolio returns, which enables the calculation of VaR."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#var-monte-carlo-simulation-example",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#var-monte-carlo-simulation-example",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "VaR: Monte Carlo simulation (example)",
    "text": "VaR: Monte Carlo simulation (example)\n\n\n\nNumber of Assets: 3\nMean Returns\n\nAsset 1: 0.10% per period\nAsset 2: 0.12% per period\nAsset 3: 0.08% per period\n\nCovariance Matrix \\(\\Sigma\\) \\[\n\\Sigma = \\begin{bmatrix}\n0.0001 & 0.00002 & 0.000015 \\\\\n0.00002 & 0.0001 & 0.000025 \\\\\n0.000015 & 0.000025 & 0.0001\n\\end{bmatrix}\n\\]\nPortfolio Weights:\n\nAsset 1: 40%\nAsset 2: 30%\nAsset 3: 30%\n\nSimulation Parameters:\n\nNumber of Scenarios: 10,000\nConfidence Level: 95%\n\n\n\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Parameters\nnp.random.seed(42)\nn_assets = 3\nn_scenarios = 10000\nconfidence_level = 0.95\n\n# Mean returns and covariance matrix for the assets\nmean_returns = np.array([0.001, 0.0012, 0.0008])  # Example mean returns\ncov_matrix = np.array(\n    [\n        [0.0001, 0.00002, 0.000015],\n        [0.00002, 0.0001, 0.000025],\n        [0.000015, 0.000025, 0.0001],\n    ]\n)  # Example covariance matrix\n\n# Cholesky decomposition of the covariance matrix\nL = np.linalg.cholesky(cov_matrix)\n\n# Generate standard normal random variables\nZ = np.random.normal(size=(n_scenarios, n_assets))\n\n# Simulate asset returns\nsimulated_returns = Z @ L.T + mean_returns\n\n# Given weights\nweights = np.array([0.4, 0.3, 0.3])  # Example weights\n\n# Calculate portfolio returns\nportfolio_returns = simulated_returns @ weights\n\n# Calculate VaR\nVaR = np.percentile(portfolio_returns, (1 - confidence_level) * 100)\n\n# Plotting the portfolio returns and VaR\nplt.figure(figsize=(10, 6))\nplt.hist(portfolio_returns, bins=50, alpha=0.75, color=\"#D6D2C4\", edgecolor=\"black\")\nplt.axvline(VaR, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2)\nplt.title(\"Simulated Portfolio Returns with VaR\")\nplt.xlabel(\"Portfolio Return\")\nplt.ylabel(\"Frequency\")\nplt.legend([\"VaR at 95%\", \"Portfolio Returns\"])\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\nFigure 4: Distributions of portfolio returns from Monte Carlo simulation"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#why-var-could-be-misleading",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#why-var-could-be-misleading",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Why VaR could be misleading?",
    "text": "Why VaR could be misleading?\nVaR tells the FI manager the loss at a particular point on the probability distribution (i.e., 99th percentile).\nIt, however, fails to incorporate information regarding the shape of the probability distribution below that particular point.\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Parameters\nnp.random.seed(42)\nn_scenarios = 10000\nconfidence_level = 0.95\n\n# Distribution 1: Normal distribution\nmu1, sigma1 = 0, 0.01\nreturns1 = np.random.normal(mu1, sigma1, n_scenarios)\nVaR1 = np.percentile(returns1, (1 - confidence_level) * 100)\n\n# Adjust Distribution 2: Mixture of normal distributions\nmu2, sigma2 = 0.01, 0.01\nextreme_mu, extreme_sigma = -0.04, 0.02\n\n# Create a mixture distribution that has the same VaR as Distribution 1\n# Adjust the proportion and parameters of the extreme component to match the target VaR\nfor _ in range(1000):\n    extreme_component = np.random.normal(\n        extreme_mu, extreme_sigma, int(n_scenarios * 0.05)\n    )\n    normal_component = np.random.normal(mu2, sigma2, int(n_scenarios * 0.95))\n    returns2 = np.concatenate([extreme_component, normal_component])\n    VaR2 = np.percentile(returns2, (1 - confidence_level) * 100)\n    if abs(VaR2 - VaR1) &lt; 0.0001:\n        break\n\n# Calculate ES\nES1 = np.mean(returns1[returns1 &lt;= VaR1])\nES2 = np.mean(returns2[returns2 &lt;= VaR2])\n\n# Plot histograms\nplt.figure(figsize=(14, 6))\n\n# Plot for Distribution 1\nplt.subplot(1, 2, 1)\nplt.hist(returns1, bins=50, alpha=0.75, color=\"#D6D2C4\", edgecolor=\"black\")\nplt.axvline(VaR1, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2)\nplt.axvline(ES1, color=\"green\", linestyle=\"dashed\", linewidth=2)\nplt.title(\"Distribution 1 (Normal)\")\nplt.xlabel(\"Return\")\nplt.ylabel(\"Frequency\")\nplt.legend([\"VaR at 95%\", \"ES\", \"Returns\"])\nplt.grid(True)\n\n# Plot for Distribution 2\nplt.subplot(1, 2, 2)\nplt.hist(returns2, bins=50, alpha=0.75, color=\"#D6D2C4\", edgecolor=\"black\")\nplt.axvline(VaR2, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2)\nplt.axvline(ES2, color=\"green\", linestyle=\"dashed\", linewidth=2)\nplt.title(\"Distribution 2 (Mixture)\")\nplt.xlabel(\"Return\")\nplt.ylabel(\"Frequency\")\nplt.legend([\"VaR at 95%\", \"ES\", \"Returns\"])\nplt.grid(True)\n\nplt.tight_layout()\nplt.show()\n\nprint(f\"Left: 95% VaR={VaR1:.5f}; Right: 95% VaR={VaR2:.5f}\")\nprint(f\"Left: Average loss beyond VaR is {ES1:.5f}\")\nprint(f\"Right: Average loss beyond VaR is {ES2:.5f}\")\n\n\n\n\n\n\n\n\nFigure 5: Distributions with same VaR but different ES\n\n\n\n\n\nLeft: 95% VaR=-0.01655; Right: 95% VaR=-0.01654\nLeft: Average loss beyond VaR is -0.02075\nRight: Average loss beyond VaR is -0.04258"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#es-conditional-var",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#es-conditional-var",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "ES: conditional VaR",
    "text": "ES: conditional VaR\nThe drawbacks of VaR became painfully evident during the financial crisis as asset returns plummeted into the fat-tail region of non-normally shaped distributions.\nFI managers and regulators were forced to recognize that VaR projections of possible losses far underestimated actual losses on extreme bad days.\nNow, regulators have replaced VaR with the expected shortfall (ES) measure as the main measure of market risk.\nExpected shortfall, aka “conditional VaR”, estimates the expected value of losses beyond a given confidence level—that is, it is the average of VaRs beyond a given confidence level."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#es-definition",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#es-definition",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "ES: definition",
    "text": "ES: definition\nFor a given confidence level \\(c\\) and a continuous probability distribution, ES can be calculated as \\[\nES(c) = \\frac{1}{1-c}\\int_c^1 VaR(c)du\n\\]\nThat is, for a confidence level of, say, 95% (i.e., \\(c\\)), we measure the area under the probability distribution from the 95th to 100th percentile.\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Parameters\nnp.random.seed(42)\nn_scenarios = 10000\nconfidence_level = 0.95\n\n# Adjust Distribution: Mixture of normal distributions\nmu2, sigma2 = 0, 0.01\nextreme_mu, extreme_sigma = -0.05, 0.02\n\n# Create a mixture distribution that has the desired VaR\nextreme_component = np.random.normal(extreme_mu, extreme_sigma, int(n_scenarios * 0.1))\nnormal_component = np.random.normal(mu2, sigma2, int(n_scenarios * 0.9))\nreturns = np.concatenate([extreme_component, normal_component])\nVaR = np.percentile(returns, (1 - confidence_level) * 100)\n\n# Calculate ES\nES = np.mean(returns[returns &lt;= VaR])\n\n# Plot histogram\nplt.figure(figsize=(10, 6))\n\n# Histogram data\nn, bins, patches = plt.hist(returns, bins=50, alpha=0.75, edgecolor=\"black\")\n\n# Highlight bars below VaR\nfor i in range(len(patches)):\n    if bins[i] &lt; VaR:\n        patches[i].set_facecolor(\"#A6192E\")\n    else:\n        patches[i].set_facecolor(\"#D6D2C4\")\n\n# Add VaR and ES lines\nplt.axvline(VaR, color=\"#A6192E\", linestyle=\"dashed\", linewidth=2, label=\"VaR at 95%\")\nplt.axvline(ES, color=\"purple\", linestyle=\"dashed\", linewidth=2, label=\"ES\")\n\nplt.title(\"Simulated Portfolio Returns with VaR and ES\")\nplt.xlabel(\"Return\")\nplt.ylabel(\"Frequency\")\nplt.legend()\nplt.grid(True)\n\nplt.show()\n\n\n\n\n\n\n\n\nFigure 6: Distribution of expected returns and ES"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#es-advantages-and-potential-problems",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#es-advantages-and-potential-problems",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "ES: advantages and (potential) problems",
    "text": "ES: advantages and (potential) problems\nES is the average of losses that occur beyond the VaR level. It provides a better risk assessment by considering the tail of the loss distribution.\nIn addition, an important advantage of ES over VaR is that ES is additive.\n\nThis means that the ES of a portfolio equals the sum of individual assets’ ESs.\nThe same does not hold true for VaR: recall that we have to consider covariances.\n\nPotential issues with the use of ES include:\n\nEstimation challenges, model dependency, computational complexity."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#bis-regulatory-models-1",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#bis-regulatory-models-1",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "BIS regulatory models",
    "text": "BIS regulatory models\nTwo major ways of calculating market risk exposures and capital requirements:\n\nThe BIS standardized framework\nBanks’ internal model approach (IMA), to be approved by regulatory supervisors\n\ne.g., RiskMetrics, back simulation, Monte Carlo, etc.\nmodels based on expected shortfall1\n\n\n\n\n\n\n\n\nImportant\n\n\nNote that the ultimate objective of measuring market risk exposure is to determine the appropriate capital requirement.\n\n\n\nIn Basel III, market risk measurement is shifted from VaR to ES. However, its implementation varies across countries."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#basel-iii-and-its-implementation",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#basel-iii-and-its-implementation",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Basel III and its implementation",
    "text": "Basel III and its implementation\nWith Basel III now being implemented by countries, the market risk measures are shifting from VaR to ES.\nThe implementation is planned to be phased in over five year since January, 2023.\nIn UK and US, the implementation is set to be applicable in 2025.\nIn Australia, APRA is reviewing the currently in force Prudential Standard APS 116 Capital Adequacy: Market Risk.\n\nAs at the time of this lecture, APRA will delay the effective dates of APS 116 from 2025 to 2026.\nThat is, currently, Australian banks using IMA measure market risks based on VaR.\n\n\n\n\n\n\n\nNote\n\n\nGlobally, banks are in need of talents with specialized knowledge in the field!"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#regulatory-model-standardized-framework",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#regulatory-model-standardized-framework",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Regulatory model: standardized framework",
    "text": "Regulatory model: standardized framework\nThe standardized framework is primarily designed for (smaller) banks that do not use internal models.\n\nCalculation is more formulaic and prescriptive, focusing on specific risk weights and capital charges for different types of assets and market risks.\n\nThe standardized approach capital requirement is the simple sum of three components:\n\nthe capital requirement under the sensitivities-based method,\nthe default risk capital (DRC) requirement, and\nthe residual risk add-on (RRAO).\n\n\n\n\n\n\n\nNote\n\n\nFor a detailed description, see MAR21, MAR22, and MAR23 in BIS Minimum capital requirements for market risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#regulatory-model-ima",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#regulatory-model-ima",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Regulatory model: IMA",
    "text": "Regulatory model: IMA\n\n\n\n\n\n\nImportant\n\n\nBanks’ IMA for market risk currently is based on VaR, but very soon (in the coming years) will be based on ES. Therefore, only the proposed ES-based IMA will be briefly explained here.\n\n\n\nGeneral steps:\n\nCalculation of expected shortfall\nCalculation of capital requirement for modellable risk factors\nCalculation of capital requirement for non-modellable risk factors\nCalculation of default risk capital requirement\nCalculation of capital requirement for model-ineligible trading desks\nAggregation of capital requirement\n\n\n\n\n\n\n\nNote\n\n\nFor a detailed description, see MAR33 in BIS Minimum capital requirements for market risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#suggested-readings",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nBIS The market risk framework in brief\nBIS Minimum capital requirements for market risk\nAPRA Prudential Standard APS 116 Capital Adequacy: Market Risk\nAPRA’s Policy Priorities\nBank of England Implementation of the Basel 3.1 standards: Market risk"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week5/index.html#references",
    "href": "teaching/AFIN8003/2025S1/Week5/index.html#references",
    "title": "AFIN8003 Week 5 - Market Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#introduction",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#introduction",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Introduction",
    "text": "Introduction\nIn Week 3, we discussed capital adequacy and the (Pillar 1 of Basel) minimum capital requirements, which involves the calculation of risk-weighted assets (RWA) that account for the various risks facing banks.\nAs suggested by Table 1 below, credit risk is likely the most significant risk factor, the risk that the promised cash flows from loans and securities may not be paid in full (e.g., borrower defaults).\n\n\n\nTable 1: RWA of Australian banks in 2023 (source: Capital IQ)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCBA\nWestpac\nNAB\nANZ\nMacquarie\n\n\n\n\nRWA for credit risk\n362,869\n339,758\n355,554\n349,041\n97,485\n\n\nRWA for market risk\n61,968\n51,676\n38,274\n41,967\n11,663\n\n\nRWA for operational risk\n43,155\n55,175\n41,178\n42,319\n15,828\n\n\nOther RWA\n0\n4,809\n0\n0\n0\n\n\nTotal RWA\n467,992\n451,418\n435,006\n433,327\n124,976\n\n\n\n\n\n\n\nFIs (banks) transform financial claims of household savers (e.g., deposits) into claims (e.g., loans) issued to corporations, individuals and governments.\nFIs accept the credit risk on these loans in exchange for a fair return sufficient to cover the cost of funding to household savers and the credit risk involved in lending."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#introduction-contd",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#introduction-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Introduction (cont’d)",
    "text": "Introduction (cont’d)\nThis week:\n\napproaches to analyzing and measuring the credit or default risk on individual loans (and bonds).\n\nNext week:\n\nmethods for evaluating the risk of the overall loan portfolio, or loan concentration risk.\n\nMeasurement of the credit risk on individual loans or bonds is crucial if an FI manager is to\n\nprice a loan or value a bond correctly, and\nset appropriate limits on the amount of credit extended to any one borrower or the loss exposure it accepts from any particular counterparty."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#importance-of-credit-risk-management",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#importance-of-credit-risk-management",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Importance of credit risk management",
    "text": "Importance of credit risk management\nCredit risk management is important because it involves the determination of many features of a loan (debt) instrument: interest rate, maturity, collateral requirement, and covenants.\n\nInadequate credit risk management could lead to higher default rates and bank insolvency, especially when markets are competitive and margins are low.\n\nDefault of one major borrower can have significant impact on value and reputation of many FIs.\n\nDirect impact on all lenders involved.\nContagion or spill-over effect on other FIs in the financial system.\n\nMajor economic or natural events can cause significant impact on many FIs loan portfolios.\n\nThe 2007-09 subprime mortgage crisis.\nFloods, earthquakes, etc."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#credit-risk-related-events",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#credit-risk-related-events",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit risk-related events",
    "text": "Credit risk-related events\nSubprime mortgage crisis and the resulting GFC 2007-09.\n\nBanks provided risky mortgages to subprime borrowers with poor credit.\nA housing boom led to speculative investments and rising home prices.\nLenders bundled these mortgages into mortgage-backed securities (MBS) and sold them to investors.\nMany loans had adjustable rates, which increased over time, causing payment difficulties.\nRising defaults led to a housing market collapse, triggering widespread financial losses.\nBanks and investors holding MBS faced a credit crisis, leading to bank failures and liquidity issues."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#credit-risk-related-events-contd",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#credit-risk-related-events-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit risk-related events (cont’d)",
    "text": "Credit risk-related events (cont’d)\nU.S. student loan debt and its future?\n\n$1.73 trillion student loan debt as at September 2021, 7.8% is in default.\n1 out of 10 Americans has defaulted on a student loan.\nPersonal consequences: homeownership, marriage, retirement savings, etc.\nEconomic burden: loan defaults can weigh down the entire country."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#banks-in-australia-non-performing-assets",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#banks-in-australia-non-performing-assets",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Banks in Australia: non-performing assets",
    "text": "Banks in Australia: non-performing assets\n\n\nFigure 1: Non-performing assets of banks in Australia"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#types-of-loans",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#types-of-loans",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Types of loans",
    "text": "Types of loans\nThe loans made by FIs can be broadly categorized into:\n\nCommercial and industrial (C&I) loans\nReal estate loans\nConsumer (individual) loans\nOthers"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#types-of-loans-ci-loans",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#types-of-loans-ci-loans",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Types of loans: C&I loans",
    "text": "Types of loans: C&I loans\nCommercial loans vary significantly in their features.\n\nMaturity, from a few weeks to years.\nAmount, from very small to millions or billions.\nSyndicated or not.\n\nA syndicated loan is one provided by a group of FIs as opposed to a single lender.\n\nSecured or unsecured.\nSpot loans vs loan commitment.\n\nSpot loan: a loan in which the loan amount is withdrawn immediately by the borrower.\nLoan commitment (or line of credit): a credit facility with a maximum size and a maximum period of time over which the borrower can withdraw funds."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#types-of-loans-real-estate-loans",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#types-of-loans-real-estate-loans",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Types of loans: real estate loans",
    "text": "Types of loans: real estate loans\nReal estate loans include residential loans (primarily mortgage loans) and commercial real estate loans.\nAs with C&I loans, residential mortgages differ widely in their characteristics:\n\nLoan size\nLTV (loan-to-value ratio): the ratio of the loan to the property’s price\nMaturity\nMortgage interest rates and fees: adjustable-rate mortgages (ARMs) and fixed-rate mortgages\n\nResidential mortgages are typically very long-term loans with 20yrs+ maturity.\n\nHousing price can fall below the loan amount, causing defaults and eventually foreclosures."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#types-of-loans-consumer-loans",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#types-of-loans-consumer-loans",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Types of loans: consumer loans",
    "text": "Types of loans: consumer loans\nConsumer (personal) loans include, for example, personal and auto loans.\nCredit cards are a type of consumer loan financing."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#types-of-loans-other-loans",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#types-of-loans-other-loans",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Types of loans: other loans",
    "text": "Types of loans: other loans\n“Other loans” include a variety of borrowers and types, including for example\n\nfarmers\nother banks\nnonbank FIs (e.g., broker margin loans)\nstate and local governments"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#calculating-the-return-on-a-loan",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#calculating-the-return-on-a-loan",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Calculating the return on a loan",
    "text": "Calculating the return on a loan\nOnce the decision to make a loan has been made, the pricing of the loan is an important aspect of credit risk management, which includes adjustments for the perceived credit risk of the borrower as well as any fees and collateral backing the loan.\nA traditional return on assets approach to calculate the return on a loan is explained here."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#contractually-promised-return-on-a-loan",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#contractually-promised-return-on-a-loan",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Contractually promised return on a loan",
    "text": "Contractually promised return on a loan\nFactors affecting the promised loan return:\n\nLoan interest rate\nCredit risk premium\nFees\nCollateral\nNon-price terms"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#contractually-promised-return-on-a-loan-contd",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#contractually-promised-return-on-a-loan-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Contractually promised return on a loan (cont’d)",
    "text": "Contractually promised return on a loan (cont’d)\n\n\nSuppose that an FI makes a spot one-year $1 million loan. The loan rate may be set as\n\\[\n\\begin{aligned}\n\\text{Base lending rate } BR &= 8\\% \\\\\n\\text{+ Credit risk premium } \\phi &= 2\\% \\\\\nBR + \\phi &= 10\\%\n\\end{aligned}\n\\]\n\nThe base lending rate (BR) reflects the FI’s weighted-average cost of capital (WACC) or its marginal cost of funds.\n\nFor example, LIBOR-the London Inter-Bank Offered Rate.\nLIBOR manipulation scandal led to its phasing out and replacement by more transparent and reliable rates like SOFR-the Secured Overnight Financing Rate.\nThe Australian equivalent is the Bank Bill Swap Rate (BBSW).\n\nThe base lending rate could also reflect the prime lending rate, the interest rate that commercial banks charge their most creditworthy and low-risk corporate customers.\n\n\n\n\n\n\nNote\n\n\nLIBOR/SOFR (BBSW) more commonly used for short-term loans, while prime rates more for long-term loans.\n\n\n\nA credit risk premium is added to the base lending rate."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#contractually-promised-return-on-a-loan-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#contractually-promised-return-on-a-loan-contd-1",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Contractually promised return on a loan (cont’d)",
    "text": "Contractually promised return on a loan (cont’d)\nDirect and indirect fees and charges:\n\nLoan origination fee (\\(f\\)) for processing the application.\nCompensating balance requirement (\\(b\\)) to be held as (demand) deposits.\n\nA portion of the loan that the borrower must keep in a deposit account, typically earning little or no interest, which helps the bank secure funds and reduce the effective loan amount while still charging interest on the full loan value.\n\nReserve requirement (\\(RR\\)) imposed by regulatory authority on the demand deposits.\n\n\n\n\n\n\n\n\nNumeric example\n\n\n\nIf a borrower takes a loan of $100,000 but must maintain a compensating balance of 10%, they need to keep $10,000 in a non-interest-bearing deposit account with the bank. Thus, they effectively receive $90,000 but pay interest on the full $100,000.\nThe bank receives this $10,000 in deposits. Given a reserve requirement of 5%, the bank must keep \\(\\$10,000 \\times 5\\%=\\$500\\) in reserve (cash or deposits with the central bank)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#contractually-promised-return-on-a-loan-contd-2",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#contractually-promised-return-on-a-loan-contd-2",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Contractually promised return on a loan (cont’d)",
    "text": "Contractually promised return on a loan (cont’d)\nThe gross return on loan (\\(k\\)) per dollar lent is given by \\[\n1+k = 1+\\frac{f+(BR+\\phi)}{1-[b(1-RR)]}\n\\]\n\n\n\n\n\n\n\nAn annotated version of the formula\n\n\n\\[\n1+k=1+\\frac{\\overbrace{f+(BR+\\phi)}^{\\text{interest and fees earned}}}{\\underbrace{1}_{\\$1 \\text{ loan}}-[\\underbrace{b}_{\\text{amount of loan deposited with the bank}}\\times \\underbrace{(1-RR)}_{\\text{not reserved for regulatory compliance}}]}\n\\]\n\nFor every $1 the FI lends, it retains \\(b\\) as compensating balance. The borrower receives \\(1-b\\).\nSince \\(b\\) is held by the borrower at the FI as a demand deposit account, regulatory authority requires the bank to hold reserves at a rate \\(RR\\) against the compensating balance.\nThe net outflow by the bank per $1 of loans made is therefore \\(1-[b(1-RR)]\\), 1 minus the reserve-adjusted compensating balance requirement."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#contractually-promised-return-on-a-loan-contd-3",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#contractually-promised-return-on-a-loan-contd-3",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Contractually promised return on a loan (cont’d)",
    "text": "Contractually promised return on a loan (cont’d)\nSuppose a bank does the following:\n\nSets the loan rate on a prospective loan at 10% (where \\(BR\\)=6% and \\(\\phi\\)=4%)\nCharges a 12.5 basis point (or 0.125%) loan origination fee \\(f\\) to the borrower\nImposes an 8% compensating balance requirement \\(b\\) to be held as non-interest-bearing demand deposits\nSets aside reserve, at a rate of 10% of deposits, held at the central bank (i.e. \\(RR\\) is 10%)\n\nWhat is the contractually promised gross return on the loan? \\[\n\\begin{aligned}\n1+k &= 1+\\frac{f+(BR+\\phi)}{1-[b(1-RR)]} \\\\\n1+k &= 1+\\frac{0.00125+(0.06+0.04)}{1-[0.08(1-0.1)]} \\\\\n1+k &= 1+\\frac{0.10125}{0.928} \\\\\nk &= 10.91\\%\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#some-notes",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#some-notes",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Some notes",
    "text": "Some notes\nSince March 26, 2020, reserve requirements (\\(RR\\)) are eliminated for all depositary institutions in the U.S.\nAs commercial lending markets have become more competitive, both origination fees (\\(f\\)) and compensating balances (\\(b\\)) are becoming less important.\nAs a result, the credit risk premium (\\(\\phi\\)) is the primary determinant for the promised return of a loan, once the base rate is set.\n\n\n\n\n\n\nNote\n\n\nTo achieve a target promised gross return (\\(k\\)) on a loan, an FI can use various combinations of fees, compensation balances, and risk margins."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#the-expected-return-on-a-loan",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#the-expected-return-on-a-loan",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "The expected return on a loan",
    "text": "The expected return on a loan\nThe promised return on a loan (\\(k\\)) can differ from the expected return and the actual return on the loan because of default risk.\nAt the time the loan is made, the expected return \\(E(r)\\) per dollar lent is related to the promised return \\(k\\) as follows: \\[\n1+E(r) = p(1+k) + (1-p)\\times 0\n\\] where \\(p\\) is the probability of complete repayment of the loan and \\((1-p)\\) is the probability of default, in which case the FI receives nothing.1 The expected return is a weighted average of:\n\nFull repayment: \\((1+k)\\) with probability of \\(p\\)\nNo repayment: 0 with probability of \\((1-p)\\)\n\nIf \\(p&lt;1\\):\n\nDefault risk exists\nFI needs to set risk premium\nFI needs to recognize that higher fees and charges might decrease \\(p\\)\n\nIn practice, the FI may recover part of the loan."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#the-expected-return-on-a-loan-contd",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#the-expected-return-on-a-loan-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "The expected return on a loan (cont’d)",
    "text": "The expected return on a loan (cont’d)\nSuppose a bank does the following:\n\nSets the loan rate on a prospective loan at 10%\nExpects a probability of default of 5%\nRecovers nothing if the loan is defaulted\n\nWhat is the expected return on the loan?\nThe probability of default \\((1-p)=0.05\\); loan rate is 10%. \\[\n\\begin{aligned}\n1+E(r) &= p(1+k) = (1-0.05)(1+0.1) = 1.045 \\\\\n  E(r) &= 0.045\n\\end{aligned}\n\\] Expected return on this loan is 4.5%."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#some-notes-1",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#some-notes-1",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Some notes",
    "text": "Some notes\nFIs usually control credit risk along two dimensions:\n\nthe price or promised return dimension, and\nthe quantity or credit availability dimension.\n\nThe quantity dimension applies more in retail (e.g., consumer) loans.\nThe price dimension applies more in wholesale (e.g., C&I) loans."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#retail",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#retail",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Retail",
    "text": "Retail\nRetail loans to household borrowers (consumers) tend to have smaller size and higher costs of information collection, and as a result, retail lending decisions tend to be “accept or reject” decisions.\n\nBorrowers of a similar loan product, regardless of their credit risk, are often charged the same credit risk premium.\n\nRetail customers are more likely to be sorted or rationed by loan quantity restrictions than by price (interest rate) differences.\n\nIn finance words, an FI controls its credit risk at the retail level by credit rationing.\n\n\n\n\n\n\n\nNote\n\n\nResidential mortgages are a good example. Two mortgage borrowers may pay the same mortgage rate while their LTVs are different."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#wholesale",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#wholesale",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Wholesale",
    "text": "Wholesale\nAt the wholesale (C&I) level, FIs use both interest rates and credit quantity to control credit risk.\n\nAs long as they are compensated with sufficiently high credit risk premium, FIs may be willing to lend to high-risk wholesale borrowers.\nHowever, higher interest rates may increase the probability of borrower’s default, reducing expected return.\n\n\n\n\n\n\n\nNote\n\n\nAnother important consideration is that only high-risk borrowers may be willing to borrow at high interest rates. This is an “adverse selection” problem.\n\n\n\n\nAs a result, FIs may credit ration its wholesale loans beyond certain interest rate level. That is, the FI can establish an upper ceiling on the amount of loan it is willing to lend.\n\n\n\n\n\n\n\nTip\n\n\nSometimes, an FI can achieve a higher expected return on its loan portfolio if it cuts its loan rates."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#it-is-all-about-information",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#it-is-all-about-information",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "It is all about information",
    "text": "It is all about information\nTo calibrate the credit risk exposure, FIs need to estimate the borrower’s default probability, which largely depends on their ability to collect and analyze information, cost-efficiently.\n\nAt the retail level, such information may be collected internally (e.g., past banking records) or externally (e.g., credit reports from rating agencies).\n\nThere are three main credit reporting bodies in Australia: Equifax, illion and Experian\n\nAt the wholesale level, such information comes from multiple sources:\n\nLarge, public firms: financial statements, stock and bond prices, analysts’ reports, etc.\nSmaller, private firms: financial statements (if any)\n\n\n\n\n\n\n\n\nNote\n\n\nAdvances in technologies make it easier to collect and analyze information of smaller borrowers."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#protection-against-credit-risk",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#protection-against-credit-risk",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Protection against credit risk",
    "text": "Protection against credit risk\nLoan covenants are often used mitigate credit risk. Covenants are loan contract terms that restrict or encourage various actions to enhance the probability of repayment.\n\nFor example, covenants may limit the type and amount of new debt, investments, and asset sales the borrower can undertake while the loan is outstanding.\nFinancial covenants may restrict changes in the borrower’s financial ratios such as leverage or current ratio."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#example-loan-contract-covenants",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#example-loan-contract-covenants",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Example loan contract covenants",
    "text": "Example loan contract covenants\nCredit Agreement, dated as of October 2, 2017, among Cincinnati Bell Inc. (borrower), Morgan Stanley Senior Funding Inc. (lead bank) and other lenders.\n\nArticle VII Affirmative Covenants\nArticle VIII Negative Covenants"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#default-risk-models-1",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#default-risk-models-1",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Default risk models",
    "text": "Default risk models\nMany different qualitative and quantitative models are employed to assess the default risk on loans and bonds.\n\nThey are not mutually exclusive.\nAn FI manager may use both qualitative and quantitative models and use more than one model to reach a credit decision.\n\nA significant amount of investments into the development of highly effective credit risk models."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#qualitative-models",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#qualitative-models",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Qualitative models",
    "text": "Qualitative models\nBorrower-specific factors are considered as well as market or systematic factors.\nSpecific factors include:\n\nReputation: implicit contract\nLeverage (capital structure)\nVolatility of earnings\nCollateral\n\nMarket-specific factors include:\n\nBusiness cycle\nLevel of interest rates\n\n\n\n\n\n\n\nNote\n\n\nA LOT more factors are considered in practice than we can discuss here."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#quantitative-models",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#quantitative-models",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Quantitative models",
    "text": "Quantitative models\nCredit scoring models use observed borrower characteristics to\n\neither calculate a score representing the applicant’s default probability, or\nsort borrowers into different default risk classes.\n\n\n\nScoring models might help to:\n\nEstablish factors that help to explain default risk\nEvaluate the relative importance of these factors\nImprove the pricing of default risk\nSort out bad loan applicants\nMore easily calculate reserve needs\n\n\nThree broad types\n\nLinear probability models\nLogit models\nLinear discriminant analysis"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#credit-scoring-linear-probability-models",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#credit-scoring-linear-probability-models",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit scoring: linear probability models",
    "text": "Credit scoring: linear probability models\nUses past data, such as financial ratios, as inputs into a linear model to explain repayment experience on old loans.\n\\[\nPD_i = \\sum^n_{j=1} \\beta_j X_{ij} + \\text{error}\n\\] where\n\n\\(PD_i\\) is the probability of default of borrower \\(i\\)\n\\(\\beta_j\\) is the estimated importance of the \\(j\\)th variable (e.g, leverage)\n\\(X_{ij}\\) is a set of causal variables that reflect quantitative information about the \\(i\\)th borrower"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#credit-scoring-linear-probability-models-contd",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#credit-scoring-linear-probability-models-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit scoring: linear probability models (cont’d)",
    "text": "Credit scoring: linear probability models (cont’d)\nSuppose there were two factors influencing the past default behaviour of borrowers: the leverage (D/E) and sales-asset ratio (S/A).\nBased on past default (repayment) experience, the linear probability model is estimated as:\n\\[\nPD = 0.5\\times \\frac{D}{E} - 0.0525 \\times \\frac{S}{A}\n\\]\nAssume a prospective borrower has a \\(D/E\\) of 0.3 and an \\(S/A\\) of 2. Its estimated default probability is \\[\nPD = 0.5\\times 0.3 - 0.0525 \\times 2 = 0.045\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#credit-scoring-logit-models",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#credit-scoring-logit-models",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit scoring: logit models",
    "text": "Credit scoring: logit models\n\n\n\n\n\n\nCaution\n\n\nLinear probability model has a weakness being that the estimated probability may be smaller than 0 or larger than 1. This can be addressed by the logit model.\n\n\n\nEssentially, this is done by plugging the estimated value of \\(PD\\) from the linear probability model (in previous example, \\(PD=0.045\\)), into the following formula:\n\\[\nF(PD) = \\frac{1}{1+e^{-PD}}\n\\] where \\(F(PD)\\) is the logistically transformed value of \\(PD\\).\n\nOther alternatives include Probit and other variants with nonlinear indicator functions."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#credit-scoring-linear-discriminant-analysis",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#credit-scoring-linear-discriminant-analysis",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Credit scoring: linear discriminant analysis",
    "text": "Credit scoring: linear discriminant analysis\n\nLinear probability and logit models estimate a default probability (a value from 0 to 1) if a loan is made.\nDiscriminant models divide borrowers into high/low default risk classes based on observed characteristics.\n\nAltman’s Z score model for manufacturing firms:\n\n\n\\[\nZ = 1.2 X_1 + 1.4 X_2 + 3.3 X_3 + 0.6 X_4 + 1.0 X_5\n\\] where\n\n\\(X_1 = \\text{Working capital / Total assets}\\).\n\\(X_2 = \\text{Retained earnings / Total assets}\\).\n\\(X_3 = \\text{Earnings before interest and taxes / Total assets}\\).\n\\(X_4 = \\text{Market value of equity / Book value of total liabilities}\\).\n\\(X_5 = \\text{Sales / Total assets}\\).\n\n\nThe classification:\n\nHigh default risk: \\(Z&lt;1.81\\)\nIndeterminant defaualt risk: \\(1.81&lt;Z&lt;2.99\\)\nLow default risk: \\(Z&gt;2.99\\)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#weaknesses-of-credit-scoring-models",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#weaknesses-of-credit-scoring-models",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Weaknesses of credit scoring models",
    "text": "Weaknesses of credit scoring models\n\nWeights in any credit scoring model unlikely to be constant over longer periods of time\nVariables in any credit scoring model unlikely to be constant over longer periods of time\nModels ignore hard-to-quantify factors such as borrower reputation\nThere is no centralised database on defaulted business loans for proprietary or other reasons\nDiscriminant models make broad distinction between borrower categories, that is, good and bad borrowers, yet in the real world various gradations of default exist, from non-payment or delay of interest payments (nonperforming assets) to outright default on all promised interest and principal payments\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#newer-models-of-credit-risk-measurement-and-pricing",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#newer-models-of-credit-risk-measurement-and-pricing",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Newer models of credit risk measurement and pricing",
    "text": "Newer models of credit risk measurement and pricing\nNewer credit risk models use finance theory and more widely available financial market data to make inference about default probabilities on debt and loan instruments.\nA lot of research is taking place and we consider a number of these newer approaches here, including\n\nTerm structure of credit risk approach (also called reduced-form models)\nMortality rate derivation of credit risk\nRAROC\nOption models (also called structural models since they are based on an economic model of why firms default)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#term-structure-derivation-of-credit-risk",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#term-structure-derivation-of-credit-risk",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Term structure derivation of credit risk",
    "text": "Term structure derivation of credit risk\nA simple key idea: extract the expected default rates from the current term structure of interest rates.\nA risk-neutral FI would be indifferent between investing in a risk-free government bond and a risky corporate loan/bond.\n\nRisk-free return: \\(1+i\\)\nCorporate bond’s expected return: \\(p(1+k)+(1-p)(1+k)\\gamma\\)\n\nwhere \\(\\gamma\\) is the recovery rate if the loan defaults.\nWe can set \\(p(1+k)+(1-p)(1+k)\\gamma = 1 + i\\) and compute the risk-neutral default probability \\((1-p)\\).\n\nMay be generalised to loans with any maturity or to adjust for varying default recovery rates.\nThe loan can be assessed using the inferred probabilities from comparable quality bonds."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#mortality-rate-derivation-of-credit-risk",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#mortality-rate-derivation-of-credit-risk",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Mortality rate derivation of credit risk",
    "text": "Mortality rate derivation of credit risk\nRather than extracting expected default rates from the current term structure of interest rates, the probability of default is estimated from past data on defaults, similar to the process employed by insurance companies to price policies.\n\n\n\n\n\n\nTip\n\n\nInsurance companies do not estimate an individual’s future health condition, but rather, use historic data to statistically examine a pool of people with similar characteristics (e.g., age, gender, medical history) to calculate the probability of mortality or other health-related risks over time.\n\n\n\nFor example, for grade B bonds, the marginal mortality rate (MMR) for the first year of issue is \\[\nMMR_1 = \\frac{\\text{Total value of grade B bonds default in year 1 of issue}}{\\text{Total value of grade B bonds outstanding in year 1 of issue}}\n\\] We can similarly construct \\(MMR_2\\), \\(MMR_3\\), …, and construct a MMR curve.\n\nMortality rate approach has a number of conceptual and applicability problems.\nHistoric, backward-looking, sensitive to the period chosen for analysis."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#raroc",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#raroc",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "RAROC",
    "text": "RAROC\nRisk-adjusted return on capital (RAROC) was pioneered by Bankers Trust (acquired by Deutsche bank in 1998).\n\\[\nRAROC = \\frac{\\text{One-year net income on a loan}}{\\text{Loan risk}}\n\\] where \\[\n\\text{One-year net income on loan} = (\\text{Spread} + \\text{Fees}) \\times \\text{Dollar value of the loan outstanding}\n\\] and Loan risk can be measure by, for example, duration. \\[\n\\frac{\\Delta LN}{LN} = - D_{LN} \\frac{\\Delta R}{1+R}\n\\] so that \\[\n\\underbrace{\\Delta LN}_{\\text{dollar risk exposure}} = - \\underbrace{D_{LN}}_{\\text{duration of loan}} \\times \\underbrace{LN}_{\\text{loan amount}} \\times \\underbrace{\\frac{\\Delta R}{1+R}}_{\\text{shock}}\n\\]\n\nLoan approval if RAROC &gt; benchmark return on capital."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#option-models-of-default-risk",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#option-models-of-default-risk",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Option models of default risk",
    "text": "Option models of default risk\nRationale:\n\nA borrower borrows to invest.\nIf its investments are successful, the borrower repays.\nIf its investments fail and the borrower cannot repay the lender,\n\nThe borrower has an option to default on its debt, simply turning any remaining assets over to the lender.\n\nThe borrower’s (equity holders’) loss is capped due to limited liability.\n\n\n\n\n\n\n\nNote\n\n\nThe KMV Corporation1 turned this relatively simple idea into a credit monitoring model.\nMany of the largest U.S. FIs are now using this model to determine the expected default frequency (EDF) of large corporations.\n\n\n\nThe KMV Corporation was purchased by Moody’s in 2002 and is now part of Moody’s Analytics Enterprise Risk Solutions."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#option-models-of-default-risk-contd",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#option-models-of-default-risk-contd",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Option models of default risk (cont’d)",
    "text": "Option models of default risk (cont’d)\nWe can use option pricing models like Merton (1974) and Black and Scholes (1973) to estimate default probability. The option valuation models can also be applied to calculate the default risk premium.\nMerton (1974) shows that the market value of risky loan made by a lender to a borrower is\n\n\n\\[\nL(\\tau) = B e^{-i\\tau} [(1/d) N(h_1) + N(h_2)]\n\\] where\n\n\\(\\tau\\) is the time remaining to loan maturity\n\\(i\\) is the risk-free rate\n\\(d\\) is the borrower’s leverage ratio measured as \\(B e^{-i\\tau} / A\\), where \\(A\\) is assets’ value\n\\(N(\\cdot)\\) is the cumulative normal distribution function\n\n\n\\[\n\\begin{aligned}\nh_1 &= - \\frac{[\\frac{1}{2} \\sigma^2 \\tau - \\ln(d)]}{\\sigma \\sqrt{\\tau}} \\\\\nh_2 &= - \\frac{[\\frac{1}{2} \\sigma^2 \\tau + \\ln(d)]}{\\sigma \\sqrt{\\tau}}\n\\end{aligned}\n\\]\n\n\\(\\sigma^2\\) measures the asset risk of the borrower, which is the variance of the rate of change in the value of the underlying assets of the borrower\n\n\nThe equilibrium default risk premium (\\(\\phi\\)) that the borrower should be charged is\n\\[\n\\phi = k(\\tau) - i = -\\frac{1}{\\tau} \\ln [N(h_2)+(1/d) N(h_1)]\n\\]\n\n\\(k(\\tau)\\) is the contractually promised return"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#option-models-of-default-risk-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#option-models-of-default-risk-contd-1",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Option models of default risk (cont’d)",
    "text": "Option models of default risk (cont’d)\n\n\nCode\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nmu = 3  # mean\nsigma = 1  # standard deviation\n\nx = np.linspace(0, 6, 300)\ny = (1 / (np.sqrt(2 * np.pi) * sigma)) * np.exp(-0.5 * ((x - mu) / sigma) ** 2)\n\nfig, ax = plt.subplots(figsize=(8, 6))\n\nax.plot(x, y, color='blue')\n\nx_fill = np.linspace(0, 0.8, 100)\ny_fill = (1 / (np.sqrt(2 * np.pi) * sigma)) * np.exp(-0.5 * ((x_fill - mu) / sigma) ** 2)\nax.fill_between(x_fill, y_fill, color='blue', alpha=0.3)\n\nax.annotate('Probability of default\\n(EDF)', xy=(0.5, 0.0), xytext=(0.01, 0.1),\n            arrowprops=dict(facecolor='black', arrowstyle='-&gt;'), fontsize=12)\n\nax.annotate('Market value at time 0', xy=(3, 0.0), xytext=(3, 0.2),\n            arrowprops=dict(facecolor='black', arrowstyle='-&gt;'), fontsize=12)\n\n# Set limits and labels\nax.set_xlim([0, 6])\nax.set_ylim([0, 0.5])\nax.set_xticklabels([])\nax.set_yticklabels([])\nax.set_xlabel('Market value of assets at loan maturity')\nax.set_ylabel('Probability')\n\n# Show plot\nplt.show()\n\n\n\n\n\n\n\n\nFigure 2: EDF and assets value"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#suggested-readings",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nRBA Interest Rate Benchmark Reform in Australia.\nRisk Management Association (RMA) content on credit risk.\n\nRMA provides average balance sheet and income data for more than 400 industries, common ratios computed for each size group and industry, five-year trend data, and financial statement data for more than 100,000 commercial borrowers.\n\n\nIf you’re into Math and would like to see some code,\n\nMerton distance to default (DD)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week6/index.html#references",
    "href": "teaching/AFIN8003/2025S1/Week6/index.html#references",
    "title": "AFIN8003 Week 6 - Credit Risk I: Individual Loan Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nBlack, Fischer, and Myron Scholes. 1973. “The Pricing of Options and Corporate Liabilities.” Journal of Political Economy 81 (3): 637–54. http://www.jstor.org/stable/1831029.\n\n\nMerton, Robert C. 1974. “On the Pricing of Corporate Debt: The Risk Structure of Interest Rates*.” The Journal of Finance 29 (2): 449–70. https://doi.org/10.1111/j.1540-6261.1974.tb03058.x."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#introduction",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#introduction",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Introduction",
    "text": "Introduction\n\nIn Week 6, we discussed alternative ways by which FI managers can measure the default (credit) risk on individual loans.\nFIs typically hold a portfolio of loans and hence credit risk should also be measured and managed in a portfolio context.\nThis week, we discuss several models used by FI managers to assess the risk of the overall loan portfolio.\nWe will also discuss the use of derivatives to manage credit risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#simple-models",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#simple-models",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Simple models",
    "text": "Simple models\n\n\n\n\n\n\nCaution\n\n\nA large credit risk exposure to a single borrower or group of related borrowers poses a potential threat to a bank’s safety and soundness.\n\n\n\n\nRegulations are in place to limit such exposure.\nAs a result, individual loans rarely cause material losses or bank failures.\nPrimary cause of credit-related distress is that pools of individual loans sharing similar characteristics perform similarly, especially during extreme conditions.\nAn important lesson learned is that products exposed to the same types of risks can have different names and under different business units.\n\nTwo simple models widely employed to measure credit risk concentration in the loan portfolio:\n\nMigration analysis\nConcentration limits"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#simple-model-migration-analysis",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#simple-model-migration-analysis",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Simple model: migration analysis",
    "text": "Simple model: migration analysis\n\nTrack credit ratings of certain types of loans or certain sectors, either externally from credit rating agencies or internally.\nIf actual rating deteriorates faster than historical experience, limit lending to that loan class or sector.\nHistorical credit migration measured through loan migration matrix (or transition matrix).\n\n\n\n\nTable 1: Example loan migration matrix\n\n\n\n\n\n\nAAA-A\nBBB-B\nCCC-C\nDefault\n\n\n\n\nAAA-A\n0.85\n0.10\n0.04\n0.01\n\n\nBBB-B\n0.12\n0.83\n0.03\n0.02\n\n\nCCC-C\n0.03\n0.13\n0.80\n0.04\n\n\n\n\n\n\nTable 1, for example, shows the transition probabilities of loans that began the year with a certain credit rating being upgraded/downgraded to a certain rating, or default.\n\n\nThe probability of AAA-rated loan at the start of a year being downgraded to BBB to B by the year’s end is 0.10.\nThe probability of AAA-rated loan at the start of a year being downgraded to CCC to C by the year’s end is 0.04.\nThe probability of AAA-rated loan at the start of a year defaults by the year’s end is 0.01."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#simple-model-migration-analysis-contd",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#simple-model-migration-analysis-contd",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Simple model: migration analysis (cont’d)",
    "text": "Simple model: migration analysis (cont’d)\nIn practice, FIs use migration matrices with many more rating classes.\nMigration analysis is used not only to evaluate commercial loan portfolios, but also to analyze credit card portfolios and consumer loans.\nHowever, potential problems with migration analysis include, for example:\n\nUse of historical data.\nRating agencies usually downgrade only after the firm has experienced a downturn."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#simple-model-concentration-limits",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#simple-model-concentration-limits",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Simple model: concentration limits",
    "text": "Simple model: concentration limits\n\nLimits set on the maximum loan size to an individual borrower/sector or geographical area.\nUsed to reduce exposures to certain industries and to increase exposure to others.\nUse of aggregate limits for industries in which performance is highly correlated.\nBank regulators also limit loan concentrations to individual borrowers to a maximum of 15% of a bank’s capital.\n\n\\[\n\\text{Concentration limit} = \\text{Maximum loss as a percentage of capital} \\times \\frac{1}{\\text{Loss rate}}\n\\]\n\n\n\n\n\n\n\nExample\n\n\nIf an FI’s manager is unwilling to permit losses exceeding 15% of the FI’s capital, with an estimated loss rate in a particular industry of 40 per cent, then the manager should set a concentration limit on the exposure to that industry as \\(15\\%\\times \\frac{1}{0.4}=37.5\\%\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#simple-model-concentration-limits-contd",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#simple-model-concentration-limits-contd",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Simple model: concentration limits (cont’d)",
    "text": "Simple model: concentration limits (cont’d)\nBelow is an industry breakdown of Bank of Queensland’s (BOQ) credit exposure as reported in FY2023’s annual report.\n\n\n\nTable 2: Proportionate credit exposures of lending activities of BOQ FY23\n\n\n\n\n\nSector\n$m\n% of Total Exposure\n\n\n\n\nResidential mortgages\n62,738\n77.8\n\n\nProperty and construction\n6,887\n8.5\n\n\nHealthcare\n2,763\n3.4\n\n\nProfessional services\n2,431\n3.0\n\n\nAgriculture\n1,232\n1.5\n\n\nTransportation\n606\n0.8\n\n\nManufacturing and mining\n682\n0.8\n\n\nHospitality and accommodation\n841\n1.0\n\n\nOther\n2,453\n3.0\n\n\nTotal\n80,633\n100.0"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#loan-portfolio-diversification-and-mpt",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#loan-portfolio-diversification-and-mpt",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Loan portfolio diversification and MPT",
    "text": "Loan portfolio diversification and MPT\nMPT can be used to measure and control an FI’s aggregate credit risk exposure.\nAny model that seeks to estimate an efficient frontier for loans needs to determine and measure three things:\n\nThe expected return on individual loans\nThe risk of individual loans\nThe correlation of default risks between loans\n\nExpected return \\(R_p\\) of a portfolio of \\(N\\) assets:\n\\[\nR_p = \\sum_{i=1}^N X_i R_i\n\\]\nwhere\n\n\\(R_i\\) is the expected return on the \\(i\\)th asset\n\\(X_i\\) is the proportion of the asset portfolio invested in the \\(i\\)th asset (the desired concentration amount)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#loan-portfolio-diversification-and-mpt-contd",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#loan-portfolio-diversification-and-mpt-contd",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Loan portfolio diversification and MPT (cont’d)",
    "text": "Loan portfolio diversification and MPT (cont’d)\nVariance of returns (or risk) of the portfolio \\(\\sigma_p^2\\) can be calculated as\n\\[\n\\begin{aligned}\n\\sigma_i^2 &= \\sum_{i=1}^N X_i^2 \\sigma^2_i + \\sum_{i=1}^N \\sum_{j=1}^N X_i X_j \\sigma_{ij} \\\\\n           &= \\sum_{i=1}^N X_i^2 \\sigma^2_i + \\sum_{i=1}^N \\sum_{j=1}^N X_i X_j \\rho_{ij} \\sigma_i \\sigma_j\n\\end{aligned}\n\\]\nwhere\n\n\\(\\rho_{ij}\\) is the correlation between the returns on the \\(i\\)th asset \\(j\\)th asset\n\\(\\sigma_i^2\\) is the variance of returns on the \\(i\\)th asset\n\\(\\sigma_{ij}^2\\) is the covariance of returns between the \\(i\\)th asset and \\(j\\)th asset"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#loan-portfolio-diversification-and-mpt-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#loan-portfolio-diversification-and-mpt-contd-1",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Loan portfolio diversification and MPT (cont’d)",
    "text": "Loan portfolio diversification and MPT (cont’d)\nThe fundamental lesson of MPT is that by taking advantage of its size, an FI can diversify considerable amounts of credit risk as long as the returns on different assets are imperfectly correlated with respect to their default risk adjusted returns.\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Define annualized returns and covariance matrix for two assets\nmean_returns = np.array([0.04, 0.1])  # Expected annual returns for two assets\ncov_matrix = np.array([[0.06, 0.02], [0.02, 0.10]])  # Covariance matrix of returns\nindividual_volatility = np.sqrt(np.diag(cov_matrix))  # Volatility of individual assets\n\n# Define the number of portfolios to simulate\nnum_portfolios = 10000\n\n# Initialize empty lists to store portfolio returns, volatilities, and weights\nresults = np.zeros((3, num_portfolios))\n\n# Simulate random portfolios\nfor i in range(num_portfolios):\n    # Generate random weights for the two assets\n    weights = np.random.random(2)\n    weights /= np.sum(weights)  # Ensure weights sum to 1\n\n    # Calculate portfolio return and volatility (risk)\n    portfolio_return = np.dot(weights, mean_returns)\n    portfolio_volatility = np.sqrt(np.dot(weights.T, np.dot(cov_matrix, weights)))\n\n    # Store the results\n    results[0, i] = portfolio_volatility\n    results[1, i] = portfolio_return\n    results[2, i] = portfolio_return / portfolio_volatility  # Sharpe ratio\n\n# Calculate the Global Minimum Variance Portfolio (GMVP)\ninv_cov_matrix = np.linalg.inv(cov_matrix)\nones = np.ones(len(mean_returns))\nweights_gmvp = inv_cov_matrix.dot(ones) / ones.T.dot(inv_cov_matrix).dot(ones)\ngmvp_return = weights_gmvp.dot(mean_returns)\ngmvp_volatility = np.sqrt(weights_gmvp.T.dot(cov_matrix).dot(weights_gmvp))\n\n# Plot the efficient frontier\nplt.figure(figsize=(10, 6))\nplt.scatter(\n    results[0, :], results[1, :], c=results[2, :], cmap=\"Blues\", marker=\"o\", alpha=1\n)\nplt.colorbar(label=\"Sharpe Ratio\")\n\n# Plot individual assets as red dots\nplt.scatter(\n    individual_volatility[0],\n    mean_returns[0],\n    # color=\"red\",\n    marker=\"o\",\n    s=100,\n    label=\"Asset 1\",\n)\nplt.scatter(\n    individual_volatility[1],\n    mean_returns[1],\n    # color=\"blue\",\n    marker=\"o\",\n    s=100,\n    label=\"Asset 2\",\n)\n# Plot GMVP\nplt.scatter(gmvp_volatility, gmvp_return, color=\"red\", marker=\"X\", s=100, label=\"GMVP\")\n\n# Set axis limits to start from 0\nplt.xlim(0, np.max(results[0, :]) + 0.02)  # Add a small margin on the right\nplt.ylim(0, np.max(results[1, :]) + 0.02)  # Add a small margin on the top\n\n# Annotate the plot\nplt.title(\"Efficient Frontier with Two Assets\")\nplt.xlabel(\"Volatility (Risk)\")\nplt.ylabel(\"Expected Return\")\nplt.legend(loc=\"upper left\")\nplt.show()\n\n\n\n\n\n\n\n\nFigure 1: MPT and efficient frontier\n\n\n\n\n\nMinimum risk portfolio (Global Minimum Variance Portfolio, GMVP)\n\nCombination of assets that reduces the variance of portfolio returns on the lowest feasible level."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#moodys-analytics-riskfrontier-model",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#moodys-analytics-riskfrontier-model",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Moody’s Analytics RiskFrontier Model",
    "text": "Moody’s Analytics RiskFrontier Model\nMoody’s Analytics RiskFrontier model (previously Portfolio Manager model) estimates the return, risk and correlations between loans in an FI’s loan portfolio (with its own proprietary methods), which are then incorporated into the standard MPT equations to get an estimate of the risk and return of the FI’s loan portfolio.\n\nMoody’s Analytics Credit Monitor model estimates EDF (Expected Default Frequency) to examine the default risk of individual loans.\nMoody’s Analytics RiskFrontier model then uses EDF to identify the overall risk of the loan portfolio.\n\nDoes not require loan returns to be normally distributed\nApplies MPT to the loan portfolio, although many loans have non-traded aspects"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#moodys-analytics-riskfrontier-model-contd",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#moodys-analytics-riskfrontier-model-contd",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Moody’s Analytics RiskFrontier Model (cont’d)",
    "text": "Moody’s Analytics RiskFrontier Model (cont’d)\nIn Moody’s Analytics RiskFrontier model, portfolio return and risk are a function of:\n\nthe extent to which loan (exposure) values can change over a one-year horizon, and\n\nbased on EDF and the loss given default (LGD)\n\nhow these value changes move together across different loans in the loan portfolio (correlations).\n\nbased on the joint impact of close to 1,000 different systematic factors, which reflect the global economy, region, industry, and country"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#moodys-analytics-riskfrontier-model-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#moodys-analytics-riskfrontier-model-contd-1",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Moody’s Analytics RiskFrontier Model (cont’d)",
    "text": "Moody’s Analytics RiskFrontier Model (cont’d)\nRequired input variables:\n\n\n\\(R_i\\): Expected return on a loan to a borrower \\(i\\) is the loan’s all-in-drawn spread (\\(AIS\\)) minus expected loss (expected default frequency times loss given default (LGD)).1 \\[\nR_i = AIS_i - E(L_i) = AIS_i - (EDF_i\\times LGD_i)\n\\]\n\nThe Basel Committee assessed a fixed 45% LGD on secured loans if fully secured by physical, non–real estate collateral and 40% if fully secured by receivables.\n\n\n\n\n\n\\(\\sigma_i\\): Risk of a loan to borrower \\(i\\), “unexpected loss”, is the volatility of the loan’s default rate \\(\\sigma_{D_i}\\) times the amount lost given default (LGD).2 \\[\n\\sigma_i = UL_i = \\sigma_{D_i} \\times LGD_i = \\sqrt{EDF_i(1-EDF_i)} \\times LGD_i\n\\]\n\nAssume defaults are binomially distributed (default or not), the standard deviation of default rate (\\(\\sigma_{D_i}\\)) is \\(\\sqrt{EDF_i(1-EDF_i)}\\).\n\n\n\n\n\n\\(\\rho_{ij}\\): Correlation of default risks between borrowers \\(i\\) and \\(j\\) is the correlation between the systematic return components of the asset returns of \\(i\\) and \\(j\\).\n\n\nIn the textbook Saunders, Cornett, and Erhemjamts (2023), this equation has a typo: \\(E(L_i)\\) is written as \\(R(L_i)\\). Note that \\(E(\\cdot)\\) represents the “expectation” sign and \\(L_i\\) stands for loan loss.In the textbook Saunders, Cornett, and Erhemjamts (2023), this equation is entirely incorrectly written."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#moodys-analytics-riskfrontier-model-contd-2",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#moodys-analytics-riskfrontier-model-contd-2",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Moody’s Analytics RiskFrontier Model (cont’d)",
    "text": "Moody’s Analytics RiskFrontier Model (cont’d)\nTo measure the unobservable default risk correlation between any two borrowers, the Moody’s Analytics Global Correlation Model (GCORR) uses the systematic asset return components of the two borrowers and calculates a correlation that is based on a factor model rather than direct historical observations.\n\n\nFigure 2: GCorr Corporate Factor Structure\nFigure 2 provides a visual representation of the Moody’s Analytics GCorr Corporate factor structure."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#moodys-analytics-riskfrontier-model-example",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#moodys-analytics-riskfrontier-model-example",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Moody’s Analytics RiskFrontier Model (example)",
    "text": "Moody’s Analytics RiskFrontier Model (example)\nSuppose that an FI holds two loans with the following characteristics. Assume that the correlation \\(\\rho_{12}=-0.25\\), what are the return and risk of the portfolio?\n\n\n\n\n\n\n\n\n\n\n\nLoan \\(i\\)\n\\(X_i\\)\nSpread between loan rate and FI’s cost of funds\nFees\nLGD\nEDF\n\n\n\n\n1\n0.6\n5%\n2%\n25%\n3%\n\n\n2\n0.4\n4.5%\n1.5%\n20%\n2%\n\n\n\nThe return and risk on loan 1 are:\n\n\\[\n\\begin{aligned}\nR_1 &= (0.05+0.02) - (0.03\\times0.25) = 0.0625 \\\\\n\\sigma_1 &= \\sqrt{0.03\\times0.97} \\times 0.25 = 0.04265\n\\end{aligned}\n\\]\n\nThe return and risk on loan 2 are:\n\n\\[\n\\begin{aligned}\nR_2 &= (0.045+0.015) - (0.02\\times0.2) = 0.056 \\\\\n\\sigma_2 &= \\sqrt{0.02\\times0.98} \\times 0.2 = 0.028\n\\end{aligned}\n\\]\n\nThe return and risk of the portfolio are then:\n\n\\[\n\\begin{aligned}\nR_p &= 0.6\\times 0.0625 + 0.4\\times 0.056 = 0.0599 \\text{ or } 5.99\\%  \\\\\n\\sigma_p^2 &= (0.6)^2(0.04265)^2 + (0.4)^2(0.028)^2 + 2(0.6)(0.4)(-0.25)(0.04265)(0.028) = 0.0006369 \\\\\n\\sigma_p &= \\sqrt{0.0006369} = 0.0252 = 2.52\\%\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#partial-application-of-portfolio-theory",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#partial-application-of-portfolio-theory",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Partial application of portfolio theory",
    "text": "Partial application of portfolio theory\n\nLoan volume-based models\nLoan loss ratio-based models"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#partial-application-of-portfolio-theory-loan-volume-based-models",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#partial-application-of-portfolio-theory-loan-volume-based-models",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Partial application of portfolio theory: Loan volume-based models",
    "text": "Partial application of portfolio theory: Loan volume-based models\nDirect application of MPT is often difficult for FIs lacking information on market prices because many of the loans are not always able to be bought and sold in established markets.\nData can be gathered from:\n\nReports to the central bank\nData on shared national credit\nCommercial databases\n\nData provides market benchmarks against which FIs can compare their loan portfolios.\n\n\n\nTable 3: Allocation of the Loan Portfolio to Different Sectors (in percentages)\n\n\n\n\n\n\n(1) National\n(2) Bank A\n(3) Bank B\n\n\n\n\nReal estate\n45%\n65%\n10%\n\n\nC&I\n30\n20\n25\n\n\nIndividual\n15\n10\n55\n\n\nOthers\n10\n5\n10\n\n\nTotal\n100\n100\n100"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#partial-application-of-portfolio-theory-loan-volume-based-models-contd",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#partial-application-of-portfolio-theory-loan-volume-based-models-contd",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Partial application of portfolio theory: Loan volume-based models (cont’d)",
    "text": "Partial application of portfolio theory: Loan volume-based models (cont’d)\n\nDeviations from the market portfolio benchmark indicate the relative degree of loan concentration.\nRelative measure of loan allocation deviation:\n\n\\[\n\\sigma_j = \\sqrt{\\frac{\\sum_{i=1}^N (X_{ij}-X{i})^2}{N}}\n\\]\nwhere\n\n\\(\\sigma_j\\) is the standard deviation of bank \\(j\\)’s asset allocation proportions from the national benchmark\n\\(X_i\\) is the national asset allocations\n\\(X_{ij}\\) is the asset allocation proportions of the \\(j\\)th bank\n\\(N\\) is the number of observations or loan categories"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#partial-application-of-portfolio-theory-loan-volume-based-models-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#partial-application-of-portfolio-theory-loan-volume-based-models-contd-1",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Partial application of portfolio theory: Loan volume-based models (cont’d)",
    "text": "Partial application of portfolio theory: Loan volume-based models (cont’d)\nRefer to Table 3. We get the deviation of Bank A’s loan portfolio allocation as follows:\n\\[\n\\begin{aligned}\n(X_{1A}-X_1)^2 &= (0.65-0.45)^2 = 0.04 \\\\\n(X_{2A}-X_2)^2 &= (0.20-0.30)^2 = 0.01 \\\\\n(X_{3A}-X_3)^2 &= (0.10-0.15)^2 = 0.0025 \\\\\n(X_{4A}-X_4)^2 &= (0.05-0.10)^2 = 0.0025\n\\end{aligned}\n\\] and therefore \\[\n\\sigma_A = \\sqrt{\\frac{0.04+0.01+0.0025+0.0025}{4}} = 11.73\\%\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#partial-application-of-portfolio-theory-loan-loss-ratio-based-models",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#partial-application-of-portfolio-theory-loan-loss-ratio-based-models",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Partial application of portfolio theory: Loan loss ratio-based models",
    "text": "Partial application of portfolio theory: Loan loss ratio-based models\nEstimates systematic loan loss risk of a particular sector or industry to the loan loss risk of an FI’s total loan portfolio\nUse of time-series regression of quarterly losses:\n\\[\n\\frac{\\text{Sectoral losses in the } i\\text{th sector}}{\\text{Loans to the } i\\text{th sector}} = \\alpha + \\beta \\frac{\\text{Total loan losses}}{\\text{Total loans}}\n\\]\nwhere\n\n\\(\\alpha\\) measures the loan loss rate for a sector that has no sensitivity to losses on the aggregate loan portfolio\n\\(\\beta\\) measures the systematic loss sensitivity of the \\(i\\)th sector loans to total loan losses\n\nThe implication of this model is that sectors with lower \\(\\beta\\)s could have higher concentration limits than high \\(\\beta\\) sectors—since low \\(\\beta\\) loan sector risks (loan losses) are less systematic (that is, are more diversifiable in a portfolio sense)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#regulatory-models",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#regulatory-models",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Regulatory models",
    "text": "Regulatory models\n\nFederal Reserve’s 1994 Ruling on Credit Concentration Risk:\n\nAdopted a subjective approach based on examiner discretion.\nRejected technical models due to insufficient data and undeveloped methods at the time.\n\n2006 Regulatory Changes:\n\nBank for International Settlements (BIS): Released guidance on credit risk assessment and valuation for loans, structured around 10 principles on risk assessment and supervisory evaluation.\nOffice of the Comptroller of the Currency (OCC): Released guidance on sound risk management practices for commercial real estate lending.\n\nOCC/Fed Joint Study on 2006 CRE Concentration Guidance (April 2013):\n\n13% of banks with construction loans exceeding 100% of capital failed.\n23% of banks exceeding both construction and total CRE lending criteria failed, compared to only 0.5% of banks that did not exceed either criterion.\nRegulators encouraged financial institutions to review their policies and practices related to CRE lending."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#credit-derivatives",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#credit-derivatives",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit derivatives",
    "text": "Credit derivatives\n\nDiversification of loan portfolio helps FIs to manage their credit risk exposure.\nNew types of derivative instruments are now available to better allow FIs to hedge their credit risk both on individual loans or on loan portfolios.\n\nCredit forwards, options, and swaps.\n\nThese credit derivatives allow FIs to separate the credit risk exposure from the lending process itself."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#credit-forward-contracts-and-credit-risk-hedging",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#credit-forward-contracts-and-credit-risk-hedging",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit forward contracts and credit risk hedging",
    "text": "Credit forward contracts and credit risk hedging\nA credit forward is a forward agreement that hedges against an increase in default risk on a loan (a decline in credit quality of borrower) after the loan rate is determined and the loan is issued.\n\nCommon buyers are insurance companies who bears the risk of an increase in default risk on the benchmark bond of the borrower\nCommon sellers are banks\nSpecifies a credit spread on a benchmark bond issued by a borrower\nExample: BBB bond at time of origination may have 2 per cent spread over US Treasury of same maturity"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#credit-forward-contracts-and-credit-risk-hedging-contd",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#credit-forward-contracts-and-credit-risk-hedging-contd",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit forward contracts and credit risk hedging (cont’d)",
    "text": "Credit forward contracts and credit risk hedging (cont’d)\n\n\n\nTable 4: Payment pattern on a credit forward contract\n\n\n\n\n\n\n\n\n\n\nCredit Spread at End of Forward Agreement\nCredit Spread Seller (bank)\nCredit Spread Buyer (counterparty)\n\n\n\n\n\\(\\phi_T&gt;\\phi_F\\)\nReceives \\((\\phi_T - \\phi_F) \\times MD \\times A\\)\nPays \\((\\phi_T - \\phi_F) \\times MD \\times A\\)\n\n\n\\(\\phi_T&lt;\\phi_F\\)\nPays \\((\\phi_F - \\phi_T) \\times MD \\times A\\)\nReceives \\((\\phi_F - \\phi_T) \\times MD \\times A\\)\n\n\n\n\n\n\nwhere\n\n\\(\\phi_F\\) is the credit spread on which the credit forward contract is written\n\\(\\phi_T\\) is the actual credit spread on the bond when the credit forward matures\n\\(MD\\) is the modified duration on the benchmark bond\n\\(A\\) is the principal amount of the forward agreement\n\nPayout by the bank is capped since \\(\\phi_T\\geq 0\\) (credit spread is non-negative).\n\nWhen a bank gives a loan, it is similar to writing a put option\nWhen a bank sells a credit forward, the payoff is similar to buying a put option"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#credit-options",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#credit-options",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit options",
    "text": "Credit options\nUse of options to hedge credit risk is a relatively new phenomenon. In September 2021, commercial bank holdings of credit options totaled $233 billion, which represented 6.05% of all credit derivatives outstanding.\n\nA credit spread call option is a call option whose payoff increases as the (default) risk premium or yield spread on a specified benchmark bond of the borrower increases above some exercise spread.\nA digital default option is an option that pays a stated amount in the event of a loan default (the extreme case of increased credit risk)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#credit-default-swaps-cds",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#credit-default-swaps-cds",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit (default) swaps (CDS)",
    "text": "Credit (default) swaps (CDS)\n\nFastest-growing types of swaps. Most important type of credit derivatives.\nIn 2000, commercial banks’ total notional principal for outstanding credit derivatives was $426 billion.\nBy March 2008, this amount had risen to $16.44 trillion, before falling to $13.44 trillion in 2009.\nBy September 2011, the amount increased to $15.66 trillion, of which $15.31 trillion was CDSs.\nDue to post-GFC regulations, the notional value of credit derivatives held by banks dropped to $3.9 trillion in September 2021, with $3.4 trillion of this amount being CDS contracts.\n\nWhy CDS?\n\nCredit risk is still more likely to cause an FI to fail than is either interest rate risk or FX risk.\nCDSs allow FIs to maintain long-term customer lending relationships without bearing the full credit risk exposure from those relationships."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#basics-of-cds",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#basics-of-cds",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Basics of CDS",
    "text": "Basics of CDS\n\nCDS Payments: The buyer makes periodic payments to the seller (quarterly, semi-annually, or annually) until the end of the swap or a credit event (e.g., default) occurs.\nSettlement: Upon default, settlement involves either physical delivery of bonds (loans) or a cash payment.\n\nThe protection buyer receives a payment upon the occurrence of a credit event trigger, but the swap “expires worthless” if no trigger occurs.\n\nCheapest-to-Deliver Option: The CDS buyer has the option to deliver the cheapest qualifying bond or loan when a default happens.\nNo requirement that the CDS buyer actually owns the underlying reference securities.\nThe CDS buyer hedges its exposure to default risk, but there is still counterparty credit risk in the event that the seller fails to perform their obligations under the terms of the contract.1\n\nWe examine two types of credit swaps:\n\ntotal return swap\npure credit swap\n\nSearch and read about the concern in September 2008 with regard to AIG, an active CDS seller."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#credit-swaps-total-return-swaps",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#credit-swaps-total-return-swaps",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit swaps: total return swaps",
    "text": "Credit swaps: total return swaps\nA total return swap involves swapping an obligation to pay interest at a specified fixed or floating rate for payments representing the total return on a loan or a bond (interest and principal value changes) of a specified amount.\nThe figure below illustrates a total return swap.1\n\n\n\n\n\nThe FI lender pays a fixed annual rate \\(f\\) plus changes in the market value of the loan and receives a variable rate payment (e.g., 1-year LIBOR).\n\nInterest rate risk remains\n\nIn the textbook Saunders, Cornett, and Erhemjamts (2023), Figure 25-4 incorrectly has \\(f-\\frac{P_t-P_0}{P_0}\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#credit-swaps-total-return-swaps-contd",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#credit-swaps-total-return-swaps-contd",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit swaps: total return swaps (cont’d)",
    "text": "Credit swaps: total return swaps (cont’d)\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nnp.random.seed(8003)\n# Parameters for the TRS\nnotional = 1_000_000  # Notional amount (1 million)\nfixed_rate = 0.03  # Fixed annual rate paid by the TRS receiver (3%)\nasset_volatility = 0.1  # Volatility of the asset's return (10%)\nyears = 5  # Time period of the TRS (5 years)\nperiods_per_year = 4  # Payments per year (quarterly)\n\n\n# Generate the timeline for TRS payments\ndef generate_trs_timeline(\n    notional, fixed_rate, asset_volatility, years, periods_per_year=4\n):\n    # Set up the timeline with quarterly periods\n    total_periods = periods_per_year * years\n    time_points = np.arange(1, total_periods + 1) / periods_per_year\n\n    # Calculate the periodic fixed payment amount (quarterly)\n    periodic_fixed_payment = (\n        -notional * fixed_rate / periods_per_year\n    )  # Fixed payment made by TRS receiver\n\n    # Simulate random returns on the asset\n    asset_returns = np.random.normal(loc=0, scale=asset_volatility, size=total_periods)\n\n    # Initialize lists to store the results\n    total_returns = np.zeros(total_periods)\n    payments = np.zeros(total_periods)\n\n    for period in range(total_periods):\n        # Total return on the asset (positive or negative)\n        total_return = notional * asset_returns[period]\n        total_returns[period] = total_return\n\n        # Net payment for the TRS receiver (positive if receiving total return, minus fixed payment)\n        payments[period] = total_return + periodic_fixed_payment\n\n    return time_points, payments, total_returns\n\n\n# Simulate TRS payments with different asset volatilities\nvolatilities = [0.05]  # Different volatilities to simulate\nsimulations = {}\n\nfor vol in volatilities:\n    timeline, payments, total_returns = generate_trs_timeline(\n        notional, fixed_rate, vol, years, periods_per_year\n    )\n    simulations[vol] = payments\n\n# Plot the timelines as bar charts\nplt.figure(figsize=(12, 8))\nbar_width = 0.2  # Width of each bar\n\n# Generate bar charts for each volatility\nfor idx, (vol, payments) in enumerate(simulations.items()):\n    plt.bar(\n        timeline + idx * bar_width * 0.1,\n        payments,\n        width=bar_width,\n        color=\"#A6192E\",\n        label=f\"Volatility: {vol*100:.0f}%\",\n    )\n\n# Customize the plot\nplt.title(f\"{years}-Year Total Return Swap Payments Example\")\nplt.xlabel(\"Time (Years)\")\nplt.ylabel(\"Net Payment Amount ($)\")\nplt.axhline(0, color=\"black\", linewidth=1)\nplt.grid(True)\nplt.legend()\n\n# Show the plot\nplt.show()\n\n\n\n\n\n\n\n\nFigure 3: Total Return Swap Payments Example"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#credit-swaps-pure-credit-swaps",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#credit-swaps-pure-credit-swaps",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit swaps: pure credit swaps",
    "text": "Credit swaps: pure credit swaps\nInterest-rate sensitive element stripped out leaving only the credit risk.\nSimilar to buying an insurance:\n\nIf default, the counterparty makes the default payment\nIf not default, the FI receives nothing from the counterparty."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#credit-swaps-pure-credit-swaps-contd",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#credit-swaps-pure-credit-swaps-contd",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Credit swaps: pure credit swaps (cont’d)",
    "text": "Credit swaps: pure credit swaps (cont’d)\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nnp.random.seed(8003)\n# Parameters for the CDS\nnotional = 1_000_000  # Notional amount (1 million)\ncds_spread = 0.02  # Annual CDS spread (2%)\nrecovery_rate = 0.9  # Recovery rate in case of default (10%)\nyears = 5  # Time period of the CDS (5 years)\nperiods_per_year = 4  # Payments per year (quarterly)\n\n\n# Generate the timeline for CDS payments\ndef generate_cds_timeline(\n    notional, cds_spread, default_probability, recovery_rate, years, periods_per_year=4\n):\n    # Set up the timeline with quarterly periods\n    total_periods = periods_per_year * years\n    time_points = np.arange(1, total_periods + 1) / periods_per_year\n\n    # Calculate the periodic payment amount (quarterly)\n    periodic_payment = (\n        -notional * cds_spread / periods_per_year\n    )  # Negative for payments\n\n    # Initialize lists to store the results\n    payments = np.zeros(total_periods)\n\n    # Simulate payments and default events\n    for period in range(total_periods):\n        if np.random.rand() &lt; default_probability / periods_per_year:\n            # Default occurs at this period\n            default_loss = notional * (\n                1 - recovery_rate\n            )  # Positive for the payment received on default\n            payments[period] = default_loss\n            payments[period + 1 :] = 0  # No more payments after default\n            break\n        else:\n            # Regular payment\n            payments[period] = periodic_payment\n\n    return time_points, payments\n\n\n# Simulate multiple series with different default probabilities\ndefault_probabilities = [0.02, 0.1]  # Different default probabilities\ncolors = [\"#D6D2C4\", \"#A6192E\"]\n\nsimulations = {}\n\n# Generate timelines for each default probability\nfor prob in default_probabilities:\n    timeline, payments = generate_cds_timeline(\n        notional, cds_spread, prob, recovery_rate, years, periods_per_year\n    )\n    simulations[prob] = payments\n\n# Plot the timelines as bar charts\nplt.figure(figsize=(12, 8))\nbar_width = 0.2  # Width of each bar\n\n# Generate bar charts for each probability\nfor idx, (prob, payments) in enumerate(simulations.items()):\n    plt.bar(\n        timeline + idx * bar_width * 0.1,\n        payments,\n        width=bar_width,\n        color=colors[idx],\n        label=f\"Default Probability: {prob*100:.0f}%\",\n    )\n\nplt.title(f\"{years}-Year Pure CDS Payments Example\")\nplt.xlabel(\"Time (Years)\")\nplt.ylabel(\"Payment Amount ($)\")\nplt.axhline(0, color=\"black\", linewidth=1)\nplt.grid(True)\nplt.legend()\nplt.show()\n\n\n\n\n\n\n\n\nFigure 4: Pure CDS Payments Example"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#suggested-readings",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nMoody’s Analytics An Overview of Modelling Credit Portfolios"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week7/index.html#references",
    "href": "teaching/AFIN8003/2025S1/Week7/index.html#references",
    "title": "AFIN8003 Week 7 - Credit Risk II: Loan Portfolio and Concentration Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nSaunders, Anthony, Marcia Millon Cornett, and Otgo Erhemjamts. 2023. Financial Institutions Management ISE. 11th ed. McGraw Hill."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#introduction",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#introduction",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Introduction",
    "text": "Introduction\nLiquidity risk is a normal aspect of everyday management of a financial institution (FI).\n\nDepository institutions (DIs) are more exposed to liquidity risk than others\nIn extreme cases liquidity risk can threaten the solvency of an FI\nThe Global Financial Crisis commencing in 2008 was, in part, due to liquidity risk\nLiquidity risk may result from asset side or liability side\n\nWe focus on the risk exposure of DIs."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#causes-of-liquidity-risk",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#causes-of-liquidity-risk",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Causes of liquidity risk",
    "text": "Causes of liquidity risk\nLiquidity risk can arise on both sides of the balance sheet: the asset side as well as the liability side\n\n\n\nLiability side\n\nDepositors and other claim holders decide to cash in their financial claims immediately\n\nThe DI has to borrow additional funds or sell assets\n\nDI need to be able to predict the distribution of net deposit drains\n\nThe difference between deposit withdrawals and deposit additions on any specific normal banking day\n\n\n\n\n\nAsset side\n\nRisk from OBS loan commitments and other credit lines\nChange of the value of investment securities portfolios due to unexpected changes of interest rates\nProblems associated with ‘quick’ asset sales/fire-sales\n\nHigh costs for turning illiquid assets into cash\nLow sales price; in worst case, fire-sale price"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liability-side-liquidity-risk",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liability-side-liquidity-risk",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liability-side liquidity risk",
    "text": "Liability-side liquidity risk\n\nA DI’s balance sheet typically features a large amount of short-term liabilities funding relatively long-term assets.\n\nShort-term liabilities: demand deposits, other transaction accounts, etc.\nLong-term assets: mortgages, C&I loans, etc.\n\nDemand deposit accounts, money market deposit accounts (MMDAs), and other transaction accounts allow holders to demand immediate repayment of the face value in cash.\n\nFor example, a DI with 20% of its liabilities in demand deposits, MMDAs, and other transaction accounts must be ready to liquidate assets to cover that amount on any banking day.\n\n\n\n\n\n\n\n\nNote\n\n\nAs of June 2021, U.S. commercial banks had total deposits representing 82.19% of total liabilities and capital.\n\nCash assets accounted for only 15.45% of total assets."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liability-side-liquidity-risk-contd",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liability-side-liquidity-risk-contd",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liability-side liquidity risk (cont’d)",
    "text": "Liability-side liquidity risk (cont’d)\nFor CBA, cash and liquid assets account for 9.3% of total assets.\n\n\nFigure 1: Excerpt of CBA’s 2023 balance sheet - assets"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liability-side-liquidity-risk-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liability-side-liquidity-risk-contd-1",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liability-side liquidity risk (cont’d)",
    "text": "Liability-side liquidity risk (cont’d)\nFor CBA, deposits and other public borrowings account for 73.25% of total liabilities.\n\n\nFigure 2: Excerpt of CBA’s 2023 balance sheet - liabilities"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liability-side-liquidity-risk-contd-2",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liability-side-liquidity-risk-contd-2",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liability-side liquidity risk (cont’d)",
    "text": "Liability-side liquidity risk (cont’d)\n\n\n\n\n\n\n\nIt’s not that bad.\n\n\n\nNormally, only a small proportion of its deposits will be withdrawn on any given day.\nFurther, deposit withdrawals may in part be offset by the inflow of new deposits1 (and the DI’s income).\n\n\n\n\n\nMost demand deposits are relatively “stable”, acting as consumer core deposits on a daily basis.\n\nCore deposits are those deposits that provide a DI with a long-term funding source.\n\nThe DI manager must monitor and predict the net deposit drains on any given normal banking day.\n\nBeyond predictable daily seasonality in deposit flows, other seasonal variations exist.\nMany of these seasonal variations are somewhat predictable.\nRetail DIs often experience above-average deposit outflows around the end of the year and in the summer (due to Christmas and the vacation season).\nRural DIs may experience a deposit inflow–outflow cycle aligned with the local agricultural cycle.\n\nDuring the planting and growing season, deposits tend to fall.\nDuring the harvest season, deposits tend to rise as crops are sold.\n\n\nLarge inflow of deposits may also cause issues if the DI cannot find sufficiently attractive investments."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#net-deposit-drains",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#net-deposit-drains",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Net deposit drains",
    "text": "Net deposit drains\n\n\n\n\nCode\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Data for the plot\nx = np.linspace(-10, 15, 1000)\ny = np.exp(-0.5 * ((x - 5) / 4)**2) / (4 * np.sqrt(2 * np.pi))\n\n# Plotting\nplt.figure(figsize=(10, 6))\nplt.plot(x, y, color='gray')\n\n# Adding vertical lines for 0 and 5%\nplt.axvline(x=0, color='black', linestyle='-', label='0')\nplt.axvline(x=5, color='gray', linestyle='--', label='5%')\n\n# Show x-axis\nplt.xlabel(\"% Net deposit drain (cash outflow)\")\n\n# Show the plot\nplt.show()\n\n\n\n\n\n\n\n\nFigure 3: A hypothetical distribution of net deposit drains\n\n\n\n\n\n\nConsider a probability distribution of net deposit drains that is assumed to be strongly peaked at the 5 percent net deposit withdrawal level, as shown in Figure 3.\n\nThis DI expects approximately 5 percent of its net deposit funds to be withdrawn on any given day with the highest probability.\nA positive net drain on deposits, so its new deposit funds and other cash flows are expected to be insufficient to offset deposit withdrawals.\n\nAs a result, the liability side of the DI’s balance sheet is contracting."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#net-deposit-drains-contd",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#net-deposit-drains-contd",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Net deposit drains (cont’d)",
    "text": "Net deposit drains (cont’d)\n\n\n\n\nCode\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Data for the plot\nx = np.linspace(-10, 15, 1000)\ny = np.exp(-0.5 * ((x + 2) / 2 )**2) / (4 * np.sqrt(2 * 0.1 * np.pi))\n\n# Plotting\nplt.figure(figsize=(10, 6))\nplt.plot(x, y, color='gray')\n\n# Adding vertical lines for 0 and 5%\nplt.axvline(x=0, color='black', linestyle='-', label='0')\nplt.axvline(x=-2, color='gray', linestyle='--', label='-2%')\n\n# Show x-axis\nplt.xlabel(\"% Net deposit drain (cash outflow)\")\n\n# Show the plot\nplt.show()\n\n\n\n\n\n\n\n\nFigure 4: Another hypothetical distribution of net deposit drains\n\n\n\n\n\n\nConsider another probability distribution of net deposit drains that is assumed to be strongly peaked at the -2 percent net deposit withdrawal level, as shown in Figure 4.\n\nA negative net drain on deposits, so its new deposit funds and other cash flows are expected to be larger than deposit withdrawals.\n\nAs a result, this DI is expected to grow with an expanding balance sheet."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#managing-net-deposit-drains",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#managing-net-deposit-drains",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Managing net deposit drains",
    "text": "Managing net deposit drains\nGenerally a drain on deposits at DIs can be managed by\n\npurchased liquidity management\nstored liquidity management\n\nTraditionally, DIs have relied on stored liquidity management. Today, most DIs rely on purchased liquidity management.\n\n\n\n\n\n\nNote\n\n\nWe will discuss in greater detail liquidity management in next week."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#purchased-liquidity-management",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#purchased-liquidity-management",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Purchased liquidity management",
    "text": "Purchased liquidity management\n\nA DI manager seeking to purchase liquidity turns to markets for purchased funds.\nOptions include the cash market and the repurchase agreement markets, which are interbank markets for short-term loans.\nAlternatively, the DI manager could:\n\nIssue additional wholesale certificates of deposit.\nSell notes and bonds.\n\nBorrowed funds (at market rates) are likely to be at higher rates than interest paid on deposits."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#purchased-liquidity-management-contd",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#purchased-liquidity-management-contd",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Purchased liquidity management (cont’d)",
    "text": "Purchased liquidity management (cont’d)\n\n\nPanel A: Balance sheet immediately before and after deposit drain\n\n\n\n\n\n\n\n\n\n\n\n\nAssets\nDeposits\nBorrowed funds\nOther liabilities\nTotal Liabilities\n\n\n\n\nBefore the drain\n100\n70\n10\n20\n100\n\n\nAfter the drain\n100\n65\n10\n20\n95\n\n\n\nPanel B: Adjusting to a deposit drain through purchased liquidity management\n\n\n\n\n\n\n\n\n\n\n\n\nAssets\nDeposits\nBorrowed funds\nOther liabilities\nTotal Liabilities\n\n\n\n\nAfter liquidity management\n100\n65\n15\n20\n100\n\n\n\n\n\nPurchased liquidity management allows DIs to maintain their overall balance sheet size\nA liability-side adjustment to the balance sheet to cover a deposit drain"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#stored-liquidity-management",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#stored-liquidity-management",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Stored liquidity management",
    "text": "Stored liquidity management\n\nA DI manager could also liquidate some of its assets, utilizing its stored liquidity.\nTraditionally, U.S. DIs hold cash reserves at the Federal Reserve and in their vaults to meet liquidity needs.\nThe Federal Reserve sets minimum reserve requirements for banks’ cash reserves.\nDespite these requirements, DIs often hold cash reserves above the minimum to manage liquidity drains.\n\n\n\n\n\n\n\nNote\n\n\n\nIn U.S., the Fed reduced the reserve requirement to 0, effective March 26, 2020.\nIn Australia, the RBA does not impose formal reserve requirements."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#stored-liquidity-management-contd",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#stored-liquidity-management-contd",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Stored liquidity management (cont’d)",
    "text": "Stored liquidity management (cont’d)\n\n\nPanel A: Balance sheet immediately before deposit drain\n\n\n\n\nAssets\n\nLiabilities\n\n\n\n\n\nCash\n9\n\nDeposits\n70\n\n\n\n\n\nBorrowed funds\n10\n\n\nOther asset\n91\n\nOther liabilities\n20\n\n\nTotal\n100\n\nTotal\n100\n\n\n\nPanel B: Adjusting to a deposit drain through stored liquidity management\n\n\n\n\nAssets\n\nLiabilities\n\n\n\n\n\nCash\n4\n\nDeposits\n65\n\n\n\n\n\nBorrowed funds\n10\n\n\nOther assets\n91\n\nOther liabilities\n20\n\n\nTotal\n95\n\nTotal\n95\n\n\n\n\n\nSize of balance sheet decreases\nDIs tend to prudently hold low-rate excess reserve assets to meet liquidity drains"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#asset-side-liquidity-risk",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#asset-side-liquidity-risk",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Asset-side liquidity risk",
    "text": "Asset-side liquidity risk\nThis far we have discussed the liability-side liquidity risk due to net deposit drains.\nOn the asset side, liquidity problems can arise due to\n\nloan requests\nthe exercise by borrowers of their loan commitments and other credit lines! (e.g., at the onset of COVID-19)\n\nSee for example Acharya et al. (2024)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#asset-side-liquidity-risk-contd",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#asset-side-liquidity-risk-contd",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Asset-side liquidity risk (cont’d)",
    "text": "Asset-side liquidity risk (cont’d)\n\n\nBalance Sheet Immediately Before and After Exercise\n\nBefore Exercise\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n100\n\n\nOther assets\n138\nBorrowed funds\n20\n\n\n\n\nOther liabilities\n5\n\n\n\n\nEquity\n25\n\n\nTotal\n150\nTotal\n150\n\n\n\n\nAfter Exercise\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n100\n\n\nOther assets\n143\nBorrowed funds\n20\n\n\n\n\nOther liabilities\n5\n\n\n\n\nEquity\n25\n\n\nTotal\n155\nTotal\n150\n\n\n\n\nAdjusting the Balance Sheet to a Loan Commitment Exercise\n\nPurchased Liquidity Management\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n100\n\n\nOther assets\n143\nBorrowed funds\n25\n\n\nOther liabilities\n5\nOther liabilities\n5\n\n\n\n\nEquity\n25\n\n\nTotal\n155\nTotal\n155\n\n\n\n\nStored Liquidity Management\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n7\nDeposits\n100\n\n\nOther assets\n143\nBorrowed funds\n20\n\n\n\n\nOther liabilities\n5\n\n\n\n\nEquity\n25\n\n\nTotal\n150\nTotal\n150"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#asset-side-liquidity-risk-investment-portfolio",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#asset-side-liquidity-risk-investment-portfolio",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Asset-side liquidity risk (investment portfolio)",
    "text": "Asset-side liquidity risk (investment portfolio)\nAnother type of asset-side liquidity risk arises from the investment portfolio.\n\nRising interest rates reduce the value of investment portfolios.\nLiquidity in a particular market could deteriorate because no one wants to buy.\n\nTechnological development is claimed to have improved the liquidity of financial markets. But given the herding hebaviour in the market, liquidity could still dry up and investment securities only sold at fire-sale prices.\n\nThe FI must fund the loss in value on the balance sheet such that loan requests and deposit withdrawals can be met.\nThe result is increased liquidity risk for the FI."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#asset-side-liquidity-risk-investment-portfolio-contd",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#asset-side-liquidity-risk-investment-portfolio-contd",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Asset-side liquidity risk (investment portfolio) (cont’d)",
    "text": "Asset-side liquidity risk (investment portfolio) (cont’d)\n\n\nBalance Sheet Immediately Before and After Drop in Investment Portfolio Value\n\nBefore Drop in Value\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n100\n\n\nInvestment portfolio\n50\nBorrowed funds\n20\n\n\nOther assets\n88\nOther liabilities\n5\n\n\n\n\nEquity\n25\n\n\nTotal\n150\nTotal\n150\n\n\n\n\nAfter Drop in Value\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n100\n\n\nInvestment portfolio\n45\nBorrowed funds\n20\n\n\nOther assets\n88\nOther liabilities\n5\n\n\n\n\nEquity\n20\n\n\nTotal\n145\nTotal\n145\n\n\n\n\nAdjusting the Balance Sheet for a Drop in Investment Portfolio Value\n\nPurchased Liquidity Management\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n12\nDeposits\n105\n\n\nInvestment portfolio\n50\nBorrowed funds\n20\n\n\nOther assets\n88\nOther liabilities\n5\n\n\n\n\nEquity\n20\n\n\nTotal\n150\nTotal\n150\n\n\n\n\nStored Liquidity Management\n\n\n\n\n\nAmount\n\nAmount\n\n\n\n\nCash\n7\nDeposits\n100\n\n\nInvestment portfolio\n50\nBorrowed funds\n20\n\n\nOther assets\n88\nOther liabilities\n5\n\n\n\n\nEquity\n20\n\n\nTotal\n145\nTotal\n145"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#measuring-a-dis-liquidity-risk-exposure",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#measuring-a-dis-liquidity-risk-exposure",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Measuring a DI’s liquidity risk exposure",
    "text": "Measuring a DI’s liquidity risk exposure\n\nFinancing gap and the financing requirement.\n\n\nFinancing gap is the difference between a DI’s average loans and average (core) deposits:\n\n\\[\n\\text{Financing gap} = \\text{Average loans} - \\text{Average deposits}\n\\]\nA positive financing gap implies that the DI must fund it using its cash and liquid assets and/or borrowing funds in the money market. Therefore,\n\\[\n\\text{Financing gap} = -\\text{Liquid assets} + \\text{Borrowerd funds}\n\\]\nWe thus have the following relationship:\n\\[\n\\text{Financing gap} + \\text{Liquid assets} = \\text{Financing requirement (borrowed funds)}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#measuring-a-dis-liquidity-risk-exposure-contd",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#measuring-a-dis-liquidity-risk-exposure-contd",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Measuring a DI’s liquidity risk exposure (cont’d)",
    "text": "Measuring a DI’s liquidity risk exposure (cont’d)\n\nPeer group ratio comparison\n\nComparison of certain key ratios and balance sheet features of the DI with similar DIs, for example,\n\nLoans to deposits\nLoans to assets\nCore deposits to total assets\n(Unused) loan commitments to assets"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#measuring-a-dis-liquidity-risk-exposure-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#measuring-a-dis-liquidity-risk-exposure-contd-1",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Measuring a DI’s liquidity risk exposure (cont’d)",
    "text": "Measuring a DI’s liquidity risk exposure (cont’d)\n\nLiquidity index\n\nDeveloped by Jim Pierce at the Federal Reserve, liquidity index measures the potential losses an FI could suffer from a sudden or fire-sale disposal of assets compared with the amount it would receive at a fair market value established under normal market (sale) conditions.\n\\[\nI = \\sum_{i=1}^N \\left(W_i \\times \\frac{P_i}{P^*_i}\\right)\n\\]\nwhere\n\n\\(W_i\\) is the percentage of each asset in the FI’s portfolio\n\\(P_i\\) is the immediate sale price\n\\(P^*_i\\) is the fair market price\n\nThe liquidity index should lie between 0 and 1."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-risk-measures",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-risk-measures",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity risk measures",
    "text": "Liquidity risk measures\n\nDuring the financial crisis, many DIs struggled to maintain adequate liquidity.\nCentral banks had to provide extraordinary levels of liquidity assistance to sustain the financial system.\nDespite this support, some DIs failed or were forced into mergers.\nIn response, the BIS’s Basel Committee on Banking Supervision introduced two new regulatory standards for liquidity risk supervision:\n\nLiquidity Coverage Ratio (LCR):\n\nCame into effect on January 1, 2015.\nGradually implemented, reaching full compliance on January 1, 2019.\n\nNet Stable Funding Ratio (NSFR):\n\nBecame a minimum standard on January 1, 2018.\n\n\nThese rules apply to:\n\nLarge, internationally active banking organizations with $250 billion or more in total consolidated assets.\nOrganizations with $10 billion or more in total on-balance-sheet foreign exposure.\nConsolidated subsidiary depository institutions with $10 billion or more in total assets."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR)",
    "text": "Liquidity Coverage Ratio (LCR)\n\nThe Liquidity Coverage Ratio (LCR) is designed to ensure that a DI maintains sufficient high-quality liquid assets (HQLA).\nThese HQLA must be easily convertible to cash to meet liquidity needs over a 30-day period.\nThe LCR is based on an “acute liquidity stress scenario” defined by supervisors.\n\nThe scenario includes both institution-specific and systemic shocks.\nIt reflects actual conditions experienced during the global financial crisis.\n\nThe purpose of maintaining the LCR is to ensure that DIs can survive severe liquidity stress for at least 30 days.\nThe LCR is reported to DI supervisors on a monthly basis.\n\n\\[\n\\text{Minimum LCR} = \\frac{\\text{Stock of HQLAs}}{\\text{Total net cash outflows over next 30 calendar days}} \\ge 100\\%\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr-contd",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr-contd",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR) (cont’d)",
    "text": "Liquidity Coverage Ratio (LCR) (cont’d)\nThe stock of HQLAs is defined as follows:\n\nLiquid assets in the stock must remain liquid in times of stress (i.e., convertible into cash at little loss of value and can be used at the central bank discount window as collateral).\nLiquid assets in the stock must be “unencumbered”, i.e., free of legal, regulatory, contractual, or other restrictions on the ability of the bank to liquidate, sell, transfer, or assign the asset.\nLiquid assets in the stock are divided into level 1 and level 2. Level 1 amount has no cap, and level 2 amount is capped at 40 percent of the stock.\n\nLevel 1 assets are limited to:\n\nCash, central bank reserves, marketable securities representing claims on or guaranteed by sovereigns, central banks, public sector entities (PSE), and some supranational institutions (e.g., BIS, IMF, ECB, multilateral development banks).1\n\nLevel 2A assets (15% haircut):\n\nEligible marketable securities representing claims on or guaranteed by sovereigns, central banks, PSEs, or multilateral development banks.\nEligible corporate debt securities and covered bonds.\n\nLevel 2B assets:\n\nEligible residential mortgage backed securities (25% haircut).\nEligible corporate debt securities and equities (50% haircut).\n\n\n\nThere’re more restrictions."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr-contd-1",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR) (cont’d)",
    "text": "Liquidity Coverage Ratio (LCR) (cont’d)\nThe total net cash outflows is defined as:\n\n\\[\n\\text{Total net cash outflows over next 30 calendar days} = Out - \\min(In, 75\\% \\times Out)\n\\]\nwhere\n\n\\(Out\\) is total expected cash outflows\n\\(In\\) is total expected cash inflows\n\nCash inflows and outflows are computed based on the type of assets/liabilities and associated draw-down factors.\n\n\n\n\n\n\nNote\n\n\nFor a detailed calculation of cash outflows and inflows, refer to textbook Saunders, Cornett, and Erhemjamts (2023) or to the suggested readings."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr-example",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr-example",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR): example",
    "text": "Liquidity Coverage Ratio (LCR): example\nConsider the following balance sheet (in million of dollars) of a bank. Calculate the bank’s LCR.\n\nAssume that the cash inflows over the next 30 days from the bank’s assets are $5 million.\n\n\n\n\n\n\n\n\n\n\n\n\nAssets\n$\nLiquidity Level\nLiabilities and Equity\n$\nRun-Off Factor\n\n\n\n\nCash\n5\nLevel 1\nStable retail deposits\n95\n3%\n\n\nDeposits at the Fed\n15\nLevel 1\nLess Stable retail deposits\n40\n10\n\n\nTreasury securities\n100\nLevel 1\nUnsecured wholesale funding from:\n\n\n\n\nGNMA securities\n75\nLevel 2A\n- Stable small business deposits\n100\n5\n\n\nLoans to A-rated corporations\n110\nLevel 2A\n- Less Stable small business deposits\n80\n10\n\n\nLoans to B-rated corporations\n85\nLevel 2B\n- Nonfinancial corporates\n50\n75\n\n\nPremises\n20\n\nEquity\n45\n\n\n\nTotal\n410\n\nTotal\n410"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr-example-contd",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr-example-contd",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR): example (cont’d)",
    "text": "Liquidity Coverage Ratio (LCR): example (cont’d)\nThe LCR is calculated as follows:\nFirst, calculate the amount of HQLA.\n\nLevel 1 assets is \\(5+15+100=120\\) million\n\nBefore adjustment for capps,\n\nLevel 2A assets is \\((75+110)\\times (1-15\\%) = 157.25\\) million1\nLevel 2B assets is \\(85\\times (1-50\\%)=42.5\\) million2\n\nHowever, Level 2 assets is capped at 40% of HQLA!\n\nGiven that Level 1 assets is 120 million, which should account for at least \\(1-40\\%=60\\%\\) of HQLA.\nHQLA should be \\(120/(1-40\\%) = 200\\) million, which means a maximum of \\(200-120=80\\) million Level 2 assets.\nThe Level 2 assets after haircut is larger than the cap - they will not further increase HQLA.\n\nTherefore, the HQLA is 200 million.\nThere is a 15% haircut applied on the value of Level 2A assets.There is a 50% haircut applied on the value of Level 2B assets."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr-example-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-coverage-ratio-lcr-example-contd-1",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity Coverage Ratio (LCR): example (cont’d)",
    "text": "Liquidity Coverage Ratio (LCR): example (cont’d)\nNext, calculate the total net cash outflows over next 30 days.\nCash outflows are:\n\nStable retail deposits: \\(95\\times 0.03 = 2.85\\)\nLess stable retail deposits: \\(40\\times 0.1 = 4\\)\nStable small business deposits: \\(100\\times 0.05 = 5\\)\nLess stable small business deposits: \\(80\\times 0.1 =8\\)\nNonfinancial corporates: \\(50\\times 0.75 = 37.5\\)\n\nTherefore,\n\nTotal cash outflows over next 30 days is 57.35 million.\nTotal cash inflows over next 30 days is 5 million (assumed).\nTotal net cash outflows over next 30 days is 52.35 million.\n\nLastly, calculate LCR:\n\\[\n\\text{LCR} = \\frac{\\text{Stock of HQLAs}}{\\text{Total net cash outflows over next 30 calendar days}} = \\frac{200}{52.35} = 382.04\\% \\ge 100\\%\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#net-stable-funding-ratio-nsfr",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#net-stable-funding-ratio-nsfr",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Net Stable Funding Ratio (NSFR)",
    "text": "Net Stable Funding Ratio (NSFR)\n\nThe Net Stable Funding Ratio (NSFR) focuses on long-term liquidity management on a DI’s balance sheet.\nIt evaluates liquidity across the entire balance sheet, encouraging the use of stable sources of financing.\nThe NSFR requires a minimum amount of stable funding over a one-year time horizon.\n\nIt aims to limit the reliance on short-term wholesale funding, a significant issue during the financial crisis.\n\nThe NSFR has been reported to DI supervisors quarterly since 2018.\n\n\\[\n\\text{NSFR} = \\frac{\\text{Available amount of stable funding}}{\\text{Required amount of stable funding}} \\ge 100\\%\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#net-stable-funding-ratio-nsfr-1",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#net-stable-funding-ratio-nsfr-1",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Net Stable Funding Ratio (NSFR)",
    "text": "Net Stable Funding Ratio (NSFR)\nAvailable stable funding (ASF) includes:\n\nBank capital\nPreferred stock with a maturity &gt; 1 year\nLiabilities with maturities &gt; 1 year\nThe portion of retail deposits and wholesale deposit expected to stay with bank during a period of idiosyncratic stress\n\nThese equity and liabilities are assigned to one of five categories, each with a specific ASF factor.\nASF is calculated as the sum of the weighted amounts."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#net-stable-funding-ratio-nsfr-2",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#net-stable-funding-ratio-nsfr-2",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Net Stable Funding Ratio (NSFR)",
    "text": "Net Stable Funding Ratio (NSFR)\nRequired stable funding (RSF) is calculated as the sum of\n\nthe value of the on-balance-sheet assets multiplied by a specific RSF factor assigned to each particular asset type, and\nthe amount of off-balance-sheet (OBS) activities (or potential liquidity exposure) multiplied by the associated RSF factor."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-risk-of-australian-banks-fy2023",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-risk-of-australian-banks-fy2023",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity risk of Australian banks (FY2023)",
    "text": "Liquidity risk of Australian banks (FY2023)\n\n\n\n\n\n\n\n\n\n\n\nCBA\nNAB\nANZ\nWestpac\n\n\n\n\nCash Outflows\n\n\n\n\n\n\nRetail And Counterparties Deposits Outflow\n37,416\n29,947\n25,517\n29,304\n\n\nStable Deposits\n12,700\n5,843\n5,879\n7,969\n\n\nLess Stable Deposits\n24,716\n24,104\n19,638\n21,335\n\n\nUnsecured Wholesale Funding Outflow\n82,444\n82,299\n146,698\n76,953\n\n\nOperational Deposit Outflow\n22,219\n21,540\n22,553\n18,631\n\n\nNon Operational Deposits Outflow\n49,236\n47,619\n111,549\n47,073\n\n\nUnsecured Debt Outflow\n10,989\n13,140\n12,596\n11,249\n\n\nSecured Wholesale Funding Outflow\n6,839\n10,701\n5,405\n3,891\n\n\nAdditional Outflow Requirements\n26,186\n38,693\n70,639\n30,463\n\n\nDerivative Expo And Other Collateral Requirement\n7,557\n8,154\n48,206\n12,462\n\n\nLoss of Funding on Debt Products\n0\n0\n0\n136\n\n\nCredit And Liquidity Facilities\n18,629\n30,539\n22,433\n17,865\n\n\nOther Contractual Funding Obligation\n0\n81\n0\n4,515\n\n\nOther Contingent Funding Obligation\n10,373\n5,219\n8,024\n4,082\n\n\nTotal Cash Outflow\n163,258\n166,940\n256,283\n149,208"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-risk-of-australian-banks-fy2023-1",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-risk-of-australian-banks-fy2023-1",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity risk of Australian banks (FY2023)",
    "text": "Liquidity risk of Australian banks (FY2023)\n\n\n\n\n\n\n\n\n\n\n\nCBA\nNAB\nANZ\nWestpac\n\n\n\n\nCash Inflows\n\n\n\n\n\n\nSecured Lending\n2,328\n3,898\n1,549\n0\n\n\nInflows From Fully Performing Exposures\n9,520\n11,788\n17,190\n5,020\n\n\nOther Cash Inflows\n6,753\n1,589\n36,016\n7,988\n\n\nTotal Cash Inflow\n18,601\n17,275\n54,755\n13,008"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-risk-of-australian-banks-fy2023-2",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-risk-of-australian-banks-fy2023-2",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity risk of Australian banks (FY2023)",
    "text": "Liquidity risk of Australian banks (FY2023)\n\n\n\n\n\n\n\n\n\n\n\nCBA\nNAB\nANZ\nWestpac\n\n\n\n\nLiquidity Coverage Ratio (LCR)\n\n\n\n\n\n\nAverage High Quality Liquid Assets\n189,419\n209,561\n267,905\n181,882\n\n\nAverage Net Cash Outflows\n144,657\n149,665\n201,528\n136,200\n\n\nAverage Liquidity Coverage Ratio\n131.00\n140.00\n132.90\n134.00\n\n\nNet Stable Funding Ratio (NSFR)\n\n\n\n\n\n\nAvailable Stable Funding\n860,999\n646,508\n625,285\n707,893\n\n\nRequired Stable Funding\n693,453\n556,016\n537,430\n615,341\n\n\nNet Stable Funding Ratio\n124.00\n116.00\n116.35\n115.00"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-planning",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-planning",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity planning",
    "text": "Liquidity planning\n\nLiquidity planning is crucial for managing liquidity risk and costs, helping with borrowing priorities and minimizing excess reserves.\nComponents of a liquidity plan:\n\nManagerial responsibilities: Assign roles during a liquidity crisis and manage public disclosures.\nList of fund providers: Identify likely fund withdrawers and patterns, including sensitivity to funding composition changes.\nWithdrawal estimates: Assess potential deposit and fund withdrawals over different time horizons and identify funding sources.\nInternal limits and asset disposal: Set borrowing limits for subsidiaries and branches, determine acceptable risk premiums, and sequence asset disposals.\n\nThe plan involves key departments like the money desk and Treasury for daily liability funding."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-risk-unexpected-deposit-drains-and-bank-runs",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-risk-unexpected-deposit-drains-and-bank-runs",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity risk, unexpected deposit drains, and bank runs",
    "text": "Liquidity risk, unexpected deposit drains, and bank runs\nMajor liquidity problems can arise, however, if deposit drains are abnormally large and unexpected, which may occur for a number of reasons, including:\n\nConcerns about a DI’s solvency relative to those of other DIs.\nFailure of a related DI (the contagion effect).\nSudden changes in investor preferences regarding holding nonbank financial assets (such as T-bills or mutual fund shares) relative to deposits.\n\nIn these cases, unexpected deposit drains could trigger a bank run that may eventually force a bank into insolvency.\nIn the worst case, a bank panic may occur - systemic or contagious bank run on deposits of banking industry."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#bank-runs-the-discount-window-and-deposit-insurance",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#bank-runs-the-discount-window-and-deposit-insurance",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Bank runs, the discount window, and deposit insurance",
    "text": "Bank runs, the discount window, and deposit insurance\nThe two major liquidity risk insulation devices are deposit insurance and the discount window.\n\nDeposit insurance\nDiscount window:\n\nA facility provided by central banks where FIs can borrow short-term funds to meet liquidity needs, typically at an interest rate called the “discount rate.”\nDuring the March 2023 United States bank failures, banks drew $153 billion from the discount window as of 15 March 2023, a new record.\n\n\nNot without economic costs\n\nProtection may encourage DIs to increase liquidity risk"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-regulation-in-australia",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#liquidity-regulation-in-australia",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Liquidity regulation in Australia",
    "text": "Liquidity regulation in Australia\n\nIn Australia, liquidity requirements set out by APRA\nAPS 210 (released in 2000) aims to ensure sufficient liquidity in FIs to meet obligations as they fall due\n\nAPRA determines whether an ADI is classified either (check suggested readings APS 210):\n\na liquidity coverage ratio (LCR) ADI (effective from 1 Jan 2015) or\nan ADI subject to the minimum liquidity holdings (MLH) regime for the purpose of APS 210 (effective from 1 January 2014)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#lcr-adi",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#lcr-adi",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "LCR ADI",
    "text": "LCR ADI\n\nThe major and larger banks fall into the LCR group\nAn LCR ADI must undertake scenario analysis on a regular basis.\nThe scenarios must at a minimum include the LCR (from 1 January 2015) and the “going concern” scenario.\nThe LCR requirement aims to ensure that DIs maintain an adequate level of unencumbered high-quality liquid assets (HQLA) that can be readily converted into cash to meet its liquidity needs for a 30-day period under a significantly severe liquidity stress scenario.\nAn LCR ADI must also meet the NSFR requirements."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#mlh-adi",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#mlh-adi",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "MLH ADI",
    "text": "MLH ADI\n\nSmaller ADIs fall in the MLH regime.\nRequired to maintain a minimum holding of 9% of its liabilities in specific liquid assets.\nAll debt securities must be eligible for repurchase agreement with the RBA and must not be subordinated.\nAn MLH ADI must ensure that it has the operational capacity to liquidate any securities held as liquid assets within two business days.\nPractically, the ADIs in the MLH regime must set a trigger ratio above the 9 per cent minimum."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#depositor-protection",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#depositor-protection",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Depositor protection",
    "text": "Depositor protection\n\nDeposit Insurance is a mechanism designed to protect DIs from liquidity crises\n\nIn the US, Federal Deposit Insurance Corporation (FDIC) was created in 1933 in wake of banking panics\nMany countries in the world have established an explicit deposit insurance scheme\n\nIn October 2008, Australia introduced the Financial Claims Scheme (FCS) as well as a temporary wholesale guarantee to provide explicit guarantee arrangements for Australian DI deposits and wholesale funding\n\nThe FCS initially provided a guarantee of deposit balances up to $1 million per depositor per institution\nThe new and permanent cap of $250 000 per person per institution was introduced from 1 February 2012\nAPRA is responsible for the administration of the FCS"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#other-australian-depositor-protection-mechanisms",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#other-australian-depositor-protection-mechanisms",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Other Australian depositor protection mechanisms",
    "text": "Other Australian depositor protection mechanisms\n\nGuarantee scheme for large deposits and wholesale funding\n\nGuaranteed deposit balances greater than $1 million and funding instruments with a maturity of 5 years or less\nAvailable to branches of foreign-owned banks\nClosed in March 2010 after the recovery of global funding conditions\n\nFinancial Claims Scheme—Policyholders Compensation Facility\n\nSimilar as FCS for DIs\nAvailable to general insurers authorised by APRA"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#life-insurance-companies",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#life-insurance-companies",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Life insurance companies",
    "text": "Life insurance companies\n\nLife insurance companies hold cash reserves and liquid assets to meet policy cancellations (surrenders) and working capital needs.\nPremium income and returns on investments usually cover policyholder surrenders, with government bonds serving as a liquidity buffer.\nIf premium income is insufficient, insurers may sell liquid assets to meet demands.\nA loss of confidence in an insurer can lead to a run, with mass policy surrenders forcing asset liquidations at potentially low prices.\nForced liquidations can push insurers towards insolvency, similar to banks (DIs).\n\n\n\n\n\n\n\nNote\n\n\nAn example is the case of Equitable Life. Increase in surrenders after it received an adverse legal ruling contributed to its failing. Its 256-year history ended in June 2018, after an 18-year-long winding-down process."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#property-casualty-insurers",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#property-casualty-insurers",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Property-casualty insurers",
    "text": "Property-casualty insurers\n\nProperty–casualty (PC) insurers sell policies insuring against certain contingencies impacting either real property or individuals.\nLarge unexpected claims may materialize and exceed the flow of premium income and income returns from assets.\n\nFor example, natural disasters."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#suggested-readings",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nAPRA Explains: Liquidity in banking.\nRBA: The Implementation of Monetary Policy: Domestic Market Operations.\nBIS: LCR - Liquidity Coverage Ratio.\nPrudential Standard APS 210 Liquidity.\nAcharya, V. V., Engle, R., Jager, M., & Steffen, S. (2024). Why Did Bank Stocks Crash during COVID-19? The Review of Financial Studies, 37, 2627–2684."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week8/index.html#references",
    "href": "teaching/AFIN8003/2025S1/Week8/index.html#references",
    "title": "AFIN8003 Week 8 - Liquidity Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nAcharya, Viral V, Robert Engle, Maximilian Jager, and Sascha Steffen. 2024. “Why Did Bank Stocks Crash During COVID-19?” The Review of Financial Studies 37 (9): 2627–84. https://doi.org/10.1093/rfs/hhae028.\n\n\nSaunders, Anthony, Marcia Millon Cornett, and Otgo Erhemjamts. 2023. Financial Institutions Management ISE. 11th ed. McGraw Hill."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#stephen-donaghy",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#stephen-donaghy",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Stephen Donaghy",
    "text": "Stephen Donaghy\nStephen Donaghy is a Senior Manager Investment at UniSuper, which has $139 billion funds under management and 647k members.\nHe is responsible for leading the analytical capabilities that feed into the asset allocation and construction of UniSuper’s Investment options. This also includes understanding the implications of the Your Future Your Super Performance Test and the monitoring and management capabilities required to operate alongside this test.\nStephen also plays a key role in building out UniSuper’s ESG data and analytics capabilities which supports the integration of ESG principles across all aspects of UniSuper’s investment process."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#introduction",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#introduction",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Introduction",
    "text": "Introduction\n\nLast week we discussed the liquidity risk of financial institutions (FIs), especially depositary institutions (DIs).\n\nLiquidity risk can arise from both asset side and liability side.\n\nThis week, we will first discuss liquidity management from banks’ point of view.\n\nAsset-side liquidity management: liquid asset positions\nLiability-side liquidity management: the liability structure of portfolios\n\nStephen will then give us an industry perspective based on UniSuper."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#source-of-liquidity",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#source-of-liquidity",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Source of liquidity",
    "text": "Source of liquidity\nHistorically, primary method of meeting cash demands: asset liquidity (stored liquidity)\n\nExamples: cash, treasury securities\nStock of liquid assets in an FI depends on\n\nFI’s willingness to trade off liquidity and returns\nFI’s ability to use liability liquidity\n\n\nToday, primary method of meeting cash demands: liability liquidity / management (purchased liquidity)\n\nExamples: interbank market for exchange settled funds, repos, interbank market"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#asset-side-liquidity-and-management",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#asset-side-liquidity-and-management",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Asset-side liquidity and management",
    "text": "Asset-side liquidity and management\n\nLiquid assets, e.g., Treasury notes/bonds, are traded in a deep market1\n\n\nThe composition of an FI’s liquid asset portfolio (especially cash and government securities) is partly determined by:\n\nminimum liquid-asset reserve requirements imposed by the central bank\nearnings consideration\n\nGovernment securities act as secondary buffer reserves\n\nWhen significant drains on cash reserves occur, these securities can be turned into cash quickly and with very little loss of principal value because of the deep nature of the markets in which these assets are traded.\n\n\nA market is deep when even large trading volumes will not impact on price."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#risk-return-trade-off-for-liquid-assets",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#risk-return-trade-off-for-liquid-assets",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Risk-return trade-off for liquid assets",
    "text": "Risk-return trade-off for liquid assets\n\nLiquid assets carry a comparatively lower interest rate\nAt the heart of management of the liquid asset portfolio is balancing the benefits and costs of holding liquid assets\n\nCash immediacy versus reduced return\n\nNeed to consider, among other things, the variability of deposit inflows and outflows, the yield and liquidation costs of non-liquid assets, the interest paid on purchased funds in the money market, and more\nDay-to-day liquidity management means that a DI faces the risk of either undershooting or overshooting the required liquidity requirement on any given day.\n\nUndershooting the regulatory required liquidity ratios (e.g., LCR, NSFR) may involve specified additional charges.\nHolding cash reserves in excess of the minimum required can be costly.1\n\nThe management of a DI’s exchange settlement account (ESA) at the RBA is critical.\n\n\n\n\n\n\n\nNote\n\n\nESA is an account held at the Reserve Bank of Australia by financial institutions to settle financial obligations arising from the clearing of payments.\n\n\n\nRBA pays ‘cash target rate minus 10 basis points’ interest on ESA balances."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#the-cash-market-and-exchange-settlement-account-esa",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#the-cash-market-and-exchange-settlement-account-esa",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "The cash market and Exchange Settlement Account (ESA)",
    "text": "The cash market and Exchange Settlement Account (ESA)\nThe cash market is where banks lend and borrow funds from each other, typically on an overnight basis. These funds can be used to:\n\nMeet liquidity needs: Banks may borrow funds to ensure they meet short-term liquidity requirements, such as the ESA balances.\nSupport lending activities: Banks may also use borrowed funds to support ongoing lending activities.\nFacilitate settlement of transactions: The funds can help banks settle large-scale interbank transactions efficiently.\n\nImportantly,\n\nThe price of funds in this market is the interest rate on these interbank loans, which is called the cash rate in Australia.\nThe quantity traded in this market is called the Exchange Settlement (ES) balance - the balance of DI’s deposit accounts at the RBA, the ESA."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#the-cash-market-esa-and-repo-transactions",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#the-cash-market-esa-and-repo-transactions",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "The cash market, ESA, and repo transactions",
    "text": "The cash market, ESA, and repo transactions\nRBA sets a target for the cash rate, it is often referred to as a “tool” of monetary policy.\nPrior to the COVID-19 recession,\n\nthe cash rate target was the RBA’s only active monetary policy tool.\nthe RBA managed the supply of ES balances so that it met estimated demand and the cash rate was close to its target.\nthe RBA achieved cash rate target through open market operations, particularly through repurchase agreements (repos).\n\n\n\n\n\n\n\n\nRepo transactions of RBA\n\n\nA repo is a transaction with two parts.\n\nIn the first part, the Reserve Bank could lend ES balances to a bank and receive a bond in exchange. This increases the supply of ES balances available to banks.\nIn the pre-arranged second part, the transaction is reversed. The Reserve Bank returns the bond and receives back the ES balances, which decreases the supply of ES balances.\n\n\n\n\n\nAfter the introduction of the package of policy measures in response to the COVID-19 recession,\n\nES balances substantially increased.\nthe RBA, as a result, no longer conducts daily open market operations to manage ES balances."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#the-changing-dynamics",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#the-changing-dynamics",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "The changing dynamics",
    "text": "The changing dynamics\nSince COVID-19, the RBA significantly adjusted its monetary operations, moving away from repos as the primary tool for managing liquidity. Banks now manage their ESA balances primarily through other mechanisms:\n\nTerm Funding Facility (ended 30 June 2024): Introduced during the pandemic, the TFF allowed banks to access longer-term funding at very low rates. It helped banks manage funding needs over the pandemic period.\nGovernment Bond Purchases (ceased on 10 February 2022): The RBA engaged in large-scale government bond purchases to inject liquidity into the financial system. This action increased the level of reserves in the banking system, reducing the immediate need for repo operations.\nStanding Facility: Banks can still access liquidity via the RBA’s standing liquidity facility, where they can borrow overnight at a penalty rate if their ESA balances fall short.\nInterbank Cash Market: Banks continue to borrow and lend among themselves in the interbank cash market to manage daily fluctuations in their ESA balances.\nRepo Transactions in the Private Market. While the RBA no longer conducts open market repos, banks and other financial institutions still use repo transactions with each other as a way to manage liquidity and secure short-term funding. These private market repos are similar in structure to the RBA’s past operations but are conducted bilaterally between financial institutions."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#liability-side-liquidity-and-management",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#liability-side-liquidity-and-management",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Liability-side liquidity and management",
    "text": "Liability-side liquidity and management\n\nLiability management is closely linked to liquidity management\nOverall aim of liability management: to construct a low-cost and low–withdrawal-risk liability portfolio\nProblems\n\nLow-cost liabilities often carry high withdrawal risk: e.g., demand deposits\nLow withdrawal risk often comes with high cost: e.g., certificates of deposit (CDs)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#liability-management-contd",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#liability-management-contd",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Liability management (cont’d)",
    "text": "Liability management (cont’d)\nDeposit liabilities\n\nCheque account and other demand deposits\nSavings account\nCash management account (CMA) / investment savings accounts\nFixed-term deposits\nNegotiable certificates of deposits (NCDs)\n\nNon-deposit liabilities\n\nInterbank funds\nRepurchase agreements (Repos)\nCovered bonds\nOther borrowings\nBank accepted bills\nCommercial bills or non-bank bills\nCommercial paper or promissory notes\nSubordinated debt, medium-term notes and long-term borrowings"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Choice of liability structure",
    "text": "Choice of liability structure\nNow we turn to a more detailed discussion of the withdrawal risk and funding cost characteristics of the major liabilities of a modern DI.\n\n\n\n\n\n\nNote\n\n\nThe following slides on specific products should be read after the lecture."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-demand-deposits",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-demand-deposits",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Choice of liability structure: demand deposits",
    "text": "Choice of liability structure: demand deposits\nWithdrawal risk:\n\nHigh degree of withdrawal risk\n\nCosts:\n\nLow\nSince 1930, in U.S., demand deposits paid zero explicit interest!\nSince 2011, such prohibition was repealed. DIs are now allowed but not required to interest on demand deposits. Few of them do.\nThis does not mean that demand deposits are free to DIs.\n\nServices associated with providing checkable accounts consume costly labor and capital.\nCompetition resulted in implicit interest.\n\nDIs can recapture costs by charging fee such as cost per cheque cleared or electronic transaction.\n\nDepositors receives a “subsidy” when such fees do not fully cover the DI’s cost of providing these services.\n\n\n\\[\n\\text{Average implicit interest rate (IIR)} = \\frac{\\text{DI's average management cost per account – average fees earned per account}}{\\text{average annual size of account}}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-interest-bearing-cheque-accounts",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-interest-bearing-cheque-accounts",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Choice of liability structure: interest-bearing cheque accounts",
    "text": "Choice of liability structure: interest-bearing cheque accounts\nWithdrawal risk:\n\nLower degree of withdrawal risk compared to current accounts\n\nMinimum balance requirements\n\n\nCosts:\n\nComparably higher cost: three pricing mechanisms\n\nImplicit interest payments\nMinimum balance requirements\nExplicit interest payments\n\nGross interest return = explicit interest + implicit interest"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-savings-account",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-savings-account",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Choice of liability structure: savings account",
    "text": "Choice of liability structure: savings account\nWithdrawal risk:\n\nLower withdrawal risk compared to cheque accounts\n\nRestrictions on withdrawals (e.g., limited monthly withdrawals, notice period)\nTypically held for long-term savings purposes\nFewer transactional services offered\n\n\nCosts:\n\nVery small implicit interest payments\nExplicit interest payments to account holders"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-mmdas",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-mmdas",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Choice of liability structure: MMDAs",
    "text": "Choice of liability structure: MMDAs\nIn U.S., since 1982, DIs can use money market deposit accounts (MMDAs) as an additional liability instrument.\n\nCompetition with money market mutual funds offered by groups such as Vanguard and Fidelity.\nMMDAs are checkable but subject to restrictions.\n\nWithdrawal risk:\n\nLower due to the restrictions on checking and transfers\n\nCosts:\n\nHigher explicit interest\n\nIn Australia, BOQ together with DDH Graham offers MMDA. Cash management accounts (CMAs) are more popular."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-cma-investment-savings-account",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-cma-investment-savings-account",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Choice of liability structure: CMA / investment savings account",
    "text": "Choice of liability structure: CMA / investment savings account\nInvestment savings accounts (or cash management accounts) are high denomination savings accounts that have no specified maturity date but require high minimum balances (e.g. $10 000) and minimum transaction size (e.g. $500).\n\nThe funds are available on call.\nRelatively low degree of withdrawal risk.\nCosts: higher interest than basic savings accounts, mitigated by fees charged"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-term-and-fixed-time-deposits-retail-cds",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-term-and-fixed-time-deposits-retail-cds",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Choice of liability structure: term and fixed-time deposits / retail CDs",
    "text": "Choice of liability structure: term and fixed-time deposits / retail CDs\nFixed-maturity instruments.\nWithdrawal risk:\n\nVery low: early withdrawal penalties\n\nCosts:\n\nHigh explicit interest\n\n\n\n\n\n\n\nNote\n\n\nFor example, Bank of America’s PDS."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-negotiable-certificates-of-deposits-ncds",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-negotiable-certificates-of-deposits-ncds",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Choice of liability structure: negotiable certificates of deposits (NCDs)",
    "text": "Choice of liability structure: negotiable certificates of deposits (NCDs)\nTime deposits with fixed maturity and face values &gt; $100 000 with varying maturities.\nNegotiable instruments: an instrument that can be sold in the secondary market thereby transferring ownership.\n\nLow withdrawal risk\nThe rates are market driven =&gt; Comparatively lower cost due to generally high credit rating of issuer\n\n\n\n\n\n\n\nNote\n\n\nNowadays banks offer more comprehensive solutions.\nFor example, CBA offers “Investment Guarantee”, a fixed term investment that is composed of a series of underlying securities, which are either a bill of exchange (e.g., bank accepted bill) or a NCD."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-non-deposit-liabilities",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-non-deposit-liabilities",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Choice of liability structure: non-deposit liabilities",
    "text": "Choice of liability structure: non-deposit liabilities\nInterbank funds\n\nShort-term un-collateralised loans between FIs\nRollover risk\nCost: short-term money market rate\n\nRepurchase agreements (repos)\n\nCollateralised interbank transactions\nHighly liquid and flexible source of funds\nYield generally below the market interbank rate due to collateralised nature"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-non-deposit-liabilities-contd",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-non-deposit-liabilities-contd",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Choice of liability structure: non-deposit liabilities (cont’d)",
    "text": "Choice of liability structure: non-deposit liabilities (cont’d)\nCovered bonds\n\nBonds issued by a bank, backed by a pool of assets that remain on the balance sheet of the issuing bank\nAvailable for Australian DIs after legislative change in 2011, with a cap at 8 per cent of DI assets.\nSafest form of bank debt\nTypically carry a higher credit rating than that of their issuer DI\n\n\n\n\n\n\n\nNote\n\n\nCovered bond is more of a feature in Australia (APS 121 Covered Bonds).\nFor example, the CBA’s covered bonds program."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-non-deposit-liabilities-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#choice-of-liability-structure-non-deposit-liabilities-contd-1",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Choice of liability structure: non-deposit liabilities (cont’d)",
    "text": "Choice of liability structure: non-deposit liabilities (cont’d)\nOther Borrowing\n\nBank accepted bills (BAB)\nCommercial bills (or non-bank bills)\nCommercial paper or promissory notes\nSubordinated debt, medium-term notes and long-term borrowings"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#liability-and-liquidity-management-in-insurance-companies",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#liability-and-liquidity-management-in-insurance-companies",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Liability and liquidity management in insurance companies",
    "text": "Liability and liquidity management in insurance companies\n\nInsurance companies require liquidity to meet claims and unexpected policy surrenders.\nIdeally, liquidity is managed through premiums received on new and existing contracts.\nHigh-frequency claims, like during a severe hurricane season, may force asset liquidation at lower-than-market value.\nDiversifying risk in insurance contracts reduces liquidity risk (e.g., covering different types of disasters).\nInsurers can hold marketable assets (e.g., government bonds, corporate bonds, stocks) to cover claim payments when premium income is insufficient."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#liability-and-liquidity-management-in-other-financial-institutions",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#liability-and-liquidity-management-in-other-financial-institutions",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Liability and liquidity management in other financial institutions",
    "text": "Liability and liquidity management in other financial institutions\n\nSecurities firms, investment banks, and finance companies face liquidity risk if they rely on short-term financing (e.g., commercial paper, bank loans) and investors hesitate to roll over funds.\n\nFor securities firms,\n\nMain funding sources include repurchase agreements, bank loans, and short positions in securities.\nLiquidity management requires enough cash and liquid resources to underwrite new securities and resell them to investors.\n\nFor investment banks (and securities firms),\n\nLiability management involves financing an inventory of securities to act as a market maker.\n\nFor finance companies,\n\nMain funding sources include commercial paper and long-term debt.\nNeed liquidity to fund loan requests and commitments promptly."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#unisuper",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#unisuper",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "UniSuper",
    "text": "UniSuper\nNow, let’s welcome Stephen Donaghy to give us a talk about UniSuper and share his insights!"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#suggested-readings",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nHow RBA implements monetary policy.\nRBA Exchange Settlement Account Policy.\nRBA Standing Facilities.\nCovered bonds in Australia.\nPrudential Standard APS 210 Liquidity."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week9/index.html#references",
    "href": "teaching/AFIN8003/2025S1/Week9/index.html#references",
    "title": "AFIN8003 Week 9 - Liability and Liquidity Management",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation"
  },
  {
    "objectID": "talks/phds.io.html#introduction",
    "href": "talks/phds.io.html#introduction",
    "title": "PhDs.io",
    "section": "Introduction",
    "text": "Introduction\n\n\n\nPhDs.io"
  },
  {
    "objectID": "talks/phds.io.html#what-is-phds.io",
    "href": "talks/phds.io.html#what-is-phds.io",
    "title": "PhDs.io",
    "section": "What is phds.io?",
    "text": "What is phds.io?\nA powerful and intuitive literature search engine designed specifically for finance and economics researchers.\n\nEfficient: Quickly finds relevant academic papers.\nFocused: Tailored to the needs of applied finance researchers.\nOpen Access: Freely available to the academic community."
  },
  {
    "objectID": "talks/phds.io.html#why-use-phds.io",
    "href": "talks/phds.io.html#why-use-phds.io",
    "title": "Introducing PhDs.io",
    "section": "Why Use phds.io?",
    "text": "Why Use phds.io?\n\n\n\nTraditional search engines can be:\n\nSlow, irrelevant\nOverloaded with results\n\nWe often narrowly focus on our own discipline…\n\n\n\nPhDs.io solves these problems via:\n\nTargeted indexing: ABDC-A*, FT50, UTD24\nFacet search: grouping by FoR, journal, year-month, issue\nComplex logic: term, logical and/or/not, diacritic-awareness\nQuality of life: highlights, sorting, BibTeX, (OA article temporarily unavailable)\nSpeed - written in Rust"
  },
  {
    "objectID": "talks/phds.io.html#key-features",
    "href": "talks/phds.io.html#key-features",
    "title": "Introducing PhDs.io",
    "section": "Key Features",
    "text": "Key Features\n\nAdvanced Search: Precise filters (authors, keywords, titles)\nCitation & Reference Tracking: Easy navigation of academic networks\nPersonalized Experience: Save searches and bookmark papers"
  },
  {
    "objectID": "talks/phds.io.html#transition-to-rust",
    "href": "talks/phds.io.html#transition-to-rust",
    "title": "Introducing PhDs.io",
    "section": "Transition to Rust",
    "text": "Transition to Rust\n\nInitially developed with Python\nRecently rewritten in Rust:\n\nImproved performance and speed\nEnhanced stability and reliability\nScalable architecture"
  },
  {
    "objectID": "talks/phds.io.html#adoption-and-impact",
    "href": "talks/phds.io.html#adoption-and-impact",
    "title": "Introducing PhDs.io",
    "section": "Adoption and Impact",
    "text": "Adoption and Impact\nphds.io is already used by leading institutions:\n\nUniversities and research institutions worldwide\nPolicymakers and financial regulators\n\nExample:\n\nA Deputy Director at the Office of the Comptroller of the Currency (U.S. Treasury) uses phds.io for policy-related research."
  },
  {
    "objectID": "talks/phds.io.html#how-to-start-using-phds.io",
    "href": "talks/phds.io.html#how-to-start-using-phds.io",
    "title": "Introducing PhDs.io",
    "section": "How to Start Using phds.io",
    "text": "How to Start Using phds.io\n\nVisit phds.io directly.\nNo registration required.\nExplore, search, and streamline your literature review process.\n\n\nFor more information, see my blog post."
  },
  {
    "objectID": "talks/phds.io.html#feedback-contributions",
    "href": "talks/phds.io.html#feedback-contributions",
    "title": "Introducing PhDs.io",
    "section": "Feedback & Contributions",
    "text": "Feedback & Contributions\n\nphds.io is continuously evolving.\nSuggestions, feedback, and collaborations are welcome.\nOpen for research partnerships and integrations."
  },
  {
    "objectID": "talks/phds.io.html#live-demo",
    "href": "talks/phds.io.html#live-demo",
    "title": "Introducing PhDs.io",
    "section": "Live Demo",
    "text": "Live Demo\nLet’s explore a quick demonstration!\n\nSearch for a paper by author name or keyword.\nNavigate through citations and references.\nExperience the intuitive interface firsthand."
  },
  {
    "objectID": "talks/phds.io.html#questions",
    "href": "talks/phds.io.html#questions",
    "title": "Introducing PhDs.io",
    "section": "Questions?",
    "text": "Questions?\n\nFeel free to ask questions now or contact me later.\nYour feedback is greatly appreciated!\n\n\n\n\nIntroducing PhDs.io - Dr. Mingze Gao"
  },
  {
    "objectID": "talks/phds.io.html#what-is-it",
    "href": "talks/phds.io.html#what-is-it",
    "title": "Introducing PhDs.io",
    "section": "What is it?",
    "text": "What is it?\nPhDs.io is a powerful literature search engine designed for researchers in finance, accounting, and economics.1\n\n\nThe target users will expand to include all business school researchers."
  },
  {
    "objectID": "talks/phds.io/index.html#what-is-it",
    "href": "talks/phds.io/index.html#what-is-it",
    "title": "Introducing PhDs.io",
    "section": "What is it?",
    "text": "What is it?\nPhDs.io is a powerful literature search engine designed for researchers in finance, accounting, and economics.1\n\n\nThe target users will expand to include all business school researchers."
  },
  {
    "objectID": "talks/phds.io/index.html#why-use-phds.io",
    "href": "talks/phds.io/index.html#why-use-phds.io",
    "title": "Introducing PhDs.io",
    "section": "Why Use phds.io?",
    "text": "Why Use phds.io?\n\n\n\nTraditional search engines can be:\n\nSlow, irrelevant\nOverloaded with results\n\nWe often narrowly focus on our own discipline…\n\n\n\nPhDs.io solves these problems via:\n\nTargeted indexing: ABDC-A*, FT50, UTD24\nFacet search: grouping by FoR, journal, year-month, issue\nComplex logic: term, logical and/or/not, diacritic-awareness\nQuality of life: highlights, sorting, BibTeX, (OA article temporarily unavailable)\nSpeed - written in Rust"
  },
  {
    "objectID": "talks/phds.io/index.html#adoption-and-impact",
    "href": "talks/phds.io/index.html#adoption-and-impact",
    "title": "Introducing PhDs.io",
    "section": "Adoption and Impact",
    "text": "Adoption and Impact\n\n\n\nPhDs.io is already used worldwide\nGreat opportunity to promote MQBS and our Department\n\n\n\n\n\n\n\n\nFigure 1: 30-day users (incl. some bots)\n\n\n\n\n\n\n\nIntroducing PhDs.io - Dr. Mingze Gao"
  },
  {
    "objectID": "talks/phds.io/index.html#how-to-start-using-phds.io",
    "href": "talks/phds.io/index.html#how-to-start-using-phds.io",
    "title": "Introducing PhDs.io",
    "section": "How to Start Using phds.io",
    "text": "How to Start Using phds.io\n\nVisit phds.io directly.\nNo registration required.\nExplore, search, and streamline your literature review process.\n\n\nFor more information, see my blog post."
  },
  {
    "objectID": "talks/phds.io/index.html#feedback-contributions",
    "href": "talks/phds.io/index.html#feedback-contributions",
    "title": "Introducing PhDs.io",
    "section": "Feedback & Contributions",
    "text": "Feedback & Contributions\n\nphds.io is continuously evolving.\nSuggestions, feedback, and collaborations are welcome.\nOpen for research partnerships and integrations."
  },
  {
    "objectID": "talks/phds.io/index.html#live-demo",
    "href": "talks/phds.io/index.html#live-demo",
    "title": "Introducing PhDs.io",
    "section": "Live Demo",
    "text": "Live Demo\nLet’s explore a quick demonstration!\n\nSearch for a paper by author name or keyword.\nNavigate through citations and references.\nExperience the intuitive interface firsthand."
  },
  {
    "objectID": "talks/phds.io/index.html#questions",
    "href": "talks/phds.io/index.html#questions",
    "title": "Introducing PhDs.io",
    "section": "Questions?",
    "text": "Questions?\n\nFeel free to ask questions now or contact me later.\nYour feedback is greatly appreciated!\n\n\n\n\nIntroducing PhDs.io - Dr. Mingze Gao"
  },
  {
    "objectID": "talks/phds.io/index.html#vision-and-roadmap",
    "href": "talks/phds.io/index.html#vision-and-roadmap",
    "title": "Introducing PhDs.io",
    "section": "Vision and Roadmap",
    "text": "Vision and Roadmap\n\nVisit phds.io directly.\nNo registration required.\nExplore, search, and streamline your literature review process.\n\n\nFor more information, see my blog post.\n\n\nSuggestions, feedback, and collaborations are welcome.\nOpen for research partnerships and integrations.\n\n\n\n\nIntroducing PhDs.io - Dr. Mingze Gao"
  },
  {
    "objectID": "talks/phds.io/index.html#vision-current-status-and-roadmap",
    "href": "talks/phds.io/index.html#vision-current-status-and-roadmap",
    "title": "Introducing PhDs.io",
    "section": "Vision, Current Status, and Roadmap",
    "text": "Vision, Current Status, and Roadmap\n\nVisit phds.io directly.\nNo registration required.\nExplore, search, and streamline your literature review process.\n\n\nFor more information, see my blog post.\n\n\nSuggestions, feedback, and collaborations are welcome.\nOpen for research partnerships and integrations.\n\n\n\n\nIntroducing PhDs.io - Dr. Mingze Gao"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#introduction",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#introduction",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Introduction",
    "text": "Introduction\n\nForeign Exchange Risk: Also known as currency risk, this is the potential for losses due to changes in exchange rates. It affects businesses and financial institutions involved in cross-border transactions, as fluctuations can alter the value of foreign-denominated assets, liabilities, or revenues.\nSovereign Risk: This risk arises when a government defaults on its debt or restricts its residents from fulfilling international debt obligations. It reflects the political and economic stability of a country, impacting investors and financial institutions with exposure to that country’s assets.\nOff-Balance-Sheet Risk: These are risks associated with contingent liabilities or commitments that do not appear on the balance sheet. Common examples include guarantees, derivatives, and letters of credit, which can lead to substantial losses if the underlying exposures materialize."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#foreign-exchange-rates",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#foreign-exchange-rates",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Foreign exchange rates",
    "text": "Foreign exchange rates\nA foreign exchange (FX) rate is the price at which one currency (e.g., the U.S. dollar) can be exchanged for another currency (e.g., the Australian dollar).\nTwo basic types of FX transactions:\n\nSpot FX transactions involve the immediate settlement, or exchange, of currencies at the current (spot) exchange rate.\nForward FX transactions involve the exchange of currencies at a specified exchange rate (i.e., the forward exchange rate) which is settled at some specified date in the future."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#source-of-fx-risk-exposure",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#source-of-fx-risk-exposure",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Source of FX risk exposure",
    "text": "Source of FX risk exposure\nAssets and liabilities denominated in foreign currencies\n\nmaking foreign currency loans\nissuing foreign currency-denominated debt\n\nThe trading of foreign currencies involves\n\npurchase and sale of currencies to complete international transactions\nfacilitating positions in foreign real and financial investments\naccommodating hedging activities\nspeculation\n\nSubstantial risk arises via open positions (unhedged positions)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#fx-exposure",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#fx-exposure",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "FX exposure",
    "text": "FX exposure\nAn FI’s overall FX exposure in any given currency can be measured by the net position exposure, which is measured in local currency as\n\\[\n\\begin{aligned}\n\\text{Net exposure}_i &= (\\text{FX assets}_i - \\text{FX liabilities}_i) + (\\text{FX bought}_i - \\text{FX sold}_i) \\\\\n&=\\text{Net foreign assets}_i + \\text{Net FX bought}_i\n\\end{aligned}\n\\]\nwhere \\(i\\) represents the \\(i\\)th currency.\n\nFI could match its foreign currency assets to its liabilities in a given currency and match buys and sells in its trading book in that foreign currency\n\nreduce its foreign exchange net exposure to zero and thus avoid FX risk.\n\nFinancial holding companies can aggregate their foreign exchange exposure through their banking, insurance and funds management businesses under one umbrella\n\nallows them to reduce their net foreign exchange exposure across all units."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#fx-rate-volatility-and-fx-exposure",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#fx-rate-volatility-and-fx-exposure",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "FX rate volatility and FX exposure",
    "text": "FX rate volatility and FX exposure\nWe can measure the potential size of an FI’s FX exposure as:\n\\[\n\\begin{aligned}\n\\text{Dollar loss/gains in currency } i &= \\text{Net exposure in foreign currency } i \\text{ measured in local currency} \\\\\n&\\times \\text{Shock (volatility) to the exchange rate of local currency to foreign currency } i\n\\end{aligned}\n\\]\n\nGreater exposure to a foreign currency combined with greater volatility of the foreign currency implies greater daily earnings at risk (DEAR).\nReason for FX volatility: fluctuations in the demand for and supply of a country’s currency"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#fx-rate-volatility-and-fx-exposure-contd",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#fx-rate-volatility-and-fx-exposure-contd",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "FX rate volatility and FX exposure (cont’d)",
    "text": "FX rate volatility and FX exposure (cont’d)\n\\[\n\\begin{aligned}\n\\text{Dollar loss/gains in currency } i &= \\text{Net exposure in foreign currency } i \\text{ measured in local currency} \\\\\n&\\times \\text{Shock (volatility) to the exchange rate of local currency to foreign currency } i\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\nExample\n\n\nOn September 8, 2024, an Australian FI has a net exposure to New Zealand dollar (NZD) of NZD$1,000,000. The exchange rate of AUD to NZD was 1.08 AUD/NZD.\nIt is now October 8, 2024, and the exchange rate becomes 1.10 AUD/NZD. The AUD has depreciated in value relative to the NZD. Calculate the FI’s dollar loss/gain for this shock to the AUD/NZD exchange rate.\n\nThe AUD value of the NZD position on September 8 is \\(\\$1,000,000\\times 1.08=\\$1,080,000\\).\nThe AUD value of the NZD position on October 8 is \\(\\$1,000,000\\times 1.10=\\$1,100,000\\).\nThe gain from the net long position in NZD is \\(\\$1,100,000-\\$1,080,000=\\$20,000\\).\n\nOr, the dollar loss/gain is\n\\(\\text{NZD}\\$1,000,000 \\times (1.10 - 1.08) = \\text{AUD}\\$20,000\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#fx-rate-volatility-and-fx-exposure-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#fx-rate-volatility-and-fx-exposure-contd-1",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "FX rate volatility and FX exposure (cont’d)",
    "text": "FX rate volatility and FX exposure (cont’d)\nThe FI has a €2.0 million long trading position in spot euros at the close of business on a particular day. The exchange rate is €0.80/$1, or $1.25/€, at the daily close. Looking back at the daily changes in the exchange rate of the euro to dollars for the past year, the FI finds that the volatility or standard deviation (\\(\\sigma\\)) of the spot exchange rate was 50 basis points (bp). What is the DEAR?\n\n\\[\n\\text{DEAR} = \\text{Dollar value of position} \\times \\text{FX volatility}\n\\]\n\nDollar value of position = €2.0 x 1.25 $/€ = $2.5 million\nFX volatility = 2.33\\(\\sigma\\) = 2.33 x 0.005 = 0.01165\nDEAR = $2,500,000 x 0.01165 = $29,125"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#interaction-of-interest-rate-inflation-and-exchange-rates",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#interaction-of-interest-rate-inflation-and-exchange-rates",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Interaction of interest rate, inflation, and exchange rates",
    "text": "Interaction of interest rate, inflation, and exchange rates\n\nGlobal financial markets are increasingly interconnected, so are interest rates, inflation, and foreign exchange rates.\nWe now explore how inflation in one country affects its foreign currency exchange rates, focusing on purchasing power parity (PPP).\nNext, we examine the relationship between domestic/foreign interest rates and spot/forward foreign exchange rates, known as interest rate parity (IRP)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#purchasing-power-parity",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#purchasing-power-parity",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Purchasing Power Parity",
    "text": "Purchasing Power Parity\nNominal interest rate \\(R\\) is basically the sum of inflation \\(i\\) and real interest rate \\(r\\):\nFor two countries, e.g., Australia (AU) and United States (US), we have:\n\\[\n\\begin{aligned}\nR_{AU} &= i_{AU} + r_{AU} \\\\\nR_{US} &= i_{US} + r_{US}\n\\end{aligned}\n\\]\nAssuming real interest rates are equal across countries: \\(r_{AU}=r_{US}\\), then\n\\[\nR_{AU} - R_{US} = i_{AU} - i_{US}\n\\]\nThat is, the (nominal) interest rate spread between Australia and the United States represents the difference in inflation rates between the two countries.\n\n\n\n\n\n\nImportant\n\n\nWhen inflation rates and/or interest rates change, foreign exchange rates (without government control) should adjust to account for relative differences in the price levels (inflation) between the two countries.\n\n\n\nThe Purchasing Power Parity (PPP) is one theory explaining how this adjustment takes place."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#purchasing-power-parity-contd",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#purchasing-power-parity-contd",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Purchasing Power Parity (cont’d)",
    "text": "Purchasing Power Parity (cont’d)\nLet’s think of an example to illustrate the idea of PPP.\n\nImagine you have $1 and can buy one candy in the U.S. Now, let’s say in Japan, 100 yen also buys one candy.\nIf $1 is worth 100 yen, things are “balanced”.\nBut if candy’s price in Japan increases to 150 yen (inflation in Japan), your $1 won’t buy as much candy anymore.\n\nPPP states that, in different countries, the same money should buy the same amount of goods and services. So, when prices change, the money’s value changes, too, to keep things fair.\n\nThe relative value of money is the exchange rate!"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#purchasing-power-parity-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#purchasing-power-parity-contd-1",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Purchasing Power Parity (cont’d)",
    "text": "Purchasing Power Parity (cont’d)\n\n\n\n\n\n\nTip\n\n\nThe PPP says that the most important factor determining exchange rates is the price differences drive trade flows and thus demand for and supplies of currencies.\n\n\n\nSpecifically, the PPP theorem states that the change in the exchange rate between two countries’ currencies is proportional to the difference in the inflation rates in the two countries. That is:\n\\[\ni_{domestic} - i_{foreign} = \\frac{\\Delta S_{domestic/foreign}}{S_{domestic/foreign}}\n\\]\nwhere\n\n\\(S_{domestic/foreign}\\) is the spot exchange rate of the domestic currency for the foreign currency\n\\(\\Delta S_{domestic/foreign}\\) is the change in the one-period spot exchange rate"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#purchasing-power-parity-contd-2",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#purchasing-power-parity-contd-2",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Purchasing Power Parity (cont’d)",
    "text": "Purchasing Power Parity (cont’d)\nSuppose that the current spot exchange rate of Australian dollars for Chinese yuan, \\(S_{AUD/CNY}\\), is 0.17 (i.e. 0.17 dollars, or 17 cents is equal to 1 yuan). The price of Chinese-produced goods increases by 10 per cent (i.e. inflation in China \\(i_C\\), is 10 per cent), and the Australian price index increases by 4 per cent (i.e. inflation in Australia, \\(i_{AUS}\\), is 4 per cent). What will be the change of the exchange rate?\nAccording to PPP:\n\\[\ni_{AUS} - i_{C} = \\frac{\\Delta S_{AUD/CNY}}{S_{AUD/CNY}}\n\\]\nSo that\n\\[\n0.04 - 0.1 = \\frac{\\Delta S_{AUD/CNY}}{0.17}\n\\]\nSolving the equation, we get \\(\\Delta S_{AUD/CNY} = −0.0102\\). Thus, it costs 1.02 cents less to receive a yuan. The Chinese yuan depreciates in value by 6 per cent against the Australian dollar as a result of its higher relative inflation rate. In other words, a 6 per cent fall in the yuan’s value translates into a new exchange rate of 0.1598 dollars per yuan."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#purchasing-power-parity-contd-3",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#purchasing-power-parity-contd-3",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Purchasing Power Parity (cont’d)",
    "text": "Purchasing Power Parity (cont’d)\nThe theory behind purchasing power parity is the law of one price, an economic concept which states that in an efficient market, if countries produce a good or service that is identical to that in other countries, that good or service must have a single price, no matter where it is purchased."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#interest-rate-parity",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#interest-rate-parity",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Interest Rate Parity",
    "text": "Interest Rate Parity\nTo illustrate (covered) interest rate parity (IRP), let’s consider two investment strategies.\nStrategy 1: Domestic Investment\n\nYou invest $1 domestically at an interest rate \\(r_d\\) for one period.\nAfter one period, your investment grows to \\(1 + r_d\\).\n\nStrategy 2: Foreign Investment with Forward Contract\n\nYou convert $1 into foreign currency at the current spot exchange rate \\(S\\), which gives \\(1/S\\) foreign currency.\nYou then invest the foreign currency amount in a foreign asset at the interest rate \\(r_f\\) for one period.\nAfter one period, this investment grows to \\((1 + r_f)\\).\nYou lock in the forward exchange rate \\(F\\) now to convert the foreign currency back to domestic currency after one period.\n\nFor these two strategies to have the same return (and eliminate arbitrage opportunities), the returns on both should be equivalent when the foreign investment is converted back using the forward rate. This gives us the CIRP condition:\n\\[\n1 + r_d = \\frac{(1 + r_f) \\cdot F}{S}\n\\]\nRearranging, we can see the relation between interest rates and the forward rate:\n\\[\nF = S \\cdot \\frac{1 + r_d}{1 + r_f}\n\\]"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#interest-rate-parity-contd",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#interest-rate-parity-contd",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Interest Rate Parity (cont’d)",
    "text": "Interest Rate Parity (cont’d)\nAssume the interest rate on Australian dollar securities at time \\(t\\) equals 5 per cent and the interest rate on euro loans at time \\(t\\) is 10 per cent. Further, suppose the $/€ spot exchange rate (\\(S_t\\)) at time t is $0.60/€1 and the future exchange rate (\\(F_t\\)) is $0.55/€1. If the spot exchange rate rises to $0.65/€1, what is the change on the forward exchange rate?\n\n\n\nTo find the change in the forward exchange rate due to a change in the spot exchange rate, we can start by using the IRP condition:\n\\[\nF_t = S_t \\cdot \\frac{1 + r_d}{1 + r_f}\n\\]\n\nDomestic interest rate (Australia), \\(r_d = 5\\% = 0.05\\)\nForeign interest rate (Euro), \\(r_f = 10\\% = 0.10\\)\nInitial spot exchange rate, \\(S_t = 0.60\\) AUD/EUR\nInitial forward exchange rate, \\(F_t = 0.55\\) AUD/EUR\nNew spot exchange rate, \\(S'_t = 0.65\\) AUD/EUR\n\nLet’s calculate the new forward rate using CIRP, then we’ll find the change in the forward rate.\n\nStep 1: Calculate the New Forward Rate \\(F'_t\\)\n\\[\n\\begin{aligned}\nF'_t &= S'_t \\cdot \\frac{1 + r_d}{1 + r_f} \\\\\n     &= 0.65 \\cdot \\frac{1 + 0.05}{1 + 0.10} \\\\\n     &\\approx 0.6205 \\text{ AUD/EUR}\n\\end{aligned}\n\\]\nStep 2: Calculate the Change in the Forward Rate\nNow, find the change between the new forward rate and the initial forward rate:\n\\[\n\\begin{aligned}\n\\Delta F_t &= F'_t - F_t \\\\\n           &= 0.6205 - 0.55 \\\\\n           &\\approx 0.0705 \\text{ AUD/EUR}\n\\end{aligned}\n\\]\nThe forward exchange rate increases by approximately 0.0704 AUD/EUR as a result of the rise in the spot exchange rate."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#managing-fx-risk",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#managing-fx-risk",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Managing FX risk",
    "text": "Managing FX risk\nOn-balance-sheet hedging\n\nRequires duration matching to control exposure to foreign interest rate risk\nA direct match of foreign assets and liabilities can result in positive profits for the FI\n\nOff-balance-sheet hedging\n\nUses forwards, futures, options and swaps\nExample: hedging with forwards allows FI to offset uncertainty regarding the future spot rate on a currency"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#introduction-to-sovereign-risk",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#introduction-to-sovereign-risk",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Introduction to sovereign risk",
    "text": "Introduction to sovereign risk\n\nMismatches in the size and maturities of foreign assets and liabilities expose FIs to FX risk.\nBeyond FX risk, holding assets in a foreign country also exposes FIs to country or sovereign risk.\n\ne.g., when the foreign corporation may be unable to repay the principal or interest on a loan even if it would like to.\nthe government of the country in which a borrower is headquartered may prohibit or limit debt payments\n\nforeign currency shortages, adverse political reasons, and more."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#credit-risk-vs-sovereign-risk",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#credit-risk-vs-sovereign-risk",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Credit risk vs sovereign risk",
    "text": "Credit risk vs sovereign risk\n\nCredit Risk: This is the risk that a borrower (like a domestic firm) might refuse or be unable to repay its debt. If this happens, lenders can negotiate loan restructuring or, ultimately, pursue bankruptcy proceedings to recover assets. This type of risk is typically manageable through legal proceedings within the borrower’s own country.\nSovereign Risk: This arises when a government (such as the Greek government) intervenes, restricting a domestic corporation from repaying its foreign debts, regardless of the corporation’s financial health. Unlike credit risk, sovereign risk is largely out of the borrower’s control and independent of the borrower’s creditworthiness. In cases of sovereign risk, international lenders have limited legal options, as there’s no global court to enforce debt repayment or asset liquidation against a sovereign state.\n\n\nTherefore, lending decisions to parties in foreign countries require two steps:\n\ncredit quality assessment of borrower\nsovereign risk quality assessment of country"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#forms-of-sovereign-risk",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#forms-of-sovereign-risk",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Forms of sovereign risk",
    "text": "Forms of sovereign risk\nA sovereign country’s (negative) decisions on its debt obligations or the obligations of its public and private organizations may take two forms: repudiation and restructuring.\n\nDebt repudiation\n\nAn outright cancellation of all a borrower’s current and future foreign debt and equity obligations\nIn 1996, World Bank, IMF and major governments around the world forgave the debt of the world’s poorest, most heavily indebted countries (HIPCs)\nBy 2021, 36 countries had received debt relief under the HIPC initiative, 30 of them in Africa, which totaled a reduction of $76 billion on their outstanding debt\n\nDebt restructuring\n\nChange the contractual terms of a loan, such as maturity and interest payment\n\nDelay the payment\nPay less interest\n\nMost common form of sovereign risk"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#repudiation-vs-restructuring",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#repudiation-vs-restructuring",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Repudiation vs restructuring",
    "text": "Repudiation vs restructuring\nRepudiation was more common before World War II, while post World War II, restructuring is more likely.\n\nOne reason is that most postwar international debt has been bank loans, while before the war it was mostly foreign bonds.\nBondholders are diverse - hard to reach an agreement to changes in the contractual terms on a bond.\nFewer FIs involved in international lending syndicates.\nMany international loan contracts contain “cross-default” provisions: one loan default automatically triggers all loans’ default to prevent a country from selectively defaulting.\nBank bailouts for large banks create (mis)incentives."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#country-risk-evaluation",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#country-risk-evaluation",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Country risk evaluation",
    "text": "Country risk evaluation\nAn FI can rely on both outside evaluation services or develop its internal evaluation models for sovereign risk.\n\nOutside Evaluation Models\n\nThe Euromoney Country Risk Index\nThe Institutional Investor Credit Ratings\nOECD Country Risk Classifications\n\nInternal Evaluation Models\n\nStatistical models"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation",
    "text": "Statistical models for country risk evaluation\nMost common form of country risk assessment scoring models based on economical factors\n\npick a set of variables that may be important in explaining restructuring probabilities\ndevelop the scoring model\n\nCommonly used economic ratios:\n\nTotal debt service ratio (TDSR)\n\n\\[\n\\begin{aligned}\nTDSR &= \\frac{\\text{Total debt service}}{\\text{Exports}} \\\\\n     &= \\frac{\\text{Interest} + \\text{amortisation on debt}}{\\text{Exports}} \\\\\n\\end{aligned}\n\\]\nA country’s exports are its primary way of generating dollars and other currencies.\n\nThe higher the ratio, the higher sovereign risk.\n\n\n\n\n\n\n\nNote\n\n\nCheck data at World Bank’s DataBank."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation-contd",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation-contd",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation (cont’d)",
    "text": "Statistical models for country risk evaluation (cont’d)\n\nImport ratio (IR)\n\n\\[\nIR = \\frac{\\text{Total imports}}{\\text{Total FX reserves}}\n\\]\nImports to meet demands - sometimes even food is a vital import - requires FX reserves.\n\nThe higher the ratio, the higher sovereign risk.\n\n\n\n\n\n\n\nNote\n\n\nIn 2020, Greece’s IR was 626% while China’s IR aws 70%. Greece imported more goods and services than it had serves to pay for them."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation-contd-1",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation (cont’d)",
    "text": "Statistical models for country risk evaluation (cont’d)\n\nInvestment ratio (INVR)\n\n\\[\nINVR = \\frac{\\text{Real investment}}{\\text{GDP}}\n\\]\n\nThe higher the ratio, the lower sovereign risk (arguable)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation-contd-2",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation-contd-2",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation (cont’d)",
    "text": "Statistical models for country risk evaluation (cont’d)\n\nVariance of export revenue (VAREX)\n\n\\[\nVAREX = \\sigma^2_{ER}\n\\]\n\nThe higher the variance, the higher sovereign risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation-contd-3",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation-contd-3",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation (cont’d)",
    "text": "Statistical models for country risk evaluation (cont’d)\n\nDomestic money supply growth (MG)\n\n\\[\nMG = \\frac{\\Delta M}{M}\n\\]\n\nWeaken local currency by pushing up inflation rate.\nThe higher the growth, the higher sovereign risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation-contd-4",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#statistical-models-for-country-risk-evaluation-contd-4",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Statistical models for country risk evaluation (cont’d)",
    "text": "Statistical models for country risk evaluation (cont’d)\nDevelop a scoring model \\(f\\) as a function of the chosen economic variables:\n\\[\np = f(TDSR, IR, INVR, VAREX, MG, \\dots)\n\\]\nwhere \\(p\\) can be the probability of restructuring."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#off-balance-sheet-obs-activities",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#off-balance-sheet-obs-activities",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Off-balance-sheet (OBS) activities",
    "text": "Off-balance-sheet (OBS) activities\nOBS items are “off-balance-sheet” as they appear frequently as footnotes to financial statements.\nIn economics terms, OBS items are contingent assets and liabilities that affect the future shape of an FI’s balance sheet. They potentially can produce positive or negative future cash flows for an FI.\n\nThe true picture of net worth should include market value of on- and off-balance-sheet activities.\n\nIncentives to increase OBS activities:\n\nGenerate additional income\nAvoid regulatory costs or taxes\n\nReserve requirements\nDeposit insurance premiums\nCapital adequacy requirements"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#major-types-of-obs-activities",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#major-types-of-obs-activities",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Major types of OBS activities",
    "text": "Major types of OBS activities\n\nLoan commitment: Contractual commitment to make a loan up to a stated amount at a given interest rate in the future.\nLetters of credit: Contingent guarantees sold by an FI to underwrite the performance of the buyer of the guaranty.\nDerivative contract: Agreement between two parties to exchange a standard quantity of an asset at a predetermined price at a specified date in the future.\nWhen-issued trading: Trading in securities prior to their actual issue.\nLoans sold: Loans originated by an FI and then sold to other investors that (in some cases) can be returned to the originating institution in the future if the credit quality of the loans deteriorates."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#loan-commitments",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#loan-commitments",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Loan commitments",
    "text": "Loan commitments\n\nCommitment to make a loan up to a stated amount at a given interest rate in the future\nNowadays very popular, sometimes more so than spot loans\nCharge up-front fee and back-end fee\n\nThe upfront fee applies on the whole commitment size and the back-end fee applies on any unused balances at the end of the period.\n\n\n\n\n\n\n\nExample of the fees\n\n\nSuppose an FI gives an one-year $10 million loan commitment to a firm with an upfront fee of 1/8% and back-end fee of 1/4%.\nThe upfront fee is \\(\\$10,000,000 \\times 1/8\\% = \\$12,500\\).\nIf the firm takes down only $8 million over the year, the back-end fee is \\(\\$10,000,000\\times 1/4\\% = \\$5,000\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#loan-commitments-contd",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#loan-commitments-contd",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Loan commitments (cont’d)",
    "text": "Loan commitments (cont’d)\n\n\nFor a one-year loan commitment, let:\n\nBase rate \\(BR=12\\%\\)\nRisk premium \\(\\phi=2\\%\\)\nUpfront fee \\(f_1=1/8\\%\\)\nBack-end fee \\(f_2=1/4\\%\\)\nCompensating balance \\(b=10\\%\\)\nReserve requirements \\(RR=10\\%\\)\nAverage takedown rate \\(td=75\\%\\)\n\n\nThen, the promised return \\(1+k\\) of the loan commitment is\n\\[\n\\begin{aligned}\n1+k &= 1+ \\frac{f_1+f_2(1-td) + (BR+\\phi) td}{td - b\\times td (1-RR)} \\\\\n    &= 1+ \\frac{0.00125+0.0025(1-0.75) + (0.12+0.02) 0.75}{0.75 - 0.1\\times 0.75 (1-0.1)} \\\\\n    &= 1.1566\n\\end{aligned}\n\\]\nSo \\(k=15.66\\%\\)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#risks-associated-with-loan-commitments",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#risks-associated-with-loan-commitments",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Risks associated with loan commitments",
    "text": "Risks associated with loan commitments\n\nInterest rate risk\n\nOn fixed-rate loan commitments the bank is exposed to interest rate risk\nOn floating-rate commitments, there is still exposure to basis risk\n\nDraw-down risk\n\nUncertainty of timing of draw-downs exposes bank to risk\nBack-end fees are intended to reduce this risk\n\nCredit risk\n\nCredit rating of the borrower may deteriorate over the life of the commitment\nAddressed through ‘adverse material change in conditions’ clause\n\nAggregate funding risk\n\nDuring a credit crunch, bank may find it difficult to meet all of the commitments (compare to externality effect)\nBank may need to adjust its risk profile on the balance sheet in order to guard against future draw-downs on loan commitments"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#letter-of-credit",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#letter-of-credit",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Letter of credit",
    "text": "Letter of credit\n\nDocumentary (Commercial) letters of credit (LCs)\n\nContingent guarantees to underwrite the trade or commercial performance\nWidely used in both domestic and international trade\n\n\n\nCommercial LC\nStandby letters of credit (SLCs)\n\nCover contingencies potentially more severe and less predictable than those covered by LCs"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#risks-associated-with-letters-of-credit",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#risks-associated-with-letters-of-credit",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Risks associated with letters of credit",
    "text": "Risks associated with letters of credit\nThe buyer of the LC may fail to perform as promised under the contractual obligation\n\nDuring the GFC, many US firms were unable to pay their maturing commercial paper (CP) obligations in the US. The amount of potential defaults would have crippled already liquidity-strapped FIs that had written standby letters of credit backing the CP issues.\nIn response, the US Federal Reserve Board (central bank) announced a support mechanism for the CP market to provide liquidity to short-term funding markets, through which the Federal Reserve purchased CPs.\nThus rather than having to draw on FI letters of credit to pay the CP liabilities, the US government bailed out these securities and the FIs that were backing them."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#derivative-contract",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#derivative-contract",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Derivative contract",
    "text": "Derivative contract\n\nFIs can be either\n\nusers of derivative contracts for hedging and other purposes, or\ndealers that act as counterparties in trades with customers for a fee\n\nIn Australia, most banks act in both capacities\nFutures, forwards, swaps and options\n\nForward contracts involve substantial counterparty risk\nOther derivatives create far less default risk\nMarket risk"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#sale-of-when-issued-securities",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#sale-of-when-issued-securities",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Sale of when-issued securities",
    "text": "Sale of when-issued securities\n\nCommitments to buy and sell securities before they are issued: ‘when issued (WI) trading’\nExample: new issue of T-Notes announced by RBA\nBanks who bid in the T-Notes auction can trade them before the announcement of the successful bidders through forward sales.\nFIs may sell the yet-to-be-issued Treasury securities for forward delivery to customers in the secondary market at a margin above the price they expect to pay at the tender.\nRisk of ‘over-commitment’"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#loans-sold",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#loans-sold",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Loans sold",
    "text": "Loans sold\n\nFI originates loans and sells them to outside investors\nPotential outside investors\n\nOther banks\nInsurance companies\nUnit trusts\nCorporations\n\nLoans sold are an indication of FIs moving from asset-transformers to brokers\nRecourse:the ability to put an asset or loan back to the seller should the credit quality of that asset deteriorate\n\n‘No recourse’: loan buyer bears all default risk if loan goes bad\nWith recourse: long-term contingent credit risk for loan seller"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#role-of-obs-activities-in-reducing-risk",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#role-of-obs-activities-in-reducing-risk",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Role of OBS activities in reducing risk",
    "text": "Role of OBS activities in reducing risk\n\nOBS activities are not always risk-increasing activities\nIn many cases they are hedging activities designed to mitigate exposure to interest rate risk, foreign exchange risk etc.\nOBS activities can decrease an FI’s insolvency risk\nOBS activities are frequently a source of fee income, especially for the largest, most credit-worthy banks"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#suggested-readings",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "Suggested readings",
    "text": "Suggested readings"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week10/index.html#references",
    "href": "teaching/AFIN8003/2025S1/Week10/index.html#references",
    "title": "AFIN8003 Week 10 - Sovereign Risk, Foreign Exchange Risk, and Off-Balance-Sheet Risk",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#introduction",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#introduction",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Introduction",
    "text": "Introduction\n\nSo far we have discussed many risks facing financial institutions, especially banks, and some of the many methods to manage them.\nThis week, we discuss two more approaches:\n\nloan sales\nsecuritisation\n\nLoan sales involve a transfer of risk to buyers.\nSecuritisation converts loans into tradable securities.\nThey both enhance liquidity and provide funding for banks.\nThe originate-to-distribute model:\n\nmake loans\nloan sales and securitisation\nuse proceeds to originate new loans/assets"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#introduction-1",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#introduction-1",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Introduction",
    "text": "Introduction\nCentral to bank risk management is credit risk, as discussed in Week 6 and Week 7.\nTraditionally, banks adopt several mechanisms to manage credit risk:\n\ncharging higher interest rates and fees for loans extended to more risky borrowers\nrationing credits (limit the amount) to more risky borrowers\nrequiring (more) collateral for loans to more risky borrowers\nimplementing more restrictive loan covenants\ndiversification\n…\n\nIn addition, FIs can use derivatives (e.g., forward, options, swaps) to manage their credit risk.\nHowever, FIs now increasingly use loan sales and securitisation to control credit risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#loan-sales-1",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#loan-sales-1",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Loan sales",
    "text": "Loan sales\n\nThe use of credit derivatives allows an FI to reduce credit risk without removing assets from balance sheet.\nWith loan sales, a loan is originated by an FI and then sold to an outside buyer (removed from the FI’s balance sheet).\n\nThere is a transfer of ownership from the seller to the buyer.\nIf a loan is sold without recourse, the FI has no explicit liability even if the loan defaults.\nIf a loan is sold with recourse, the buy may put the loan back to the selling FI under certain conditions.\nIn practice, most loans are sold without recourse.\n\nLoan sales do not create new types of securities such as the pass-throughs, CMOs, and MBBs, which are products of securitisation."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#types-of-loan-sales",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#types-of-loan-sales",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Types of loan sales",
    "text": "Types of loan sales\n\n\nTraditional short-term loan sales\n\nsecured by assets of the borrowing firm.\nmade to investment-grade borrowers or better.\nissued for a short term (90 days or less).\nhave yields closely tied to the commercial paper rate.\nsold in units of $1 million and up.\n\n\nLeveraged loan sales\n\nterm loans (TLs).\nsecured by assets of the borrowing firm (usually given senior secured status).\na long maturity (often three- to six-year maturities).\nhave floating rates tied to LIBOR, the prime rate, or a CD rate.\nhave strong covenant protection.\n\n\n\n\n\n\n\nNote\n\n\nThe definition of “leveraged loan” is ambiguous: some use spreads (e.g., +125bps) and others use rating criteria (e.g., BB- or lower).\n\n\n\n\n\n\n\n\n\nNote\n\n\nLeveraged loans can be:\n\nnondistressed (bid price exceeds 90 cents per $1 of loans), or\ndistressed (bid price is less than 90 cents per $1 of loans or the borrower is in default)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#types-of-loan-sales-contracts",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#types-of-loan-sales-contracts",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Types of loan sales contracts",
    "text": "Types of loan sales contracts\nTwo basic forms by which loans can be transferred from seller to buyer.\n\n\nParticipation\n\nbuyer is not a party to the underlying credit agreement so that the initial contract between loan seller and borrower remains in place after the sale.\nbuyer can exercise only partial control over changes in the loan contract’s terms.\nbuyer has a double risk exposure: underlying borrower and the selling FI.\n\n\nAssignment\n\nthe most common type.\nall rights are transferred on sale, i.e. buyer holds a direct claim on the borrower.\ntransfer of ownership"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#the-bank-loan-sales-market",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#the-bank-loan-sales-market",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "The bank loan sales market",
    "text": "The bank loan sales market\n\nIrani et al. (2021) provides a good summary.\nIf you’re interested in reading more, check here."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#the-buyers-and-sellers",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#the-buyers-and-sellers",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "The buyers and sellers",
    "text": "The buyers and sellers\n\n\nBuyers\n\nInvestment banks\nVulture funds (a specialized fund that invests in distressed loans)\nOther domestic banks and foreign banks\nInsurance companies and pension funds\nBank loan mutual funds\n\n\nSellers\n\nMajor money center banks\nGovernment and government agencies\nInvestment banks\nForeign banks\n“Good bank-bad bank”\n\nSome special-purpose banks established to absorb distressed assets from “good” banks."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#why-loan-sales",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#why-loan-sales",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Why loan sales?",
    "text": "Why loan sales?\nApart from credit risk management, there are some other reasons for FIs to sell loans.\n\nReserve requirements (becoming less important)\nFee income\nCapital costs (by reducing risky assets)\nLiquidity risk (by improving asset-side liquidity)"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#factors-affecting-loan-sales-growth",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#factors-affecting-loan-sales-growth",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Factors affecting loan sales growth",
    "text": "Factors affecting loan sales growth\n\nAccess to the commercial paper market\nCustomer relationship\nLegal concerns\nBIS capital requirements\nMarket value accounting\nAssert brokerage and loan trading\nGovernment loan sales\nCredit ratings\nPurchase and sale of foreign bank loans\n…"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#introduction-2",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#introduction-2",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Introduction",
    "text": "Introduction\nAsset securitisation is another mechanism to manage credit risk, interest rate risk, liquidity and more.\n\nIt is the process of packaging loans or other assets into newly created securities and selling these asset-backed securities (ABS) to investors.\nTwo basic mechanisms of securitisation, but both involve the creation of off-balance-sheet subsidiaries:\n\nspecial-purpose vehicle (SPV, aka special-purpose entity, SPE)\nstructured investment vehicle (SIV)\n\n\nThe mechanism is:\n\nThe loans are transferred from the originating FI to the SPV or SIV.\nThe SPV or SIV securitizes the loans (either directly or through the issuance of asset-backed commercial paper) and then sells the resulting asset-backed securities to investors.\nThe proceeds of the asset-backed security sale are paid to the FI that originates the loans."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#securitisation-via-spv",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#securitisation-via-spv",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Securitisation via SPV",
    "text": "Securitisation via SPV\n\nBank pools loans and sells them to a SPV.\nSPV packages the loans, creates new securities backed by cash flows from the underlying pool, and sells them to investors.\nSPV earns fees from the creation and servicing of these securities.\nSPV ceases to exist when underlying loans mature.\n\n\n\n\n\n\n\nNote\n\n\nThe underlying loans belong to the ultimate investors in these ABS."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#securitisation-via-spv-contd",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#securitisation-via-spv-contd",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Securitisation via SPV (cont’d)",
    "text": "Securitisation via SPV (cont’d)\n\nThe Traditional Securitization Process Using a Special-Purpose Vehicle"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#securitisation-via-siv",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#securitisation-via-siv",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Securitisation via SIV",
    "text": "Securitisation via SIV\n\nBank pools loans and sells them to a SIV.\nSIV manages the loans and sells commercial paper (or bonds) to investors.\nSIV earns fees and the expected spreads between loan returns and costs paid for the commercial paper (or bonds).\nSIV continues to exist!\n\n\n\n\n\n\n\nNote\n\n\nThe underlying loans belong to the SIV.\n\n\n\nSIV acts like a traditional bank: hold loans until maturity and issue short-term debt instruments.\n\nSIV cannot take deposits.\nSIV faces run risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#securitisation-via-siv-contd",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#securitisation-via-siv-contd",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Securitisation via SIV (cont’d)",
    "text": "Securitisation via SIV (cont’d)\n\nSecuritization Process Using a Structured Investment Vehicle"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#three-major-forms-of-securitisation",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#three-major-forms-of-securitisation",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Three major forms of securitisation",
    "text": "Three major forms of securitisation\nThe major forms of asset securitisation are:\n\nthe pass-through security,\nthe collateralized mortgage obligation (CMO), and\nthe mortgage-backed bond (MBB)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#pass-through-security",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#pass-through-security",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Pass-through security",
    "text": "Pass-through security\nPass-through securities “pass through” payments by underlying borrowers (e.g., household borrowers of mortgages) to secondary market investors holding an interest in the mortgage pool.\n\nEach pass-through security represents a fractional ownership share in a mortgage pool.\n1% ownership is entitled to 1% share of the principal and interest payment made over the life of mortgages underlying the pool.\nPrepayment risk.\n\n\n\n\n\n\n\nNote\n\n\nPass-throughs are the primary mechanism for securitisation."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#collateralized-mortgage-obligation-cmo",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#collateralized-mortgage-obligation-cmo",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Collateralized Mortgage Obligation (CMO)",
    "text": "Collateralized Mortgage Obligation (CMO)\nCMO is a second and growing securitisation mechanism.\n\nCMO repackages the cash flows from mortgages differently to create a multi-class pass-through.\nEach bond class (tranche) has a different guaranteed coupon.\nBut the allocation of early cash flows from mortgage prepayments has an pre-specified order, thereby mitigating prepayment risk."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#collateralized-mortgage-obligation-cmo-contd",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#collateralized-mortgage-obligation-cmo-contd",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Collateralized Mortgage Obligation (CMO) (cont’d)",
    "text": "Collateralized Mortgage Obligation (CMO) (cont’d)\nClass A\n\nPrepayment used to first retire principal of Class A.\nMinimum prepayment protection.\nShortest average life.\nDepositary institutions are large buyers.\n\nClass B\n\nSome prepayment protection.\nExpected durations from five to seven years.\nPension funds and life insurance companies are primary buyers.\n\nClass C\n\nLong expected duration.\nAttractive to insurance companies and pension funds seeking long-duration assets."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#mortgage-backed-bond-mbb-and-covered-bond",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#mortgage-backed-bond-mbb-and-covered-bond",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Mortgage-Backed Bond (MBB) and Covered Bond",
    "text": "Mortgage-Backed Bond (MBB) and Covered Bond\nMBB or covered bonds are the third securitisation vehicle.\nThey differ from pass-throughs and CMOs in two main aspects:\n\nMBBs normally remain on the balance sheet.\nNo direct link between cash flows on the underlying assets and the cash flows on the bond vehicles.\n\n\n\n\n\n\n\nNote\n\n\nUnderlying mortgages are more of collateral for the MBBs."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#mortgage-backed-bond-mbb-and-covered-bond-contd",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#mortgage-backed-bond-mbb-and-covered-bond-contd",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Mortgage-Backed Bond (MBB) and Covered Bond (cont’d)",
    "text": "Mortgage-Backed Bond (MBB) and Covered Bond (cont’d)\nThe process involved:\n\nThe FI segregates a group of mortgage assets on its balance sheet and pledges (covers) this group as collateral against the MBB issue.\nA trustee normally monitors the segregation of assets and makes sure that the market value of the collateral exceeds the principal owed to MBB holders.\nAs a result, FIs back most MBB issues by excess collateral.\nThis excess collateral ensures that these bonds can be sold with a high credit rating (can be even higher than the FI itself)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#the-goods-and-bads-about-mbb-and-covered-bond",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#the-goods-and-bads-about-mbb-and-covered-bond",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "The goods and bads about MBB and covered bond",
    "text": "The goods and bads about MBB and covered bond\nHowever, MBBs are less appealing to FIs for a number of reasons:\n\nThe underlying mortgages remain on the FI’s balance sheet.\nExcess collateral exacerbates the size of mortgages tied up on the FI’s balance sheet.\nThe FI remains liable for capital adequacy and reserve requirement taxes due to these mortgages staying on balance sheet."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#the-goods-and-bads-about-mbb-and-covered-bond-contd",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#the-goods-and-bads-about-mbb-and-covered-bond-contd",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "The goods and bads about MBB and covered bond (cont’d)",
    "text": "The goods and bads about MBB and covered bond (cont’d)\n\n\n\n\n\n\nCaution\n\n\nBut FIs issuing MBBs could gain at the cost of taxpayers’ money (deposit insurance)! Let’s see why.\n\n\n\nConsider an FI with $20 million in long-term mortgages as assets financed with $10 million in short-term uninsured deposits and $10 million in insured deposits.\n\n\n\nAssets\n\nLiabilities\n\n\n\n\n\nLong-term mortgages\n$20\nInsured deposits\n$10\n\n\n\n\nUninsured deposits\n$10\n\n\n\n$20\n\n$20\n\n\n\n\nA positive duration gap: interest rate risk and more.\nUninsured depositors are likely demand higher interest rate for their deposits.\nInsured depositors may demand interest rate marginally above the risk-free rate (since their deposits are fully insured)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#the-goods-and-bads-about-mbb-and-covered-bond-contd-1",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#the-goods-and-bads-about-mbb-and-covered-bond-contd-1",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "The goods and bads about MBB and covered bond (cont’d)",
    "text": "The goods and bads about MBB and covered bond (cont’d)\nTo lower the duration gap and funding cost, the FI may choose securitisation via MBB issue.\n\nPledge $12 million of the mortgages as collateral backing a $10 million long-term MBB issue.\nThis excess collateralization reduces the required yield on the MBB, to maybe even lower than the interest rate for uninsured deposits.\nThe FI can use the proceeds to retire the $10 million of uninsured deposits.\n\n\n\n\n\n\n\n\n\n\nAssets\n\nLiabilities\n\n\n\n\n\nCollateral (market value of segregated mortgages)\n$12\nMBB issue\n$10\n\n\nOther mortgages\n8\nInsured deposits\n$10\n\n\n\n$20\n\n$20\n\n\n\n\n\n\n\n\n\nImportant\n\n\nThe $10 million insured deposits are now backed only by $8 million in unpledged assets!!"
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#securitisation-of-non-mortgage-assets",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#securitisation-of-non-mortgage-assets",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Securitisation of non-mortgage assets",
    "text": "Securitisation of non-mortgage assets\nThe major use of the three securitisation vehicles (pass-throughs, CMOs and MBBs) packages fixed-rate mortgages. But securitisation can also be applied for other assets:\n\nAutomobile loans.\nCredit card receivables (certificates of amortizing revolving debts).\nSmall business loans guaranteed by the Small Business Administration.\nJunk bonds.\nAdjustable rate mortgages.\nCommercial and industrial loans [collateralized loan obligations (CLOs)].\nLeveraged loans (CLOs)."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#leveraged-loans-via-clos",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#leveraged-loans-via-clos",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Leveraged loans via CLOs",
    "text": "Leveraged loans via CLOs\n\nIn September 2018, the Federal Reserve highlighted leveraged loans as a financial stability risk, with similar warnings from the Bank of England, IMF, and BIS.\nThe U.S. leveraged loan market doubled in six years, with high-risk loans (debt over five times EBITDA) making up half of new corporate issuances, surpassing pre-crisis levels.\nRising interest rates led money managers to invest heavily in leveraged loans via CLOs, expanding the market to $1.3 trillion—equivalent to the 2007 subprime mortgage market.\nInvestor demand led to weaker protections on loans to junk-rated companies, with 86% now “covenant-lite”, compared to less than 25% in 2006-2007 (Berlin, Nini, and Yu 2020).\nThe rating quality of leveraged loans declined, with over 60% rated B2 or lower by 2021, yet CLOs still purchase 60-70% of these syndicated loans."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#suggested-readings",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#suggested-readings",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "Suggested readings",
    "text": "Suggested readings\n\nLoan Syndications and Trading Association (LSTA).\nBerlin, M., Nini, G., & Yu, E. G. (2020). Concentration of control rights in leveraged loan syndicates. Journal of Financial Economics, 137, 249–271.\nIrani, R. M., Iyer, R., Meisenzahl, R. R., & Peydró, J.-L. (2021). The Rise of Shadow Banking: Evidence from Capital Regulation. The Review of Financial Studies, 34, 2181–2235.."
  },
  {
    "objectID": "teaching/AFIN8003/2025S1/Week11/index.html#references",
    "href": "teaching/AFIN8003/2025S1/Week11/index.html#references",
    "title": "AFIN8003 Week 11 - Loan Sales and Securitisation",
    "section": "References",
    "text": "References\n\n\n\nAFIN8003 Banking and Financial Intermediation\n\n\n\n\nBerlin, Mitchell, Greg Nini, and Edison G. Yu. 2020. “Concentration of Control Rights in Leveraged Loan Syndicates.” Journal of Financial Economics 137 (1): 249–71. https://doi.org/10.1016/j.jfineco.2020.02.002.\n\n\nIrani, Rustom M, Rajkamal Iyer, Ralf R Meisenzahl, and José-Luis Peydró. 2021. “The Rise of Shadow Banking: Evidence from Capital Regulation.” The Review of Financial Studies 34 (5): 2181–2235. https://doi.org/10.1093/rfs/hhaa106."
  }
]