
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Mingze Gao's personal website.">
      
      
        <meta name="author" content="Mingze Gao">
      
      
        <link rel="canonical" href="https://mingze-gao.com/posts/compute-weekly-return-from-daily-crsp-data/">
      
      
        <link rel="prev" href="../convert-between-numeric-and-character-variables/">
      
      
        <link rel="next" href="../bloomberg-bquant/">
      
      
        
      
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.1.21+insiders-4.37.1">
    
    
      
        <title>Compute Weekly Return from Daily CRSP Data - Mingze Gao</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3a36e643.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc776e4.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.197 10a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Zm-2.382 4a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Zm-1.581 4a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Z"/><path d="M4.125 0h15.75a4.11 4.11 0 0 1 2.92 1.205A4.11 4.11 0 0 1 24 4.125c0 1.384-.476 2.794-1.128 4.16-.652 1.365-1.515 2.757-2.352 4.104l-.008.013c-.849 1.368-1.669 2.691-2.28 3.97-.614 1.283-.982 2.45-.982 3.503a2.625 2.625 0 1 0 4.083-2.183.75.75 0 1 1 .834-1.247A4.126 4.126 0 0 1 19.875 24H4.5a4.125 4.125 0 0 1-4.125-4.125c0-2.234 1.258-4.656 2.59-6.902.348-.586.702-1.162 1.05-1.728.8-1.304 1.567-2.553 2.144-3.738H3.39c-.823 0-1.886-.193-2.567-1.035A3.647 3.647 0 0 1 0 4.125 4.125 4.125 0 0 1 4.125 0ZM15.75 19.875c0-1.38.476-2.786 1.128-4.15.649-1.358 1.509-2.743 2.343-4.086l.017-.028c.849-1.367 1.669-2.692 2.28-3.972.614-1.285.982-2.457.982-3.514A2.615 2.615 0 0 0 19.875 1.5a2.625 2.625 0 0 0-2.625 2.625c0 .865.421 1.509 1.167 2.009A.75.75 0 0 1 18 7.507H7.812c-.65 1.483-1.624 3.069-2.577 4.619-.334.544-.666 1.083-.98 1.612-1.355 2.287-2.38 4.371-2.38 6.137A2.625 2.625 0 0 0 4.5 22.5h12.193a4.108 4.108 0 0 1-.943-2.625ZM1.5 4.125c-.01.511.163 1.008.487 1.403.254.313.74.479 1.402.479h12.86a3.648 3.648 0 0 1-.499-1.882 4.11 4.11 0 0 1 .943-2.625H4.125A2.625 2.625 0 0 0 1.5 4.125Z"/></svg>');}</style>


    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-1QDTTQ6EHM"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-1QDTTQ6EHM",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-1QDTTQ6EHM",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#compute-weekly-return-from-daily-crsp-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
              </button>
            
            
From January 2024, I'll join <a href="https://www.mq.edu.au/">Macquarie University</a> as a Lecturer in Finance! ðŸ˜„

          </div>
          
            <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Mingze Gao" class="md-header__button md-logo" aria-label="Mingze Gao" data-md-component="logo">
      
  <img src="../../favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mingze Gao
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Compute Weekly Return from Daily CRSP Data
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
        </form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../cv.pdf" class="md-tabs__link">
        
  
    
  
  CV

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../research/" class="md-tabs__link">
        
  
    
  
  Research

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item">
        <a href="../" class="md-tabs__link md-tabs__link--active">
          
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../finc50/" class="md-tabs__link">
          
  
    
  
  FINC50

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://phds.io" class="md-tabs__link">
        
  
    
  
  phds.io

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://frds.io" class="md-tabs__link">
        
  
    
  
  frds.io

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Mingze Gao" class="md-nav__button md-logo" aria-label="Mingze Gao" data-md-component="logo">
      
  <img src="../../favicon.png" alt="logo">

    </a>
    Mingze Gao
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../cv.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    CV
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../research/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Research
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            </a>
            
              <label class="md-nav__link " for="__nav_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Tags
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../archive/2023/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../category/cryptocurrency/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../finc50/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    
  
    FINC50
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="https://phds.io" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    phds.io
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="https://frds.io" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    frds.io
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#incorrect-ways" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          <strong>INCORRECT</strong> ways
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="INCORRECT ways">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weekly-index-return-from-daily-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Weekly index return from daily data
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weekly-stock-return-from-daily-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Weekly stock return from daily data
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whats-wrong" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          What's wrong?
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correct-ways" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          <strong>CORRECT</strong> ways
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CORRECT ways">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-start-with-a-list-of-dates-slow-version" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          1. Start with a list of dates (slow version)
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-group-using-aligned-dates-fast-version-with-caveat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          2. Group using aligned dates (fast version with caveat)
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="https://mingze-gao.com/images/Adrian.jpg" alt="Mingze Gao">
                    </span>
                    <span class="md-profile__description">
                      <strong>Mingze Gao</strong><br>
                      PhD, BCom (Hon)
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__title">
                <div class="md-nav__link">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
              </li>
              <li class="md-nav__item">
                <div class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg>
                  <time datetime="2020-05-22 00:00:00" class="md-ellipsis">May 22, 2020</time>
                </div>
              </li>
              
                <li class="md-nav__item">
                  <div class="md-nav__link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg>
                    <span class="md-ellipsis">
                      in
                      
                        <a href="../category/research-notes/">Research Notes</a></span>
                  </div>
                </li>
              
              
                
                <li class="md-nav__item">
                  <div class="md-nav__link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg>
                    <span class="md-ellipsis">
                      
                        7 min read
                      
                    </span>
                  </div>
                </li>
              
            </ul>
            
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        <!--
  Copyright (c) 2016-2022 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->


  
  


  <nav class="md-tags" >
    
      
      
        <a href="../../tags/#crsp" class="md-tag">CRSP</a>
      
    
      
      
        <a href="../../tags/#sas" class="md-tag">SAS</a>
      
    
      
      
        <a href="../../tags/#code" class="md-tag">Code</a>
      
    
  </nav>



<!-- Edit button -->


<!--
  Hack: check whether the content contains a h1 headline. If it
  doesn't, the page title (or respectively site name) is used
  as the main headline.
-->


<!-- Markdown content -->
<div><h1 id="compute-weekly-return-from-daily-crsp-data">Compute Weekly Return from Daily CRSP Data<a class="headerlink" href="#compute-weekly-return-from-daily-crsp-data" title="Permanent link">Â¶</a></h1>
<p>Computing the weekly returns from the CRSP daily stock data is a common task but
may be tricky sometimes. Let's discuss a few different ways to get it done
incorrectly and correctly.</p>
<div class="admonition tip">
<p class="admonition-title"><strong>TL;DR</strong> Take me to the final solution!</p>
<p>Surely -&gt; <a href="#2-group-using-aligned-dates-fast-version-with-caveat">The solution</a></p>
</div>
<!-- more -->

<h2 id="incorrect-ways"><strong>INCORRECT</strong> ways<a class="headerlink" href="#incorrect-ways" title="Permanent link">Â¶</a></h2>
<p>Let me start with a few incorrect ways, which may seem perfectly okay at first
glance. This part is important because it shows you how a small mistake can lead
to hard-to-discover bugs.</p>
<h3 id="weekly-index-return-from-daily-data">Weekly index return from daily data<a class="headerlink" href="#weekly-index-return-from-daily-data" title="Permanent link">Â¶</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked id="date-as-the-friday-of-the-week" name="__tabbed_1" type="radio"><input id="date-as-the-last-trading-day-of-the-week" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="date-as-the-friday-of-the-week">Date as the Friday of the week</label><label for="date-as-the-last-trading-day-of-the-week">Date as the last trading day of the week</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Using <code>intnx()</code>, we can derive the Friday of the week given a date, as shown
below. </p>
<div class="language-sas highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kr">proc sql;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="c">/* Compute weekly marekt return from daily data */</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="k">create</span> <span class="k">table</span> mktret_weekly <span class="k">as</span> 
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="k">select</span> <span class="k">distinct</span> date, 
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a>  <span class="nb">year(</span>date) <span class="k">as</span> Year,
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a>  week(date) <span class="k">as</span> Week,
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="hll">  case when <span class="nb">weekday(</span>date)=<span class="m">6</span> <span class="k">then</span> date
</span></span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="hll">  <span class="k">else</span> <span class="nb">intnx(</span><span class="s">"week.6"</span>,date,<span class="m">1</span>) <span class="k">end</span> <span class="k">as</span> FridayOfWeek <span class="k">format</span>=date9.,
</span></span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a>  (<span class="nb">exp(sum(log(</span><span class="m">1</span>+sprtrn)))-<span class="m">1</span>)*<span class="m">100</span> <span class="k">as</span> mktret <span class="k">label</span>=<span class="s">"Weekly SP500 Index Return (%)"</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="k">from</span> crsp<span class="m">.</span>dsi 
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="k">where</span> 
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a>  <span class="nb">year(</span>date) between <span class="nv">&amp;startyear.</span> <span class="k">and</span> <span class="nv">&amp;endyear.</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="k">group</span> <span class="k">by</span> <span class="nb">year(</span>date), week(date) <span class="k">order</span> <span class="k">by</span> date<span class="kr">;</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="kr">quit;</span>
</span></code></pre></div></td></tr></table></div>
<p>Note that <code>intnx("weekday.6", date, 0)</code> will give the <strong>last</strong> Friday, which is
not what we want. We want the <strong>next</strong> Friday of the week for a given date, so
we use <code>intnx("weekday.6", date, 1)</code>. The <code>case...when...</code> statement ensures
that if the given date is already a Friday, we don't go for the next one. Below
is a sample output of the <code>mktret_weekly</code> table generated. </p>
<details class="example">
<summary>Example output of <code>mktret_weekly</code></summary>
</details>
<table>
<thead>
<tr>
<th>Obs</th>
<th>Date</th>
<th>Year</th>
<th>Week</th>
<th>FridayOfWeek</th>
<th>mktret</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>19860102</td>
<td>1986</td>
<td>0</td>
<td>03JAN1986</td>
<td>-0.1893222</td>
</tr>
<tr>
<td>2</td>
<td>19860103</td>
<td>1986</td>
<td>0</td>
<td>03JAN1986</td>
<td>-0.1893222</td>
</tr>
<tr>
<td>3</td>
<td>19860106</td>
<td>1986</td>
<td>1</td>
<td>10JAN1986</td>
<td>-2.333080418</td>
</tr>
<tr>
<td>4</td>
<td>19860107</td>
<td>1986</td>
<td>1</td>
<td>10JAN1986</td>
<td>-2.333080418</td>
</tr>
<tr>
<td>5</td>
<td>19860108</td>
<td>1986</td>
<td>1</td>
<td>10JAN1986</td>
<td>-2.333080418</td>
</tr>
<tr>
<td>6</td>
<td>19860109</td>
<td>1986</td>
<td>1</td>
<td>10JAN1986</td>
<td>-2.333080418</td>
</tr>
<tr>
<td>7</td>
<td>19860110</td>
<td>1986</td>
<td>1</td>
<td>10JAN1986</td>
<td>-2.333080418</td>
</tr>
<tr>
<td>8</td>
<td>19860113</td>
<td>1986</td>
<td>2</td>
<td>17JAN1986</td>
<td>1.1992620931</td>
</tr>
<tr>
<td>9</td>
<td>19860114</td>
<td>1986</td>
<td>2</td>
<td>17JAN1986</td>
<td>1.1992620931</td>
</tr>
</tbody>
</table>
<p>We can verify that the <code>FridayOfWeek</code> indeed gives the Friday of the week.
Therefore, the final weekly dataset using Friday as the date identifier just
need to keep <code>FridayOfWeek</code> and <code>mktret</code>.</p>
<div class="language-sas highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kr">proc sql;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="c">/* Compute weekly marekt return from daily data */</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="k">create</span> <span class="k">table</span> mktret_weekly <span class="k">as</span> 
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="k">select</span> <span class="k">distinct</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="hll">  case when <span class="nb">weekday(</span>date)=<span class="m">6</span> <span class="k">then</span> date <span class="k">else</span> <span class="nb">intnx(</span><span class="s">"week.6"</span>,date,<span class="m">1</span>) <span class="k">end</span> 
</span></span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="hll">    <span class="k">as</span> date <span class="k">format</span>=date9. <span class="k">label</span>=<span class="s">"Friday of the Week"</span>,
</span></span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7"></a>  (<span class="nb">exp(sum(log(</span><span class="m">1</span>+sprtrn)))-<span class="m">1</span>)*<span class="m">100</span> 
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8"></a>    <span class="k">as</span> mktret <span class="k">label</span>=<span class="s">"Weekly SP500 Index Return (%)"</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="k">from</span> crsp<span class="m">.</span>dsi 
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="k">where</span> 
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11"></a>  <span class="nb">year(</span>date) between <span class="nv">&amp;startyear.</span> <span class="k">and</span> <span class="nv">&amp;endyear.</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="k">group</span> <span class="k">by</span> <span class="nb">year(</span>date), week(date) <span class="k">order</span> <span class="k">by</span> date<span class="kr">;</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="kr">quit;</span>
</span></code></pre></div></td></tr></table></div>
<details class="example">
<summary>Example output of <code>mktret_weekly</code></summary>
</details>
<table>
<thead>
<tr>
<th>Obs</th>
<th>date</th>
<th>mktret</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>03JAN1986</td>
<td>-0.1893222</td>
</tr>
<tr>
<td>2</td>
<td>10JAN1986</td>
<td>-2.333080418</td>
</tr>
<tr>
<td>3</td>
<td>17JAN1986</td>
<td>1.1992620931</td>
</tr>
<tr>
<td>4</td>
<td>24JAN1986</td>
<td>-0.959555101</td>
</tr>
<tr>
<td>5</td>
<td>31JAN1986</td>
<td>2.5916781551</td>
</tr>
<tr>
<td>6</td>
<td>07FEB1986</td>
<td>1.3126828796</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="language-sas highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="nb">%let</span> startyear=<span class="m">1986</span>;
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="nb">%let</span> endyear=<span class="m">2019</span><span class="kr">;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="kr">proc sql;</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="c">/* Compute weekly marekt return from daily data */</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="k">create</span> <span class="k">table</span> mktret_weekly <span class="k">as</span> 
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="k">select</span> <span class="k">distinct</span> date, 
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a>  (<span class="nb">exp(sum(log(</span><span class="m">1</span>+sprtrn)))-<span class="m">1</span>)*<span class="m">100</span> <span class="k">as</span> mktret <span class="k">label</span>=<span class="s">"Weekly SP500 Index Return (%)"</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="k">from</span> crsp<span class="m">.</span>dsi <span class="k">where</span> <span class="nb">year(</span>date) between <span class="nv">&amp;startyear.</span> <span class="k">and</span> <span class="nv">&amp;endyear.</span> 
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="k">group</span> <span class="k">by</span> <span class="nb">year(</span>date), week(date) 
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="hll"><span class="k">having</span> date=<span class="nb">max(</span>date) 
</span></span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="k">order</span> <span class="k">by</span> date<span class="kr">;</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="kr">quit;</span>
</span></code></pre></div></td></tr></table></div>
<p>Note here that it's tempting to use <code>having weekday(date)=6</code> to make sure the
dates are all Friday. However, if Friday in a week is not the last trading day,
then the weekly return will be missing. This is why here I use <code>date=max(date)</code>
to ensure non-missing weekly returns. The date is the last trading day in any
given week, consistent with the CRSP's daily stock file.</p>
<p>The caveat here is that since the dates are the weekly last trading days, when
merged with other weekly datasets, you should be very careful about whether the
other dataset is using Friday or the last trading day per week as its date
variable.</p>
</div>
</div>
</div>
<h3 id="weekly-stock-return-from-daily-data">Weekly stock return from daily data<a class="headerlink" href="#weekly-stock-return-from-daily-data" title="Permanent link">Â¶</a></h3>
<p>Following the same logic, we can calculate the weekly stock returns from daily
CRSP data, where dates are aligned to the Friday of the week.</p>
<div class="language-sas highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kr">proc sql;</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="c">/* Stocks (ordinary shares only) in the financial sector */</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="k">create</span> <span class="k">table</span> stocks <span class="k">as</span> <span class="k">select</span> <span class="k">distinct</span> permno <span class="k">from</span> crsp<span class="m">.</span>stocknames
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="k">where</span> shrcd <span class="k">in</span> (<span class="m">10</span>, <span class="m">11</span>) <span class="k">and</span> <span class="nb">floor(</span>siccd/<span class="m">100</span>) between <span class="m">60</span> <span class="k">and</span> <span class="m">67</span>;
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="k">create</span> <span class="k">table</span> stockrets_weekly <span class="k">as</span> 
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="k">select</span> <span class="k">distinct</span> permno,
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="hll">  case when <span class="nb">weekday(</span>date)=<span class="m">6</span> <span class="k">then</span> date <span class="k">else</span> <span class="nb">intnx(</span><span class="s">"week.6"</span>,date,<span class="m">1</span>) <span class="k">end</span> 
</span></span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="hll">    <span class="k">as</span> date <span class="k">format</span>=date9. <span class="k">label</span>=<span class="s">"Friday of the Week"</span>,
</span></span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10"></a>  (<span class="nb">exp(sum(log(</span><span class="m">1</span>+ret)))-<span class="m">1</span>)*<span class="m">100</span> <span class="k">as</span> ret <span class="k">label</span>=<span class="s">"Weekly Return (%)"</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="k">from</span> crsp<span class="m">.</span>dsf 
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="k">where</span> 
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13"></a>  <span class="nb">year(</span>date) between <span class="nv">&amp;startyear.</span> <span class="k">and</span> <span class="nv">&amp;endyear.</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14"></a>  <span class="k">and</span> permno <span class="k">in</span> (<span class="k">select</span> * <span class="k">from</span> stocks) 
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15"></a>  <span class="k">and</span> prc&gt;<span class="m">0</span> <span class="k">and</span> <span class="k">not</span> <span class="k">missing</span>(ret)
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="k">group</span> <span class="k">by</span> <span class="nb">year(</span>date), week(date), permno <span class="k">order</span> <span class="k">by</span> permno, date<span class="kr">;</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="kr">quit;</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="whats-wrong">What's wrong?<a class="headerlink" href="#whats-wrong" title="Permanent link">Â¶</a></h3>
<p>The code above seems okay. We know that CRSP daily stock file contains many
observations where the daily trading volume is 0, in which case the price is
recorded as the negative bid-ask midpoint. Therefore, we restrict to only those
with positive stock prices. So what's the problem?</p>
<div class="admonition bug">
<p class="admonition-title">The problem is that a week can span two calendar years.</p>
</div>
<p>For example, check out the last week of 2019:</p>
<table>
<thead>
<tr>
<th>Mon</th>
<th>Tue</th>
<th>Wed</th>
<th>Thu</th>
<th>Fri</th>
<th>Sat</th>
<th>Sun</th>
</tr>
</thead>
<tbody>
<tr>
<td>30</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
</tr>
</tbody>
</table>
<ul>
<li>Dec30 and Dec31 belong to week 53 of 2019, while the code above will use these
  two days' returns to compute the weekly return and align the date to Jan03 of
  2020.</li>
<li>Jan01 to Jan03 belong to week 0 of 2020, so the code above will use these
  three days' returns to compute the weekly return and align the date to Jan03
  of 2020.</li>
</ul>
<p>Now we have a mistake. A single week is broken into two because of the use of
<code>week()</code> function in SAS. Another consequence is that when there're many years
of data, there will be a lot of duplicates.</p>
<h2 id="correct-ways"><strong>CORRECT</strong> ways<a class="headerlink" href="#correct-ways" title="Permanent link">Â¶</a></h2>
<p>Now let's explore two ways that avoid this mistake. Although both generate the
same result (there can be a few differences, see the caveat), the second one is
much faster.</p>
<h3 id="1-start-with-a-list-of-dates-slow-version">1. Start with a list of dates (slow version)<a class="headerlink" href="#1-start-with-a-list-of-dates-slow-version" title="Permanent link">Â¶</a></h3>
<p>Now we can write some correct code to compute the weekly returns. We'll generate
a series of Fridays first, then we merge based on the past 5 calendar days. This
will ensure all trading days with non-missing data will be included in the
weekly return calculation, and correct the mistake mentioned above.</p>
<div class="language-sas highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="nb">%let</span> start_date = 01Jan1986;
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="nb">%let</span> end_date   = 31Dec2019;
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="c">/* Generate a series of Fridays */</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="kr">data </span>fridays;
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a>date=<span class="s">"</span><span class="nv">&amp;start_date</span><span class="s">"</span>d;
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="k">do</span> <span class="k">while</span> (date&lt;=<span class="s">"</span><span class="nv">&amp;end_date</span><span class="s">"</span>d);
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a>    <span class="k">if</span> <span class="nb">weekday(</span>date)=<span class="m">6</span> <span class="k">then</span> <span class="k">output</span>;
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a>    date=<span class="nb">intnx(</span><span class="s">'day'</span>, date, <span class="m">1</span>, <span class="s">'s'</span>);
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="k">end</span>;
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="k">format</span> date date9.<span class="kr">;</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="kr">run;</span>
</span></code></pre></div></td></tr></table></div>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked id="weekly-index-return-from-daily-data-as-at-friday" name="__tabbed_2" type="radio"><input id="weekly-stock-return-from-daily-data-as-at-friday" name="__tabbed_2" type="radio"><div class="tabbed-labels"><label for="weekly-index-return-from-daily-data-as-at-friday">Weekly index return from daily data (as at Friday)</label><label for="weekly-stock-return-from-daily-data-as-at-friday">Weekly stock return from daily data (as at Friday)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-sas highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="kr">proc sql;</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="c">/* Compute weekly index return from daily data */</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="k">create</span> <span class="k">table</span> mktret_weekly <span class="k">as</span> 
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16"></a><span class="k">select</span> <span class="k">distinct</span> a<span class="m">.</span>date,
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17"></a>  (<span class="nb">exp(sum(log(</span><span class="m">1</span>+sprtrn)))-<span class="m">1</span>)*<span class="m">100</span> 
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18"></a>    <span class="k">as</span> mktret <span class="k">label</span>=<span class="s">"Weekly SP500 Index Return (%)"</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19"></a><span class="k">from</span> fridays <span class="k">as</span> a left join crsp<span class="m">.</span>dsi <span class="k">as</span> dsi
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="k">on</span> dsi<span class="m">.</span>date between <span class="nb">intnx(</span><span class="s">'day'</span>, a<span class="m">.</span>date, -<span class="m">4</span>) <span class="k">and</span> a<span class="m">.</span>date
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21"></a><span class="k">group</span> <span class="k">by</span> a<span class="m">.</span>date
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22"></a><span class="k">order</span> <span class="k">by</span> a<span class="m">.</span>date<span class="kr">;</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23"></a><span class="kr">quit;</span>
</span></code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<p>Note that this version is inefficient and takes a long time to run.</p>
<div class="language-sas highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span>
<span class="normal"><a href="#__codelineno-6-22">22</a></span>
<span class="normal"><a href="#__codelineno-6-23">23</a></span>
<span class="normal"><a href="#__codelineno-6-24">24</a></span>
<span class="normal"><a href="#__codelineno-6-25">25</a></span>
<span class="normal"><a href="#__codelineno-6-26">26</a></span>
<span class="normal"><a href="#__codelineno-6-27">27</a></span>
<span class="normal"><a href="#__codelineno-6-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="kr">proc sql;</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="c">/* Stocks (ordinary shares) in the financial sector (2-digit SIC=60-67) */</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="k">create</span> <span class="k">table</span> stocks <span class="k">as</span> <span class="k">select</span> <span class="k">distinct</span> permno <span class="k">from</span> crsp<span class="m">.</span>stocknames
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="k">where</span> shrcd <span class="k">in</span> (<span class="m">10</span>, <span class="m">11</span>) <span class="k">and</span> <span class="nb">floor(</span>siccd/<span class="m">100</span>) between <span class="m">60</span> <span class="k">and</span> <span class="m">67</span>;
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17"></a>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="c">/* Compute weekly stock return from daily data */</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="k">create</span> <span class="k">table</span> stockrets_weekly <span class="k">as</span> 
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="k">select</span> <span class="k">distinct</span> a<span class="m">.</span>date, dsf<span class="m">.</span>permno, dsf<span class="m">.</span>hsiccd,
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21"></a>  (<span class="nb">exp(sum(log(</span><span class="m">1</span>+ret)))-<span class="m">1</span>)*<span class="m">100</span> <span class="k">as</span> ret <span class="k">label</span>=<span class="s">"Weekly Return (%)"</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="k">from</span> fridays <span class="k">as</span> a left join crsp<span class="m">.</span>dsf <span class="k">as</span> dsf
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23"></a><span class="k">on</span> dsf<span class="m">.</span>date between <span class="nb">intnx(</span><span class="s">'day'</span>, a<span class="m">.</span>date, -<span class="m">4</span>) <span class="k">and</span> a<span class="m">.</span>date
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24"></a>  <span class="k">and</span> dsf<span class="m">.</span>permno <span class="k">in</span> (<span class="k">select</span> * <span class="k">from</span> stocks) 
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25"></a>  <span class="k">and</span> dsf<span class="m">.</span>prc&gt;<span class="m">0</span> <span class="k">and</span> <span class="k">not</span> <span class="k">missing</span>(dsf<span class="m">.</span>ret)
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26"></a><span class="k">group</span> <span class="k">by</span> dsf<span class="m">.</span>permno, a<span class="m">.</span>date
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27"></a><span class="k">order</span> <span class="k">by</span> dsf<span class="m">.</span>permno, a<span class="m">.</span>date<span class="kr">;</span>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28"></a><span class="kr">quit;</span>
</span></code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h3 id="2-group-using-aligned-dates-fast-version-with-caveat">2. Group using aligned dates (fast version with caveat)<a class="headerlink" href="#2-group-using-aligned-dates-fast-version-with-caveat" title="Permanent link">Â¶</a></h3>
<p>This version uses a similar logic from the <a href="#weekly-stock-return-from-daily-data">previous incorrect
one</a>, but it groups based on the aligned
dates instead of <code>year(date)</code> and <code>week(date)</code>.</p>
<div class="language-sas highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kr">proc sql;</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="c">/* Compute weekly stock return from daily data */</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="k">create</span> <span class="k">table</span> stockrets_weekly2 <span class="k">as</span> 
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="k">select</span> <span class="k">distinct</span> permno, hsiccd,
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a>  case when <span class="nb">weekday(</span>date)=<span class="m">6</span> <span class="k">then</span> date <span class="k">else</span> <span class="nb">intnx(</span><span class="s">"week.6"</span>,date,<span class="m">1</span>) <span class="k">end</span> 
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a>    <span class="k">as</span> date <span class="k">format</span>=date9. <span class="k">label</span>=<span class="s">"Friday of the Week"</span>,
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a>  (<span class="nb">exp(sum(log(</span><span class="m">1</span>+ret)))-<span class="m">1</span>)*<span class="m">100</span> <span class="k">as</span> ret <span class="k">label</span>=<span class="s">"Weekly Return (%)"</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="k">from</span> crsp<span class="m">.</span>dsf (<span class="k">keep</span>=permno date ret prc shrout hsiccd)
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="k">where</span> 
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10"></a>  date between <span class="s">"01Jan1986"</span>d <span class="k">and</span> <span class="s">"31Dec2019"</span>d
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11"></a>  <span class="k">and</span> permno <span class="k">in</span> (<span class="k">select</span> * <span class="k">from</span> stocks) 
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12"></a>  <span class="k">and</span> prc&gt;<span class="m">0</span> <span class="k">and</span> <span class="k">not</span> <span class="k">missing</span>(ret)
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="hll"><span class="k">group</span> <span class="k">by</span> permno, calculated date <span class="k">order</span> <span class="k">by</span> permno, date<span class="kr">;</span>
</span></span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="kr">quit;</span>
</span></code></pre></div></td></tr></table></div>
<div class="admonition warning">
<p class="admonition-title">Caveat</p>
<p>If the beginning and ending dates, <code>"01Jan1986"d and "31Dec2019"d</code> in the 
example, are not Fridays, then the first and last weekly returns for all 
stocks will be incorrect, because they are not using all the daily data in 
those weeks.</p>
<p>To fix this minor issue, simply extend the beginning and ending dates beyond
your sample period by a few weeks.</p>
</div></div>

<!-- Source file information -->


<!-- Add copied contents from original content.html here -->

<!-- Get setting from mkdocs.yml, but allow page-level overrides -->



<!-- Inject Disqus into current page -->

  <h2 id="__comments">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function() {
      this.page.url = "https://mingze-gao.com/posts/compute-weekly-return-from-daily-crsp-data/"
      this.page.identifier =
        "posts/compute-weekly-return-from-daily-crsp-data/" 
    }

    /* Set up for the first time */
    if (typeof DISQUS === "undefined") {
      var script = document.createElement("script")
      script.async = true
      script.src = "https://mingze-gao.disqus.com/embed.js"
      script.setAttribute("data-timestamp", Date.now())

      /* Inject script tag */
      document.body.appendChild(script)

    /* Set up on navigation (instant loading) */
    } else {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      })
    }
  </script>

      
    </article>
  </div>

          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../convert-between-numeric-and-character-variables/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Convert Between Numeric and Character Variables" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Convert Between Numeric and Character Variables
              </div>
            </div>
          </a>
        
        
          
          <a href="../bloomberg-bquant/" class="md-footer__link md-footer__link--next" aria-label="Next: Bloomberg BQuant (BQNT)" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Bloomberg BQuant (BQNT)
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019 - 2023 <a href="https://mingze-gao.com">Mingze Gao</a>
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/mgao6767/mingze-gao.com" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/adriangao" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:mingze.gao@sydney.edu.au" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "navigation.footer", "search.suggest", "search.highlight", "search.share", "content.action.edit", "content.action.view", "content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link", "toc.follow", "navigation.prune", "navigation.tabs", "navigation.path", "navigation.indexes", "navigation.top"], "search": "../../assets/javascripts/workers/search.6c7302c4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.7c5c0157.min.js"></script>
      
        
          <script src="../../js/mkdocs-charts-plugin.js"></script>
        
      
        
          <script src="../../javascripts/extra.js"></script>
        
      
        
          <script src="../../javascripts/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
        
      
    
  </body>
</html>