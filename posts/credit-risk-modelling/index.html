<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mingze Gao">
<meta name="dcterms.date" content="2025-09-03">

<title>Credit Risk Modelling (IRB) – Mingze Gao</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-455cc40e60a3918d8e97c40ba46c9f52.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1QDTTQ6EHM"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-1QDTTQ6EHM', { 'anonymize_ip': true});
</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<meta name="mermaid-theme" content="default">
<script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Credit Risk Modelling (IRB) – Mingze Gao">
<meta name="twitter:description" content="This article provides an educational overview of the Internal Ratings-Based (IRB) approach to credit risk modeling under the Basel III framework. It covers the key concepts, methodologies, and practical considerations involved in developing and validating IRB models.">
<meta name="twitter:image" content="https://mingze-gao.com/posts/credit-risk-modelling/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/favicon.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv/index.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching/index.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://phds.io/"> 
<span class="menu-text">Literature 🔍</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"><span class="header-section-number">1</span> Background</a></li>
  <li><a href="#overview-of-the-irb-approach" id="toc-overview-of-the-irb-approach" class="nav-link" data-scroll-target="#overview-of-the-irb-approach"><span class="header-section-number">2</span> Overview of the IRB Approach</a>
  <ul class="collapse">
  <li><a href="#key-components-of-the-irb-approach" id="toc-key-components-of-the-irb-approach" class="nav-link" data-scroll-target="#key-components-of-the-irb-approach"><span class="header-section-number">2.1</span> Key components of the IRB approach</a></li>
  <li><a href="#irb-risk-weight-functions" id="toc-irb-risk-weight-functions" class="nav-link" data-scroll-target="#irb-risk-weight-functions"><span class="header-section-number">2.2</span> IRB risk-weight functions</a></li>
  </ul></li>
  <li><a href="#credit-scoring---estimating-pd" id="toc-credit-scoring---estimating-pd" class="nav-link" data-scroll-target="#credit-scoring---estimating-pd"><span class="header-section-number">3</span> Credit Scoring - Estimating PD</a>
  <ul class="collapse">
  <li><a href="#overview-of-credit-scoring-model-development" id="toc-overview-of-credit-scoring-model-development" class="nav-link" data-scroll-target="#overview-of-credit-scoring-model-development"><span class="header-section-number">3.1</span> Overview of credit scoring model development</a></li>
  <li><a href="#sample-selection" id="toc-sample-selection" class="nav-link" data-scroll-target="#sample-selection"><span class="header-section-number">3.2</span> Sample selection</a></li>
  <li><a href="#sec-variable-screening" id="toc-sec-variable-screening" class="nav-link" data-scroll-target="#sec-variable-screening"><span class="header-section-number">3.3</span> Variable screening</a></li>
  <li><a href="#model-estimation-evaluation" id="toc-model-estimation-evaluation" class="nav-link" data-scroll-target="#model-estimation-evaluation"><span class="header-section-number">3.4</span> Model estimation &amp; evaluation</a></li>
  <li><a href="#calibration" id="toc-calibration" class="nav-link" data-scroll-target="#calibration"><span class="header-section-number">3.5</span> Calibration</a></li>
  <li><a href="#validation" id="toc-validation" class="nav-link" data-scroll-target="#validation"><span class="header-section-number">3.6</span> Validation</a></li>
  <li><a href="#approval-deployment-ongoing-monitoring" id="toc-approval-deployment-ongoing-monitoring" class="nav-link" data-scroll-target="#approval-deployment-ongoing-monitoring"><span class="header-section-number">3.7</span> Approval, Deployment &amp; Ongoing Monitoring</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Credit Risk Modelling (IRB)</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Teaching Notes</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Mingze Gao, PhD <a href="mailto:mingze.gao@mq.edu.au" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-8635-4269" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Macquarie University
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 3, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">September 4, 2025</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    This article provides an educational overview of the Internal Ratings-Based (IRB) approach to credit risk modeling under the Basel III framework. It covers the key concepts, methodologies, and practical considerations involved in developing and validating IRB models.
  </div>
</div>


</header>


<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>This article is a part of my <a href="https://mingze-gao.com/teaching/">teaching notes</a> for <strong>AFIN8003 Banking and Financial Intermediation</strong> at the Macquarie Business School. It is intended for educational purposes and aims to provide students with an understanding of the IRB approach.</p>
</div>
</div>
</div>
<section id="background" class="level2 page-columns page-full" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="background"><span class="header-section-number">1</span> Background</h2>
<p>Under Basel III capital adequacy regulations, banks are required to maintain appropriate levels of <em>capital ratios</em>, which are essentially computed as</p>
<p><span id="eq-capital-ratio"><span class="math display">\[
\text{Capital Ratio} = \frac{\text{Capital}}{\text{Risk-Weighted Assets (RWA)}},
\tag{1}\]</span></span></p>
<p>where <span class="math inline">\(\text{Capital}\)</span> is the amount of capital (e.g., CET1, Tier 1, and Total Capital), and <span class="math inline">\(\text{RWA}\)</span> is the total risk-weighted assets, calculated as the sum of RWA for different risk types, including credit risk, market risk, and operational risk.</p>
<p>Of the different risk types, <strong>credit risk</strong> contributes the most to RWA, as shown in the <a href="#tbl-rwa-au-banks" class="quarto-xref">Table&nbsp;1</a> below. Therefore, accurate measurement and management of credit risk are crucial for banks to maintain adequate capital levels. Even outside of regulatory requirements, effective credit risk management can help banks optimize their capital allocation and improve profitability. This is the “essence of banking” <span class="citation" data-cites="Gorton2008BankCycles">(<a href="#ref-Gorton2008BankCycles" role="doc-biblioref">Gorton and He 2008</a>)</span>.</p>
<div id="tbl-rwa-au-banks" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-rwa-au-banks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 35%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>CBA</th>
<th>Westpac</th>
<th>NAB</th>
<th>ANZ</th>
<th>Macquarie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>RWA for credit risk</td>
<td>370,444</td>
<td>351,724</td>
<td>350,891</td>
<td>361,185</td>
<td>98,250</td>
</tr>
<tr class="even">
<td>RWA for market risk</td>
<td>52,132</td>
<td>37,510</td>
<td>26,953</td>
<td>30,875</td>
<td>14,277</td>
</tr>
<tr class="odd">
<td>RWA for operational risk</td>
<td>44,975</td>
<td>48,196</td>
<td>36,102</td>
<td>49,650</td>
<td>17,512</td>
</tr>
<tr class="even">
<td>Other RWA</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4,872</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Total RWA</td>
<td>467,551</td>
<td>437,430</td>
<td>413,946</td>
<td>446,582</td>
<td>130,039</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-rwa-au-banks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: RWA of some Australian banks in 2024 (source: Capital IQ)
</figcaption>
</figure>
</div>
<p>To compute the RWA for credit risk, smaller banks use the <strong>Standardised Approach</strong>, while larger banks can use the <strong>Internal Ratings-Based (IRB)</strong> approach,<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> which allows them to use their own estimates of key risk parameters to calculate capital requirements.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;The use of the IRB approach requires approval from the relevant regulatory authority.</p></div></div><p>While the Standardised Approach is simpler and more prescriptive, the IRB approach can be somewhat more opaque. The purpose of this article is to shed light on the IRB approach and provide an educational overview of its implementation.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>This article is written in the Australian context, using the Basel III framework as implemented by APRA via <a href="https://www.apra.gov.au/capital-adequacy-internal-ratings-based-approach-to-credit-risk">Prudential Standard APS 113: Capital Adequacy: Internal Ratings-Based Approach to Credit Risk</a>. However, the concepts and formulas discussed here are broadly applicable to other jurisdictions that have adopted the Basel III framework.</p>
</div>
</div>
</div>
</section>
<section id="overview-of-the-irb-approach" class="level2 page-columns page-full" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="overview-of-the-irb-approach"><span class="header-section-number">2</span> Overview of the IRB Approach</h2>
<p>Using the IRB approach, banks need to classify its <em>banking book</em> exposures to one of the following asset classes:</p>
<ol type="1">
<li>corporate;</li>
<li>sovereign;</li>
<li>financial institution; and</li>
<li>retail.</li>
</ol>
<p>Then for each asset class, banks must estimate the key risk parameters to calculate RWA. The total RWA (for credit risk) is the sum of the RWA for each asset class, subject to certain adjustments.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;This means that the computed RWAs may receive additional scaling or other adjustments as specified by the APS 113.</p></div></div><p>A simplified overview of the IRB approach is illustrated below.</p>
<div class="column-screen-inset-shaded">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph Corporate
        A1[Estimate PD] --&gt; D1[Risk-weight function]
        B1[Estimate LGD] --&gt; D1
        C1[Estimate EAD] --&gt; D1
        D1 --&gt; E1[RWA Corporate]
        style A1 fill:#ddeaf1,stroke:#333,stroke-width:2px
        style B1 fill:#ddeaf1,stroke:#333,stroke-width:2px
        style C1 fill:#ddeaf1,stroke:#333,stroke-width:2px
    end
    subgraph Sovereign
        A2[...] --&gt;
        E2[RWA Sovereign]
    end
    subgraph Financial Institution
        A3[...] --&gt; E3[RWA Financial]
    end
    subgraph Retail
        A4[...] --&gt; E4[RWA Retail]
    end
    E1 --&gt; F[Aggregation]
    E2 --&gt; F
    E3 --&gt; F
    E4 --&gt; F
    F --&gt; G[Total Credit Risk RWA]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<section id="key-components-of-the-irb-approach" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="key-components-of-the-irb-approach"><span class="header-section-number">2.1</span> Key components of the IRB approach</h3>
<p>Central to the implementation of the IRB approach is the accurate estimation of three key risk parameters:</p>
<ol type="1">
<li><strong>Probability of Default (PD)</strong>: The likelihood that a borrower will default on their obligations, expressed as a percentage.</li>
<li><strong>Loss Given Default (LGD)</strong>: The economic loss upon the default of a borrower, expressed as a percentage.</li>
<li><strong>Exposure at Default (EAD)</strong>: The gross exposure under a facility (i.e., the amount that is legally owed to the bank) upon the default of a borrower, expressed in Australian dollars.</li>
</ol>
<p>Once these parameters are estimated, banks can use them to calculate the RWA for each asset class using the prescribed <strong>risk-weight functions</strong> as set out in APS 113.</p>
</section>
<section id="irb-risk-weight-functions" class="level3 page-columns page-full" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="irb-risk-weight-functions"><span class="header-section-number">2.2</span> IRB risk-weight functions</h3>
<p>The IRB approach specifies different risk-weight functions for each asset class, which are used to calculate the RWA based on the estimated risk parameters. Specifically, Attachment A of APS 113 sets out the <strong>risk-weight functions</strong> for different exposures, including:</p>
<ul>
<li>Risk-weighted assets for corporate, sovereign and financial institution exposures</li>
<li>Risk-weighted assets for specialised lending exposures subject to the supervisory slotting approach</li>
<li>Risk-weighted assets for retail exposure</li>
<li>Risk-weighted assets for lease exposures</li>
<li>Risk-weighted assets for defaulted exposures</li>
</ul>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Without loss of generality, this article focuses on the risk-weight function for <strong>non-defaulted corporate, sovereign and financial institution exposures</strong>.</p>
</div>
</div>
</div>
<p>For example, as at the time of writing, the risk-weight function for <strong>non-defaulted corporate, sovereign and financial institution exposures</strong> is:</p>
<div class="column-page-inset-right">
<p><span id="eq-rwa-func"><span class="math display">\[
\begin{align}
\text{Correlation} (R) &amp;= AVCM \times \left(0.12 \times \frac{1-\exp(-50 \times PD)}{1-\exp(-50)} + 0.24 \times \left[1-\frac{1-\exp(-50 \times PD)}{1-\exp(-50)} \right]\right) \\
\text{Maturity adjustment} (b) &amp;= \left[0.11852 - 0.05478 \ln(PD)\right]^2 \\
\text{Capital requirement} (K) &amp;= \left[LGD \times N\left(\frac{G(PD) + \sqrt{R} \times G(0.999)}{\sqrt{1-R}}\right) - PD \times LGD \right] \times \left(\frac{1+(M-2.5)\times b}{1 - 1.5\times b}\right) \\
RWA &amp;= K \times 12.5 \times EAD
\end{align}
\tag{2}\]</span></span></p>
</div>
<p>where <span class="math inline">\(N(\cdot)\)</span> is the cumulative distribution function (CDF) of the standard normal distribution, and <span class="math inline">\(G(\cdot)\)</span> is the inverse CDF of the standard normal distribution, i.e., <span class="math inline">\(G(x) = N^{-1}(x)\)</span>. Further, if the calculated <span class="math inline">\(K\)</span> is negative, banks must apply a zero capital requirement for that exposure.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <strong>asset value correlation multiplier (AVCM)</strong> is normally set to 1. However, for exposures to large financial institutions (those with total assets of $125 billion or more) or to unregulated financial institutions, the AVCM is increased to 1.25.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
</div>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;The reason is that very large and unregulated financial institutions tend to be more exposed to systemic shocks. Large institutions are highly interconnected across markets, so their performance often moves with the financial system as a whole. Unregulated institutions, on the other hand, typically operate with less oversight, higher leverage, and riskier business models, making their losses more likely to coincide with broader market stress. By setting AVCM higher, Basel III ensures banks hold extra capital against exposures that are more likely to default together with the system, amplifying contagion risk.</p></div></div><p>To have an intuitive understanding of how these parameters interact, play around with the following calculator.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="150" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 149;"><span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {Plot} <span class="im">from</span> <span class="st">"@observablehq/plot"</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a><span class="co">// --- Inputs ---</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>viewof pd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.05</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">1.00</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"PD (%)"</span>})</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>viewof lgd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">25</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"LGD (%)"</span>})</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>viewof ead <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">5_000_000</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">1_000_000</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">10_000</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"EAD"</span>})</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>viewof m <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.25</span><span class="op">,</span> <span class="dv">20</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">2.5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.25</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Maturity (years)"</span>})</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>viewof avcm <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="dv">1</span><span class="op">,</span> <span class="fl">1.25</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"AVCM"</span>})</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a><span class="co">// --- Formulas ---</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>corr_R <span class="op">=</span> (PD<span class="op">,</span> AVCM) <span class="kw">=&gt;</span> {</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span><span class="dv">50</span> <span class="op">*</span> PD)) <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span><span class="dv">50</span>))<span class="op">;</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> R <span class="op">=</span> AVCM <span class="op">*</span> (<span class="fl">0.12</span> <span class="op">*</span> x <span class="op">+</span> <span class="fl">0.24</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x))<span class="op">;</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(R<span class="op">,</span> <span class="fl">1e-6</span>)<span class="op">,</span> <span class="fl">0.999</span>)<span class="op">;</span></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>b_maturity <span class="op">=</span> PD <span class="kw">=&gt;</span> (<span class="fl">0.11852</span> <span class="op">-</span> <span class="fl">0.05478</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log</span>(PD)) <span class="op">**</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a><span class="co">// Standard normal CDF</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">stdnorm_cdf</span>(x) {</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fu">erf</span>(x <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(<span class="dv">2</span>))) <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a><span class="co">// Error function</span></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">erf</span>(x) {</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Abramowitz and Stegun formula 7.1.26</span></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sign <span class="op">=</span> x <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(x)<span class="op">;</span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> a1 <span class="op">=</span>  <span class="fl">0.254829592</span><span class="op">,</span> a2 <span class="op">=</span> <span class="op">-</span><span class="fl">0.284496736</span><span class="op">,</span> a3 <span class="op">=</span> <span class="fl">1.421413741</span><span class="op">;</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> a4 <span class="op">=</span> <span class="op">-</span><span class="fl">1.453152027</span><span class="op">,</span> a5 <span class="op">=</span> <span class="fl">1.061405429</span><span class="op">,</span> p <span class="op">=</span> <span class="fl">0.3275911</span><span class="op">;</span></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> t <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> p <span class="op">*</span> x)<span class="op">;</span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (((((a5 <span class="op">*</span> t <span class="op">+</span> a4) <span class="op">*</span> t) <span class="op">+</span> a3) <span class="op">*</span> t <span class="op">+</span> a2) <span class="op">*</span> t <span class="op">+</span> a1) <span class="op">*</span> t <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>x <span class="op">*</span> x)<span class="op">;</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> sign <span class="op">*</span> y<span class="op">;</span></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a><span class="co">// Inverse error function (approximate)</span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">erfinv</span>(x) {</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Approximation by Mike Giles (2010)</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> a <span class="op">=</span> <span class="fl">0.147</span><span class="op">;</span></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ln <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log</span>((<span class="dv">1</span> <span class="op">-</span> x) <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> x))<span class="op">;</span></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sgn <span class="op">=</span> x <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> part1 <span class="op">=</span> <span class="dv">2</span> <span class="op">/</span> (<span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">*</span> a) <span class="op">+</span> ln <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> part2 <span class="op">=</span> ln <span class="op">/</span> a<span class="op">;</span></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> sgn <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(part1 <span class="op">*</span> part1 <span class="op">-</span> part2) <span class="op">-</span> part1)<span class="op">;</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>capital_K <span class="op">=</span> (PD<span class="op">,</span> LGD<span class="op">,</span> M<span class="op">,</span> AVCM) <span class="kw">=&gt;</span> {</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> R <span class="op">=</span> <span class="fu">corr_R</span>(PD<span class="op">,</span> AVCM)<span class="op">;</span></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> b <span class="op">=</span> <span class="fu">b_maturity</span>(PD)<span class="op">;</span></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> qnorm <span class="op">=</span> p <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(<span class="dv">2</span>) <span class="op">*</span> <span class="fu">erfinv</span>(<span class="dv">2</span> <span class="op">*</span> p <span class="op">-</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">// Approximate inverse normal</span></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> term <span class="op">=</span> (<span class="fu">qnorm</span>(PD) <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(R) <span class="op">*</span> <span class="fu">qnorm</span>(<span class="fl">0.999</span>)) <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(<span class="dv">1</span> <span class="op">-</span> R)<span class="op">;</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> K <span class="op">=</span> LGD <span class="op">*</span> <span class="fu">stdnorm_cdf</span>(term) <span class="op">-</span> PD <span class="op">*</span> LGD<span class="op">;</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> K_adj <span class="op">=</span> K <span class="op">*</span> ((<span class="dv">1</span> <span class="op">+</span> (M <span class="op">-</span> <span class="fl">2.5</span>) <span class="op">*</span> b) <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> b))<span class="op">;</span></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(K_adj<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a><span class="co">// --- Calculations ---</span></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>PD <span class="op">=</span> pd <span class="op">/</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>LGD <span class="op">=</span> lgd <span class="op">/</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>EAD <span class="op">=</span> ead<span class="op">;</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> m<span class="op">;</span></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>AVCM <span class="op">=</span> avcm<span class="op">;</span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> <span class="fu">corr_R</span>(PD<span class="op">,</span> AVCM)<span class="op">;</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fu">b_maturity</span>(PD)<span class="op">;</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> <span class="fu">capital_K</span>(PD<span class="op">,</span> LGD<span class="op">,</span> M<span class="op">,</span> AVCM)<span class="op">;</span></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>RWA <span class="op">=</span> K <span class="op">*</span> <span class="fl">12.5</span> <span class="op">*</span> EAD<span class="op">;</span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a><span class="co">// --- Sensitivity Data ---</span></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a><span class="co">// Lower and upper bounds for PD in decimal (0.0005 to 1.0)</span></span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>pd_min <span class="op">=</span> <span class="fl">0.0005</span><span class="op">;</span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>pd_max <span class="op">=</span> <span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>pd_lower <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(pd_min<span class="op">,</span> PD <span class="op">*</span> <span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>pd_upper <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(pd_max<span class="op">,</span> PD <span class="op">*</span> <span class="fl">1.5</span>)<span class="op">;</span></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>pd_seq <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">50</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> pd_lower <span class="op">+</span> i <span class="op">*</span> (pd_upper <span class="op">-</span> pd_lower) <span class="op">/</span> <span class="dv">49</span>)<span class="op">;</span></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>lgd_seq <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">50</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="dv">0</span><span class="op">,</span> LGD<span class="op">*</span><span class="fl">0.5</span>) <span class="op">+</span> i<span class="op">*</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(<span class="dv">1</span><span class="op">,</span> LGD<span class="op">*</span><span class="fl">1.5</span>)<span class="op">-</span><span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="dv">0</span><span class="op">,</span> LGD<span class="op">*</span><span class="fl">0.5</span>))<span class="op">/</span><span class="dv">49</span>)<span class="op">;</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>ead_seq <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">50</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> EAD<span class="op">*</span><span class="fl">0.5</span> <span class="op">+</span> i<span class="op">*</span>(EAD<span class="op">*</span><span class="fl">1.5</span><span class="op">-</span>EAD<span class="op">*</span><span class="fl">0.5</span>)<span class="op">/</span><span class="dv">49</span>)<span class="op">;</span></span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>m_min <span class="op">=</span> <span class="fl">0.25</span><span class="op">;</span></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>m_max <span class="op">=</span> <span class="fl">20.0</span><span class="op">;</span></span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>m_lower <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(m_min<span class="op">,</span> M <span class="op">*</span> <span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>m_upper <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(m_max<span class="op">,</span> M <span class="op">*</span> <span class="fl">1.5</span>)<span class="op">;</span></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>m_seq <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">50</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> m_lower <span class="op">+</span> i <span class="op">*</span> (m_upper <span class="op">-</span> m_lower) <span class="op">/</span> <span class="dv">49</span>)<span class="op">;</span></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>data_pd <span class="op">=</span> pd_seq<span class="op">.</span><span class="fu">map</span>(p <span class="kw">=&gt;</span> ({<span class="dt">PD</span><span class="op">:</span> p<span class="op">*</span><span class="dv">100</span><span class="op">,</span> <span class="dt">RWA</span><span class="op">:</span> <span class="fu">capital_K</span>(p<span class="op">,</span> LGD<span class="op">,</span> M<span class="op">,</span> AVCM) <span class="op">*</span> <span class="fl">12.5</span> <span class="op">*</span> EAD}))<span class="op">;</span></span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>data_lgd <span class="op">=</span> lgd_seq<span class="op">.</span><span class="fu">map</span>(l <span class="kw">=&gt;</span> ({<span class="dt">LGD</span><span class="op">:</span> l<span class="op">*</span><span class="dv">100</span><span class="op">,</span> <span class="dt">RWA</span><span class="op">:</span> <span class="fu">capital_K</span>(PD<span class="op">,</span> l<span class="op">,</span> M<span class="op">,</span> AVCM) <span class="op">*</span> <span class="fl">12.5</span> <span class="op">*</span> EAD}))<span class="op">;</span></span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>data_ead <span class="op">=</span> ead_seq<span class="op">.</span><span class="fu">map</span>(e <span class="kw">=&gt;</span> ({<span class="dt">EAD</span><span class="op">:</span> e<span class="op">,</span> <span class="dt">RWA</span><span class="op">:</span> <span class="fu">capital_K</span>(PD<span class="op">,</span> LGD<span class="op">,</span> M<span class="op">,</span> AVCM) <span class="op">*</span> <span class="fl">12.5</span> <span class="op">*</span> e}))<span class="op">;</span></span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>data_m <span class="op">=</span> m_seq<span class="op">.</span><span class="fu">map</span>(mv <span class="kw">=&gt;</span> ({<span class="dt">M</span><span class="op">:</span> mv<span class="op">,</span> <span class="dt">RWA</span><span class="op">:</span> <span class="fu">capital_K</span>(PD<span class="op">,</span> LGD<span class="op">,</span> mv<span class="op">,</span> AVCM) <span class="op">*</span> <span class="fl">12.5</span> <span class="op">*</span> EAD}))<span class="op">;</span></span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">highlight</span>(x<span class="op">,</span> y<span class="op">,</span> xlab<span class="op">,</span> ylab) {</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleX</span>([x]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"gray"</span><span class="op">,</span> <span class="dt">strokeDasharray</span><span class="op">:</span> <span class="st">"4,2"</span>})<span class="op">,</span></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([y]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"gray"</span><span class="op">,</span> <span class="dt">strokeDasharray</span><span class="op">:</span> <span class="st">"4,2"</span>})<span class="op">,</span></span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>([{[xlab]<span class="op">:</span> x<span class="op">,</span> [ylab]<span class="op">:</span> y}]<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> xlab<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> ylab<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span> <span class="dt">r</span><span class="op">:</span> <span class="dv">5</span>})<span class="op">,</span></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>([{[xlab]<span class="op">:</span> x<span class="op">,</span> [ylab]<span class="op">:</span> y<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="vs">`(</span><span class="sc">${</span>x<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span><span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(y)<span class="sc">}</span><span class="vs">)`</span>}]<span class="op">,</span> {</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> xlab<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> ylab<span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"label"</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">12</span></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a><span class="co">// --- Individual Plots ---</span></span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>plot_pd <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">350</span><span class="op">,</span></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(data_pd<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"PD"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"RWA"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"blue"</span>})<span class="op">,</span></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span><span class="fu">highlight</span>(pd<span class="op">,</span> <span class="fu">capital_K</span>(PD<span class="op">,</span> LGD<span class="op">,</span> M<span class="op">,</span> AVCM) <span class="op">*</span> <span class="fl">12.5</span> <span class="op">*</span> EAD<span class="op">,</span> <span class="st">"PD"</span><span class="op">,</span> <span class="st">"RWA"</span>)</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"PD (%)"</span>}<span class="op">,</span></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"RWA"</span>}<span class="op">,</span></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>  <span class="dt">caption</span><span class="op">:</span> <span class="st">"Sensitivity to PD"</span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>plot_lgd <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">350</span><span class="op">,</span></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(data_lgd<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"LGD"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"RWA"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"darkred"</span>})<span class="op">,</span></span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span><span class="fu">highlight</span>(lgd<span class="op">,</span> <span class="fu">capital_K</span>(PD<span class="op">,</span> LGD<span class="op">,</span> M<span class="op">,</span> AVCM) <span class="op">*</span> <span class="fl">12.5</span> <span class="op">*</span> EAD<span class="op">,</span> <span class="st">"LGD"</span><span class="op">,</span> <span class="st">"RWA"</span>)</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"LGD (%)"</span>}<span class="op">,</span></span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"RWA"</span>}<span class="op">,</span></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>  <span class="dt">caption</span><span class="op">:</span> <span class="st">"Sensitivity to LGD"</span></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>plot_ead <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">350</span><span class="op">,</span></span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(data_ead<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"EAD"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"RWA"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"darkgreen"</span>})<span class="op">,</span></span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span><span class="fu">highlight</span>(ead<span class="op">,</span> <span class="fu">capital_K</span>(PD<span class="op">,</span> LGD<span class="op">,</span> M<span class="op">,</span> AVCM) <span class="op">*</span> <span class="fl">12.5</span> <span class="op">*</span> EAD<span class="op">,</span> <span class="st">"EAD"</span><span class="op">,</span> <span class="st">"RWA"</span>)</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"EAD"</span>}<span class="op">,</span></span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"RWA"</span>}<span class="op">,</span></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>  <span class="dt">caption</span><span class="op">:</span> <span class="st">"Sensitivity to EAD"</span></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>plot_m <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">350</span><span class="op">,</span></span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span></span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(data_m<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"M"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"RWA"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"darkorange"</span>})<span class="op">,</span></span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span><span class="fu">highlight</span>(m<span class="op">,</span> <span class="fu">capital_K</span>(PD<span class="op">,</span> LGD<span class="op">,</span> M<span class="op">,</span> AVCM) <span class="op">*</span> <span class="fl">12.5</span> <span class="op">*</span> EAD<span class="op">,</span> <span class="st">"M"</span><span class="op">,</span> <span class="st">"RWA"</span>)</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Maturity (years)"</span>}<span class="op">,</span></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"RWA"</span>}<span class="op">,</span></span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>  <span class="dt">caption</span><span class="op">:</span> <span class="st">"Sensitivity to Maturity"</span></span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a><span class="co">// --- Output: Results Table and Plots ---</span></span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;table class="table"&gt;</span></span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;thead&gt;&lt;tr&gt;&lt;th&gt;Quantity&lt;/th&gt;&lt;th&gt;Value&lt;/th&gt;&lt;th&gt;Units&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;</span></span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;tbody&gt;</span></span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;tr&gt;&lt;td&gt;Correlation (R)&lt;/td&gt;&lt;td&gt;</span><span class="sc">${</span>R<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">6</span>)<span class="sc">}</span><span class="vs">&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</span></span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;tr&gt;&lt;td&gt;Maturity adjustment (b)&lt;/td&gt;&lt;td&gt;</span><span class="sc">${</span>b<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">6</span>)<span class="sc">}</span><span class="vs">&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</span></span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;tr&gt;&lt;td&gt;Capital requirement (K)&lt;/td&gt;&lt;td&gt;</span><span class="sc">${</span>K<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">6</span>)<span class="sc">}</span><span class="vs">&lt;/td&gt;&lt;td&gt;per unit EAD&lt;/td&gt;&lt;/tr&gt;</span></span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;tr&gt;&lt;td&gt;RWA&lt;/td&gt;&lt;td&gt;</span><span class="sc">${</span><span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(RWA)<span class="op">.</span><span class="fu">toLocaleString</span>()<span class="sc">}</span><span class="vs">&lt;/td&gt;&lt;td&gt;currency&lt;/td&gt;&lt;/tr&gt;</span></span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/tbody&gt;</span></span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/table&gt;</span></span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: flex-start;"&gt;</span></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div&gt;</span><span class="sc">${</span>plot_pd<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div&gt;</span><span class="sc">${</span>plot_lgd<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div&gt;</span><span class="sc">${</span>plot_ead<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div&gt;</span><span class="sc">${</span>plot_m<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;</span></span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-25" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-26" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-27" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-28" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-29" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-30" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-31" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-32" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-33" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-34" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-35" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-36" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-37" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-38" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-39" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-40" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-41" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-42" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-43" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why IRB Capital (K) Falls at Very High PDs
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the IRB framework, <strong>capital (K)</strong> is designed to cover <mark><em>unexpected losses</em></mark> — the part of credit loss that arises only in bad-tail scenarios.</p>
<ul>
<li><strong>When PD is low</strong>: Defaults are rare, so if one happens it is a big surprise. The unexpected loss is large, and capital requirements rise as PD increases.<br>
</li>
<li><strong>When PD is high</strong> (say above 30%): Default is almost certain. At that point, most of the loss is <strong>expected</strong> rather than unexpected.</li>
</ul>
<p><mark><em>Expected loss</em></mark> is not covered by capital. Instead, it is addressed through <strong>accounting provisions</strong>. Simply put, when a loan’s default risk (PD) is sufficiently high, the bank needs to increase <em>loan loss provisions</em> to cover these expected losses. This is governed by IFRS 9.</p>
<p>Because those losses are already anticipated and provisioned, the “unexpected” portion becomes smaller. This is why IRB capital can actually <strong>decline for very high PD exposures</strong> — capital is only needed for the residual uncertainty, not for losses that everyone already expects.</p>
</div>
</div>
</div>
</section>
</section>
<section id="credit-scoring---estimating-pd" class="level2 page-columns page-full" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="credit-scoring---estimating-pd"><span class="header-section-number">3</span> Credit Scoring - Estimating PD</h2>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>This article focuses on the estimation of <strong>Probability of Default (PD)</strong>, taking as given <strong>Loss Given Default (LGD)</strong> and <strong>Exposure at Default (EAD)</strong>.</p>
</div>
</div>
</div>
<p>Under the IRB approach, banks use their own internal credit scoring and rating systems to estimate risk parameters like Probability of Default (PD).</p>
<p>Importantly, Basel III and its Australian implementation (APS 113) requires the PD estimates to be <mark><em>calibrated to a long-run average of one-year default rates (one-year PD) for borrowers in each borrower grade and for exposures in each pool</em></mark>.</p>
<section id="overview-of-credit-scoring-model-development" class="level3 page-columns page-full" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="overview-of-credit-scoring-model-development"><span class="header-section-number">3.1</span> Overview of credit scoring model development</h3>
<p>The flowchart below illustrates the key steps to develop a PD model in the credit risk modelling process. We will then break down each step in detail.</p>
<div class="column-screen-inset-shaded">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  %% A[Start] --&gt; B[Sample selection]
  B[Sample selection]
  B --&gt; C[Variable screening]
  C --&gt; D["Model estimation 
  &amp; evaluation"]
  D --&gt; E[Calibration]
  E --&gt; F["Transition matrix 
  analysis"]
  F --&gt; G{Ratings stable?}
  G -- No --&gt; E
  G -- Yes --&gt; H["RWA impact 
  analysis"]
  H --&gt; I{Impact acceptable?}
  I -- Yes --&gt; J[Approval &amp; deployment]
  I -- No  --&gt; E
  %% J --&gt; K[Ongoing monitoring]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>To illustrate the process, I will use a simulated dataset <code>credit_data</code> to demonstrate the steps involved in credit risk modeling. The dataset contains 100,000 loans over a period of 5 years.</p>
</div>
</div>
</div>
</section>
<section id="sample-selection" class="level3 page-columns page-full" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="sample-selection"><span class="header-section-number">3.2</span> Sample selection</h3>
<p>We begin by building a representative sample from the accumulated data of loans and borrowers. This includes both performing and non-performing (defaulted) loans. Typically, <em>default</em> is defined by 90+ days past due (DPD), which indicates a payment that is at least three months overdue, marking a serious stage of delinquency. The sample period could cover one mini-cycle, e.g., 5 to 7 years.</p>
<p>Consider, for example, the simulated dataset <code>credit_data</code> as a representative sample. <a href="#tbl-sample" class="quarto-xref">Table&nbsp;2</a> below gives an overview of <code>credit_data</code>.</p>
<div class="column-page">
<div class="cell" data-code-code-summary="Sample of simulated credit data.">
<div id="tbl-sample" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-code-code-summary="Sample of simulated credit data.">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_1c0hbz2zy850cs5u9bwi(i, j, css_id) {
          var table = document.getElementById("tinytable_1c0hbz2zy850cs5u9bwi");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_1c0hbz2zy850cs5u9bwi(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_1c0hbz2zy850cs5u9bwi");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '10', j: 2 }, { i: '10', j: 6 }, { i: '10', j: 9 }, { i: '10', j: 10 }, { i: '10', j: 4 }, { i: '10', j: 15 }, { i: '10', j: 3 }, { i: '10', j: 14 }, { i: '10', j: 8 }, { i: '10', j: 13 }, { i: '10', j: 7 }, { i: '10', j: 1 }, { i: '10', j: 12 }, { i: '10', j: 0 }, { i: '10', j: 11 }, { i: '10', j: 5 }, { i: '10', j: 16 },  ], css_id: 'tinytable_css_hwh5vn68doyslbi10r70',}, 
          { positions: [ { i: '3', j: 1 }, { i: '2', j: 0 }, { i: '7', j: 1 }, { i: '6', j: 0 }, { i: '3', j: 0 }, { i: '9', j: 0 }, { i: '6', j: 4 }, { i: '7', j: 0 }, { i: '3', j: 2 }, { i: '2', j: 1 }, { i: '5', j: 2 }, { i: '6', j: 2 }, { i: '7', j: 2 }, { i: '6', j: 1 }, { i: '9', j: 2 }, { i: '6', j: 6 }, { i: '9', j: 1 }, { i: '6', j: 5 }, { i: '2', j: 3 }, { i: '3', j: 3 }, { i: '2', j: 2 }, { i: '5', j: 3 }, { i: '6', j: 3 }, { i: '7', j: 3 }, { i: '1', j: 0 }, { i: '9', j: 3 }, { i: '6', j: 7 }, { i: '4', j: 0 }, { i: '5', j: 0 }, { i: '2', j: 4 }, { i: '3', j: 4 }, { i: '8', j: 0 }, { i: '5', j: 4 }, { i: '2', j: 8 }, { i: '7', j: 4 }, { i: '1', j: 1 }, { i: '9', j: 4 }, { i: '6', j: 8 }, { i: '4', j: 1 }, { i: '5', j: 1 }, { i: '2', j: 5 }, { i: '3', j: 5 }, { i: '8', j: 1 }, { i: '5', j: 5 }, { i: '2', j: 9 }, { i: '7', j: 5 }, { i: '1', j: 2 }, { i: '9', j: 5 }, { i: '6', j: 9 }, { i: '4', j: 2 }, { i: '1', j: 6 }, { i: '2', j: 6 }, { i: '3', j: 6 }, { i: '8', j: 2 }, { i: '5', j: 6 }, { i: '2', j: 10 }, { i: '7', j: 6 }, { i: '1', j: 3 }, { i: '9', j: 6 }, { i: '6', j: 10 }, { i: '4', j: 3 }, { i: '1', j: 7 }, { i: '2', j: 7 }, { i: '3', j: 7 }, { i: '8', j: 3 }, { i: '5', j: 7 }, { i: '2', j: 11 }, { i: '7', j: 7 }, { i: '1', j: 4 }, { i: '9', j: 7 }, { i: '6', j: 11 }, { i: '4', j: 4 }, { i: '1', j: 8 }, { i: '9', j: 11 }, { i: '3', j: 8 }, { i: '8', j: 4 }, { i: '5', j: 8 }, { i: '2', j: 12 }, { i: '7', j: 8 }, { i: '1', j: 5 }, { i: '9', j: 8 }, { i: '6', j: 12 }, { i: '4', j: 5 }, { i: '1', j: 9 }, { i: '9', j: 12 }, { i: '3', j: 9 }, { i: '8', j: 5 }, { i: '5', j: 9 }, { i: '2', j: 13 }, { i: '7', j: 9 }, { i: '8', j: 9 }, { i: '9', j: 9 }, { i: '6', j: 13 }, { i: '4', j: 6 }, { i: '1', j: 10 }, { i: '9', j: 13 }, { i: '3', j: 10 }, { i: '8', j: 6 }, { i: '5', j: 10 }, { i: '2', j: 14 }, { i: '7', j: 10 }, { i: '8', j: 10 }, { i: '9', j: 10 }, { i: '6', j: 14 }, { i: '4', j: 7 }, { i: '1', j: 11 }, { i: '9', j: 14 }, { i: '3', j: 11 }, { i: '8', j: 7 }, { i: '5', j: 11 }, { i: '2', j: 15 }, { i: '7', j: 11 }, { i: '8', j: 11 }, { i: '5', j: 15 }, { i: '6', j: 15 }, { i: '4', j: 8 }, { i: '1', j: 12 }, { i: '9', j: 15 }, { i: '3', j: 12 }, { i: '8', j: 8 }, { i: '5', j: 12 }, { i: '2', j: 16 }, { i: '7', j: 12 }, { i: '8', j: 12 }, { i: '5', j: 16 }, { i: '6', j: 16 }, { i: '4', j: 9 }, { i: '1', j: 13 }, { i: '9', j: 16 }, { i: '3', j: 13 }, { i: '4', j: 13 }, { i: '5', j: 13 }, { i: '8', j: 14 }, { i: '7', j: 13 }, { i: '8', j: 13 }, { i: '4', j: 11 }, { i: '1', j: 15 }, { i: '4', j: 10 }, { i: '1', j: 14 }, { i: '4', j: 15 }, { i: '3', j: 14 }, { i: '4', j: 14 }, { i: '5', j: 14 }, { i: '8', j: 15 }, { i: '7', j: 14 }, { i: '3', j: 16 }, { i: '4', j: 12 }, { i: '1', j: 16 }, { i: '7', j: 16 }, { i: '4', j: 16 }, { i: '3', j: 15 }, { i: '8', j: 16 }, { i: '7', j: 15 },  ], css_id: 'tinytable_css_613d03s0t51mdfyf0r6k',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 11 }, { i: '0', j: 5 }, { i: '0', j: 16 }, { i: '0', j: 4 }, { i: '0', j: 15 }, { i: '0', j: 9 }, { i: '0', j: 3 }, { i: '0', j: 8 }, { i: '0', j: 2 }, { i: '0', j: 13 }, { i: '0', j: 1 }, { i: '0', j: 12 }, { i: '0', j: 6 }, { i: '0', j: 7 }, { i: '0', j: 10 }, { i: '0', j: 14 },  ], css_id: 'tinytable_css_bofg3dy8qw4okcxxt3ue',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_1c0hbz2zy850cs5u9bwi(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_hwh5vn68doyslbi10r70, .table th.tinytable_css_hwh5vn68doyslbi10r70 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_613d03s0t51mdfyf0r6k, .table th.tinytable_css_613d03s0t51mdfyf0r6k { text-align: left; }
      .table td.tinytable_css_bofg3dy8qw4okcxxt3ue, .table th.tinytable_css_bofg3dy8qw4okcxxt3ue { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }

.regtable table {
  border-collapse: collapse;      /* removes default cell gaps */
  border-spacing: 0;
  font-size: 0.9rem;              /* relative, responsive */
}

.regtable caption {
  caption-side: top;
  font-weight: bold;
  color: black;
}

.regtable th,
.regtable td {
  font-weight: normal;            /* normal weight for data cells */
  line-height: 1;                 /* tight vertical spacing */
  padding: 0.2em 0.4em;           /* minimal padding for readability */
  white-space: nowrap;            /* no wrapping */
  margin: 0;                      /* avoid extra vertical gaps */
}

    </style>
    <div class="container">
      <table class="table table-borderless regtable" id="tinytable_1c0hbz2zy850cs5u9bwi" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">loan_id</th>
                <th scope="col" data-row="0" data-col="1">borrower_id</th>
                <th scope="col" data-row="0" data-col="2">year_borrowed</th>
                <th scope="col" data-row="0" data-col="3">net_worth</th>
                <th scope="col" data-row="0" data-col="4">leverage</th>
                <th scope="col" data-row="0" data-col="5">ebitda_to_debt</th>
                <th scope="col" data-row="0" data-col="6">net_profit_margin</th>
                <th scope="col" data-row="0" data-col="7">net_profit_vol</th>
                <th scope="col" data-row="0" data-col="8">board_size</th>
                <th scope="col" data-row="0" data-col="9">ceo_tenure</th>
                <th scope="col" data-row="0" data-col="10">audit_firm_big4</th>
                <th scope="col" data-row="0" data-col="11">amount_in_thousands</th>
                <th scope="col" data-row="0" data-col="12">term_months</th>
                <th scope="col" data-row="0" data-col="13">interest_rate</th>
                <th scope="col" data-row="0" data-col="14">days_past_due</th>
                <th scope="col" data-row="0" data-col="15">default</th>
                <th scope="col" data-row="0" data-col="16">rating</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">345583.00</td>
                  <td data-row="1" data-col="1">97569.00</td>
                  <td data-row="1" data-col="2">2022.00</td>
                  <td data-row="1" data-col="3">158.45</td>
                  <td data-row="1" data-col="4">0.53</td>
                  <td data-row="1" data-col="5">0.26</td>
                  <td data-row="1" data-col="6">0.06</td>
                  <td data-row="1" data-col="7">0.02</td>
                  <td data-row="1" data-col="8">3.00</td>
                  <td data-row="1" data-col="9">6.00</td>
                  <td data-row="1" data-col="10">1.00</td>
                  <td data-row="1" data-col="11">28.20</td>
                  <td data-row="1" data-col="12">60.00</td>
                  <td data-row="1" data-col="13">0.04</td>
                  <td data-row="1" data-col="14">0.00</td>
                  <td data-row="1" data-col="15">0.00</td>
                  <td data-row="1" data-col="16">CCC</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">146926.00</td>
                  <td data-row="2" data-col="1">8297.00</td>
                  <td data-row="2" data-col="2">2021.00</td>
                  <td data-row="2" data-col="3">137.80</td>
                  <td data-row="2" data-col="4">0.88</td>
                  <td data-row="2" data-col="5">0.13</td>
                  <td data-row="2" data-col="6">0.01</td>
                  <td data-row="2" data-col="7">0.04</td>
                  <td data-row="2" data-col="8">11.00</td>
                  <td data-row="2" data-col="9">3.00</td>
                  <td data-row="2" data-col="10">1.00</td>
                  <td data-row="2" data-col="11">13.74</td>
                  <td data-row="2" data-col="12">36.00</td>
                  <td data-row="2" data-col="13">0.03</td>
                  <td data-row="2" data-col="14">1.00</td>
                  <td data-row="2" data-col="15">0.00</td>
                  <td data-row="2" data-col="16">C</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">991741.00</td>
                  <td data-row="3" data-col="1">79496.00</td>
                  <td data-row="3" data-col="2">2025.00</td>
                  <td data-row="3" data-col="3">56.66</td>
                  <td data-row="3" data-col="4">0.21</td>
                  <td data-row="3" data-col="5">1.10</td>
                  <td data-row="3" data-col="6">0.07</td>
                  <td data-row="3" data-col="7">0.03</td>
                  <td data-row="3" data-col="8">7.00</td>
                  <td data-row="3" data-col="9">1.00</td>
                  <td data-row="3" data-col="10">1.00</td>
                  <td data-row="3" data-col="11">15.06</td>
                  <td data-row="3" data-col="12">12.00</td>
                  <td data-row="3" data-col="13">0.05</td>
                  <td data-row="3" data-col="14">0.00</td>
                  <td data-row="3" data-col="15">0.00</td>
                  <td data-row="3" data-col="16">A</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">345056.00</td>
                  <td data-row="4" data-col="1">160230.00</td>
                  <td data-row="4" data-col="2">2021.00</td>
                  <td data-row="4" data-col="3">90.43</td>
                  <td data-row="4" data-col="4">0.33</td>
                  <td data-row="4" data-col="5">0.65</td>
                  <td data-row="4" data-col="6">0.08</td>
                  <td data-row="4" data-col="7">0.01</td>
                  <td data-row="4" data-col="8">5.00</td>
                  <td data-row="4" data-col="9">19.00</td>
                  <td data-row="4" data-col="10">1.00</td>
                  <td data-row="4" data-col="11">16.15</td>
                  <td data-row="4" data-col="12">84.00</td>
                  <td data-row="4" data-col="13">0.06</td>
                  <td data-row="4" data-col="14">0.00</td>
                  <td data-row="4" data-col="15">0.00</td>
                  <td data-row="4" data-col="16">BB</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">650702.00</td>
                  <td data-row="5" data-col="1">172780.00</td>
                  <td data-row="5" data-col="2">2025.00</td>
                  <td data-row="5" data-col="3">410.62</td>
                  <td data-row="5" data-col="4">0.58</td>
                  <td data-row="5" data-col="5">0.45</td>
                  <td data-row="5" data-col="6">0.08</td>
                  <td data-row="5" data-col="7">0.05</td>
                  <td data-row="5" data-col="8">11.00</td>
                  <td data-row="5" data-col="9">17.00</td>
                  <td data-row="5" data-col="10">1.00</td>
                  <td data-row="5" data-col="11">4.72</td>
                  <td data-row="5" data-col="12">60.00</td>
                  <td data-row="5" data-col="13">0.05</td>
                  <td data-row="5" data-col="14">0.00</td>
                  <td data-row="5" data-col="15">0.00</td>
                  <td data-row="5" data-col="16">BB</td>
                </tr>
                <tr>
                  <td data-row="6" data-col="0">737402.00</td>
                  <td data-row="6" data-col="1">97574.00</td>
                  <td data-row="6" data-col="2">2022.00</td>
                  <td data-row="6" data-col="3">399.49</td>
                  <td data-row="6" data-col="4">0.38</td>
                  <td data-row="6" data-col="5">0.55</td>
                  <td data-row="6" data-col="6">0.07</td>
                  <td data-row="6" data-col="7">0.02</td>
                  <td data-row="6" data-col="8">4.00</td>
                  <td data-row="6" data-col="9">10.00</td>
                  <td data-row="6" data-col="10">1.00</td>
                  <td data-row="6" data-col="11">10.62</td>
                  <td data-row="6" data-col="12">36.00</td>
                  <td data-row="6" data-col="13">0.06</td>
                  <td data-row="6" data-col="14">0.00</td>
                  <td data-row="6" data-col="15">0.00</td>
                  <td data-row="6" data-col="16">BBB</td>
                </tr>
                <tr>
                  <td data-row="7" data-col="0">871685.00</td>
                  <td data-row="7" data-col="1">2343.00</td>
                  <td data-row="7" data-col="2">2021.00</td>
                  <td data-row="7" data-col="3">97.98</td>
                  <td data-row="7" data-col="4">0.48</td>
                  <td data-row="7" data-col="5">0.58</td>
                  <td data-row="7" data-col="6">0.09</td>
                  <td data-row="7" data-col="7">0.03</td>
                  <td data-row="7" data-col="8">10.00</td>
                  <td data-row="7" data-col="9">17.00</td>
                  <td data-row="7" data-col="10">1.00</td>
                  <td data-row="7" data-col="11">11.91</td>
                  <td data-row="7" data-col="12">36.00</td>
                  <td data-row="7" data-col="13">0.03</td>
                  <td data-row="7" data-col="14">0.00</td>
                  <td data-row="7" data-col="15">0.00</td>
                  <td data-row="7" data-col="16">B</td>
                </tr>
                <tr>
                  <td data-row="8" data-col="0">229471.00</td>
                  <td data-row="8" data-col="1">41342.00</td>
                  <td data-row="8" data-col="2">2021.00</td>
                  <td data-row="8" data-col="3">338.26</td>
                  <td data-row="8" data-col="4">0.20</td>
                  <td data-row="8" data-col="5">0.50</td>
                  <td data-row="8" data-col="6">0.18</td>
                  <td data-row="8" data-col="7">0.04</td>
                  <td data-row="8" data-col="8">13.00</td>
                  <td data-row="8" data-col="9">17.00</td>
                  <td data-row="8" data-col="10">1.00</td>
                  <td data-row="8" data-col="11">67.29</td>
                  <td data-row="8" data-col="12">12.00</td>
                  <td data-row="8" data-col="13">0.05</td>
                  <td data-row="8" data-col="14">0.00</td>
                  <td data-row="8" data-col="15">0.00</td>
                  <td data-row="8" data-col="16">BB</td>
                </tr>
                <tr>
                  <td data-row="9" data-col="0">545936.00</td>
                  <td data-row="9" data-col="1">91092.00</td>
                  <td data-row="9" data-col="2">2025.00</td>
                  <td data-row="9" data-col="3">212.70</td>
                  <td data-row="9" data-col="4">0.18</td>
                  <td data-row="9" data-col="5">1.02</td>
                  <td data-row="9" data-col="6">0.01</td>
                  <td data-row="9" data-col="7">0.05</td>
                  <td data-row="9" data-col="8">14.00</td>
                  <td data-row="9" data-col="9">19.00</td>
                  <td data-row="9" data-col="10">1.00</td>
                  <td data-row="9" data-col="11">10.58</td>
                  <td data-row="9" data-col="12">12.00</td>
                  <td data-row="9" data-col="13">0.06</td>
                  <td data-row="9" data-col="14">4.00</td>
                  <td data-row="9" data-col="15">0.00</td>
                  <td data-row="9" data-col="16">A</td>
                </tr>
                <tr>
                  <td data-row="10" data-col="0">250347.00</td>
                  <td data-row="10" data-col="1">231266.00</td>
                  <td data-row="10" data-col="2">2022.00</td>
                  <td data-row="10" data-col="3">90.90</td>
                  <td data-row="10" data-col="4">0.21</td>
                  <td data-row="10" data-col="5">0.94</td>
                  <td data-row="10" data-col="6">0.11</td>
                  <td data-row="10" data-col="7">0.01</td>
                  <td data-row="10" data-col="8">13.00</td>
                  <td data-row="10" data-col="9">17.00</td>
                  <td data-row="10" data-col="10">0.00</td>
                  <td data-row="10" data-col="11">24.16</td>
                  <td data-row="10" data-col="12">12.00</td>
                  <td data-row="10" data-col="13">0.04</td>
                  <td data-row="10" data-col="14">0.00</td>
                  <td data-row="10" data-col="15">0.00</td>
                  <td data-row="10" data-col="16">BBB</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl" id="tbl-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Sample of Simulated Credit Data
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#tbl-grade-dist" class="quarto-xref">Table&nbsp;3</a> shows the empirical distribution of credit ratings and their associated default rates.</p>
<div class="cell page-columns page-full">
<div id="tbl-grade-dist" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-grade-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_9a8fk31ujp0x66hydt07(i, j, css_id) {
          var table = document.getElementById("tinytable_9a8fk31ujp0x66hydt07");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_9a8fk31ujp0x66hydt07(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_9a8fk31ujp0x66hydt07");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '9', j: 0 }, { i: '9', j: 1 }, { i: '9', j: 2 }, { i: '9', j: 3 },  ], css_id: 'tinytable_css_pb8io34wftsqi5ice1js',}, 
          { positions: [ { i: '1', j: 0 }, { i: '5', j: 0 }, { i: '2', j: 0 }, { i: '3', j: 0 }, { i: '8', j: 0 }, { i: '2', j: 2 }, { i: '6', j: 0 }, { i: '1', j: 1 }, { i: '2', j: 1 }, { i: '3', j: 1 }, { i: '4', j: 1 }, { i: '5', j: 1 }, { i: '6', j: 1 }, { i: '4', j: 0 }, { i: '8', j: 1 }, { i: '2', j: 3 }, { i: '7', j: 0 }, { i: '1', j: 2 }, { i: '5', j: 3 }, { i: '3', j: 2 }, { i: '4', j: 2 }, { i: '5', j: 2 }, { i: '6', j: 2 }, { i: '7', j: 2 }, { i: '8', j: 2 }, { i: '3', j: 3 }, { i: '7', j: 1 }, { i: '1', j: 3 }, { i: '6', j: 3 }, { i: '7', j: 3 }, { i: '4', j: 3 }, { i: '8', j: 3 },  ], css_id: 'tinytable_css_1q3ypk9bbt2wuawr2nzl',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 },  ], css_id: 'tinytable_css_2exck85t42i0rc9bd03y',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_9a8fk31ujp0x66hydt07(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_pb8io34wftsqi5ice1js, .table th.tinytable_css_pb8io34wftsqi5ice1js { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_1q3ypk9bbt2wuawr2nzl, .table th.tinytable_css_1q3ypk9bbt2wuawr2nzl { text-align: left; }
      .table td.tinytable_css_2exck85t42i0rc9bd03y, .table th.tinytable_css_2exck85t42i0rc9bd03y { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }

.regtable table {
  border-collapse: collapse;      /* removes default cell gaps */
  border-spacing: 0;
  font-size: 0.9rem;              /* relative, responsive */
}

.regtable caption {
  caption-side: top;
  font-weight: bold;
  color: black;
}

.regtable th,
.regtable td {
  font-weight: normal;            /* normal weight for data cells */
  line-height: 1;                 /* tight vertical spacing */
  padding: 0.2em 0.4em;           /* minimal padding for readability */
  white-space: nowrap;            /* no wrapping */
  margin: 0;                      /* avoid extra vertical gaps */
}

    </style>
    <div class="container">
      <table class="table table-borderless regtable" id="tinytable_9a8fk31ujp0x66hydt07" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">Rating Grade</th>
                <th scope="col" data-row="0" data-col="1">Count</th>
                <th scope="col" data-row="0" data-col="2">Defaults</th>
                <th scope="col" data-row="0" data-col="3">Observed Default Rate (%)</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">AAA</td>
                  <td data-row="1" data-col="1">1,000</td>
                  <td data-row="1" data-col="2">0</td>
                  <td data-row="1" data-col="3">0.00</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">AA</td>
                  <td data-row="2" data-col="1">4,000</td>
                  <td data-row="2" data-col="2">3</td>
                  <td data-row="2" data-col="3">0.07</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">A</td>
                  <td data-row="3" data-col="1">15,000</td>
                  <td data-row="3" data-col="2">30</td>
                  <td data-row="3" data-col="3">0.20</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">BBB</td>
                  <td data-row="4" data-col="1">30,000</td>
                  <td data-row="4" data-col="2">180</td>
                  <td data-row="4" data-col="3">0.60</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">BB</td>
                  <td data-row="5" data-col="1">25,000</td>
                  <td data-row="5" data-col="2">375</td>
                  <td data-row="5" data-col="3">1.50</td>
                </tr>
                <tr>
                  <td data-row="6" data-col="0">B</td>
                  <td data-row="6" data-col="1">15,000</td>
                  <td data-row="6" data-col="2">525</td>
                  <td data-row="6" data-col="3">3.50</td>
                </tr>
                <tr>
                  <td data-row="7" data-col="0">CCC</td>
                  <td data-row="7" data-col="1">6,000</td>
                  <td data-row="7" data-col="2">600</td>
                  <td data-row="7" data-col="3">10.00</td>
                </tr>
                <tr>
                  <td data-row="8" data-col="0">CC</td>
                  <td data-row="8" data-col="1">2,500</td>
                  <td data-row="8" data-col="2">625</td>
                  <td data-row="8" data-col="3">25.00</td>
                </tr>
                <tr>
                  <td data-row="9" data-col="0">C</td>
                  <td data-row="9" data-col="1">1,500</td>
                  <td data-row="9" data-col="2">450</td>
                  <td data-row="9" data-col="3">30.00</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-grade-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Empirical Grade Distribution and Default Rates
</figcaption>
</figure>
</div>
</div>
<p><a href="#tbl-summary-statistics" class="quarto-xref">Table&nbsp;4</a> presents the summary statistics.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Summary statistics for the analysis.</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>modelsummary<span class="sc">::</span><span class="fu">datasummary</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.formula</span>(<span class="fu">paste</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setdiff</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(credit_data)[<span class="fu">sapply</span>(credit_data, is.numeric)],</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"loan_id"</span>, <span class="st">"borrower_id"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">collapse =</span> <span class="st">" + "</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"~ N + Mean + SD + Min + P25 + Median + P75 + Max"</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  )),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> credit_data,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">3</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_html</span>(<span class="at">class=</span><span class="st">"table table-borderless regtable"</span>, <span class="at">css_rule=</span>table_css)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-summary-statistics" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-summary-statistics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_u2pm2mmviwk3nq8exlx9(i, j, css_id) {
          var table = document.getElementById("tinytable_u2pm2mmviwk3nq8exlx9");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_u2pm2mmviwk3nq8exlx9(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_u2pm2mmviwk3nq8exlx9");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '14', j: 1 }, { i: '14', j: 2 }, { i: '14', j: 3 }, { i: '14', j: 6 }, { i: '14', j: 4 }, { i: '14', j: 7 }, { i: '14', j: 5 }, { i: '14', j: 8 },  ], css_id: 'tinytable_css_fuihjy74tks5l9erd8wq',}, 
          { positions: [ { i: '3', j: 1 }, { i: '1', j: 1 }, { i: '6', j: 1 }, { i: '11', j: 1 }, { i: '8', j: 1 }, { i: '13', j: 1 }, { i: '9', j: 4 }, { i: '2', j: 1 }, { i: '1', j: 2 }, { i: '4', j: 1 }, { i: '3', j: 2 }, { i: '4', j: 2 }, { i: '7', j: 1 }, { i: '6', j: 2 }, { i: '9', j: 1 }, { i: '8', j: 2 }, { i: '9', j: 2 }, { i: '12', j: 1 }, { i: '11', j: 2 }, { i: '12', j: 2 }, { i: '13', j: 2 }, { i: '9', j: 5 }, { i: '2', j: 2 }, { i: '1', j: 3 }, { i: '2', j: 3 }, { i: '3', j: 3 }, { i: '4', j: 3 }, { i: '7', j: 2 }, { i: '6', j: 3 }, { i: '7', j: 3 }, { i: '8', j: 3 }, { i: '9', j: 3 }, { i: '10', j: 3 }, { i: '11', j: 3 }, { i: '12', j: 3 }, { i: '13', j: 3 }, { i: '9', j: 6 }, { i: '5', j: 1 }, { i: '1', j: 4 }, { i: '2', j: 4 }, { i: '3', j: 4 }, { i: '4', j: 4 }, { i: '10', j: 1 }, { i: '6', j: 4 }, { i: '7', j: 4 }, { i: '8', j: 4 }, { i: '4', j: 7 }, { i: '10', j: 4 }, { i: '11', j: 4 }, { i: '12', j: 4 }, { i: '13', j: 4 }, { i: '9', j: 7 }, { i: '5', j: 2 }, { i: '1', j: 5 }, { i: '2', j: 5 }, { i: '3', j: 5 }, { i: '4', j: 5 }, { i: '10', j: 2 }, { i: '6', j: 5 }, { i: '7', j: 5 }, { i: '8', j: 5 }, { i: '4', j: 8 }, { i: '10', j: 5 }, { i: '11', j: 5 }, { i: '12', j: 5 }, { i: '13', j: 5 }, { i: '9', j: 8 }, { i: '5', j: 3 }, { i: '1', j: 6 }, { i: '2', j: 6 }, { i: '3', j: 6 }, { i: '4', j: 6 }, { i: '5', j: 6 }, { i: '6', j: 6 }, { i: '7', j: 6 }, { i: '8', j: 6 }, { i: '7', j: 7 }, { i: '10', j: 6 }, { i: '11', j: 6 }, { i: '12', j: 6 }, { i: '13', j: 6 }, { i: '12', j: 7 }, { i: '5', j: 4 }, { i: '1', j: 7 }, { i: '2', j: 7 }, { i: '3', j: 7 }, { i: '2', j: 8 }, { i: '5', j: 7 }, { i: '6', j: 7 }, { i: '5', j: 8 }, { i: '8', j: 7 }, { i: '7', j: 8 }, { i: '10', j: 7 }, { i: '11', j: 7 }, { i: '10', j: 8 }, { i: '13', j: 7 }, { i: '12', j: 8 }, { i: '5', j: 5 }, { i: '1', j: 8 }, { i: '6', j: 8 }, { i: '3', j: 8 }, { i: '8', j: 8 }, { i: '13', j: 8 }, { i: '11', j: 8 },  ], css_id: 'tinytable_css_f3zk2qzdseadf9hn7lh9',}, 
          { positions: [ { i: '0', j: 1 }, { i: '0', j: 4 }, { i: '0', j: 2 }, { i: '0', j: 5 }, { i: '0', j: 3 }, { i: '0', j: 6 }, { i: '0', j: 7 }, { i: '0', j: 8 },  ], css_id: 'tinytable_css_6l5hmzc89w4amcym6k0x',}, 
          { positions: [ { i: '14', j: 0 },  ], css_id: 'tinytable_css_4trowb8x8w9g0vggiin3',}, 
          { positions: [ { i: '1', j: 0 }, { i: '2', j: 0 }, { i: '3', j: 0 }, { i: '4', j: 0 }, { i: '5', j: 0 }, { i: '6', j: 0 }, { i: '7', j: 0 }, { i: '8', j: 0 }, { i: '9', j: 0 }, { i: '10', j: 0 }, { i: '11', j: 0 }, { i: '12', j: 0 }, { i: '13', j: 0 },  ], css_id: 'tinytable_css_i3vtw091noalgnhmjgpq',}, 
          { positions: [ { i: '0', j: 0 },  ], css_id: 'tinytable_css_aegf79fsd8v4rhetexsc',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_u2pm2mmviwk3nq8exlx9(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_fuihjy74tks5l9erd8wq, .table th.tinytable_css_fuihjy74tks5l9erd8wq { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_f3zk2qzdseadf9hn7lh9, .table th.tinytable_css_f3zk2qzdseadf9hn7lh9 { text-align: right; }
      .table td.tinytable_css_6l5hmzc89w4amcym6k0x, .table th.tinytable_css_6l5hmzc89w4amcym6k0x { text-align: right; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_4trowb8x8w9g0vggiin3, .table th.tinytable_css_4trowb8x8w9g0vggiin3 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_i3vtw091noalgnhmjgpq, .table th.tinytable_css_i3vtw091noalgnhmjgpq { text-align: left; }
      .table td.tinytable_css_aegf79fsd8v4rhetexsc, .table th.tinytable_css_aegf79fsd8v4rhetexsc { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }

.regtable table {
  border-collapse: collapse;      /* removes default cell gaps */
  border-spacing: 0;
  font-size: 0.9rem;              /* relative, responsive */
}

.regtable caption {
  caption-side: top;
  font-weight: bold;
  color: black;
}

.regtable th,
.regtable td {
  font-weight: normal;            /* normal weight for data cells */
  line-height: 1;                 /* tight vertical spacing */
  padding: 0.2em 0.4em;           /* minimal padding for readability */
  white-space: nowrap;            /* no wrapping */
  margin: 0;                      /* avoid extra vertical gaps */
}

    </style>
    <div class="container">
      <table class="table table-borderless regtable" id="tinytable_u2pm2mmviwk3nq8exlx9" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0"> </th>
                <th scope="col" data-row="0" data-col="1">N</th>
                <th scope="col" data-row="0" data-col="2">Mean</th>
                <th scope="col" data-row="0" data-col="3">SD</th>
                <th scope="col" data-row="0" data-col="4">Min</th>
                <th scope="col" data-row="0" data-col="5">P25</th>
                <th scope="col" data-row="0" data-col="6">Median</th>
                <th scope="col" data-row="0" data-col="7">P75</th>
                <th scope="col" data-row="0" data-col="8">Max</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">year_borrowed</td>
                  <td data-row="1" data-col="1">100000</td>
                  <td data-row="1" data-col="2">2023.005</td>
                  <td data-row="1" data-col="3">1.412</td>
                  <td data-row="1" data-col="4">2021.000</td>
                  <td data-row="1" data-col="5">2022.000</td>
                  <td data-row="1" data-col="6">2023.000</td>
                  <td data-row="1" data-col="7">2024.000</td>
                  <td data-row="1" data-col="8">2025.000</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">net_worth</td>
                  <td data-row="2" data-col="1">100000</td>
                  <td data-row="2" data-col="2">199.969</td>
                  <td data-row="2" data-col="3">157.792</td>
                  <td data-row="2" data-col="4">7.910</td>
                  <td data-row="2" data-col="5">89.210</td>
                  <td data-row="2" data-col="6">151.660</td>
                  <td data-row="2" data-col="7">259.242</td>
                  <td data-row="2" data-col="8">1863.100</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">leverage</td>
                  <td data-row="3" data-col="1">100000</td>
                  <td data-row="3" data-col="2">0.361</td>
                  <td data-row="3" data-col="3">0.191</td>
                  <td data-row="3" data-col="4">0.100</td>
                  <td data-row="3" data-col="5">0.220</td>
                  <td data-row="3" data-col="6">0.310</td>
                  <td data-row="3" data-col="7">0.460</td>
                  <td data-row="3" data-col="8">0.900</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">ebitda_to_debt</td>
                  <td data-row="4" data-col="1">100000</td>
                  <td data-row="4" data-col="2">0.682</td>
                  <td data-row="4" data-col="3">0.286</td>
                  <td data-row="4" data-col="4">-0.098</td>
                  <td data-row="4" data-col="5">0.476</td>
                  <td data-row="4" data-col="6">0.697</td>
                  <td data-row="4" data-col="7">0.889</td>
                  <td data-row="4" data-col="8">4.209</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">net_profit_margin</td>
                  <td data-row="5" data-col="1">100000</td>
                  <td data-row="5" data-col="2">0.083</td>
                  <td data-row="5" data-col="3">0.040</td>
                  <td data-row="5" data-col="4">-0.106</td>
                  <td data-row="5" data-col="5">0.056</td>
                  <td data-row="5" data-col="6">0.083</td>
                  <td data-row="5" data-col="7">0.110</td>
                  <td data-row="5" data-col="8">0.247</td>
                </tr>
                <tr>
                  <td data-row="6" data-col="0">net_profit_vol</td>
                  <td data-row="6" data-col="1">100000</td>
                  <td data-row="6" data-col="2">0.030</td>
                  <td data-row="6" data-col="3">0.014</td>
                  <td data-row="6" data-col="4">0.000</td>
                  <td data-row="6" data-col="5">0.020</td>
                  <td data-row="6" data-col="6">0.030</td>
                  <td data-row="6" data-col="7">0.040</td>
                  <td data-row="6" data-col="8">0.090</td>
                </tr>
                <tr>
                  <td data-row="7" data-col="0">board_size</td>
                  <td data-row="7" data-col="1">100000</td>
                  <td data-row="7" data-col="2">8.711</td>
                  <td data-row="7" data-col="3">3.734</td>
                  <td data-row="7" data-col="4">3.000</td>
                  <td data-row="7" data-col="5">5.000</td>
                  <td data-row="7" data-col="6">9.000</td>
                  <td data-row="7" data-col="7">12.000</td>
                  <td data-row="7" data-col="8">15.000</td>
                </tr>
                <tr>
                  <td data-row="8" data-col="0">ceo_tenure</td>
                  <td data-row="8" data-col="1">100000</td>
                  <td data-row="8" data-col="2">10.571</td>
                  <td data-row="8" data-col="3">5.770</td>
                  <td data-row="8" data-col="4">1.000</td>
                  <td data-row="8" data-col="5">6.000</td>
                  <td data-row="8" data-col="6">11.000</td>
                  <td data-row="8" data-col="7">16.000</td>
                  <td data-row="8" data-col="8">20.000</td>
                </tr>
                <tr>
                  <td data-row="9" data-col="0">audit_firm_big4</td>
                  <td data-row="9" data-col="1">100000</td>
                  <td data-row="9" data-col="2">0.699</td>
                  <td data-row="9" data-col="3">0.459</td>
                  <td data-row="9" data-col="4">0.000</td>
                  <td data-row="9" data-col="5">0.000</td>
                  <td data-row="9" data-col="6">1.000</td>
                  <td data-row="9" data-col="7">1.000</td>
                  <td data-row="9" data-col="8">1.000</td>
                </tr>
                <tr>
                  <td data-row="10" data-col="0">amount_in_thousands</td>
                  <td data-row="10" data-col="1">100000</td>
                  <td data-row="10" data-col="2">21.905</td>
                  <td data-row="10" data-col="3">16.057</td>
                  <td data-row="10" data-col="4">1.079</td>
                  <td data-row="10" data-col="5">11.360</td>
                  <td data-row="10" data-col="6">17.680</td>
                  <td data-row="10" data-col="7">27.500</td>
                  <td data-row="10" data-col="8">263.860</td>
                </tr>
                <tr>
                  <td data-row="11" data-col="0">term_months</td>
                  <td data-row="11" data-col="1">100000</td>
                  <td data-row="11" data-col="2">40.644</td>
                  <td data-row="11" data-col="3">20.837</td>
                  <td data-row="11" data-col="4">12.000</td>
                  <td data-row="11" data-col="5">36.000</td>
                  <td data-row="11" data-col="6">36.000</td>
                  <td data-row="11" data-col="7">60.000</td>
                  <td data-row="11" data-col="8">84.000</td>
                </tr>
                <tr>
                  <td data-row="12" data-col="0">interest_rate</td>
                  <td data-row="12" data-col="1">100000</td>
                  <td data-row="12" data-col="2">0.045</td>
                  <td data-row="12" data-col="3">0.012</td>
                  <td data-row="12" data-col="4">-0.007</td>
                  <td data-row="12" data-col="5">0.037</td>
                  <td data-row="12" data-col="6">0.045</td>
                  <td data-row="12" data-col="7">0.053</td>
                  <td data-row="12" data-col="8">0.097</td>
                </tr>
                <tr>
                  <td data-row="13" data-col="0">days_past_due</td>
                  <td data-row="13" data-col="1">100000</td>
                  <td data-row="13" data-col="2">2.911</td>
                  <td data-row="13" data-col="3">15.479</td>
                  <td data-row="13" data-col="4">0.000</td>
                  <td data-row="13" data-col="5">0.000</td>
                  <td data-row="13" data-col="6">0.000</td>
                  <td data-row="13" data-col="7">0.000</td>
                  <td data-row="13" data-col="8">124.000</td>
                </tr>
                <tr>
                  <td data-row="14" data-col="0">default</td>
                  <td data-row="14" data-col="1">100000</td>
                  <td data-row="14" data-col="2">0.028</td>
                  <td data-row="14" data-col="3">0.165</td>
                  <td data-row="14" data-col="4">0.000</td>
                  <td data-row="14" data-col="5">0.000</td>
                  <td data-row="14" data-col="6">0.000</td>
                  <td data-row="14" data-col="7">0.000</td>
                  <td data-row="14" data-col="8">1.000</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-summary-statistics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Summary Statistics of Simulated Credit Data
</figcaption>
</figure>
</div>
</div>
<p>The sample is then split into a <strong>training set</strong> and a <strong>test set</strong>, typically using a 70/30 or 80/20 split. The training set is used to build the model, while the test set is used to evaluate its performance.</p>
<div class="cell">
<details class="code-fold">
<summary>Partition the data into training and test sets based on an 80/20 split.</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(credit_data), <span class="fl">0.8</span> <span class="sc">*</span> <span class="fu">nrow</span>(credit_data))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> credit_data[train_indices, ]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> credit_data[<span class="sc">-</span>train_indices, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sec-variable-screening" class="level3 page-columns page-full" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="sec-variable-screening"><span class="header-section-number">3.3</span> Variable screening</h3>
<p>The next step involves short listing a set of candidate variables that are potentially predictive of default risk. This is done through a combination of domain knowledge and statistical techniques. We start with a broad set of variables and then apply various screening methods to identify the most relevant ones.</p>
<section id="single-factor-screening" class="level4 page-columns page-full" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="single-factor-screening"><span class="header-section-number">3.3.1</span> Single-factor screening</h4>
<p>First, because the outcome variable (<code>default</code>) that we are interested in is binary (default vs non-default), we can use the <strong>Information Value (IV)</strong> metric to assess the predictive power of each candidate variable. The IV measures how well a variable can distinguish between defaulters and non-defaulters. A higher IV indicates a stronger predictive power. IV provides a <em>univariate measure</em> of the variable’s ability to distinguish between good and bad accounts. It helps in keeping predictors with meaningful discriminatory power before building a multivariate model.</p>
<div class="callout callout-style-simple callout-note callout-titled" title="Information Value (IV)">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Information Value (IV)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The Information Value (IV) is a statistic commonly used in credit scoring to measure how well a predictor variable <span class="math inline">\(X\)</span> separates two groups: “good” (non-default) and “bad” (default). It is based on the idea of comparing the proportion of goods and bads in each bin (or category) of the variable.</p>
<p>Suppose we partition the values of <span class="math inline">\(X\)</span> into <span class="math inline">\(k\)</span> bins. The <strong>Information Value (IV)</strong> for variable <span class="math inline">\(X\)</span> is then:</p>
<p><span class="math display">\[
IV(X) = \sum_{i=1}^k \left( p_i^G - p_i^B \right) \cdot  \ln \left( \frac{p_i^G}{p_i^B} \right),
\]</span></p>
<p>where <span class="math inline">\(p_{i}^{G}\)</span> is the proportion of goods (non-defaults) in bin <span class="math inline">\(i\)</span> and <span class="math inline">\(p_{i}^{B}\)</span> is the proportion of bads (defaults) in bin <span class="math inline">\(i\)</span>.</p>
</div>
</div>
</div>
<p><a href="#tbl-iv-screening" class="quarto-xref">Table&nbsp;5</a> shows the Information Value (IV) for each candidate variable based on the training data. For demonstration purposes, we consider only borrower characteristics available in the dataset.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Compute and rank Information Value (IV) for each variable.</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scorecard)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Select candidate variables (exclude IDs, year, and outcome)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"net_worth"</span>, <span class="st">"leverage"</span>, <span class="st">"ebitda_to_debt"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"net_profit_margin"</span>, <span class="st">"net_profit_vol"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"board_size"</span>, <span class="st">"ceo_tenure"</span>, <span class="st">"audit_firm_big4"</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute IV for each variable and display sorted table using tidyverse pipes</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>iv_df <span class="ot">&lt;-</span> scorecard<span class="sc">::</span><span class="fu">iv</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  train_data,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"default"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> vars</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(info_value)) <span class="sc">|&gt;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> variable,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Information Value</span><span class="st">`</span> <span class="ot">=</span> info_value</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Show IV table</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>iv_df <span class="sc">|&gt;</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  modelsummary<span class="sc">::</span><span class="fu">datasummary_df</span>(<span class="at">fmt =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_html</span>(<span class="at">class=</span><span class="st">"table table-borderless regtable"</span>, <span class="at">css_rule=</span>table_css)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-iv-screening" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-iv-screening-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_da9cjrhdc8u2rzs02ov5(i, j, css_id) {
          var table = document.getElementById("tinytable_da9cjrhdc8u2rzs02ov5");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_da9cjrhdc8u2rzs02ov5(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_da9cjrhdc8u2rzs02ov5");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '8', j: 0 }, { i: '8', j: 1 },  ], css_id: 'tinytable_css_53fvm8uccw5crksxccth',}, 
          { positions: [ { i: '2', j: 0 }, { i: '3', j: 0 }, { i: '4', j: 0 }, { i: '1', j: 0 }, { i: '6', j: 0 }, { i: '7', j: 0 }, { i: '3', j: 1 }, { i: '5', j: 0 }, { i: '1', j: 1 }, { i: '2', j: 1 }, { i: '7', j: 1 }, { i: '4', j: 1 }, { i: '5', j: 1 }, { i: '6', j: 1 },  ], css_id: 'tinytable_css_vysb53na6cha78jwcsok',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 },  ], css_id: 'tinytable_css_m0zsxwc7x8xhruy1l05u',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_da9cjrhdc8u2rzs02ov5(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_53fvm8uccw5crksxccth, .table th.tinytable_css_53fvm8uccw5crksxccth { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_vysb53na6cha78jwcsok, .table th.tinytable_css_vysb53na6cha78jwcsok { text-align: left; }
      .table td.tinytable_css_m0zsxwc7x8xhruy1l05u, .table th.tinytable_css_m0zsxwc7x8xhruy1l05u { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }

.regtable table {
  border-collapse: collapse;      /* removes default cell gaps */
  border-spacing: 0;
  font-size: 0.9rem;              /* relative, responsive */
}

.regtable caption {
  caption-side: top;
  font-weight: bold;
  color: black;
}

.regtable th,
.regtable td {
  font-weight: normal;            /* normal weight for data cells */
  line-height: 1;                 /* tight vertical spacing */
  padding: 0.2em 0.4em;           /* minimal padding for readability */
  white-space: nowrap;            /* no wrapping */
  margin: 0;                      /* avoid extra vertical gaps */
}

    </style>
    <div class="container">
      <table class="table table-borderless regtable" id="tinytable_da9cjrhdc8u2rzs02ov5" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">Variable</th>
                <th scope="col" data-row="0" data-col="1">Information Value</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">ebitda_to_debt</td>
                  <td data-row="1" data-col="1">1.622</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">leverage</td>
                  <td data-row="2" data-col="1">1.012</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">net_worth</td>
                  <td data-row="3" data-col="1">0.475</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">net_profit_margin</td>
                  <td data-row="4" data-col="1">0.264</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">net_profit_vol</td>
                  <td data-row="5" data-col="1">0.264</td>
                </tr>
                <tr>
                  <td data-row="6" data-col="0">board_size</td>
                  <td data-row="6" data-col="1">0.033</td>
                </tr>
                <tr>
                  <td data-row="7" data-col="0">ceo_tenure</td>
                  <td data-row="7" data-col="1">0.012</td>
                </tr>
                <tr>
                  <td data-row="8" data-col="0">audit_firm_big4</td>
                  <td data-row="8" data-col="1">0.001</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-iv-screening-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Information Value (IV) Screening Results
</figcaption>
</figure>
</div>
</div>
<p>As a rule of thumb, we consider variables with an IV of 0.1 or higher as having medium predictive power and worthy of further consideration in the modeling process. This leaves us with only the following variable: <code>ebitda_to_debt</code>, <code>leverage</code>, <code>net_worth</code>, <code>net_profit_margin</code>, <code>net_profit_vol</code>.</p>
</section>
<section id="redundancy-and-correlation-control" class="level4 page-columns page-full" data-number="3.3.2">
<h4 data-number="3.3.2" class="anchored" data-anchor-id="redundancy-and-correlation-control"><span class="header-section-number">3.3.2</span> Redundancy and correlation control</h4>
<p>Second, after short listing a set of candidate variables via single-factor screening, we need to check for redundancy and correlation among them. Highly correlated variables can introduce multicollinearity into the model, making it difficult to isolate the effect of each variable on default risk.</p>
<p>In practice, we can compute the pairwise Pearson and Spearman correlation coefficients to identify highly correlated variables. If two variables are found to be highly correlated (e.g., the size of the correlation coefficient larger than 0.6), we may choose to retain only one of them in the model.</p>
<p><a href="#tbl-corr-matrix" class="quarto-xref">Table&nbsp;6</a> shows the correlation matrix of the short listed candidate variables in the training data.</p>
<div class="cell page-columns page-full">
<div id="tbl-corr-matrix" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-corr-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_wchgc8zo2jx0e694o32q(i, j, css_id) {
          var table = document.getElementById("tinytable_wchgc8zo2jx0e694o32q");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_wchgc8zo2jx0e694o32q(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_wchgc8zo2jx0e694o32q");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '5', j: 3 }, { i: '5', j: 1 }, { i: '5', j: 4 }, { i: '5', j: 2 }, { i: '5', j: 5 },  ], css_id: 'tinytable_css_hzaokhglp256p9svi9jo',}, 
          { positions: [ { i: '1', j: 1 }, { i: '2', j: 1 }, { i: '3', j: 1 }, { i: '4', j: 1 }, { i: '3', j: 2 }, { i: '4', j: 2 }, { i: '1', j: 2 }, { i: '2', j: 2 }, { i: '1', j: 3 }, { i: '2', j: 3 }, { i: '3', j: 3 }, { i: '4', j: 3 }, { i: '3', j: 4 }, { i: '4', j: 4 }, { i: '1', j: 4 }, { i: '2', j: 4 }, { i: '1', j: 5 }, { i: '2', j: 5 }, { i: '3', j: 5 }, { i: '4', j: 5 },  ], css_id: 'tinytable_css_lr6osqyd1t7ddpl167hy',}, 
          { positions: [ { i: '0', j: 1 }, { i: '0', j: 4 }, { i: '0', j: 2 }, { i: '0', j: 5 }, { i: '0', j: 3 },  ], css_id: 'tinytable_css_lov0qrmzdu3aauplklfu',}, 
          { positions: [ { i: '5', j: 0 },  ], css_id: 'tinytable_css_cbuo6wea2etiobgah17a',}, 
          { positions: [ { i: '1', j: 0 }, { i: '2', j: 0 }, { i: '3', j: 0 }, { i: '4', j: 0 },  ], css_id: 'tinytable_css_8jgknxz19t86vps52lwp',}, 
          { positions: [ { i: '0', j: 0 },  ], css_id: 'tinytable_css_ia5sybrivwazl6n22o3x',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_wchgc8zo2jx0e694o32q(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_hzaokhglp256p9svi9jo, .table th.tinytable_css_hzaokhglp256p9svi9jo { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_lr6osqyd1t7ddpl167hy, .table th.tinytable_css_lr6osqyd1t7ddpl167hy { text-align: right; }
      .table td.tinytable_css_lov0qrmzdu3aauplklfu, .table th.tinytable_css_lov0qrmzdu3aauplklfu { text-align: right; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_cbuo6wea2etiobgah17a, .table th.tinytable_css_cbuo6wea2etiobgah17a { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_8jgknxz19t86vps52lwp, .table th.tinytable_css_8jgknxz19t86vps52lwp { text-align: left; }
      .table td.tinytable_css_ia5sybrivwazl6n22o3x, .table th.tinytable_css_ia5sybrivwazl6n22o3x { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }

.regtable table {
  border-collapse: collapse;      /* removes default cell gaps */
  border-spacing: 0;
  font-size: 0.9rem;              /* relative, responsive */
}

.regtable caption {
  caption-side: top;
  font-weight: bold;
  color: black;
}

.regtable th,
.regtable td {
  font-weight: normal;            /* normal weight for data cells */
  line-height: 1;                 /* tight vertical spacing */
  padding: 0.2em 0.4em;           /* minimal padding for readability */
  white-space: nowrap;            /* no wrapping */
  margin: 0;                      /* avoid extra vertical gaps */
}

    </style>
    <div class="container">
      <table class="table table-borderless regtable" id="tinytable_wchgc8zo2jx0e694o32q" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0"> </th>
                <th scope="col" data-row="0" data-col="1">ebitda_to_debt</th>
                <th scope="col" data-row="0" data-col="2">leverage</th>
                <th scope="col" data-row="0" data-col="3">net_worth</th>
                <th scope="col" data-row="0" data-col="4">net_profit_margin</th>
                <th scope="col" data-row="0" data-col="5">net_profit_vol</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">ebitda_to_debt</td>
                  <td data-row="1" data-col="1">1</td>
                  <td data-row="1" data-col="2">.</td>
                  <td data-row="1" data-col="3">.</td>
                  <td data-row="1" data-col="4">.</td>
                  <td data-row="1" data-col="5">.</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">leverage</td>
                  <td data-row="2" data-col="1">-.693</td>
                  <td data-row="2" data-col="2">1</td>
                  <td data-row="2" data-col="3">.</td>
                  <td data-row="2" data-col="4">.</td>
                  <td data-row="2" data-col="5">.</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">net_worth</td>
                  <td data-row="3" data-col="1">-.442</td>
                  <td data-row="3" data-col="2">.341</td>
                  <td data-row="3" data-col="3">1</td>
                  <td data-row="3" data-col="4">.</td>
                  <td data-row="3" data-col="5">.</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">net_profit_margin</td>
                  <td data-row="4" data-col="1">-.070</td>
                  <td data-row="4" data-col="2">.045</td>
                  <td data-row="4" data-col="3">-.005</td>
                  <td data-row="4" data-col="4">1</td>
                  <td data-row="4" data-col="5">.</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">net_profit_vol</td>
                  <td data-row="5" data-col="1">.027</td>
                  <td data-row="5" data-col="2">-.016</td>
                  <td data-row="5" data-col="3">.005</td>
                  <td data-row="5" data-col="4">.002</td>
                  <td data-row="5" data-col="5">1</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-corr-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Correlation Matrix of Candidate Variables
</figcaption>
</figure>
</div>
</div>
<p>Given that <code>leverage</code> and <code>ebitda_to_debt</code> have a high (negative) correlation (correlation = -0.693), we may consider removing one of them from the model. Since <code>ebitda_to_debt</code> has a higher IV (1.622 vs 1.012), we may choose to keep <code>ebitda_to_debt</code> and drop <code>leverage</code>.</p>
<p>The final set of selected variables after redundancy and correlation control is: <code>ebitda_to_debt</code>, <code>net_worth</code>, <code>net_profit_margin</code>, <code>net_profit_vol</code>.</p>
</section>
</section>
<section id="model-estimation-evaluation" class="level3 page-columns page-full" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="model-estimation-evaluation"><span class="header-section-number">3.4</span> Model estimation &amp; evaluation</h3>
<p>Notably, many different statistical models can be used for credit risk modeling. For demonstration purposes, we will focus on logistic regression given that our outcome variable <code>default</code> is binary.</p>
<section id="model-estimation" class="level4 page-columns page-full" data-number="3.4.1">
<h4 data-number="3.4.1" class="anchored" data-anchor-id="model-estimation"><span class="header-section-number">3.4.1</span> Model estimation</h4>
<p>Specifically, we fit a logistic regression model to the training data, where the outcome variable is <code>default</code> and the predictor variables are the selected features from <a href="#sec-variable-screening" class="quarto-xref">Section&nbsp;3.3</a>. The logistic regression model estimates the log-odds of default as a linear combination of the predictor variables. It can be expressed as:</p>
<p><span class="math display">\[
P(\text{default}=1|X) = \frac{1}{1 + e^{-(\beta^{T} X)}},
\]</span></p>
<p>where <span class="math inline">\(P(\text{default}=1|X)\)</span> is the probability of default given the vector of predictor variables <span class="math inline">\(X\)</span>, and <span class="math inline">\(\beta\)</span> is the vector of coefficients to be estimated.</p>
<p><a href="#tbl-logit-results" class="quarto-xref">Table&nbsp;7</a> reports the results of the logistic regression model using the training data and our selected features.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Fit logistic regression using selected variables after screening.</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build formula using final_vars</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>logit_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">"default ~"</span>, <span class="fu">paste</span>(final_vars, <span class="at">collapse =</span> <span class="st">" + "</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit logistic regression model on training data</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>logit_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> logit_formula,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> train_data,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>()</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">"Logistic Model"</span> <span class="ot">=</span> logit_fit),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="fu">c</span>(<span class="st">"*"</span> <span class="ot">=</span> <span class="fl">0.1</span>, <span class="st">"**"</span> <span class="ot">=</span> <span class="fl">0.05</span>, <span class="st">"***"</span> <span class="ot">=</span> <span class="fl">0.01</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">note =</span> <span class="st">"Standard errors in parentheses."</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_html</span>(<span class="at">class=</span><span class="st">"table table-borderless regtable"</span>, <span class="at">css_rule=</span>table_css)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-logit-results" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-logit-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_gzy7cqgopyjv0rrpp98o(i, j, css_id) {
          var table = document.getElementById("tinytable_gzy7cqgopyjv0rrpp98o");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_gzy7cqgopyjv0rrpp98o(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_gzy7cqgopyjv0rrpp98o");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '15', j: 1 },  ], css_id: 'tinytable_css_7g2f754g8z0zg23pri25',}, 
          { positions: [ { i: '10', j: 1 },  ], css_id: 'tinytable_css_8p4unh17hx5xnmwc6t25',}, 
          { positions: [ { i: '1', j: 1 }, { i: '2', j: 1 }, { i: '3', j: 1 }, { i: '4', j: 1 }, { i: '5', j: 1 }, { i: '6', j: 1 }, { i: '7', j: 1 }, { i: '8', j: 1 }, { i: '9', j: 1 }, { i: '14', j: 1 }, { i: '11', j: 1 }, { i: '12', j: 1 }, { i: '13', j: 1 },  ], css_id: 'tinytable_css_w6pqyz7kw6139vqub6ks',}, 
          { positions: [ { i: '0', j: 1 },  ], css_id: 'tinytable_css_2u4n9heh0oa9u6f86hmo',}, 
          { positions: [ { i: '15', j: 0 },  ], css_id: 'tinytable_css_9bcnpngrlj093o4wqcc9',}, 
          { positions: [ { i: '10', j: 0 },  ], css_id: 'tinytable_css_jxta1aliy8vf3k8o9wpt',}, 
          { positions: [ { i: '1', j: 0 }, { i: '2', j: 0 }, { i: '3', j: 0 }, { i: '4', j: 0 }, { i: '5', j: 0 }, { i: '6', j: 0 }, { i: '7', j: 0 }, { i: '8', j: 0 }, { i: '9', j: 0 }, { i: '14', j: 0 }, { i: '11', j: 0 }, { i: '12', j: 0 }, { i: '13', j: 0 },  ], css_id: 'tinytable_css_4orert679xqjp9mddv3u',}, 
          { positions: [ { i: '0', j: 0 },  ], css_id: 'tinytable_css_mz48mn99yzo3xa366qav',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_gzy7cqgopyjv0rrpp98o(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_7g2f754g8z0zg23pri25, .table th.tinytable_css_7g2f754g8z0zg23pri25 { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_8p4unh17hx5xnmwc6t25, .table th.tinytable_css_8p4unh17hx5xnmwc6t25 { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_w6pqyz7kw6139vqub6ks, .table th.tinytable_css_w6pqyz7kw6139vqub6ks { text-align: center; }
      .table td.tinytable_css_2u4n9heh0oa9u6f86hmo, .table th.tinytable_css_2u4n9heh0oa9u6f86hmo { text-align: center; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_9bcnpngrlj093o4wqcc9, .table th.tinytable_css_9bcnpngrlj093o4wqcc9 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_jxta1aliy8vf3k8o9wpt, .table th.tinytable_css_jxta1aliy8vf3k8o9wpt { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_4orert679xqjp9mddv3u, .table th.tinytable_css_4orert679xqjp9mddv3u { text-align: left; }
      .table td.tinytable_css_mz48mn99yzo3xa366qav, .table th.tinytable_css_mz48mn99yzo3xa366qav { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }

.regtable table {
  border-collapse: collapse;      /* removes default cell gaps */
  border-spacing: 0;
  font-size: 0.9rem;              /* relative, responsive */
}

.regtable caption {
  caption-side: top;
  font-weight: bold;
  color: black;
}

.regtable th,
.regtable td {
  font-weight: normal;            /* normal weight for data cells */
  line-height: 1;                 /* tight vertical spacing */
  padding: 0.2em 0.4em;           /* minimal padding for readability */
  white-space: nowrap;            /* no wrapping */
  margin: 0;                      /* avoid extra vertical gaps */
}

    </style>
    <div class="container">
      <table class="table table-borderless regtable" id="tinytable_gzy7cqgopyjv0rrpp98o" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0"> </th>
                <th scope="col" data-row="0" data-col="1">Logistic Model</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan="2">* p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01</td></tr>
<tr><td colspan="2">Standard errors in parentheses.</td></tr></tfoot>
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">(Intercept)</td>
                  <td data-row="1" data-col="1">1.547***</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0"></td>
                  <td data-row="2" data-col="1">(0.090)</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">ebitda_to_debt</td>
                  <td data-row="3" data-col="1">-6.777***</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0"></td>
                  <td data-row="4" data-col="1">(0.112)</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">net_worth</td>
                  <td data-row="5" data-col="1">-0.008***</td>
                </tr>
                <tr>
                  <td data-row="6" data-col="0"></td>
                  <td data-row="6" data-col="1">(0.000)</td>
                </tr>
                <tr>
                  <td data-row="7" data-col="0">net_profit_margin</td>
                  <td data-row="7" data-col="1">-7.147***</td>
                </tr>
                <tr>
                  <td data-row="8" data-col="0"></td>
                  <td data-row="8" data-col="1">(0.589)</td>
                </tr>
                <tr>
                  <td data-row="9" data-col="0">net_profit_vol</td>
                  <td data-row="9" data-col="1">6.705***</td>
                </tr>
                <tr>
                  <td data-row="10" data-col="0"></td>
                  <td data-row="10" data-col="1">(1.615)</td>
                </tr>
                <tr>
                  <td data-row="11" data-col="0">Num.Obs.</td>
                  <td data-row="11" data-col="1">80000</td>
                </tr>
                <tr>
                  <td data-row="12" data-col="0">AIC</td>
                  <td data-row="12" data-col="1">14177.5</td>
                </tr>
                <tr>
                  <td data-row="13" data-col="0">BIC</td>
                  <td data-row="13" data-col="1">14223.9</td>
                </tr>
                <tr>
                  <td data-row="14" data-col="0">Log.Lik.</td>
                  <td data-row="14" data-col="1">-7083.736</td>
                </tr>
                <tr>
                  <td data-row="15" data-col="0">RMSE</td>
                  <td data-row="15" data-col="1">0.15</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-logit-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Logistic Regression Results
</figcaption>
</figure>
</div>
</div>
</section>
<section id="performance-evaluation" class="level4 page-columns page-full" data-number="3.4.2">
<h4 data-number="3.4.2" class="anchored" data-anchor-id="performance-evaluation"><span class="header-section-number">3.4.2</span> Performance evaluation</h4>
<p>After estimating the model parameters, we can compute the <strong>AUC (Area Under the Curve)</strong> or the <strong>Gini score</strong> to evaluate the model’s discriminatory power.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;The Gini score is simply calculated as <span class="math inline">\(\text{Gini} = 2 \times AUC - 1\)</span> and bounded by 0 and 1. It is preferred over AUC because a random prediction will yield a Gini score of 0 as opposed to the AUC which will be 0.5.</p></div></div><p>Ideally, we want the model to achieve a sufficiently high Gini score. If the model’s performance is unsatisfactory, we may need to revisit the variable screening step to select different variables or consider alternative modeling techniques.</p>
<p>Based on the test data, we can evaluate the performance of our model (given by <a href="#tbl-logit-results" class="quarto-xref">Table&nbsp;7</a>) using the ROC curve and compute the AUC and Gini score.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Plot ROC curve and compute AUC/Gini using test data.</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Score test set with predicted PDs</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>test_data<span class="sc">$</span>pd_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_fit, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) ROC and AUC</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> test_data<span class="sc">$</span>default, <span class="at">predictor =</span> test_data<span class="sc">$</span>pd_hat, <span class="at">direction =</span> <span class="st">"&lt;"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">auc</span>(roc_obj))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>gini_val <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> auc_val <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Plot ROC with ggplot2</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>roc_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">fpr =</span> <span class="dv">1</span> <span class="sc">-</span> roc_obj<span class="sc">$</span>specificities,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">tpr =</span> roc_obj<span class="sc">$</span>sensitivities</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(roc_df, <span class="fu">aes</span>(<span class="at">x =</span> fpr, <span class="at">y =</span> tpr)) <span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">sprintf</span>(<span class="st">"ROC Curve (AUC = %.3f, Gini = %.3f)"</span>, auc_val, gini_val),</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"False Positive Rate"</span>,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"True Positive Rate"</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-roc-curve" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-roc-curve-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-roc-curve-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-roc-curve-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: ROC Curve with AUC and Gini Score
</figcaption>
</figure>
</div>
</div>
</div>
<p>Our model achieves a Gini score of 0.8039705, which is considered excellent. We now proceed to model calibration.</p>
</section>
</section>
<section id="calibration" class="level3 page-columns page-full" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="calibration"><span class="header-section-number">3.5</span> Calibration</h3>
<p>At this step, we have built a credit scoring model (a logistic model) that has good discriminatory power (Gini score of 0.8039705). However, the predicted PDs from the model are known to be <strong>point-in-time (PIT)</strong> estimates, meaning they reflect the borrower’s credit risk at a specific point in time. In recessions PIT PDs rise; in booms they fall.</p>
<p>For regulatory capital calculation, Basel III and APS 113 do not allow direct use of PIT PDs, because that would make capital requirements fluctuate too much with the cycle. Instead, banks must calibrate PDs to long-run averages of one-year default rates for each grade or pool. These are empirical averages that cover both benign and stressed periods.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;It is important to distinguish these from <strong>through-the-cycle (TTC)</strong> PDs, which are smoothed to be cycle-neutral and essentially fixed. Basel’s long-run PDs are not fully TTC; rather, they are a hybrid: more stable than PIT, but still anchored in actual long-run default experience and updated as history evolves.</p></div></div><p>In short:</p>
<ul>
<li>The logit model provides PIT PDs for rank-ordering.</li>
<li>Calibration maps them into rating grades with long-run average PDs.</li>
<li>These calibrated grade PDs are the inputs to the Basel IRB capital formula.</li>
</ul>
<section id="long-run-pd" class="level4" data-number="3.5.1">
<h4 data-number="3.5.1" class="anchored" data-anchor-id="long-run-pd"><span class="header-section-number">3.5.1</span> Long-run PD</h4>
<p>The long-run PDs assigned to each credit grade are used for regulatory capital calculations. APS 113 mandates that <mark>these long-run PDs must be based on the observed historical one-year default rate that is calculated as a simple average based on the number of borrowers or facilities, with a minimum historical observation period of five years</mark>.</p>
</section>
<section id="binning-calibration" class="level4 page-columns page-full" data-number="3.5.2">
<h4 data-number="3.5.2" class="anchored" data-anchor-id="binning-calibration"><span class="header-section-number">3.5.2</span> Binning calibration</h4>
<p>Because the predicted probabilities from the model are continuous values, they need to be mapped to discrete (internal) credit grades for which long-run PDs are estimated. This is where binning comes in, i.e., grouping the continuous model outputs into a set of intervals (bins), each corresponding to a credit grade. The choice of bin edges can be based on quantiles of the predicted PD distribution or based on business considerations.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>In a narrow sense, calibration refers to the process of determining the bin edges and assigning long-run PDs to each bin.</p>
</div>
</div>
</div>
<p>Suppose we have created the following calibrated rating table, where we decide:</p>
<ol type="1">
<li>the range of PIT PDs for each credit grade, and</li>
<li>the long-run PD assigned for each credit grade.</li>
</ol>
<div id="tbl-calibrated-rating" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-calibrated-rating-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 27%">
<col style="width: 42%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>Grade</th>
<th>Description</th>
<th>PIT PD range (model output)</th>
<th>Long-run PD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AAA</td>
<td>Prime</td>
<td>0.00% – 0.05%</td>
<td>0.00%</td>
</tr>
<tr class="even">
<td>AA</td>
<td>Very strong</td>
<td>0.05% – 0.10%</td>
<td>0.07%</td>
</tr>
<tr class="odd">
<td>A</td>
<td>Strong</td>
<td>0.10% – 0.25%</td>
<td>0.20%</td>
</tr>
<tr class="even">
<td>BBB</td>
<td>Satisfactory</td>
<td>0.25% – 0.75%</td>
<td>0.60%</td>
</tr>
<tr class="odd">
<td>BB</td>
<td>Weak</td>
<td>0.75% – 2.00%</td>
<td>1.50%</td>
</tr>
<tr class="even">
<td>B</td>
<td>Very weak</td>
<td>2.00% – 5.00%</td>
<td>3.50%</td>
</tr>
<tr class="odd">
<td>CCC</td>
<td>Distressed</td>
<td>5.00% – 15.0%</td>
<td>10.0%</td>
</tr>
<tr class="even">
<td>CC</td>
<td>Highly distressed</td>
<td>15.0% – 25.0%</td>
<td>25.0%</td>
</tr>
<tr class="odd">
<td>C</td>
<td>Near default</td>
<td>&gt;= 25.0%</td>
<td>30.0%</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-calibrated-rating-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Calibrated Rating Table
</figcaption>
</figure>
</div>
<div class="callout callout-style-simple callout-caution">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Notably, the long-run PDs in this table match the historical one-year default rates observed for each credit grade in <a href="#tbl-grade-dist" class="quarto-xref">Table&nbsp;3</a>. This largely aligns with the requirements set forth in APS 113. On the other hand, APS 113 requires a minimum PD of 0.05% in calculating capital requirements, which is not reflected in this table.</p>
<p>In practice, however, banks may need to adjust these long-run PDs based on their internal risk assessments and the specific characteristics of their credit portfolios. Here we used only the simple average based on our chosen sample.</p>
</div>
</div>
</div>
</section>
</section>
<section id="validation" class="level3 page-columns page-full" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="validation"><span class="header-section-number">3.6</span> Validation</h3>
<section id="transition-matrix-analysis" class="level4 page-columns page-full" data-number="3.6.1">
<h4 data-number="3.6.1" class="anchored" data-anchor-id="transition-matrix-analysis"><span class="header-section-number">3.6.1</span> Transition matrix analysis</h4>
<p>Transition matrix analysis involves examining the changes in credit ratings over time. This can help assess the stability of the credit grades assigned to borrowers and the performance of the credit scoring model.</p>
<p>In the context of developing a credit scoring model, transition matrix can be used to study how credit grades change using the new model compared to the old model. This can help identify any significant shifts in credit ratings and assess the impact of the new model on the bank’s credit portfolio.</p>
<p>If the new model results in a significant change in credit ratings of existing borrowers, it may prompt a review of the underlying factors driving these changes and potential adjustments to the model.</p>
<p>Comparing the old ratings (assigned under the previous model, given in the data) with the new ratings, <a href="#tbl-transition-matrix" class="quarto-xref">Table&nbsp;9</a> shows the transition matrix as percentages. The diagonal cells (in bold) represent borrowers whose ratings remain unchanged, while the off-diagonal cells represent borrowers whose ratings have changed.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Tabulate transition matrix comparing original and new model ratings.</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Define the calibrated PIT PD bin edges and grade labels (from the calibrated table)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>calib_rating_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"AAA"</span>, <span class="st">"AA"</span>, <span class="st">"A"</span>, <span class="st">"BBB"</span>, <span class="st">"BB"</span>, <span class="st">"B"</span>, <span class="st">"CCC"</span>, <span class="st">"CC"</span>, <span class="st">"C"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>calib_pd_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.0005</span>, <span class="fl">0.001</span>, <span class="fl">0.002</span>, <span class="fl">0.007</span>, <span class="fl">0.02</span>, <span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.25</span>, <span class="dv">1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Score all observations with the fitted logistic model to get new PIT PDs</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>credit_data<span class="sc">$</span>pd_pit_new <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_fit, <span class="at">newdata =</span> credit_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Assign new ratings based on the calibrated PIT PD bins</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>credit_data<span class="sc">$</span>rating_new <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  credit_data<span class="sc">$</span>pd_pit_new,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> calib_pd_breaks,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> calib_rating_labels,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">right =</span> <span class="cn">TRUE</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Tabulate the transition matrix: old (rows) vs new (columns), as proportions</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>transition_mat <span class="ot">&lt;-</span> <span class="fu">table</span>(</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Old Rating"</span> <span class="ot">=</span> credit_data<span class="sc">$</span>rating,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"New Rating"</span> <span class="ot">=</span> credit_data<span class="sc">$</span>rating_new</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>transition_prop <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(transition_mat, <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Convert to data frame for display, add vertical header</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>transition_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(transition_prop)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>transition_df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(transition_df, <span class="at">var =</span> <span class="st">"Old Rating"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rename</span>(<span class="st">"Rating"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Old Rating</span><span class="st">`</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Display as a formatted table (vertical and horizontal headers, proportions)</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(transition_df)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>tbl <span class="ot">&lt;-</span> modelsummary<span class="sc">::</span><span class="fu">datasummary_df</span>(transition_df)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the max value for scaling</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>max_val <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>min_val <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute color shade based on value (higher = darker teal)</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>get_teal_shade <span class="ot">&lt;-</span> <span class="cf">function</span>(val, min_val, max_val) {</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Scale value between 0.2 (light) and 1 (dark)</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="cf">if</span> (max_val <span class="sc">&gt;</span> min_val) (val <span class="sc">-</span> min_val) <span class="sc">/</span> (max_val <span class="sc">-</span> min_val) <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use a fixed set of teal shades (from light to dark)</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We'll interpolate between two colors</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  light_teal <span class="ot">&lt;-</span> grDevices<span class="sc">::</span><span class="fu">col2rgb</span>(<span class="st">"#e0f7fa"</span>) <span class="co"># light teal</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  dark_teal <span class="ot">&lt;-</span> grDevices<span class="sc">::</span><span class="fu">col2rgb</span>(<span class="st">"#008080"</span>)  <span class="co"># dark teal</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  rgb_val <span class="ot">&lt;-</span> <span class="fu">round</span>(light_teal <span class="sc">+</span> (dark_teal <span class="sc">-</span> light_teal) <span class="sc">*</span> alpha)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rgb</span>(rgb_val[<span class="dv">1</span>], rgb_val[<span class="dv">2</span>], rgb_val[<span class="dv">3</span>], <span class="at">maxColorValue =</span> <span class="dv">255</span>)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Style diagonal and off-diagonal cells based on value</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(n)) {</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n<span class="sc">+</span><span class="dv">1</span>)) {</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    val <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(transition_df[i, j])</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    bg_col <span class="ot">&lt;-</span> <span class="fu">get_teal_shade</span>(val, min_val, max_val)</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    bold <span class="ot">&lt;-</span> <span class="cf">if</span> (i <span class="sc">==</span> (j<span class="dv">-1</span>)) <span class="cn">TRUE</span> <span class="cf">else</span> <span class="cn">FALSE</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    tbl <span class="ot">&lt;-</span> <span class="fu">style_tt</span>(tbl, <span class="at">i =</span> i, <span class="at">j =</span> j, <span class="at">background =</span> bg_col, <span class="at">bold =</span> bold)</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>tbl <span class="sc">|&gt;</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_html</span>(<span class="at">class=</span><span class="st">"table table-borderless regtable"</span>, <span class="at">css_rule=</span>table_css)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-transition-matrix" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-transition-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_t4fbznkf7w0oshk6yp4n(i, j, css_id) {
          var table = document.getElementById("tinytable_t4fbznkf7w0oshk6yp4n");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_t4fbznkf7w0oshk6yp4n(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_t4fbznkf7w0oshk6yp4n");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '9', j: 9 },  ], css_id: 'tinytable_css_4cblxtl3k3zjvpqwgmlo',}, 
          { positions: [ { i: '8', j: 9 },  ], css_id: 'tinytable_css_s7sy9hqvcswdlxoorlke',}, 
          { positions: [ { i: '9', j: 8 },  ], css_id: 'tinytable_css_5x973xdebb3gh8dmnd2e',}, 
          { positions: [ { i: '8', j: 8 },  ], css_id: 'tinytable_css_6v033rmeklmuq89llvx4',}, 
          { positions: [ { i: '7', j: 8 },  ], css_id: 'tinytable_css_ba4ajrc4dudiv4j9rfm6',}, 
          { positions: [ { i: '8', j: 7 },  ], css_id: 'tinytable_css_psdpswx4bj8ww5hsdn5l',}, 
          { positions: [ { i: '7', j: 7 },  ], css_id: 'tinytable_css_y6x8xv5c5fimbang3np7',}, 
          { positions: [ { i: '6', j: 7 },  ], css_id: 'tinytable_css_cjvdtthy1a04863z046b',}, 
          { positions: [ { i: '7', j: 6 },  ], css_id: 'tinytable_css_uxesrx4ibg7scyai0fdw',}, 
          { positions: [ { i: '6', j: 6 },  ], css_id: 'tinytable_css_jueey98c97emx8298a5c',}, 
          { positions: [ { i: '5', j: 6 },  ], css_id: 'tinytable_css_hcg9mr7yk307nz0w0zem',}, 
          { positions: [ { i: '6', j: 5 },  ], css_id: 'tinytable_css_2498hdqn2tpqxapvlmq1',}, 
          { positions: [ { i: '5', j: 5 },  ], css_id: 'tinytable_css_5s7yw2jeuy5d5e6i76nq',}, 
          { positions: [ { i: '4', j: 5 },  ], css_id: 'tinytable_css_5htw034ga71elrfpb9sp',}, 
          { positions: [ { i: '5', j: 4 },  ], css_id: 'tinytable_css_q6oxehinoy68nis4h2ue',}, 
          { positions: [ { i: '4', j: 4 },  ], css_id: 'tinytable_css_mk07r7npdkgo7qbtqoux',}, 
          { positions: [ { i: '3', j: 4 },  ], css_id: 'tinytable_css_n7vlucmhxl0aj45eslow',}, 
          { positions: [ { i: '4', j: 3 },  ], css_id: 'tinytable_css_5t40eqz1px6rq14wdvyd',}, 
          { positions: [ { i: '3', j: 3 },  ], css_id: 'tinytable_css_n3c8mwy2s6ampqgf2o0j',}, 
          { positions: [ { i: '2', j: 3 },  ], css_id: 'tinytable_css_c9mz50cjoh708l779fei',}, 
          { positions: [ { i: '4', j: 2 },  ], css_id: 'tinytable_css_uq345kauo8ufa3qs5xr1',}, 
          { positions: [ { i: '3', j: 2 },  ], css_id: 'tinytable_css_4zq3b2jqz5ti3gkbjtxh',}, 
          { positions: [ { i: '2', j: 2 },  ], css_id: 'tinytable_css_x44iudhqziwciyjcbgll',}, 
          { positions: [ { i: '1', j: 2 },  ], css_id: 'tinytable_css_3m6yws7kte04vyqox7gv',}, 
          { positions: [ { i: '9', j: 3 }, { i: '9', j: 4 }, { i: '9', j: 1 }, { i: '9', j: 5 }, { i: '9', j: 6 }, { i: '9', j: 7 }, { i: '9', j: 2 },  ], css_id: 'tinytable_css_24sihxc0xxwfhniwyrl4',}, 
          { positions: [ { i: '8', j: 5 }, { i: '5', j: 3 }, { i: '6', j: 3 }, { i: '6', j: 1 }, { i: '6', j: 2 }, { i: '4', j: 1 }, { i: '5', j: 1 }, { i: '2', j: 4 }, { i: '7', j: 1 }, { i: '8', j: 1 }, { i: '1', j: 7 }, { i: '6', j: 4 }, { i: '7', j: 4 }, { i: '8', j: 4 }, { i: '2', j: 6 }, { i: '7', j: 3 }, { i: '5', j: 2 }, { i: '2', j: 5 }, { i: '7', j: 2 }, { i: '8', j: 2 }, { i: '8', j: 6 }, { i: '2', j: 8 }, { i: '1', j: 3 }, { i: '4', j: 8 }, { i: '2', j: 7 }, { i: '3', j: 7 }, { i: '1', j: 6 }, { i: '5', j: 7 }, { i: '3', j: 6 }, { i: '8', j: 3 }, { i: '1', j: 9 }, { i: '3', j: 5 }, { i: '1', j: 4 }, { i: '1', j: 8 }, { i: '5', j: 9 }, { i: '7', j: 5 }, { i: '7', j: 9 }, { i: '5', j: 8 }, { i: '6', j: 8 }, { i: '4', j: 7 }, { i: '2', j: 9 }, { i: '3', j: 9 }, { i: '1', j: 5 }, { i: '4', j: 6 }, { i: '3', j: 8 }, { i: '6', j: 9 }, { i: '4', j: 9 },  ], css_id: 'tinytable_css_lym9oyb9ceqa6tx6t8q6',}, 
          { positions: [ { i: '3', j: 1 },  ], css_id: 'tinytable_css_36e0tf3hnjcim9vrc4ky',}, 
          { positions: [ { i: '2', j: 1 },  ], css_id: 'tinytable_css_5pcd9zg1lkxgl0b2b2gs',}, 
          { positions: [ { i: '1', j: 1 },  ], css_id: 'tinytable_css_fqzetw7vckeh13a5c5t1',}, 
          { positions: [ { i: '9', j: 0 },  ], css_id: 'tinytable_css_0uxlww6s3ooc3pcl1fp6',}, 
          { positions: [ { i: '4', j: 0 }, { i: '6', j: 0 }, { i: '3', j: 0 }, { i: '8', j: 0 }, { i: '1', j: 0 }, { i: '2', j: 0 }, { i: '7', j: 0 }, { i: '5', j: 0 },  ], css_id: 'tinytable_css_tgrklp11x0q8fb5ka9ls',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 4 }, { i: '0', j: 8 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 7 }, { i: '0', j: 1 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 9 },  ], css_id: 'tinytable_css_jdqlb825dkxx47qkvb0a',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_t4fbznkf7w0oshk6yp4n(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_4cblxtl3k3zjvpqwgmlo, .table th.tinytable_css_4cblxtl3k3zjvpqwgmlo { text-align: left; font-weight: bold; background-color: #038181; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_s7sy9hqvcswdlxoorlke, .table th.tinytable_css_s7sy9hqvcswdlxoorlke { text-align: left; background-color: #80C4C6; }
      .table td.tinytable_css_5x973xdebb3gh8dmnd2e, .table th.tinytable_css_5x973xdebb3gh8dmnd2e { text-align: left; background-color: #DDF6F9; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_6v033rmeklmuq89llvx4, .table th.tinytable_css_6v033rmeklmuq89llvx4 { text-align: left; font-weight: bold; background-color: #67B7B8; }
      .table td.tinytable_css_ba4ajrc4dudiv4j9rfm6, .table th.tinytable_css_ba4ajrc4dudiv4j9rfm6 { text-align: left; background-color: #B5E0E3; }
      .table td.tinytable_css_psdpswx4bj8ww5hsdn5l, .table th.tinytable_css_psdpswx4bj8ww5hsdn5l { text-align: left; background-color: #D8F3F6; }
      .table td.tinytable_css_y6x8xv5c5fimbang3np7, .table th.tinytable_css_y6x8xv5c5fimbang3np7 { text-align: left; font-weight: bold; background-color: #389E9E; }
      .table td.tinytable_css_cjvdtthy1a04863z046b, .table th.tinytable_css_cjvdtthy1a04863z046b { text-align: left; background-color: #C8EAED; }
      .table td.tinytable_css_uxesrx4ibg7scyai0fdw, .table th.tinytable_css_uxesrx4ibg7scyai0fdw { text-align: left; background-color: #D3F0F3; }
      .table td.tinytable_css_jueey98c97emx8298a5c, .table th.tinytable_css_jueey98c97emx8298a5c { text-align: left; font-weight: bold; background-color: #369D9E; }
      .table td.tinytable_css_hcg9mr7yk307nz0w0zem, .table th.tinytable_css_hcg9mr7yk307nz0w0zem { text-align: left; background-color: #D6F2F4; }
      .table td.tinytable_css_2498hdqn2tpqxapvlmq1, .table th.tinytable_css_2498hdqn2tpqxapvlmq1 { text-align: left; background-color: #C2E7EA; }
      .table td.tinytable_css_5s7yw2jeuy5d5e6i76nq, .table th.tinytable_css_5s7yw2jeuy5d5e6i76nq { text-align: left; font-weight: bold; background-color: #319A9B; }
      .table td.tinytable_css_5htw034ga71elrfpb9sp, .table th.tinytable_css_5htw034ga71elrfpb9sp { text-align: left; background-color: #DBF5F7; }
      .table td.tinytable_css_q6oxehinoy68nis4h2ue, .table th.tinytable_css_q6oxehinoy68nis4h2ue { text-align: left; background-color: #B9E2E5; }
      .table td.tinytable_css_mk07r7npdkgo7qbtqoux, .table th.tinytable_css_mk07r7npdkgo7qbtqoux { text-align: left; font-weight: bold; background-color: #2D9899; }
      .table td.tinytable_css_n7vlucmhxl0aj45eslow, .table th.tinytable_css_n7vlucmhxl0aj45eslow { text-align: left; background-color: #D9F3F6; }
      .table td.tinytable_css_5t40eqz1px6rq14wdvyd, .table th.tinytable_css_5t40eqz1px6rq14wdvyd { text-align: left; background-color: #B8E2E4; }
      .table td.tinytable_css_n3c8mwy2s6ampqgf2o0j, .table th.tinytable_css_n3c8mwy2s6ampqgf2o0j { text-align: left; font-weight: bold; background-color: #58AFB0; }
      .table td.tinytable_css_c9mz50cjoh708l779fei, .table th.tinytable_css_c9mz50cjoh708l779fei { text-align: left; background-color: #D4F1F4; }
      .table td.tinytable_css_uq345kauo8ufa3qs5xr1, .table th.tinytable_css_uq345kauo8ufa3qs5xr1 { text-align: left; background-color: #DFF7FA; }
      .table td.tinytable_css_4zq3b2jqz5ti3gkbjtxh, .table th.tinytable_css_4zq3b2jqz5ti3gkbjtxh { text-align: left; background-color: #92CECF; }
      .table td.tinytable_css_x44iudhqziwciyjcbgll, .table th.tinytable_css_x44iudhqziwciyjcbgll { text-align: left; font-weight: bold; background-color: #57AEAF; }
      .table td.tinytable_css_3m6yws7kte04vyqox7gv, .table th.tinytable_css_3m6yws7kte04vyqox7gv { text-align: left; background-color: #DDF5F8; }
      .table td.tinytable_css_24sihxc0xxwfhniwyrl4, .table th.tinytable_css_24sihxc0xxwfhniwyrl4 { text-align: left; background-color: #E0F7FA; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_lym9oyb9ceqa6tx6t8q6, .table th.tinytable_css_lym9oyb9ceqa6tx6t8q6 { text-align: left; background-color: #E0F7FA; }
      .table td.tinytable_css_36e0tf3hnjcim9vrc4ky, .table th.tinytable_css_36e0tf3hnjcim9vrc4ky { text-align: left; background-color: #DEF6F9; }
      .table td.tinytable_css_5pcd9zg1lkxgl0b2b2gs, .table th.tinytable_css_5pcd9zg1lkxgl0b2b2gs { text-align: left; background-color: #95CFD1; }
      .table td.tinytable_css_fqzetw7vckeh13a5c5t1, .table th.tinytable_css_fqzetw7vckeh13a5c5t1 { text-align: left; font-weight: bold; background-color: #038282; }
      .table td.tinytable_css_0uxlww6s3ooc3pcl1fp6, .table th.tinytable_css_0uxlww6s3ooc3pcl1fp6 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_tgrklp11x0q8fb5ka9ls, .table th.tinytable_css_tgrklp11x0q8fb5ka9ls { text-align: left; }
      .table td.tinytable_css_jdqlb825dkxx47qkvb0a, .table th.tinytable_css_jdqlb825dkxx47qkvb0a { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }

.regtable table {
  border-collapse: collapse;      /* removes default cell gaps */
  border-spacing: 0;
  font-size: 0.9rem;              /* relative, responsive */
}

.regtable caption {
  caption-side: top;
  font-weight: bold;
  color: black;
}

.regtable th,
.regtable td {
  font-weight: normal;            /* normal weight for data cells */
  line-height: 1;                 /* tight vertical spacing */
  padding: 0.2em 0.4em;           /* minimal padding for readability */
  white-space: nowrap;            /* no wrapping */
  margin: 0;                      /* avoid extra vertical gaps */
}

    </style>
    <div class="container">
      <table class="table table-borderless regtable" id="tinytable_t4fbznkf7w0oshk6yp4n" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">Rating</th>
                <th scope="col" data-row="0" data-col="1">AAA</th>
                <th scope="col" data-row="0" data-col="2">AA</th>
                <th scope="col" data-row="0" data-col="3">A</th>
                <th scope="col" data-row="0" data-col="4">BBB</th>
                <th scope="col" data-row="0" data-col="5">BB</th>
                <th scope="col" data-row="0" data-col="6">B</th>
                <th scope="col" data-row="0" data-col="7">CCC</th>
                <th scope="col" data-row="0" data-col="8">CC</th>
                <th scope="col" data-row="0" data-col="9">C</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">AAA</td>
                  <td data-row="1" data-col="1">98.70</td>
                  <td data-row="1" data-col="2">1.30</td>
                  <td data-row="1" data-col="3">0.00</td>
                  <td data-row="1" data-col="4">0.00</td>
                  <td data-row="1" data-col="5">0.00</td>
                  <td data-row="1" data-col="6">0.00</td>
                  <td data-row="1" data-col="7">0.00</td>
                  <td data-row="1" data-col="8">0.00</td>
                  <td data-row="1" data-col="9">0.00</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">AA</td>
                  <td data-row="2" data-col="1">33.60</td>
                  <td data-row="2" data-col="2">61.18</td>
                  <td data-row="2" data-col="3">5.22</td>
                  <td data-row="2" data-col="4">0.00</td>
                  <td data-row="2" data-col="5">0.00</td>
                  <td data-row="2" data-col="6">0.00</td>
                  <td data-row="2" data-col="7">0.00</td>
                  <td data-row="2" data-col="8">0.00</td>
                  <td data-row="2" data-col="9">0.00</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">A</td>
                  <td data-row="3" data-col="1">1.01</td>
                  <td data-row="3" data-col="2">34.87</td>
                  <td data-row="3" data-col="3">60.91</td>
                  <td data-row="3" data-col="4">3.22</td>
                  <td data-row="3" data-col="5">0.00</td>
                  <td data-row="3" data-col="6">0.00</td>
                  <td data-row="3" data-col="7">0.00</td>
                  <td data-row="3" data-col="8">0.00</td>
                  <td data-row="3" data-col="9">0.00</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">BBB</td>
                  <td data-row="4" data-col="1">0.00</td>
                  <td data-row="4" data-col="2">0.22</td>
                  <td data-row="4" data-col="3">17.99</td>
                  <td data-row="4" data-col="4">79.70</td>
                  <td data-row="4" data-col="5">2.08</td>
                  <td data-row="4" data-col="6">0.00</td>
                  <td data-row="4" data-col="7">0.00</td>
                  <td data-row="4" data-col="8">0.00</td>
                  <td data-row="4" data-col="9">0.00</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">BB</td>
                  <td data-row="5" data-col="1">0.00</td>
                  <td data-row="5" data-col="2">0.00</td>
                  <td data-row="5" data-col="3">0.00</td>
                  <td data-row="5" data-col="4">17.28</td>
                  <td data-row="5" data-col="5">78.19</td>
                  <td data-row="5" data-col="6">4.54</td>
                  <td data-row="5" data-col="7">0.00</td>
                  <td data-row="5" data-col="8">0.00</td>
                  <td data-row="5" data-col="9">0.00</td>
                </tr>
                <tr>
                  <td data-row="6" data-col="0">B</td>
                  <td data-row="6" data-col="1">0.00</td>
                  <td data-row="6" data-col="2">0.00</td>
                  <td data-row="6" data-col="3">0.00</td>
                  <td data-row="6" data-col="4">0.00</td>
                  <td data-row="6" data-col="5">13.49</td>
                  <td data-row="6" data-col="6">75.70</td>
                  <td data-row="6" data-col="7">10.81</td>
                  <td data-row="6" data-col="8">0.00</td>
                  <td data-row="6" data-col="9">0.00</td>
                </tr>
                <tr>
                  <td data-row="7" data-col="0">CCC</td>
                  <td data-row="7" data-col="1">0.00</td>
                  <td data-row="7" data-col="2">0.00</td>
                  <td data-row="7" data-col="3">0.00</td>
                  <td data-row="7" data-col="4">0.00</td>
                  <td data-row="7" data-col="5">0.00</td>
                  <td data-row="7" data-col="6">5.73</td>
                  <td data-row="7" data-col="7">75.07</td>
                  <td data-row="7" data-col="8">19.05</td>
                  <td data-row="7" data-col="9">0.15</td>
                </tr>
                <tr>
                  <td data-row="8" data-col="0">CC</td>
                  <td data-row="8" data-col="1">0.00</td>
                  <td data-row="8" data-col="2">0.00</td>
                  <td data-row="8" data-col="3">0.00</td>
                  <td data-row="8" data-col="4">0.00</td>
                  <td data-row="8" data-col="5">0.00</td>
                  <td data-row="8" data-col="6">0.00</td>
                  <td data-row="8" data-col="7">3.48</td>
                  <td data-row="8" data-col="8">53.88</td>
                  <td data-row="8" data-col="9">42.64</td>
                </tr>
                <tr>
                  <td data-row="9" data-col="0">C</td>
                  <td data-row="9" data-col="1">0.00</td>
                  <td data-row="9" data-col="2">0.00</td>
                  <td data-row="9" data-col="3">0.00</td>
                  <td data-row="9" data-col="4">0.00</td>
                  <td data-row="9" data-col="5">0.00</td>
                  <td data-row="9" data-col="6">0.00</td>
                  <td data-row="9" data-col="7">0.00</td>
                  <td data-row="9" data-col="8">1.13</td>
                  <td data-row="9" data-col="9">98.87</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-transition-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Transition Matrix
</figcaption>
</figure>
</div>
</div>
<p>Based on <a href="#tbl-transition-matrix" class="quarto-xref">Table&nbsp;9</a>, we can observe that the new model has resulted in some changes. It seems to be more optimistic for borrowers with previously higher ratings, and more conservative for those with lower ratings. Let’s assume that this level of rating change is acceptable to the bank.</p>
</section>
<section id="rwa-impact-analysis" class="level4 page-columns page-full" data-number="3.6.2">
<h4 data-number="3.6.2" class="anchored" data-anchor-id="rwa-impact-analysis"><span class="header-section-number">3.6.2</span> RWA impact analysis</h4>
<p>Finally, banks need to assess the impact of the new credit scoring model on the calculation of risk-weighted assets (RWA) for regulatory capital purposes. This involves comparing the RWA calculated using the new model with that calculated using the old model.</p>
<p>If the new model results in a significant increase in RWA, it may indicate that the model is more conservative and may require higher capital reserves. Conversely, if the new model results in a significant decrease in RWA, it may indicate that the model is less conservative and may require lower capital reserves. If the impact on RWA is deemed unacceptable, banks may need to revisit the model development process, including variable selection, model estimation, and calibration.</p>
<div class="callout callout-style-simple callout-note callout-titled" title="Assumptions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Assumptions
</div>
</div>
<div class="callout-body-container callout-body">
<p>For simplicity, assume a LGD (Loss Given Default) of 20% for all exposures in our sample. We also assume that the EAD (Exposure at Default) is equal to the loan amount, and the maturity (M) is equal to the term in years. The asset value correlation multiplier (AVCM) is set to 1.</p>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Calculate and compare RWA using old and new ratings and long-run PDs.</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- IRB RWA function (from eq-rwa-func) ---</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>irb_rwa <span class="ot">&lt;-</span> <span class="cf">function</span>(PD, LGD, EAD, M, <span class="at">AVCM =</span> <span class="dv">1</span>) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  PD <span class="ot">&lt;-</span> <span class="fu">pmax</span>(PD, <span class="fl">0.0005</span>) <span class="co"># Minimum PD is 0.05%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> AVCM <span class="sc">*</span> (<span class="fl">0.12</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">50</span> <span class="sc">*</span> PD)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">50</span>)) <span class="sc">+</span> <span class="fl">0.24</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">50</span> <span class="sc">*</span> PD)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">50</span>))))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> (<span class="fl">0.11852</span> <span class="sc">-</span> <span class="fl">0.05478</span> <span class="sc">*</span> <span class="fu">log</span>(PD))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  term <span class="ot">&lt;-</span> (<span class="fu">qnorm</span>(PD) <span class="sc">+</span> <span class="fu">sqrt</span>(R) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="fl">0.999</span>)) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> R)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">&lt;-</span> (LGD <span class="sc">*</span> <span class="fu">pnorm</span>(term) <span class="sc">-</span> PD <span class="sc">*</span> LGD) <span class="sc">*</span> ((<span class="dv">1</span> <span class="sc">+</span> (M <span class="sc">-</span> <span class="fl">2.5</span>) <span class="sc">*</span> b) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> b))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  K_adj <span class="ot">&lt;-</span> <span class="fu">pmax</span>(K, <span class="dv">0</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  RWA <span class="ot">&lt;-</span> K_adj <span class="sc">*</span> <span class="fl">12.5</span> <span class="sc">*</span> EAD</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(RWA)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Long-run PDs for each grade (from calibrated table) ---</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>calib_rating_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"AAA"</span>, <span class="st">"AA"</span>, <span class="st">"A"</span>, <span class="st">"BBB"</span>, <span class="st">"BB"</span>, <span class="st">"B"</span>, <span class="st">"CCC"</span>, <span class="st">"CC"</span>, <span class="st">"C"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>long_run_pd_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">rating =</span> calib_rating_labels,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">long_run_pd =</span> <span class="fu">c</span>(<span class="fl">0.0000</span>, <span class="fl">0.0007</span>, <span class="fl">0.0020</span>, <span class="fl">0.0060</span>, <span class="fl">0.0150</span>, <span class="fl">0.0350</span>, <span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.30</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Assign long-run PDs to each loan for old and new ratings ---</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>credit_data<span class="sc">$</span>pd_old <span class="ot">&lt;-</span> long_run_pd_table<span class="sc">$</span>long_run_pd[<span class="fu">match</span>(credit_data<span class="sc">$</span>rating, long_run_pd_table<span class="sc">$</span>rating)]</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>credit_data<span class="sc">$</span>pd_new <span class="ot">&lt;-</span> long_run_pd_table<span class="sc">$</span>long_run_pd[<span class="fu">match</span>(credit_data<span class="sc">$</span>rating_new, long_run_pd_table<span class="sc">$</span>rating)]</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate maturity year for each loan</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>credit_data<span class="sc">$</span>maturity_year <span class="ot">&lt;-</span> credit_data<span class="sc">$</span>year_borrowed <span class="sc">+</span> <span class="fu">ceiling</span>(credit_data<span class="sc">$</span>term_months <span class="sc">/</span> <span class="dv">12</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for loans not yet matured as of current_year</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>active_loans <span class="ot">&lt;-</span> credit_data <span class="sc">|&gt;</span> <span class="fu">filter</span>(maturity_year <span class="sc">&gt;=</span> current_year)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Calculate RWA for old and new ratings (active loans only) ---</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>LGD <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>EAD <span class="ot">&lt;-</span> active_loans<span class="sc">$</span>amount_in_thousands <span class="sc">*</span> <span class="dv">1000</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> active_loans<span class="sc">$</span>term_months <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>AVCM <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>active_loans<span class="sc">$</span>rwa_old <span class="ot">&lt;-</span> <span class="fu">irb_rwa</span>(<span class="at">PD =</span> active_loans<span class="sc">$</span>pd_old, <span class="at">LGD =</span> LGD, <span class="at">EAD =</span> EAD, <span class="at">M =</span> M, <span class="at">AVCM =</span> AVCM)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>active_loans<span class="sc">$</span>rwa_new <span class="ot">&lt;-</span> <span class="fu">irb_rwa</span>(<span class="at">PD =</span> active_loans<span class="sc">$</span>pd_new, <span class="at">LGD =</span> LGD, <span class="at">EAD =</span> EAD, <span class="at">M =</span> M, <span class="at">AVCM =</span> AVCM)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Tabulate total RWA by old and new ratings (active loans only) ---</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Save total RWA for old and new models in variables</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>total_rwa_old <span class="ot">&lt;-</span> <span class="fu">sum</span>(active_loans<span class="sc">$</span>rwa_old, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>total_rwa_new <span class="ot">&lt;-</span> <span class="fu">sum</span>(active_loans<span class="sc">$</span>rwa_new, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>total_loans <span class="ot">&lt;-</span> <span class="fu">sum</span>(active_loans<span class="sc">$</span>amount_in_thousands <span class="sc">*</span> <span class="dv">1000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">Scenario =</span> <span class="fu">c</span>(<span class="st">"Old Model"</span>, <span class="st">"New Model"</span>),</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Total Active Loans</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(total_loans, total_loans),</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Total RWA</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(total_rwa_old, total_rwa_new)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total Active Loans</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format</span>(<span class="st">`</span><span class="at">Total Active Loans</span><span class="st">`</span>, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total RWA</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format</span>(<span class="st">`</span><span class="at">Total RWA</span><span class="st">`</span>, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  modelsummary<span class="sc">::</span><span class="fu">datasummary_df</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-rwa-impact" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-rwa-impact-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_lejwexzuq6jtmznosbm4(i, j, css_id) {
          var table = document.getElementById("tinytable_lejwexzuq6jtmznosbm4");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_lejwexzuq6jtmznosbm4(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_lejwexzuq6jtmznosbm4");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '2', j: 1 }, { i: '2', j: 0 }, { i: '2', j: 2 },  ], css_id: 'tinytable_css_38ldiv2d96ivc71dc45r',}, 
          { positions: [ { i: '1', j: 0 }, { i: '1', j: 1 }, { i: '1', j: 2 },  ], css_id: 'tinytable_css_udwvgjin6o7hp6wl9dji',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 2 }, { i: '0', j: 1 },  ], css_id: 'tinytable_css_pcvj8b831ndxd5vz4pzb',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_lejwexzuq6jtmznosbm4(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_38ldiv2d96ivc71dc45r, .table th.tinytable_css_38ldiv2d96ivc71dc45r { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_udwvgjin6o7hp6wl9dji, .table th.tinytable_css_udwvgjin6o7hp6wl9dji { text-align: left; }
      .table td.tinytable_css_pcvj8b831ndxd5vz4pzb, .table th.tinytable_css_pcvj8b831ndxd5vz4pzb { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_lejwexzuq6jtmznosbm4" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">Scenario</th>
                <th scope="col" data-row="0" data-col="1">Total Active Loans</th>
                <th scope="col" data-row="0" data-col="2">Total RWA</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">Old Model</td>
                  <td data-row="1" data-col="1">1,396,763,204</td>
                  <td data-row="1" data-col="2">744,295,657</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">New Model</td>
                  <td data-row="2" data-col="1">1,396,763,204</td>
                  <td data-row="2" data-col="2">718,267,530</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-rwa-impact-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: RWA by Old and New Ratings
</figcaption>
</figure>
</div>
</div>
<p>Based on <a href="#tbl-rwa-impact" class="quarto-xref">Table&nbsp;10</a>, we can see that the new model results in a lower total RWA compared to the old model, or a change of -3.497%. Let’s assume that this level of change is acceptable to the bank.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Our validation suggests that the new model is performing well in terms of discriminatory power (Gini score of 0.8039705), rating stability (as per the transition matrix), and RWA impact (change of -3.497%). Therefore, we can proceed with the implementation of the new model.</p>
</div>
</div>
</div>
</section>
</section>
<section id="approval-deployment-ongoing-monitoring" class="level3" data-number="3.7">
<h3 data-number="3.7" class="anchored" data-anchor-id="approval-deployment-ongoing-monitoring"><span class="header-section-number">3.7</span> Approval, Deployment &amp; Ongoing Monitoring</h3>
<p>After the model has been developed and validated, it must be approved by the relevant internal governance bodies within the bank before it can be deployed. This process typically involves a review of the model documentation, validation results, calibration approach, and any known limitations. In addition, supervisory authorities may review the model as part of the regulatory approval process.</p>
<p>Once the model is approved, it can be deployed into production. This may involve integrating the model into existing IT systems, developing user interfaces for model users, and providing training to staff on how to apply the model consistently.</p>
<p>Ongoing monitoring of the model’s performance is essential to ensure that it continues to operate as intended. This includes regular backtesting of the model’s predictions, monitoring for changes in the underlying data or economic environment, and reviewing override patterns. Where necessary, the model should be updated or recalibrated.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Override analysis
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In practice, credit decisions are not always fully automated. Senior credit officers or committees may override the model’s suggested rating when they have additional information not captured by the model (e.g., recent restructuring, parent company support, or industry events).</p>
<p>While some level of overrides is expected and even healthy, frequent overrides can be a red flag. High override rates may suggest that the model is missing important risk drivers, that calibration does not align well with expert judgment, or that the economic environment has shifted.</p>
</div>
</div>
</div>



</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Gorton2008BankCycles" class="csl-entry" role="listitem">
Gorton, G B, and Ping He. 2008. <span>“Bank Credit Cycles.”</span> <em>Review of Economic Studies</em> 75 (4): 1181–1214.
</div>
</div></section></div></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuaW1wb3J0IHtQbG90fSBmcm9tIFwiQG9ic2VydmFibGVocS9wbG90XCJcblxuLy8gLS0tIElucHV0cyAtLS1cbnZpZXdvZiBwZCA9IElucHV0cy5yYW5nZShbMC4wNSwgMTAwXSwge3ZhbHVlOiAxLjAwLCBzdGVwOiAwLjAxLCBsYWJlbDogXCJQRCAoJSlcIn0pXG52aWV3b2YgbGdkID0gSW5wdXRzLnJhbmdlKFswLCAxMDBdLCB7dmFsdWU6IDI1LCBzdGVwOiAwLjUsIGxhYmVsOiBcIkxHRCAoJSlcIn0pXG52aWV3b2YgZWFkID0gSW5wdXRzLnJhbmdlKFswLCA1XzAwMF8wMDBdLCB7dmFsdWU6IDFfMDAwXzAwMCwgc3RlcDogMTBfMDAwLCBsYWJlbDogXCJFQURcIn0pXG52aWV3b2YgbSA9IElucHV0cy5yYW5nZShbMC4yNSwgMjBdLCB7dmFsdWU6IDIuNSwgc3RlcDogMC4yNSwgbGFiZWw6IFwiTWF0dXJpdHkgKHllYXJzKVwifSlcbnZpZXdvZiBhdmNtID0gSW5wdXRzLnNlbGVjdChbMSwgMS4yNV0sIHt2YWx1ZTogMSwgbGFiZWw6IFwiQVZDTVwifSlcblxuLy8gLS0tIEZvcm11bGFzIC0tLVxuY29ycl9SID0gKFBELCBBVkNNKSA9PiB7XG4gIGNvbnN0IHggPSAoMSAtIE1hdGguZXhwKC01MCAqIFBEKSkgLyAoMSAtIE1hdGguZXhwKC01MCkpO1xuICBjb25zdCBSID0gQVZDTSAqICgwLjEyICogeCArIDAuMjQgKiAoMSAtIHgpKTtcbiAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KFIsIDFlLTYpLCAwLjk5OSk7XG59O1xuXG5iX21hdHVyaXR5ID0gUEQgPT4gKDAuMTE4NTIgLSAwLjA1NDc4ICogTWF0aC5sb2coUEQpKSAqKiAyO1xuXG4vLyBTdGFuZGFyZCBub3JtYWwgQ0RGXG5mdW5jdGlvbiBzdGRub3JtX2NkZih4KSB7XG4gIHJldHVybiAoMSArIGVyZih4IC8gTWF0aC5zcXJ0KDIpKSkgLyAyO1xufVxuLy8gRXJyb3IgZnVuY3Rpb25cbmZ1bmN0aW9uIGVyZih4KSB7XG4gIC8vIEFicmFtb3dpdHogYW5kIFN0ZWd1biBmb3JtdWxhIDcuMS4yNlxuICBjb25zdCBzaWduID0geCA8IDAgPyAtMSA6IDE7XG4gIHggPSBNYXRoLmFicyh4KTtcbiAgY29uc3QgYTEgPSAgMC4yNTQ4Mjk1OTIsIGEyID0gLTAuMjg0NDk2NzM2LCBhMyA9IDEuNDIxNDEzNzQxO1xuICBjb25zdCBhNCA9IC0xLjQ1MzE1MjAyNywgYTUgPSAxLjA2MTQwNTQyOSwgcCA9IDAuMzI3NTkxMTtcbiAgY29uc3QgdCA9IDEgLyAoMSArIHAgKiB4KTtcbiAgY29uc3QgeSA9IDEgLSAoKCgoKGE1ICogdCArIGE0KSAqIHQpICsgYTMpICogdCArIGEyKSAqIHQgKyBhMSkgKiB0ICogTWF0aC5leHAoLXggKiB4KTtcbiAgcmV0dXJuIHNpZ24gKiB5O1xufVxuLy8gSW52ZXJzZSBlcnJvciBmdW5jdGlvbiAoYXBwcm94aW1hdGUpXG5mdW5jdGlvbiBlcmZpbnYoeCkge1xuICAvLyBBcHByb3hpbWF0aW9uIGJ5IE1pa2UgR2lsZXMgKDIwMTApXG4gIGNvbnN0IGEgPSAwLjE0NztcbiAgY29uc3QgbG4gPSBNYXRoLmxvZygoMSAtIHgpICogKDEgKyB4KSk7XG4gIGNvbnN0IHNnbiA9IHggPCAwID8gLTEgOiAxO1xuICBjb25zdCBwYXJ0MSA9IDIgLyAoTWF0aC5QSSAqIGEpICsgbG4gLyAyO1xuICBjb25zdCBwYXJ0MiA9IGxuIC8gYTtcbiAgcmV0dXJuIHNnbiAqIE1hdGguc3FydChNYXRoLnNxcnQocGFydDEgKiBwYXJ0MSAtIHBhcnQyKSAtIHBhcnQxKTtcbn1cblxuY2FwaXRhbF9LID0gKFBELCBMR0QsIE0sIEFWQ00pID0+IHtcbiAgY29uc3QgUiA9IGNvcnJfUihQRCwgQVZDTSk7XG4gIGNvbnN0IGIgPSBiX21hdHVyaXR5KFBEKTtcbiAgY29uc3QgcW5vcm0gPSBwID0+IE1hdGguc3FydCgyKSAqIGVyZmludigyICogcCAtIDEpOyAvLyBBcHByb3hpbWF0ZSBpbnZlcnNlIG5vcm1hbFxuICBjb25zdCB0ZXJtID0gKHFub3JtKFBEKSArIE1hdGguc3FydChSKSAqIHFub3JtKDAuOTk5KSkgLyBNYXRoLnNxcnQoMSAtIFIpO1xuICBjb25zdCBLID0gTEdEICogc3Rkbm9ybV9jZGYodGVybSkgLSBQRCAqIExHRDtcbiAgY29uc3QgS19hZGogPSBLICogKCgxICsgKE0gLSAyLjUpICogYikgLyAoMSAtIDEuNSAqIGIpKTtcbiAgcmV0dXJuIE1hdGgubWF4KEtfYWRqLCAwKTtcbn07XG5cbi8vIC0tLSBDYWxjdWxhdGlvbnMgLS0tXG5QRCA9IHBkIC8gMTAwO1xuTEdEID0gbGdkIC8gMTAwO1xuRUFEID0gZWFkO1xuTSA9IG07XG5BVkNNID0gYXZjbTtcblxuUiA9IGNvcnJfUihQRCwgQVZDTSk7XG5iID0gYl9tYXR1cml0eShQRCk7XG5LID0gY2FwaXRhbF9LKFBELCBMR0QsIE0sIEFWQ00pO1xuUldBID0gSyAqIDEyLjUgKiBFQUQ7XG5cbi8vIC0tLSBTZW5zaXRpdml0eSBEYXRhIC0tLVxuLy8gTG93ZXIgYW5kIHVwcGVyIGJvdW5kcyBmb3IgUEQgaW4gZGVjaW1hbCAoMC4wMDA1IHRvIDEuMClcbnBkX21pbiA9IDAuMDAwNTtcbnBkX21heCA9IDEuMDtcbnBkX2xvd2VyID0gTWF0aC5tYXgocGRfbWluLCBQRCAqIDAuNSk7XG5wZF91cHBlciA9IE1hdGgubWluKHBkX21heCwgUEQgKiAxLjUpO1xucGRfc2VxID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiA1MH0sIChfLCBpKSA9PiBwZF9sb3dlciArIGkgKiAocGRfdXBwZXIgLSBwZF9sb3dlcikgLyA0OSk7XG5sZ2Rfc2VxID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiA1MH0sIChfLCBpKSA9PiBNYXRoLm1heCgwLCBMR0QqMC41KSArIGkqKE1hdGgubWluKDEsIExHRCoxLjUpLU1hdGgubWF4KDAsIExHRCowLjUpKS80OSk7XG5lYWRfc2VxID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiA1MH0sIChfLCBpKSA9PiBFQUQqMC41ICsgaSooRUFEKjEuNS1FQUQqMC41KS80OSk7XG5tX21pbiA9IDAuMjU7XG5tX21heCA9IDIwLjA7XG5tX2xvd2VyID0gTWF0aC5tYXgobV9taW4sIE0gKiAwLjUpO1xubV91cHBlciA9IE1hdGgubWluKG1fbWF4LCBNICogMS41KTtcbm1fc2VxID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiA1MH0sIChfLCBpKSA9PiBtX2xvd2VyICsgaSAqIChtX3VwcGVyIC0gbV9sb3dlcikgLyA0OSk7XG5cbmRhdGFfcGQgPSBwZF9zZXEubWFwKHAgPT4gKHtQRDogcCoxMDAsIFJXQTogY2FwaXRhbF9LKHAsIExHRCwgTSwgQVZDTSkgKiAxMi41ICogRUFEfSkpO1xuZGF0YV9sZ2QgPSBsZ2Rfc2VxLm1hcChsID0+ICh7TEdEOiBsKjEwMCwgUldBOiBjYXBpdGFsX0soUEQsIGwsIE0sIEFWQ00pICogMTIuNSAqIEVBRH0pKTtcbmRhdGFfZWFkID0gZWFkX3NlcS5tYXAoZSA9PiAoe0VBRDogZSwgUldBOiBjYXBpdGFsX0soUEQsIExHRCwgTSwgQVZDTSkgKiAxMi41ICogZX0pKTtcbmRhdGFfbSA9IG1fc2VxLm1hcChtdiA9PiAoe006IG12LCBSV0E6IGNhcGl0YWxfSyhQRCwgTEdELCBtdiwgQVZDTSkgKiAxMi41ICogRUFEfSkpO1xuXG5mdW5jdGlvbiBoaWdobGlnaHQoeCwgeSwgeGxhYiwgeWxhYikge1xuICByZXR1cm4gW1xuICAgIFBsb3QucnVsZVgoW3hdLCB7c3Ryb2tlOiBcImdyYXlcIiwgc3Ryb2tlRGFzaGFycmF5OiBcIjQsMlwifSksXG4gICAgUGxvdC5ydWxlWShbeV0sIHtzdHJva2U6IFwiZ3JheVwiLCBzdHJva2VEYXNoYXJyYXk6IFwiNCwyXCJ9KSxcbiAgICBQbG90LmRvdChbe1t4bGFiXTogeCwgW3lsYWJdOiB5fV0sIHt4OiB4bGFiLCB5OiB5bGFiLCBmaWxsOiBcImJsYWNrXCIsIHI6IDV9KSxcbiAgICBQbG90LnRleHQoW3tbeGxhYl06IHgsIFt5bGFiXTogeSwgbGFiZWw6IGAoJHt4LnRvRml4ZWQoMil9LCAke01hdGgucm91bmQoeSl9KWB9XSwge1xuICAgICAgeDogeGxhYiwgeTogeWxhYiwgdGV4dDogXCJsYWJlbFwiLCBkeDogMTAsIGR5OiAtMTAsIGZpbGw6IFwiYmxhY2tcIiwgZm9udFNpemU6IDEyXG4gICAgfSlcbiAgXTtcbn1cblxuLy8gLS0tIEluZGl2aWR1YWwgUGxvdHMgLS0tXG5wbG90X3BkID0gUGxvdC5wbG90KHtcbiAgZ3JpZDogdHJ1ZSxcbiAgd2lkdGg6IDM1MCxcbiAgaGVpZ2h0OiAyNTAsXG4gIG1hcmdpbkxlZnQ6IDUwLFxuICBtYXJnaW5Cb3R0b206IDQwLFxuICBtYXJrczogW1xuICAgIFBsb3QubGluZShkYXRhX3BkLCB7eDogXCJQRFwiLCB5OiBcIlJXQVwiLCBzdHJva2U6IFwiYmx1ZVwifSksXG4gICAgLi4uaGlnaGxpZ2h0KHBkLCBjYXBpdGFsX0soUEQsIExHRCwgTSwgQVZDTSkgKiAxMi41ICogRUFELCBcIlBEXCIsIFwiUldBXCIpXG4gIF0sXG4gIHg6IHtsYWJlbDogXCJQRCAoJSlcIn0sXG4gIHk6IHtsYWJlbDogXCJSV0FcIn0sXG4gIGNhcHRpb246IFwiU2Vuc2l0aXZpdHkgdG8gUERcIlxufSlcblxucGxvdF9sZ2QgPSBQbG90LnBsb3Qoe1xuICBncmlkOiB0cnVlLFxuICB3aWR0aDogMzUwLFxuICBoZWlnaHQ6IDI1MCxcbiAgbWFyZ2luTGVmdDogNTAsXG4gIG1hcmdpbkJvdHRvbTogNDAsXG4gIG1hcmtzOiBbXG4gICAgUGxvdC5saW5lKGRhdGFfbGdkLCB7eDogXCJMR0RcIiwgeTogXCJSV0FcIiwgc3Ryb2tlOiBcImRhcmtyZWRcIn0pLFxuICAgIC4uLmhpZ2hsaWdodChsZ2QsIGNhcGl0YWxfSyhQRCwgTEdELCBNLCBBVkNNKSAqIDEyLjUgKiBFQUQsIFwiTEdEXCIsIFwiUldBXCIpXG4gIF0sXG4gIHg6IHtsYWJlbDogXCJMR0QgKCUpXCJ9LFxuICB5OiB7bGFiZWw6IFwiUldBXCJ9LFxuICBjYXB0aW9uOiBcIlNlbnNpdGl2aXR5IHRvIExHRFwiXG59KVxuXG5wbG90X2VhZCA9IFBsb3QucGxvdCh7XG4gIGdyaWQ6IHRydWUsXG4gIHdpZHRoOiAzNTAsXG4gIGhlaWdodDogMjUwLFxuICBtYXJnaW5MZWZ0OiA1MCxcbiAgbWFyZ2luQm90dG9tOiA0MCxcbiAgbWFya3M6IFtcbiAgICBQbG90LmxpbmUoZGF0YV9lYWQsIHt4OiBcIkVBRFwiLCB5OiBcIlJXQVwiLCBzdHJva2U6IFwiZGFya2dyZWVuXCJ9KSxcbiAgICAuLi5oaWdobGlnaHQoZWFkLCBjYXBpdGFsX0soUEQsIExHRCwgTSwgQVZDTSkgKiAxMi41ICogRUFELCBcIkVBRFwiLCBcIlJXQVwiKVxuICBdLFxuICB4OiB7bGFiZWw6IFwiRUFEXCJ9LFxuICB5OiB7bGFiZWw6IFwiUldBXCJ9LFxuICBjYXB0aW9uOiBcIlNlbnNpdGl2aXR5IHRvIEVBRFwiXG59KVxuXG5wbG90X20gPSBQbG90LnBsb3Qoe1xuICBncmlkOiB0cnVlLFxuICB3aWR0aDogMzUwLFxuICBoZWlnaHQ6IDI1MCxcbiAgbWFyZ2luTGVmdDogNTAsXG4gIG1hcmdpbkJvdHRvbTogNDAsXG4gIG1hcmtzOiBbXG4gICAgUGxvdC5saW5lKGRhdGFfbSwge3g6IFwiTVwiLCB5OiBcIlJXQVwiLCBzdHJva2U6IFwiZGFya29yYW5nZVwifSksXG4gICAgLi4uaGlnaGxpZ2h0KG0sIGNhcGl0YWxfSyhQRCwgTEdELCBNLCBBVkNNKSAqIDEyLjUgKiBFQUQsIFwiTVwiLCBcIlJXQVwiKVxuICBdLFxuICB4OiB7bGFiZWw6IFwiTWF0dXJpdHkgKHllYXJzKVwifSxcbiAgeToge2xhYmVsOiBcIlJXQVwifSxcbiAgY2FwdGlvbjogXCJTZW5zaXRpdml0eSB0byBNYXR1cml0eVwiXG59KVxuXG4vLyAtLS0gT3V0cHV0OiBSZXN1bHRzIFRhYmxlIGFuZCBQbG90cyAtLS1cbmh0bWxgXG4gIDx0YWJsZSBjbGFzcz1cInRhYmxlXCI+XG4gICAgPHRoZWFkPjx0cj48dGg+UXVhbnRpdHk8L3RoPjx0aD5WYWx1ZTwvdGg+PHRoPlVuaXRzPC90aD48L3RyPjwvdGhlYWQ+XG4gICAgPHRib2R5PlxuICAgICAgPHRyPjx0ZD5Db3JyZWxhdGlvbiAoUik8L3RkPjx0ZD4ke1IudG9GaXhlZCg2KX08L3RkPjx0ZD48L3RkPjwvdHI+XG4gICAgICA8dHI+PHRkPk1hdHVyaXR5IGFkanVzdG1lbnQgKGIpPC90ZD48dGQ+JHtiLnRvRml4ZWQoNil9PC90ZD48dGQ+PC90ZD48L3RyPlxuICAgICAgPHRyPjx0ZD5DYXBpdGFsIHJlcXVpcmVtZW50IChLKTwvdGQ+PHRkPiR7Sy50b0ZpeGVkKDYpfTwvdGQ+PHRkPnBlciB1bml0IEVBRDwvdGQ+PC90cj5cbiAgICAgIDx0cj48dGQ+UldBPC90ZD48dGQ+JHtNYXRoLnJvdW5kKFJXQSkudG9Mb2NhbGVTdHJpbmcoKX08L3RkPjx0ZD5jdXJyZW5jeTwvdGQ+PC90cj5cbiAgICA8L3Rib2R5PlxuICA8L3RhYmxlPlxuICA8ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgZmxleC13cmFwOiB3cmFwOyBnYXA6IDEwcHg7IGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcIj5cbiAgICA8ZGl2PiR7cGxvdF9wZH08L2Rpdj5cbiAgICA8ZGl2PiR7cGxvdF9sZ2R9PC9kaXY+XG4gICAgPGRpdj4ke3Bsb3RfZWFkfTwvZGl2PlxuICAgIDxkaXY+JHtwbG90X219PC9kaXY+XG4gIDwvZGl2PlxuYFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdwZCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdsZ2QnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnZWFkJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ20nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnYXZjbScpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../posts/credit-risk-modelling";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/mingze-gao\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "mgao6767/mingze-gao";
    script.dataset.repoId = "MDEwOlJlcG9zaXRvcnkyODEwMTIwMjk=";
    script.dataset.category = "Comments";
    script.dataset.categoryId = "DIC_kwDOEL_nPc4CgWgL";
    script.dataset.mapping = "pathname";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><img src="../..\images/MQ_FABRC_HOR_RGB_REV.png" class="light-content" alt="MQ FinTech and Banking Research Centre" height="67"></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Copyright © 2019 - 2025 Mingze Gao
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mgao6767">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/AdrianMingzeGao">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/adriangao/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:mingze.gao@mq.edu.au">
      <i class="bi bi-send" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>