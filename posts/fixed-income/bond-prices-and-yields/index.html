<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mingze Gao">
<meta name="dcterms.date" content="2023-08-21">

<title>Bond Prices and Yields ‚Äì Mingze Gao</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/favicon.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-de84f8d6bb715db06a919283c2d1e787.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-17cf1aa965d7a3061eaf472c0fafa655.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1QDTTQ6EHM"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-1QDTTQ6EHM', { 'anonymize_ip': true});
</script>
<script type="module" src="../../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
<meta name="twitter:title" content="Bond Prices and Yields ‚Äì Mingze Gao">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://mingze-gao.com/posts/fixed-income/bond-prices-and-yields/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../images/favicon.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../cv/index.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../posts/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../teaching/index.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://phds.io/"> 
<span class="menu-text">Literature üîç</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../posts/fixed-income/introduction/index.html">Fixed Income</a></li><li class="breadcrumb-item"><a href="../../../posts/fixed-income/bond-prices-and-yields/index.html">Bond Prices and Yields</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Fixed Income</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/fixed-income/introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Fixed Income Securities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/fixed-income/bond-prices-and-yields/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Bond Prices and Yields</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/fixed-income/bond-price-volatility/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bond Price Volatility (Sensitivity)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/fixed-income/yield-curve/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Yield Curve and Term Structure of Interest Rates</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Stata Workshop</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/stata/introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stata - Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/stata/packages/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stata - Packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/stata/working-with-datasets/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stata - Working with datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/fred/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FRED - Federal Reserve Economic Data</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#price-of-a-bond" id="toc-price-of-a-bond" class="nav-link active" data-scroll-target="#price-of-a-bond">Price of a bond</a>
  <ul class="collapse">
  <li><a href="#the-formula" id="toc-the-formula" class="nav-link" data-scroll-target="#the-formula">The formula</a></li>
  </ul></li>
  <li><a href="#price-over-time" id="toc-price-over-time" class="nav-link" data-scroll-target="#price-over-time">Price over time</a>
  <ul class="collapse">
  <li><a href="#a-slightly-improved-formula" id="toc-a-slightly-improved-formula" class="nav-link" data-scroll-target="#a-slightly-improved-formula">A slightly improved formula</a></li>
  <li><a href="#a-more-improved-formula" id="toc-a-more-improved-formula" class="nav-link" data-scroll-target="#a-more-improved-formula">A more improved formula</a></li>
  </ul></li>
  <li><a href="#price-dirty-and-clean" id="toc-price-dirty-and-clean" class="nav-link" data-scroll-target="#price-dirty-and-clean">Price: dirty and clean</a></li>
  <li><a href="#price-and-yield-to-maturity" id="toc-price-and-yield-to-maturity" class="nav-link" data-scroll-target="#price-and-yield-to-maturity">Price and yield (to maturity)</a></li>
  <li><a href="#other-yields" id="toc-other-yields" class="nav-link" data-scroll-target="#other-yields">Other yields</a></li>
  <li><a href="#trouble-maker-floating-rate-bonds" id="toc-trouble-maker-floating-rate-bonds" class="nav-link" data-scroll-target="#trouble-maker-floating-rate-bonds">Trouble maker: floating-rate bonds</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../posts/fixed-income/introduction/index.html">Fixed Income</a></li><li class="breadcrumb-item"><a href="../../../posts/fixed-income/bond-prices-and-yields/index.html">Bond Prices and Yields</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Bond Prices and Yields</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Teaching Notes</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Mingze Gao, PhD <a href="mailto:mingze.gao@mq.edu.au" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-8635-4269" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Macquarie University
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 21, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>In the <a href="../../../posts/fixed-income/introduction/index.html">last post</a> we introduce features of a bond. Now, let‚Äôs look at how to price a <em>plain vanilla</em> bond and examine the relation between bond price and yield.</p>
<section id="price-of-a-bond" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="price-of-a-bond">Price of a bond</h2>
<p>First, what‚Äôs the fair price of a bond?</p>
<p>For the investor, a bond represents a series of cashflows to receive in the future. So its price is naturally the total present value of all cashflows from the bond, including coupon payments (if any) and the repayment of principal (bond face value).</p>
<p>Therefore, the following equation holds true universally at all time <span class="math inline">\(t\)</span>:</p>
<p><span class="math display">\[
\text{Bond Price}_{t} = \text{PV}_t(\text{future coupons}) + \text{PV}_t(\text{face value})
\]</span></p>
<blockquote class="blockquote">
<p>A bond‚Äôs price at time <span class="math inline">\(t\)</span> is the present value as at time <span class="math inline">\(t\)</span> of all coupons to receive in the future, plus the present value as at time <span class="math inline">\(t\)</span> of the bond face value. Personally, I‚Äôd call this fundamental.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled" title="Before we move on">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Before we move on
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember that all the complications we will see later are just results of uncertainties about the PVs, which ultimately are determined by cashflows and discount rates. Whenever you‚Äôre lost, pause and think about how they are affected, and then reason about how bond price may be affected.</p>
</div>
</div>
<p>I like examples. Suppose we are to issue a 10-year bond with a $10,000 face value that pays 5% annual coupon in arrears<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, with 8% discount rate<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, what would be the price today <span class="math inline">\(t=0\)</span> at which we can sell the bond to investors?</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;‚Äúin arrears‚Äù means that the payment is made at the end of the period. So in this case, the bond pays coupon annually at the end of the year, not any time sooner.</p></div><div id="fn2"><p><sup>2</sup>&nbsp;We assume that this is an effective annual rate, and is the same for all 10 years in the future.</p></div></div><p>The chart below shows the result. Specifically, the blue bars indicate the bond‚Äôs cashflows, the overlaying red bars indicate their present values as at time <span class="math inline">\(t=0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="40" data-source-offset="-3"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 39;"><span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>viewof maturity <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span><span class="op">,</span> <span class="dv">30</span>]<span class="op">,</span> </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">value</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Maturity (years):"</span>}</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>viewof discountRate <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.2</span>]<span class="op">,</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">"Discount rate:"</span>}</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>viewof couponRate <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.2</span>]<span class="op">,</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">"Coupon rate:"</span>}</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>viewof couponFreq <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Annual"</span><span class="op">,</span> <span class="st">"Semiannual"</span>]<span class="op">,</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">value</span><span class="op">:</span> <span class="st">"Annual"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">"Coupon frequency:"</span>}</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> {</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> f <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> c<span class="op">,</span> m<span class="op">,</span> r<span class="op">;</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (couponFreq <span class="op">==</span> <span class="st">"Semiannual"</span>) {</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> couponRate <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> maturity<span class="op">;</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> discountRate <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> couponRate<span class="op">;</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> maturity<span class="op">;</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> discountRate<span class="op">;</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cashflows <span class="op">=</span> {<span class="st">"Time"</span><span class="op">:</span> []<span class="op">,</span> <span class="st">"Cashflow"</span><span class="op">:</span> []<span class="op">,</span> <span class="st">"PV"</span><span class="op">:</span> []}<span class="op">;</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> cf <span class="op">=</span> f <span class="op">*</span> c<span class="op">;</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> m<span class="op">+</span><span class="dv">1</span><span class="op">;</span> <span class="op">++</span>i) {</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    cashflows[<span class="st">"Time"</span>]<span class="op">.</span><span class="fu">push</span>(i)<span class="op">;</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="op">==</span> m) cf <span class="op">=</span> f <span class="op">*</span> (<span class="dv">1</span><span class="op">+</span>c)<span class="op">;</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    cashflows[<span class="st">"Cashflow"</span>]<span class="op">.</span><span class="fu">push</span>(cf)<span class="op">;</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    cashflows[<span class="st">"PV"</span>]<span class="op">.</span><span class="fu">push</span>(cf <span class="op">/</span> (<span class="dv">1</span><span class="op">+</span>r)<span class="op">**</span>i)<span class="op">;</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> cashflows<span class="op">;</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="fu">transpose</span>(a)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">padding</span><span class="op">:</span> <span class="fl">0.4</span>}<span class="op">,</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">barY</span>(data<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"Time"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"Cashflow"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"blue"</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="op">-</span><span class="dv">2</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">barY</span>(data<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"Time"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"PV"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-7" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Try it out">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Try it out
</div>
</div>
<div class="callout-body-container callout-body">
<p>Change the parameters, see what happens to the bond price!</p>
</div>
</div>
<section id="the-formula" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-formula">The formula</h3>
<p>The initial price <span class="math inline">\(P_{t=0}\)</span> of a plain vanilla <span class="math inline">\(N\)</span>-year bond with face value <span class="math inline">\(F\)</span>, annual coupon <span class="math inline">\(C\)</span>, at a constant discount rate <span class="math inline">\(r\)</span><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, is given by</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;This discount rate <span class="math inline">\(r\)</span> is assumed to be an effective rate for a period of time between two coupons, i.e., effective annual rate in this case.</p></div></div><p><span class="math display">\[
P_{t=0} = \underbrace{\sum_{\tau=1}^{N} \frac{C}{(1+r)^{\tau}}}_{\text{sum of coupons' PVs}} + \underbrace{\frac{F}{(1+r)^N}}_{\text{face value's PV}}
\]</span></p>
<p>Note that this is only the <strong>initial price</strong> when the bond is issued at time <span class="math inline">\(t=0\)</span>.</p>
</section>
</section>
<section id="price-over-time" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="price-over-time">Price over time</h2>
<div class="callout callout-style-default callout-note callout-titled" title="Question">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>So, other things equal, how does bond price changes <strong><em>over time</em></strong> as we approaches the maturity date?</p>
</div>
</div>
<p>We need a better formula that can let <span class="math inline">\(t\)</span> take values other than 0. Recall the rationale that the price is nothing but sum of all PVs of future payments.</p>
<section id="a-slightly-improved-formula" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="a-slightly-improved-formula">A slightly improved formula</h3>
<p>At time <span class="math inline">\(t\)</span>, which is <em>exactly</em> <span class="math inline">\(n\)</span> years till maturity, the price, <span class="math inline">\(P_{t}\)</span>, of a plain vanilla bond with face value <span class="math inline">\(F\)</span>, annual coupon <span class="math inline">\(C\)</span>, at a constant discount rate <span class="math inline">\(r\)</span>, is given by</p>
<p><span class="math display">\[
P_{t} = \underbrace{\sum_{\tau=1}^{n} \frac{C}{(1+r)^{\tau}}}_{\text{sum of coupons' PVs}} + \underbrace{\frac{F}{(1+r)^n}}_{\text{face value's PV}}
\]</span></p>
<p>From only <span class="math inline">\(P_{t=0}\)</span> to <span class="math inline">\(\{P_{t}\}\)</span> is a major improvement!<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;However, here <span class="math inline">\(t\)</span> can only be positive integers as we assume <span class="math inline">\(t\)</span> is exactly <span class="math inline">\(n\)</span> years before the bond‚Äôs maturity. See the next question.</p></div><div id="fn5"><p><sup>5</sup>&nbsp;Note that at maturity, <span class="math inline">\(n=0\)</span> such that the price <span class="math inline">\(P_t=F\)</span>.</p></div></div><p>Let me show you another graph. Note that in this graph, each bar represents the bond price as at a point in time.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="134" data-source-offset="-3"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 133;"><span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>viewof maturity2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span><span class="op">,</span> <span class="dv">30</span>]<span class="op">,</span> </span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">value</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Maturity (years):"</span>}</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>viewof discountRate2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.2</span>]<span class="op">,</span></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">"Discount rate:"</span>}</span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>viewof couponRate2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.2</span>]<span class="op">,</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.05</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">"Coupon rate:"</span>}</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>viewof couponFreq2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Annual"</span><span class="op">,</span> <span class="st">"Semiannual"</span>]<span class="op">,</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">value</span><span class="op">:</span> <span class="st">"Annual"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">"Coupon frequency:"</span>}</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> {</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> f <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> c<span class="op">,</span> m<span class="op">,</span> r<span class="op">;</span></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (couponFreq2 <span class="op">==</span> <span class="st">"Semiannual"</span>) {</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> couponRate2 <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> maturity2<span class="op">;</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> discountRate2 <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> couponRate2<span class="op">;</span></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> maturity2<span class="op">;</span></span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> discountRate2<span class="op">;</span></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">pv</span>(c<span class="op">,</span> f<span class="op">,</span> t<span class="op">,</span> r) {</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="dv">1</span><span class="op">+</span>r)<span class="op">**</span>(<span class="op">-</span>(m<span class="op">-</span>t))) <span class="op">/</span> r <span class="op">+</span> f <span class="op">/</span> (<span class="dv">1</span><span class="op">+</span>r)<span class="op">**</span>(m<span class="op">-</span>t)</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cashflows <span class="op">=</span> {<span class="st">"Time"</span><span class="op">:</span> []<span class="op">,</span> <span class="st">"PV"</span><span class="op">:</span> []}<span class="op">;</span></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> coupon <span class="op">=</span> f <span class="op">*</span> c<span class="op">;</span></span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> m<span class="op">+</span><span class="dv">1</span><span class="op">;</span> <span class="op">++</span>i) {</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>    cashflows[<span class="st">"Time"</span>]<span class="op">.</span><span class="fu">push</span>(i)<span class="op">;</span></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>    cashflows[<span class="st">"PV"</span>]<span class="op">.</span><span class="fu">push</span>(<span class="fu">pv</span>(coupon<span class="op">,</span> f<span class="op">,</span> i<span class="op">,</span> r))<span class="op">;</span></span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> cashflows<span class="op">;</span></span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> <span class="fu">transpose</span>(b)</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>  <span class="dt">caption</span><span class="op">:</span> <span class="st">"Assume $100 bond, coupons paid in arrears and effective annual discount rate."</span><span class="op">,</span></span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">padding</span><span class="op">:</span> <span class="fl">0.4</span>}<span class="op">,</span></span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">100</span>])<span class="op">,</span></span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">barY</span>(data2<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"Time"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"PV"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"blue"</span>})<span class="op">,</span></span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-7" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="calloout" title="Try it out">
<p>Change the discount rate to be lower than coupon rate, what do you find?</p>
</div>
<p>It‚Äôs not difficult to find that, as it approaches the maturity, the bond price approaches the face value, regardless of whether the bond is traded at a premium or discount.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;A bond is traded at a premium (discount) if its price is above (below) face value.</p></div></div><div class="callout callout-style-default callout-note callout-titled" title="Confused?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Confused?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Recall earlier we said that the <em>longer</em> the maturity, the <em>lower</em> the bond price. This is true because we are talking about the <em>initial</em> price at issue. For example, other things equal, the price of a 30-year bond is lower than the price of a 10-year bond.</p>
<p>Here, <em>time</em> is changing. There is <em>a bond</em> of a given maturity (e.g., 30 years), and we study how its price changes over time as we get close to the 30-year mark.</p>
</div>
</div>
</section>
<section id="a-more-improved-formula" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="a-more-improved-formula">A more improved formula</h3>
<p>But we can still do better!</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>So far we have been assuming the next coupon is exactly one period (e.g., year) in the future, or in other words, <em>the last coupon has just been paid</em>. What if this is not the case? What if the next annual coupon is in 2 months, not in 12 months, from now?</p>
</div>
</div>
<p>When the coupon payment date does not align with the time at which we compute the bond price, only a simple adjustment is required.</p>
<p>The basic idea is, since next coupon and all future payments are closer than what‚Äôs assumed in computation, we have <strong>over-discounted</strong> the bond value. So, we can correct it by ‚Äúgrowing‚Äù the undervalued price for the time since last coupon payment.</p>
<p><span class="math display">\[
P_{t} = \underbrace{\left[\sum_{\tau=1}^{n} \frac{C}{(1+r)^{\tau}} + \frac{F}{(1+r)^n}\right]}_{\text{bond price right after last coupon}} \times (1+r)^{\frac{\text{days since last coupon}}{\text{days between coupons}}}
\]</span></p>
<p>As such, we can now derive a <em>continuous</em> path for the bond price since issue to maturity, assuming other things equal. This is shown in the next chart as a blue line.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;In the last one, I deliberately use bar chart to indicate discreteness.</p></div></div></section>
</section>
<section id="price-dirty-and-clean" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="price-dirty-and-clean">Price: dirty and clean</h2>
<div class="callout callout-style-default callout-warning callout-titled" title="Attention!">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Attention!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Now imagine you are to buy a bond <em>immediately</em> before it matures. What would be the price according to the formula and the chart above?</p>
<p>No matter how much coupon the bond pays, the price (indicated by the the last bar) is the face value of the bond $10,000. After the purchase, however, you will <em>immediately</em> receive a total payment of bond face value and the last coupon payment, which surely is greater than $10,000.</p>
<p>Apparently, you need to pay more than the price described by the formula to the seller.</p>
</div>
</div>
<p>In fact, a bondholder starts to accumulate <strong>accrued interest</strong><a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> the moment their own the bond. Even though they may sell the bond right before a coupon payment, but given that they have been holding the bond for almost entire the time until selling just before the next coupon payment, they should be given compensation for not receiving the next coupon, which will be paid to the buyer.</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>&nbsp;<strong>Accrued interest</strong>: payoffs entitled to the investor but not yet paid.</p></div></div><p>Further, we generalize this idea to bond transactions any time between coupon payments ‚Äì the buyer should compensate the seller additionally a coupon payment proportional to the time that the seller has been holding since last coupon payment relative to the time between two coupon payments.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="240" data-source-offset="-3"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 239;"><span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>viewof maturity3 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span><span class="op">,</span> <span class="dv">30</span>]<span class="op">,</span> </span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">value</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Maturity (years):"</span>}</span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>viewof discountRate3 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.2</span>]<span class="op">,</span></span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">"Discount rate:"</span>}</span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a>viewof couponRate3 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.2</span>]<span class="op">,</span></span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.05</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">"Coupon rate:"</span>}</span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a>viewof couponFreq3 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(</span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Annual"</span><span class="op">,</span> <span class="st">"Semiannual"</span>]<span class="op">,</span></span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">value</span><span class="op">:</span> <span class="st">"Annual"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">"Coupon frequency:"</span>}</span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> {</span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> f <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> c<span class="op">,</span> m<span class="op">,</span> r<span class="op">;</span></span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (couponFreq3 <span class="op">==</span> <span class="st">"Semiannual"</span>) {</span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> couponRate3 <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> maturity3<span class="op">;</span></span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> discountRate3 <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> couponRate3<span class="op">;</span></span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> maturity3<span class="op">;</span></span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> discountRate3<span class="op">;</span></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> scale <span class="op">=</span> <span class="dv">300</span> <span class="op">/</span> m<span class="op">;</span></span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">pv</span>(c<span class="op">,</span> f<span class="op">,</span> t<span class="op">,</span> r) {</span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="dv">1</span><span class="op">+</span>r)<span class="op">**</span>(<span class="op">-</span>(m<span class="op">-</span>t))) <span class="op">/</span> r <span class="op">+</span> f <span class="op">/</span> (<span class="dv">1</span><span class="op">+</span>r)<span class="op">**</span>(m<span class="op">-</span>t)</span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cashflows <span class="op">=</span> {<span class="st">"Time"</span><span class="op">:</span> []<span class="op">,</span> <span class="st">"Clean"</span><span class="op">:</span> []<span class="op">,</span> <span class="st">"Dirty"</span><span class="op">:</span> []}<span class="op">;</span></span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> coupon <span class="op">=</span> f <span class="op">*</span> c<span class="op">;</span></span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> m <span class="op">*</span> scale <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">++</span>i) {</span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> t <span class="op">=</span> <span class="pp">parseInt</span>(i <span class="op">/</span> scale<span class="op">,</span> <span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a>    cashflows[<span class="st">"Time"</span>]<span class="op">.</span><span class="fu">push</span>(i)<span class="op">;</span></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> clean <span class="op">=</span> <span class="fu">pv</span>(coupon<span class="op">,</span> f<span class="op">,</span> i<span class="op">/</span>scale<span class="op">,</span> r)<span class="op">;</span></span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> dirty <span class="op">=</span> clean <span class="op">+</span> coupon <span class="op">*</span> (i<span class="op">-</span>t<span class="op">*</span>scale)<span class="op">/</span>scale<span class="op">;</span></span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a>    cashflows[<span class="st">"Clean"</span>]<span class="op">.</span><span class="fu">push</span>(clean)<span class="op">;</span></span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>    cashflows[<span class="st">"Dirty"</span>]<span class="op">.</span><span class="fu">push</span>(dirty)<span class="op">;</span></span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> cashflows<span class="op">;</span></span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a>data3 <span class="op">=</span> <span class="fu">transpose</span>(c)</span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a>  <span class="dt">caption</span><span class="op">:</span> <span class="st">"Assume $100 bond, coupons paid in arrears and effective annual discount rate."</span><span class="op">,</span></span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">padding</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span> </span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>        <span class="dt">transform</span><span class="op">:</span> (x) <span class="kw">=&gt;</span> (x<span class="op">/</span>(<span class="dv">300</span><span class="op">/</span>maturity3))<span class="op">,</span></span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> maturity3]<span class="op">,</span></span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"Year"</span>}<span class="op">,</span></span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">,</span></span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">lineY</span>(data3<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"Time"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"Clean"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"blue"</span>})<span class="op">,</span></span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">lineY</span>(data3<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"Time"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"Dirty"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>})<span class="op">,</span></span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-7" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p>The chart above shows the continuous path of bond price described by the formula in blue and the price including the additional compensation, i.e., the accrued interest. We names these two prices ‚Äúclean price‚Äù and ‚Äúdirty price‚Äù, respectively.</p>
<ul>
<li>The <strong>clean price</strong> is the price suggested by the formula. In reality, this is the price that market participants deal with more often, e.g., in financial reporting, portfolio management, etc.</li>
<li>The <strong>dirty price</strong> is the clean price plus accrued interest. This is the actual settlement price for bond transactions.</li>
</ul>
<p>And the accrued interest is given by</p>
<p><span class="math display">\[
\text{coupon} \times \frac{\text{time since last coupon}}{\text{time between coupons}}
\]</span></p>
<p>which periodically increases and resets.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Day count convention">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Day count convention
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>For Treasury bonds, we use ‚Äúactual/actual‚Äù convention.</li>
<li>For others, typically ‚Äú30/360‚Äù convention.</li>
</ul>
</div>
</div>
</section>
<section id="price-and-yield-to-maturity" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="price-and-yield-to-maturity">Price and yield (to maturity)</h2>
<p>So far, we have not yet spent a single word on a bond‚Äôs ‚Äúyield‚Äù, but instead been using ‚Äúdiscount rate‚Äù. What‚Äôs the difference?</p>
<p>The answer is straightforward. A bond consists of a series of cashflows in the future, each of which may be discounted at different rates. For example, the coupon in 1 year may be discounted at a 5% discount rate, the coupon in 2 years may be discounted at 6%, and so on.</p>
<p>It turns out that, at any time <span class="math inline">\(t\)</span>, while a bond can have multiple future payments each discounted at different rates <span class="math inline">\(\{r_{\tau}\}\)</span>, we can always find a single discount rate <span class="math inline">\(\color{red}y\)</span> which, when applied to all future payments, leads to the same bond price at the time:</p>
<p><span class="math display">\[
P_{t} = \underbrace{\sum_{\tau=1}^{n} \frac{C}{(1+r_\tau)^{\tau}} + \frac{F}{(1+r_n)^n}}_{\text{each discounted at varying rates}} = \underbrace{\sum_{\tau=1}^{n} \frac{C}{(1+{\color{red}y})^{\tau}} + \frac{F}{(1+{\color{red}y})^n}}_{\text{all discounted at the same rate}}
\]</span></p>
<p>This single discount rate <span class="math inline">\(\color{red}y\)</span> is called the <strong>yield to maturity</strong>, or <em>yield</em>, of the bond at time <span class="math inline">\(t\)</span>.</p>
<p>If we plot bond prices against yields, <em>at a given time</em>, it‚Äôs easy to see that they have a one-to-one mapping and a inverse non-linear relationship.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="339" data-source-offset="-3"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 338;"><span id="cb4-339"><a href="#cb4-339" aria-hidden="true" tabindex="-1"></a>viewof maturity4 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb4-340"><a href="#cb4-340" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span><span class="op">,</span> <span class="dv">30</span>]<span class="op">,</span> </span>
<span id="cb4-341"><a href="#cb4-341" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">value</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Maturity (years):"</span>}</span>
<span id="cb4-342"><a href="#cb4-342" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-343"><a href="#cb4-343" aria-hidden="true" tabindex="-1"></a>viewof couponRate4 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb4-344"><a href="#cb4-344" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.2</span>]<span class="op">,</span></span>
<span id="cb4-345"><a href="#cb4-345" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.05</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">"Coupon rate:"</span>}</span>
<span id="cb4-346"><a href="#cb4-346" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-347"><a href="#cb4-347" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> {</span>
<span id="cb4-348"><a href="#cb4-348" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> f <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb4-349"><a href="#cb4-349" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> c<span class="op">,</span> m<span class="op">;</span></span>
<span id="cb4-350"><a href="#cb4-350" aria-hidden="true" tabindex="-1"></a>  c <span class="op">=</span> couponRate4<span class="op">;</span></span>
<span id="cb4-351"><a href="#cb4-351" aria-hidden="true" tabindex="-1"></a>  m <span class="op">=</span> maturity4<span class="op">;</span></span>
<span id="cb4-352"><a href="#cb4-352" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">pv</span>(c<span class="op">,</span> f<span class="op">,</span> t<span class="op">,</span> r) {</span>
<span id="cb4-353"><a href="#cb4-353" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="dv">1</span><span class="op">+</span>r)<span class="op">**</span>(<span class="op">-</span>t)) <span class="op">/</span> r <span class="op">+</span> f <span class="op">/</span> (<span class="dv">1</span><span class="op">+</span>r)<span class="op">**</span>(t)</span>
<span id="cb4-354"><a href="#cb4-354" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-355"><a href="#cb4-355" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> prices <span class="op">=</span> {<span class="st">"YTM"</span><span class="op">:</span> []<span class="op">,</span> <span class="st">"Price"</span><span class="op">:</span> []}<span class="op">;</span></span>
<span id="cb4-356"><a href="#cb4-356" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> coupon <span class="op">=</span> f <span class="op">*</span> c<span class="op">;</span></span>
<span id="cb4-357"><a href="#cb4-357" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> ytm <span class="op">=</span> <span class="fl">0.01</span><span class="op">;</span> ytm <span class="op">&lt;</span> <span class="dv">20</span><span class="op">;</span> ytm<span class="op">++</span>) {</span>
<span id="cb4-358"><a href="#cb4-358" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> price <span class="op">=</span> <span class="fu">pv</span>(coupon<span class="op">,</span> f<span class="op">,</span> m<span class="op">,</span> ytm<span class="op">/</span><span class="dv">100</span>)<span class="op">;</span></span>
<span id="cb4-359"><a href="#cb4-359" aria-hidden="true" tabindex="-1"></a>    prices[<span class="st">"YTM"</span>]<span class="op">.</span><span class="fu">push</span>(ytm)<span class="op">;</span></span>
<span id="cb4-360"><a href="#cb4-360" aria-hidden="true" tabindex="-1"></a>    prices[<span class="st">"Price"</span>]<span class="op">.</span><span class="fu">push</span>(price)<span class="op">;</span></span>
<span id="cb4-361"><a href="#cb4-361" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-362"><a href="#cb4-362" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> prices<span class="op">;</span></span>
<span id="cb4-363"><a href="#cb4-363" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-364"><a href="#cb4-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-365"><a href="#cb4-365" aria-hidden="true" tabindex="-1"></a>data4 <span class="op">=</span> <span class="fu">transpose</span>(d)</span>
<span id="cb4-366"><a href="#cb4-366" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb4-367"><a href="#cb4-367" aria-hidden="true" tabindex="-1"></a>  <span class="dt">caption</span><span class="op">:</span> <span class="st">"Assume $100 bond, annual coupons paid in arrears and effective annual discount rate."</span><span class="op">,</span></span>
<span id="cb4-368"><a href="#cb4-368" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">padding</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"YTM (%)"</span>}<span class="op">,</span></span>
<span id="cb4-369"><a href="#cb4-369" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb4-370"><a href="#cb4-370" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb4-371"><a href="#cb4-371" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">,</span></span>
<span id="cb4-372"><a href="#cb4-372" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb4-373"><a href="#cb4-373" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">lineY</span>(data4<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"YTM"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"Price"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"blue"</span>})<span class="op">,</span></span>
<span id="cb4-374"><a href="#cb4-374" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb4-375"><a href="#cb4-375" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-5" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p>There are many interesting features about the bond price-yield relationship.</p>
<p>The <strong>one-to-one mapping</strong> between bond price and yield implies that we can always compute the other when given either of them. So, knowing either price or yield is sufficient when dealing with bonds.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn9"><p><sup>9</sup>&nbsp;Assuming other bond features are known, such as coupon rate, frequency, etc., which are public information.</p></div></div><p>The <strong>inverse</strong> relationship suggests that the higher the yield, the lower the bond price.</p>
<p>The <strong>non-linearity</strong> suggests that the sensitivity of bond price to yield is not static. In fact, we can tell from the graph that the curve is <em>convex</em>. This <em>convexity</em> will be of great importance in later studies of bond risk.</p>
</section>
<section id="other-yields" class="level2">
<h2 class="anchored" data-anchor-id="other-yields">Other yields</h2>
<p>When we talk about a bond‚Äôs yield, we usually refer to the yield to maturity. But there can be some other yield measures:</p>
<ul>
<li><a href="https://www.google.com/search?q=bond+current+yield">Current yield</a>.</li>
<li><a href="https://google.com/search?q=bond+equivalent+yield">Bond equivalent yield</a>.</li>
<li><a href="https://google.com/search?q=bond+yield+to+call">Yield to call</a>.</li>
<li><a href="https://google.com/search?q=bond+yield+to+put">Yield to put</a>.</li>
<li><a href="https://google.com/search?q=bond+yield+to+worse">Yield to worse</a>.</li>
<li>‚Ä¶</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled" title="Portfolio of bonds">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Portfolio of bonds
</div>
</div>
<div class="callout-body-container callout-body">
<p>The yield of a portfolio of bonds is <strong>NOT</strong> a weighted average of individual bonds‚Äô yields because the bonds are not homogeneous.</p>
</div>
</div>
</section>
<section id="trouble-maker-floating-rate-bonds" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="trouble-maker-floating-rate-bonds">Trouble maker: floating-rate bonds</h2>
<p>We cannot easily compute the yield of a floater, simply because the values of reference rate in the future are unknown. Instead, we can use some spread measures that describe the yield in excess of the reference rate. The most popular measure of yield spread for a floating-rate bond is <em>discount margin</em>.</p>
<p>As its name suggests, discount margin basically captures the ‚Äúdiscount rate in excess of reference rate‚Äù.</p>
<p>Suppose the bond market price is <span class="math inline">\(P_t\)</span>, reference rate is assumed <em>constant</em> at <span class="math inline">\(R\)</span>, the discount margin <span class="math inline">\(DM\)</span> is the one that solves the equation below:</p>
<p><span class="math display">\[
P_{t} = \sum_{\tau=1}^{n} \frac{C}{(1+R+{\color{red}DM})^{\tau}} + \frac{F}{(1+R+{\color{red}DM})^n}
\]</span></p>
<p>Note that here the coupon payment <span class="math inline">\(C\)</span> is determined by the reference rate <span class="math inline">\(R\)</span> and the quoted margin.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>


<div class="no-row-height column-margin column-container"><div id="fn10"><p><sup>10</sup>&nbsp;Quoted margin: a floating-rate bond‚Äôs coupon rate is determined by a reference rate plus its quoted margin.</p></div></div></section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IiBcclxudmlld29mIG1hdHVyaXR5ID0gSW5wdXRzLnJhbmdlKFxyXG4gIFsxLCAzMF0sIFxyXG4gIHt2YWx1ZTogMTUsIHN0ZXA6IDEsIGxhYmVsOiBcIk1hdHVyaXR5ICh5ZWFycyk6XCJ9XHJcbilcclxudmlld29mIGRpc2NvdW50UmF0ZSA9IElucHV0cy5yYW5nZShcclxuICAgIFswLjAxLCAwLjJdLFxyXG4gICAge3ZhbHVlOiAwLjEsIHN0ZXA6IDAuMDEsIGxhYmVsOlwiRGlzY291bnQgcmF0ZTpcIn1cclxuKVxyXG52aWV3b2YgY291cG9uUmF0ZSA9IElucHV0cy5yYW5nZShcclxuICAgIFswLjAxLCAwLjJdLFxyXG4gICAge3ZhbHVlOiAwLjEsIHN0ZXA6IDAuMDEsIGxhYmVsOlwiQ291cG9uIHJhdGU6XCJ9XHJcbilcclxudmlld29mIGNvdXBvbkZyZXEgPSBJbnB1dHMucmFkaW8oXHJcbiAgICBbXCJBbm51YWxcIiwgXCJTZW1pYW5udWFsXCJdLFxyXG4gICAge3ZhbHVlOiBcIkFubnVhbFwiLCBsYWJlbDpcIkNvdXBvbiBmcmVxdWVuY3k6XCJ9XHJcbilcclxuYSA9IHtcclxuICBjb25zdCBmID0gMTAwO1xyXG4gIGxldCBjLCBtLCByO1xyXG4gIGlmIChjb3Vwb25GcmVxID09IFwiU2VtaWFubnVhbFwiKSB7XHJcbiAgICBjID0gY291cG9uUmF0ZSAvIDI7XHJcbiAgICBtID0gMiAqIG1hdHVyaXR5O1xyXG4gICAgciA9IGRpc2NvdW50UmF0ZSAvIDI7XHJcbiAgfSBlbHNlIHtcclxuICAgIGMgPSBjb3Vwb25SYXRlO1xyXG4gICAgbSA9IG1hdHVyaXR5O1xyXG4gICAgciA9IGRpc2NvdW50UmF0ZTtcclxuICB9XHJcbiAgY29uc3QgY2FzaGZsb3dzID0ge1wiVGltZVwiOiBbXSwgXCJDYXNoZmxvd1wiOiBbXSwgXCJQVlwiOiBbXX07XHJcbiAgbGV0IGNmID0gZiAqIGM7XHJcbiAgZm9yIChsZXQgaSA9IDE7IGkgPCBtKzE7ICsraSkge1xyXG4gICAgY2FzaGZsb3dzW1wiVGltZVwiXS5wdXNoKGkpO1xyXG4gICAgaWYgKGkgPT0gbSkgY2YgPSBmICogKDErYyk7XHJcbiAgICBjYXNoZmxvd3NbXCJDYXNoZmxvd1wiXS5wdXNoKGNmKTtcclxuICAgIGNhc2hmbG93c1tcIlBWXCJdLnB1c2goY2YgLyAoMStyKSoqaSk7XHJcbiAgfVxyXG4gIHJldHVybiBjYXNoZmxvd3M7XHJcbn1cclxuXHJcbmRhdGEgPSB0cmFuc3Bvc2UoYSlcclxuUGxvdC5wbG90KHtcclxuICB4OiB7cGFkZGluZzogMC40fSxcclxuICBncmlkOiB0cnVlLFxyXG4gIG1hcmtzOiBbXHJcbiAgICBQbG90LnJ1bGVZKFswXSksXHJcbiAgICBQbG90LmJhclkoZGF0YSwge3g6IFwiVGltZVwiLCB5OiBcIkNhc2hmbG93XCIsIGZpbGw6IFwiYmx1ZVwiLCBkeDogLTIsIGR5OiAtMn0pLFxyXG4gICAgUGxvdC5iYXJZKGRhdGEsIHt4OiBcIlRpbWVcIiwgeTogXCJQVlwiLCBmaWxsOiBcInJlZFwiLCBkeDogMiwgZHk6IDJ9KSxcclxuICBdXHJcbn0pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IiBcclxudmlld29mIG1hdHVyaXR5MiA9IElucHV0cy5yYW5nZShcclxuICBbMSwgMzBdLCBcclxuICB7dmFsdWU6IDE1LCBzdGVwOiAxLCBsYWJlbDogXCJNYXR1cml0eSAoeWVhcnMpOlwifVxyXG4pXHJcbnZpZXdvZiBkaXNjb3VudFJhdGUyID0gSW5wdXRzLnJhbmdlKFxyXG4gICAgWzAuMDEsIDAuMl0sXHJcbiAgICB7dmFsdWU6IDAuMTAsIHN0ZXA6IDAuMDEsIGxhYmVsOlwiRGlzY291bnQgcmF0ZTpcIn1cclxuKVxyXG52aWV3b2YgY291cG9uUmF0ZTIgPSBJbnB1dHMucmFuZ2UoXHJcbiAgICBbMC4wMSwgMC4yXSxcclxuICAgIHt2YWx1ZTogMC4wNSwgc3RlcDogMC4wMSwgbGFiZWw6XCJDb3Vwb24gcmF0ZTpcIn1cclxuKVxyXG52aWV3b2YgY291cG9uRnJlcTIgPSBJbnB1dHMucmFkaW8oXHJcbiAgICBbXCJBbm51YWxcIiwgXCJTZW1pYW5udWFsXCJdLFxyXG4gICAge3ZhbHVlOiBcIkFubnVhbFwiLCBsYWJlbDpcIkNvdXBvbiBmcmVxdWVuY3k6XCJ9XHJcbilcclxuYiA9IHtcclxuICBjb25zdCBmID0gMTAwO1xyXG4gIGxldCBjLCBtLCByO1xyXG4gIGlmIChjb3Vwb25GcmVxMiA9PSBcIlNlbWlhbm51YWxcIikge1xyXG4gICAgYyA9IGNvdXBvblJhdGUyIC8gMjtcclxuICAgIG0gPSAyICogbWF0dXJpdHkyO1xyXG4gICAgciA9IGRpc2NvdW50UmF0ZTIgLyAyO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBjID0gY291cG9uUmF0ZTI7XHJcbiAgICBtID0gbWF0dXJpdHkyO1xyXG4gICAgciA9IGRpc2NvdW50UmF0ZTI7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIHB2KGMsIGYsIHQsIHIpIHtcclxuICAgIHJldHVybiBjICogKDEgLSAoMStyKSoqKC0obS10KSkpIC8gciArIGYgLyAoMStyKSoqKG0tdClcclxuICB9XHJcbiAgY29uc3QgY2FzaGZsb3dzID0ge1wiVGltZVwiOiBbXSwgXCJQVlwiOiBbXX07XHJcbiAgbGV0IGNvdXBvbiA9IGYgKiBjO1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbSsxOyArK2kpIHtcclxuICAgIGNhc2hmbG93c1tcIlRpbWVcIl0ucHVzaChpKTtcclxuICAgIGNhc2hmbG93c1tcIlBWXCJdLnB1c2gocHYoY291cG9uLCBmLCBpLCByKSk7XHJcbiAgfVxyXG4gIHJldHVybiBjYXNoZmxvd3M7XHJcbn1cclxuXHJcbmRhdGEyID0gdHJhbnNwb3NlKGIpXHJcblBsb3QucGxvdCh7XHJcbiAgY2FwdGlvbjogXCJBc3N1bWUgJDEwMCBib25kLCBjb3Vwb25zIHBhaWQgaW4gYXJyZWFycyBhbmQgZWZmZWN0aXZlIGFubnVhbCBkaXNjb3VudCByYXRlLlwiLFxyXG4gIHg6IHtwYWRkaW5nOiAwLjR9LFxyXG4gIGdyaWQ6IHRydWUsXHJcbiAgbWFya3M6IFtcclxuICAgIFBsb3QucnVsZVkoWzBdKSxcclxuICAgIFBsb3QucnVsZVkoWzEwMF0pLFxyXG4gICAgUGxvdC5iYXJZKGRhdGEyLCB7eDogXCJUaW1lXCIsIHk6IFwiUFZcIiwgZmlsbDogXCJibHVlXCJ9KSxcclxuICBdXHJcbn0pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IiBcclxudmlld29mIG1hdHVyaXR5MyA9IElucHV0cy5yYW5nZShcclxuICBbMSwgMzBdLCBcclxuICB7dmFsdWU6IDE1LCBzdGVwOiAxLCBsYWJlbDogXCJNYXR1cml0eSAoeWVhcnMpOlwifVxyXG4pXHJcbnZpZXdvZiBkaXNjb3VudFJhdGUzID0gSW5wdXRzLnJhbmdlKFxyXG4gICAgWzAuMDEsIDAuMl0sXHJcbiAgICB7dmFsdWU6IDAuMTAsIHN0ZXA6IDAuMDEsIGxhYmVsOlwiRGlzY291bnQgcmF0ZTpcIn1cclxuKVxyXG52aWV3b2YgY291cG9uUmF0ZTMgPSBJbnB1dHMucmFuZ2UoXHJcbiAgICBbMC4wMSwgMC4yXSxcclxuICAgIHt2YWx1ZTogMC4wNSwgc3RlcDogMC4wMSwgbGFiZWw6XCJDb3Vwb24gcmF0ZTpcIn1cclxuKVxyXG52aWV3b2YgY291cG9uRnJlcTMgPSBJbnB1dHMucmFkaW8oXHJcbiAgICBbXCJBbm51YWxcIiwgXCJTZW1pYW5udWFsXCJdLFxyXG4gICAge3ZhbHVlOiBcIkFubnVhbFwiLCBsYWJlbDpcIkNvdXBvbiBmcmVxdWVuY3k6XCJ9XHJcbilcclxuYyA9IHtcclxuICBjb25zdCBmID0gMTAwO1xyXG4gIGxldCBjLCBtLCByO1xyXG4gIGlmIChjb3Vwb25GcmVxMyA9PSBcIlNlbWlhbm51YWxcIikge1xyXG4gICAgYyA9IGNvdXBvblJhdGUzIC8gMjtcclxuICAgIG0gPSAyICogbWF0dXJpdHkzO1xyXG4gICAgciA9IGRpc2NvdW50UmF0ZTMgLyAyO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBjID0gY291cG9uUmF0ZTM7XHJcbiAgICBtID0gbWF0dXJpdHkzO1xyXG4gICAgciA9IGRpc2NvdW50UmF0ZTM7XHJcbiAgfVxyXG4gIGxldCBzY2FsZSA9IDMwMCAvIG07XHJcbiAgZnVuY3Rpb24gcHYoYywgZiwgdCwgcikge1xyXG4gICAgcmV0dXJuIGMgKiAoMSAtICgxK3IpKiooLShtLXQpKSkgLyByICsgZiAvICgxK3IpKioobS10KVxyXG4gIH1cclxuICBjb25zdCBjYXNoZmxvd3MgPSB7XCJUaW1lXCI6IFtdLCBcIkNsZWFuXCI6IFtdLCBcIkRpcnR5XCI6IFtdfTtcclxuICBsZXQgY291cG9uID0gZiAqIGM7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtICogc2NhbGUgKyAxOyArK2kpIHtcclxuICAgIGxldCB0ID0gcGFyc2VJbnQoaSAvIHNjYWxlLCAxMCk7XHJcbiAgICBjYXNoZmxvd3NbXCJUaW1lXCJdLnB1c2goaSk7XHJcbiAgICBsZXQgY2xlYW4gPSBwdihjb3Vwb24sIGYsIGkvc2NhbGUsIHIpO1xyXG4gICAgbGV0IGRpcnR5ID0gY2xlYW4gKyBjb3Vwb24gKiAoaS10KnNjYWxlKS9zY2FsZTtcclxuICAgIGNhc2hmbG93c1tcIkNsZWFuXCJdLnB1c2goY2xlYW4pO1xyXG4gICAgY2FzaGZsb3dzW1wiRGlydHlcIl0ucHVzaChkaXJ0eSk7XHJcbiAgfVxyXG4gIHJldHVybiBjYXNoZmxvd3M7XHJcbn1cclxuXHJcbmRhdGEzID0gdHJhbnNwb3NlKGMpXHJcblBsb3QucGxvdCh7XHJcbiAgY2FwdGlvbjogXCJBc3N1bWUgJDEwMCBib25kLCBjb3Vwb25zIHBhaWQgaW4gYXJyZWFycyBhbmQgZWZmZWN0aXZlIGFubnVhbCBkaXNjb3VudCByYXRlLlwiLFxyXG4gIHg6IHtwYWRkaW5nOiAwLjQsIFxyXG4gICAgICAgIHRyYW5zZm9ybTogKHgpID0+ICh4LygzMDAvbWF0dXJpdHkzKSksXHJcbiAgICAgICAgZG9tYWluOiBbMCwgbWF0dXJpdHkzXSxcclxuICAgICAgICBsYWJlbDogXCJZZWFyXCJ9LFxyXG4gIGdyaWQ6IHRydWUsXHJcbiAgbWFya3M6IFtcclxuICAgIFBsb3QucnVsZVkoWzAsIDEwMF0pLFxyXG4gICAgUGxvdC5ydWxlWChbMF0pLFxyXG4gICAgUGxvdC5saW5lWShkYXRhMywge3g6IFwiVGltZVwiLCB5OiBcIkNsZWFuXCIsIHN0cm9rZTogXCJibHVlXCJ9KSxcclxuICAgIFBsb3QubGluZVkoZGF0YTMsIHt4OiBcIlRpbWVcIiwgeTogXCJEaXJ0eVwiLCBzdHJva2U6IFwicmVkXCJ9KSxcclxuICBdXHJcbn0pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IiBcclxudmlld29mIG1hdHVyaXR5NCA9IElucHV0cy5yYW5nZShcclxuICBbMSwgMzBdLCBcclxuICB7dmFsdWU6IDE1LCBzdGVwOiAxLCBsYWJlbDogXCJNYXR1cml0eSAoeWVhcnMpOlwifVxyXG4pXHJcbnZpZXdvZiBjb3Vwb25SYXRlNCA9IElucHV0cy5yYW5nZShcclxuICAgIFswLjAxLCAwLjJdLFxyXG4gICAge3ZhbHVlOiAwLjA1LCBzdGVwOiAwLjAxLCBsYWJlbDpcIkNvdXBvbiByYXRlOlwifVxyXG4pXHJcbmQgPSB7XHJcbiAgY29uc3QgZiA9IDEwMDtcclxuICBsZXQgYywgbTtcclxuICBjID0gY291cG9uUmF0ZTQ7XHJcbiAgbSA9IG1hdHVyaXR5NDtcclxuICBmdW5jdGlvbiBwdihjLCBmLCB0LCByKSB7XHJcbiAgICByZXR1cm4gYyAqICgxIC0gKDErcikqKigtdCkpIC8gciArIGYgLyAoMStyKSoqKHQpXHJcbiAgfVxyXG4gIGNvbnN0IHByaWNlcyA9IHtcIllUTVwiOiBbXSwgXCJQcmljZVwiOiBbXX07XHJcbiAgbGV0IGNvdXBvbiA9IGYgKiBjO1xyXG4gIGZvciAobGV0IHl0bSA9IDAuMDE7IHl0bSA8IDIwOyB5dG0rKykge1xyXG4gICAgbGV0IHByaWNlID0gcHYoY291cG9uLCBmLCBtLCB5dG0vMTAwKTtcclxuICAgIHByaWNlc1tcIllUTVwiXS5wdXNoKHl0bSk7XHJcbiAgICBwcmljZXNbXCJQcmljZVwiXS5wdXNoKHByaWNlKTtcclxuICB9XHJcbiAgcmV0dXJuIHByaWNlcztcclxufVxyXG5cclxuZGF0YTQgPSB0cmFuc3Bvc2UoZClcclxuUGxvdC5wbG90KHtcclxuICBjYXB0aW9uOiBcIkFzc3VtZSAkMTAwIGJvbmQsIGFubnVhbCBjb3Vwb25zIHBhaWQgaW4gYXJyZWFycyBhbmQgZWZmZWN0aXZlIGFubnVhbCBkaXNjb3VudCByYXRlLlwiLFxyXG4gIHg6IHtwYWRkaW5nOiAwLjQsIGxhYmVsOiBcIllUTSAoJSlcIn0sXHJcbiAgZ3JpZDogdHJ1ZSxcclxuICBtYXJrczogW1xyXG4gICAgUGxvdC5ydWxlWShbMCwgMTAwXSksXHJcbiAgICBQbG90LnJ1bGVYKFswXSksXHJcbiAgICBQbG90LmxpbmVZKGRhdGE0LCB7eDogXCJZVE1cIiwgeTogXCJQcmljZVwiLCBzdHJva2U6IFwiYmx1ZVwifSksXHJcbiAgXVxyXG59KVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ21hdHVyaXR5JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2Rpc2NvdW50UmF0ZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdjb3Vwb25SYXRlJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2NvdXBvbkZyZXEnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnbWF0dXJpdHkyJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2Rpc2NvdW50UmF0ZTInKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnY291cG9uUmF0ZTInKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnY291cG9uRnJlcTInKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnbWF0dXJpdHkzJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2Rpc2NvdW50UmF0ZTMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnY291cG9uUmF0ZTMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnY291cG9uRnJlcTMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnbWF0dXJpdHk0JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2NvdXBvblJhdGU0JykifV19
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../posts/fixed-income/bond-prices-and-yields";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/mingze-gao\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="mgao6767/mingze-gao" data-repo-id="MDEwOlJlcG9zaXRvcnkyODEwMTIwMjk=" data-category="Comments" data-category-id="DIC_kwDOEL_nPc4CgWgL" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright ¬© 2019 - 2024 Mingze Gao</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mgao6767">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/AdrianMingzeGao">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/adriangao/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:mingze.gao@mq.edu.au">
      <i class="bi bi-send" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>